self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1295.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1295],{16690:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r(1311),o=r(4406),i=r(1497),c=r(2199),d=r(3),l=Object(d.mutatorAction)("removeSingleItemFromConversation",(function(e,t){var r,o,c=i.a.tableViews.get(t),d=Object(n.E)([e.itemConversationId.Id],c);try{for(var l=Object(a.__values)(d),s=l.next();!s.done;s=l.next()){u(s.value,e,t)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}}));function u(e,t,r){var a=Object(o.a)(t.itemConversationId.Id),n=Object(c.a)(e,r),i=n.itemIds.indexOf(t.itemId);i>=0&&(n.itemIds.splice(i,1),t.isRead||n.unreadCount--),(i=a.globalItemIds.indexOf(t.itemId))>=0&&(a.globalItemIds.splice(i,1),t.isRead||a.globalUnreadCount--),(i=n.draftItemIds.indexOf(t.itemId))>=0&&n.draftItemIds.splice(i,1)}var s=r(4701),b=r(1737),f=r(1712),v=r(77),O=r(3444),j=Object(v.e)(f.a,"clone_deleteItemsStoreUpdate",(function(e){var t,r,o=e.itemContexts[0],i=Object(s.a)(null==o?void 0:o.mailboxInfo,e.parentFolderId,!0);try{for(var c=Object(a.__values)(i),d=c.next();!d.done;d=c.next()){var l=d.value;Object(n.P)(l)?I(e.itemContexts,l):1==l.tableQuery.listViewType&&m(e.itemContexts,l)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}}));function m(e,t){var r=e.map((function(e){return e.itemId})),a=Object(n.E)(r,t),o=a.filter((function(e){return t.rowKeys.indexOf(e)>=0}));0!=o.length&&(Object(O.a)(o,t),y(t,a))}function I(e,t){var r,o,i,c;try{for(var d=Object(a.__values)(e),u=d.next();!u.done;u=d.next()){var s=u.value,b=Object(n.E)([s.itemConversationId.Id],t);try{for(var f=(i=void 0,Object(a.__values)(b)),v=f.next();!v.done;v=f.next()){var j=v.value,m=Object(n.K)(j,t.id);m&&(1==m.itemIds.length&&m.itemIds[0]==s.itemId?(Object(O.a)([j],t),y(t,[j])):l(s,t.id))}}catch(e){i={error:e}}finally{try{v&&!v.done&&(c=f.return)&&c.call(f)}finally{if(i)throw i.error}}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}}function y(e,t){0!==e.tableQuery.type&&2!==e.tableQuery.type||b.a.add(t,e,3)}var w=r(1849),h=r(1965),p=r(3008);function g(e,t,r){var a=t.id,o=Object(n.E)(e,t);if(0!=o.length){var i=function(e,t){for(var r=0,a=0,n=new Map,o=0;o<e.length;o++){var i=e[o],d=Object(c.a)(i,t);n.get(d.id)||(n.set(d.id,!0),r-=d.unreadCount,a-=d.itemIds.length)}return[r,a]}(o,a);Object(p.a)(i[0],i[1],t.serverFolderId,!0),0!=t.tableQuery.type&&2!=t.tableQuery.type||b.a.add(o,t,3),Object(h.a)(o,t,r)}}var C=Object(v.e)(w.a,"deleteConversationStoreUpdateClone",(function(e){g(e.conversationIds,e.tableView,e.actionType)})),V=r(2206),R=r(2996);var x=r(3272),E=Object(v.e)(x.a,"deleteFolderStoreUpdateClone",(function(e){e.folderIds.forEach((function(e){!function(e){Object(V.a)(e,!1).forEach((function(e){return Object(R.d)(e.id)}))}(e)}))})),S=r(2575),A=r(3144),k=r(2184),U=r(285),Q=r(8281);var _=Object(U.select)({tableViews:function(){return n.X.tableViews}})((function(e,t,r,a,o){var i=o.tableViews.get(t);0===i.tableQuery.type&&(b.a.add(e,i,1),Object(Q.a)(e,i)),Object(n.C)(e,t).forEach((function(e){o.tableViews.forEach((function(o){o.tableQuery.folderId==i.tableQuery.folderId&&Object(n.E)([e],o).forEach((function(e){(a(e,o.id,r),0===o.tableQuery.type)&&(Object(n.Z)(o,2),function(e,t,r,a,n){var o,i=Object(S.a)(a,r);if(i<0)throw new Error("Row being pinned / unpinnned must exist in the list");var c=n?0:i+1;return i<(o=Object(A.a)(e,t,r,c))&&o--,-1==o?(Object(h.a)([a],r,"Pin"),!1):(k.a.updateRowPosition(o,a,r),!0)}(n.b.getLastDeliveryOrRenewTimeStamp(e,o),n.b.getLastDeliveryTimeStamp(e,o),o,e,r)||o.id!=t||b.a.add([e],i,3))}))}))}))})),T=r(2816),K=r(3139),F=Object(v.e)(T.a,"clone_markConversationsAsPinnedStoreUpdate",(function(e){var t=e.rowKeys,r=e.tableViewId,a=e.shouldMarkAsPinned;_(t,r,a,M)}));function M(e,t,r){var a=Object(c.a)(e,t);if(a)if(r){var n=Object(K.d)();n&&(a.lastDeliveryOrRenewTimeStamp=n)}else a.lastDeliveryOrRenewTimeStamp=a.lastDeliveryTimeStamp}var P=r(2817),D=r(1323),L=Object(v.e)(P.a,"clone_markItemsAsPinnedStoreUpdate",(function(e){var t=e.rowKeys,r=e.tableViewId,a=e.shouldMarkAsPinned;_(t,r,a,X)}));function X(e,t,r){var a=Object(n.L)(e,t);if(a){var o=D.u.items.get(a.clientId.Id);if(r){var i=Object(K.d)();i&&(o.ReceivedOrRenewTime=i)}else o.ReceivedOrRenewTime=o.DateTimeReceived}}var G=r(1319),N=r(8214);var $=Object(U.action)("MarkItemsReadInListViewStore")(Object(U.select)({items:function(){return G.a.items},conversationItems:function(){return n.X.conversationItems}})((function(e,t,r,a){var o=r?-1*t.length:t.length,i=e.tableQuery.folderId;Object(N.a)(i)&&Object(p.a)(o,0,i,!0),0==e.tableQuery.listViewType&&t.forEach((function(e){var t=a.items.get(e);if(t){var o=t.ConversationId.Id;Object(s.a)(t.MailboxInfo,t.ParentFolderId.Id,!0).forEach((function(e){return function(e,t,r,a){var o=Object(n.E)([e],t),i=t.id;o.forEach((function(t){var n=Object(c.a)(t,i),o=a.get(e);n&&(r?(n.unreadCount--,o.globalUnreadCount--):(n.unreadCount++,o.globalUnreadCount++))}))}(o,e,r,a.conversationItems)}))}}))}))),q=r(1967),Z=Object(v.e)(q.a,"clone_markItemsAsReadStoreUpdateOrchestrator",(function(e){var t=e.itemIds,r=e.isReadValue,a=e.isExplicit,o=e.tableViewId,i=n.X.tableViews.get(o);if(i){$(i,t,r);var c=[],d=Object(n.ab)(i,r,a);1==i.tableQuery.listViewType?c=Object(n.E)(t,i):t.forEach((function(e){var t=D.u.items.get(e);if(t){var r=t.ConversationId.Id,a=Object(n.E)([r],i);a.forEach((function(e){var t=Object(n.K)(e,o);d&&0!=t.unreadCount||a.push(e)}))}})),0!=c.length&&(d?(b.a.add(c,i,3),Object(h.a)(c,i,"MarkAsRead")):b.a.add(c,i,2))}})),z=Object(U.action)("MarkConversationReadInListViewStore")(Object(U.select)({conversationItems:function(){return n.X.conversationItems}})((function(e,t,r,a,o){var i=0,c={};e.forEach((function(e){if(!(r.virtualSelectAllExclusionList.indexOf(e)>=0)){var a=Object(n.K)(e,r.id),d=B(a,t);a.unreadCount+=d;var l=a.id;o.conversationItems.get(l).globalUnreadCount+=d,c[l]||(c[l]=!0,i+=d),function(e,t,r){Object(V.a)(r.tableQuery.folderId,!1).forEach((function(a){if(a.id!==r.id){var o=Object(n.K)(e,a.id);if(o){var i=B(o,t);o.unreadCount+=i}}}))}(e,t,r)}})),a&&Object(p.a)(i,0,r.tableQuery.folderId,!0)})));function B(e,t){var r=e.unreadCount;return t?-1*r:e.itemIds.length-r}var H=r(1966),J=Object(v.e)(H.a,"clone_markConversationAsReadStoreUpdate",(function(e){var t=e.conversationIds,r=e.tableViewId,a=e.isReadValue,o=e.isExplicit,i=n.X.tableViews.get(r);if(i){var c=Object(n.E)(t,i);z(c,a,i,!0),Object(n.ab)(i,a,o)?(b.a.add(c,i,3),Object(h.a)(c,i,"MarkAsRead")):b.a.add(c,i,2)}})),W=r(1816),Y=Object(v.e)(W.a,"markAllAsReadOrchestratorClone",(function(e){var t=e.tableView,r=e.markAsRead;if(t)switch(t.tableQuery.listViewType){case 0:z(t.rowKeys,r,t,!1);break;case 1:var a=Object(n.C)(t.rowKeys,t.id);$(t,a,r)}})),ee=r(2646),te=Object(U.select)({tableViews:function(){return i.a.tableViews}})(Object(U.action)("removeTableFromStore")((function(e,t){var r=t.tableViews,a=r.get(e);Object(ee.a)()!=e&&(k.a.clear(a,null),r.delete(e),0==Object(V.a)(a.tableQuery.folderId,!1).length&&b.a.clearMapForFolder(a.serverFolderId))}))),re=r(3145),ae=r(3273),ne=r(3274),oe=r(269),ie=Object(v.e)(re.a,"clone_updateCategoriesInView",(function(e){var t,r,o=Object(n.G)();if(o){var i=e.modifiedCategoryName,c=e.newCategoryName,d=[];try{for(var l=Object(a.__values)(o.rowKeys),u=l.next();!u.done;u=l.next()){var s=u.value,f=n.b.getCategories(s,o);(null==f?void 0:f.includes(i))&&d.push(s)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}if(Object(oe.p)("UpdateCategoriesInViewMail",[d.length]),d.length>0){var v=c?[c]:null;Object(n.P)(o)?Object(ae.a)(d,o.id,v,[i],!1):Object(ne.a)(Object(n.C)(d,o.id),v,[i],!1),b.a.add(d,o,0)}}}));r.d(t,"deleteItemsStoreUpdateOrchestrator",(function(){return j})),r.d(t,"deleteConversationStoreUpdateOrchestrator",(function(){return C})),r.d(t,"deleteFolderStoreUpdateOrchestrator",(function(){return E})),r.d(t,"markConversationsAsPinnedStoreUpdateOrchestrator",(function(){return F})),r.d(t,"markItemsAsPinnedStoreUpdateOrchestrator",(function(){return L})),r.d(t,"markItemsAsReadStoreUpdateOrchestrator",(function(){return Z})),r.d(t,"markConversationsAsReadStoreUpdateOrchestrator",(function(){return J})),r.d(t,"markAllAsReadOrchestrator",(function(){return Y})),r.d(t,"removeTableFromStore",(function(){return te})),r.d(t,"updateCategoriesInViewOrchestrator",(function(){return ie}))},4701:function(e,t,r){"use strict";var a=r(2206),n=r(1425),o=r(1311),i=r(285),c=Object(i.select)({tableViews:function(){return o.X.tableViews}})((function(e,t,r){var a=r.tableViews,o=[];return a.forEach((function(r){(Object(n.b)(r.tableQuery)==e||t&&1==r.tableQuery.type)&&o.push(r)})),o}));function d(e,t,r){return e&&"GroupMailbox"==e.type?c(e.mailboxSmtpAddress,r):Object(a.a)(t,r)}r.d(t,"a",(function(){return d}))},8214:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r(1312),n=r(1325);function o(e){return Object(a.D)(e,n.c)||Object(a.D)(e,n.k)}},8281:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r(1510),n=r(1498);function o(e,t){var r=e[e.length-1],o=t.rowKeys.indexOf(r);o<t.rowKeys.length-1?Object(a.q)(t,t.rowKeys[o+1],!1,n.a.RowRemoval):Object(a.j)(t,n.a.Reset)}}}]);
//# sourceMappingURL=owa.1295.js.map
self.scriptsLoaded['owa.1295.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1295.js'] = (new Date()).getTime();