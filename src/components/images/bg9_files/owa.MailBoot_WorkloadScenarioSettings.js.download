self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~WorkloadScenarioSettings.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[777],{1346:function(t,e,n){"use strict";function r(t,e){Object.keys(e).forEach((function(n){return t.set(n,e[n])}))}function o(t){var e=null!=t?t:{headers:new Headers};return e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}))},1347:function(t,e,n){"use strict";var r=n(0),o=n(1405),a=n(388),c=n(662),i=n(269),u=n(9),s="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";function b(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,b,O,v,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n={},b=Object(a.k)(t)){if(b.accountState==a.b.AccessRevoked)return[2,null];if(b.accountState==a.b.AccountDeprovisioned||b.accountState==a.b.AccountNotFound)return Object(a.c)(b.accountState,b.accountProviderType),[2,null]}return e?(n[s]=e,n[f]=e):b&&(n[s]=b.anchorMailbox),b?(O=b.token,!(v=Object(c.g)(b.tokenExpiry))&&O?[3,2]:(Object(i.p)("getAndUpdateAccessToken",{tokenExpiry:Object(u.y)(b.tokenExpiry,Object(u.Pb)()),isTokenExpired_1:v,isTokenInvalid_2:!O},{isCore:!0}),[4,o.a.importAndExecute(b.accountId,t)])):[3,3];case 1:(O=r.sent())||(O=""),r.label=2;case 2:p=void 0,"Outlook"==b.accountProviderType?(p='MSAuth1.0 usertoken="'+O+'", type="MSACT"',n[l]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(p="Bearer "+O,n[l]=2..toString()),n[d]=p,r.label=3;case 3:return[2,n]}}))}))}var O=n(1346),v=n(59);function p(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(O.a)(),o=n,[4,m(t,e)];case 1:return o.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function m(t,e){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=e&&(null===(n=t.headers)||void 0===n?void 0:n.set)?new Headers(t.headers):new Headers,[4,b(t.mailboxInfo.userIdentity,h(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null)];case 1:return a=r.sent(),Object(O.b)(o,a),[2,o]}}))}))}function h(t,e){var n="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return n&&null==e&&v.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return h}))},1348:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3),o=Object(r.action)("triggerReInitializeAccount",(function(t){return{userIdentity:t}}))},1353:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1438);function o(){return r.a.currentWorkload}},1396:function(t,e,n){"use strict";var r=n(1353),o=n(1438),a=n(3),c=Object(a.mutatorAction)("setOwaWorkload",(function(t){o.a.currentWorkload=t})),i=n(1435);function u(){switch(Object(r.a)()){case 1:case 8:case 32:case 2415919103:case 0:return["outlookweberrors@microsoft.com"];case 2:return["outlookweberrors@microsoft.com","calendarreactfeedback@service.microsoft.com"];case 8192:return["outlookweberrors@microsoft.com","calendarreactfeedback@service.microsoft.com","timepanel@service.microsoft.com"];case 4:return["outlookweberrors@microsoft.com","Opfeedbackoc@service.microsoft.com"];case 4096:return["spacesteam@service.microsoft.com"];case 16384:return["eventifyfeedback@microsoft.com"];default:return["outlookweberrors@microsoft.com"]}}n.d(e,"b",(function(){return r.a})),n.d(e,"d",(function(){return c})),n.d(e,"c",(function(){return i.a})),n.d(e,"a",(function(){return u}))},1405:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(77),o=n(1348);n.d(e,"b",(function(){return o.a}));var a=new r.c((function(){return n.e(1149).then(n.bind(null,1664))})),c=new r.a(a,(function(t){return t.getAndUpdateAccessToken}))},1418:function(t,e,n){"use strict";var r=n(0),o=n(1346);function a(t){return{"X-OWA-ExplicitLogonUser":t,"X-AnchorMailbox":t}}function c(t,e){e&&t&&Object(o.b)(e,a(t))}function i(t,e){var n,o=null!=e?e:{},a=(null===(n=o.headers)||void 0===n?void 0:n.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",c(t,a),Object(r.__assign)(Object(r.__assign)({},o),{headers:a})}var u=n(388),s=n(1347),d=n(121),l=n(360);function f(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e=Object(d.a)(),t?Object(u.r)(t.userIdentity)?[4,Object(s.a)(t.userIdentity,"GroupMailbox"==t.type||"TeamsMailbox"==t.type?t.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return n=r.sent(),l(e,n),[3,3];case 2:"GroupMailbox"!=t.type&&"TeamsMailbox"!=t.type||(o=a(t.mailboxSmtpAddress),l(e,o)),r.label=3;case 3:return[2,e]}}))}))}function b(){var t=Object(d.a)();return t.prefer='exchange.Behavior="CalendarInternal"',t}function O(t){void 0===t&&(t=null);var e={};return Object(u.r)(t)?(e=b(),Object(s.a)(t).then((function(t){return Object.keys(t).forEach((function(n){return e[n]=t[n]})),e}))):Promise.resolve(e)}var v=n(43);function p(t,e,n){var r=new Headers;return n&&r.set("X-OWA-CANARY",Object(v.a)()),e&&r.set("X-OWA-ActionName",e),t&&c(t,r),r}n.d(e,"a",(function(){return i})),n.d(e,"d",(function(){return f})),n.d(e,"b",(function(){return O})),n.d(e,"c",(function(){return b})),n.d(e,"f",(function(){return c})),n.d(e,"e",(function(){return p}))},1435:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1353);function o(t){return!!(Object(r.a)()&t)}},1438:function(t,e,n){"use strict";var r=n(3);e.a=Object(r.createStore)("owaWorkload",{currentWorkload:0})()},1523:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return u}));var r,o=n(119),a=n(96);function c(){var t,e,n=d();return s()&&n?r.ToDo:(e=Object(a.h)(),(null===(t=e.SessionSettings)||void 0===t?void 0:t.IsShadowMailbox)||n?r.None:r.LegacyTasks)}function i(){return s()&&d()}function u(){return s()&&d(!0)}function s(){var t,e,n=Object(a.h)(),r=!Object(o.d)()&&(null===(t=n.SessionSettings)||void 0===t?void 0:t.IsExplicitLogon),c=null===(e=n.SessionSettings)||void 0===e?void 0:e.IsShadowMailbox;return!r&&!c}function d(t){var e=Object(a.h)(),n=e.UserOptions,r=e.PolicySettings;return!!((null==n?void 0:n.ReactOptinSettings)&&(n.ReactOptinSettings.TasksGraduatedFromBeta||n.ReactOptinSettings.TasksEnabled&&(t||function(t){var e;return(null===(e=null==t?void 0:t.ReactOptinSettings)||void 0===e?void 0:e.TasksShouldUseSharedToggle)?1!==t.ClientTypeOptInState:1!==t.TasksClientTypeOptInState}(n))&&function(t){if(t&&!1===t.OutlookBetaToggleEnabled)return!1;return!0}(r))&&null!==n.ReactOptinSettings.TasksRedirectUrl)}!function(t){t[t.None=0]="None",t[t.LegacyTasks=1]="LegacyTasks",t[t.ToDo=2]="ToDo"}(r||(r={}))},1654:function(t,e,n){"use strict";var r=n(3),o=Object(r.action)("closeFlexPane",(function(t){return{flexPaneId:t}}));e.a=o},1705:function(t,e,n){"use strict";var r=n(3),o=Object(r.action)("openTimePanel",(function(t){return{source:t}})),a=Object(r.action)("handleTimePanelClosed",(function(t,e,n,r){return{source:t,sessionDuration:e,lastView:n,clientItemId:r}})),c=Object(r.action)("popView"),i=n(722);function u(){return!Object(i.v)()||!window.opener}var s=n(1523);function d(){return u()&&Object(s.c)()}n.d(e,"d",(function(){return o})),n.d(e,"a",(function(){return a})),n.d(e,"e",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return d}))},1911:function(t,e,n){"use strict";function r(){return window.O365Shell}var o=n(3),a=Object(o.action)("openFlexPane",(function(t){return{flexPaneId:t}})),c=(Object(o.orchestrator)(a,(function(t){var e=r();e&&e.FlexPane.OpenFlexPaneForProvider(t.flexPaneId)})),n(1654));Object(o.orchestrator)(c.a,(function(t){var e=r();e&&e.FlexPane.CloseFlexPaneForProvider(t.flexPaneId)}));function i(t){var e=r();e&&e.Theme.SetSearchActive(t)}function u(t,e){r().Extensibility.SetCustomHeaderButtonBadgeValue(t,e)}function s(t,e){r().Extensibility.UpdateButtonState(t,e)}n.d(e,"a",(function(){return c.a})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return u})),n.d(e,"e",(function(){return s}))},4681:function(t,e,n){"use strict";var r=n(3),o=Object(r.action)("DEACTIVATE_CHARM",(function(t){return{charm:t}})),a=Object(r.createStore)("headerViewState",{activeCharm:null});Object(r.mutator)(o,(function(t){var e=t.charm,n=a();n.activeCharm===e&&(n.activeCharm=null)}));var c=Object(r.action)("TOGGLE_CHARM",(function(t){return{charm:t}}));function i(){return a().activeCharm}Object(r.mutator)(c,(function(t){var e=t.charm,n=a();n.activeCharm===e?n.activeCharm=null:n.activeCharm=e})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return c}))},6579:function(t,e,n){"use strict";n.r(e);var r=n(2049),o=(n(4342),n(2500),n(3228),n(83)),a=n(295),c=n(9201),i=n(1450),u=n(1705),s=n(3),d=null;function l(){Object(u.d)("AutoOpen")}Object(s.orchestrator)(r.j,(function(t){var e=t.settings,n=t.userIdentity;if(Object(a.d)().userIdentity===n&&(d=e.isTimePanelOpen,Object(i.c)())){var r=d&&Object(u.b)()&&Object(o.i)("cal-time-panel-softPin");Object(c.a)("OwaTimePanel",{shouldAutoOpen:r,handleAutoOpen:l})}})),Object(s.orchestrator)(i.e,(function(t){if(null!==d){var e=t.isRendered&&d&&Object(u.b)()&&Object(o.i)("cal-time-panel-softPin");Object(c.a)("OwaTimePanel",{shouldAutoOpen:e,handleAutoOpen:l})}}));n(9210);n.d(e,"loadWorkloadScenarioSettings",(function(){return r.a}))},9201:function(t,e,n){"use strict";var r=n(0),o=n(3),a=Object(o.action)("updateAutoOpenRegistrationInStore",(function(t,e){return{autoOpenPaneId:t,autoOpenRegistration:e}})),c=n(74),i=Object(o.action)("updateAutoOpenRegistration",(function(t,e){return{autoOpenPaneId:t,autoOpenRegistration:e}})),u=Object(o.action)("flexPaneAutoOpened",(function(t){return Object(c.c)({name:"flexPaneAutoOpened",customData:{autoOpenPaneId:t}},{autoOpenPaneId:t})})),s=["whatsNewPane","OwaTimePanel"],d=n(20),l=Object(o.createStore)("suiteHeaderAutoOpenStore",{autoOpenRegistrationMap:new d.ObservableMap});var f=n(4681),b=n(1911),O=!1;Object(o.orchestrator)(i,(function(t){var e=t.autoOpenPaneId,n=t.autoOpenRegistration;a(e,n),O||function(){var t,e,n=l().autoOpenRegistrationMap;try{for(var o=Object(r.__values)(s),a=o.next();!a.done;a=o.next()){var c=a.value;if(!n.has(c))break;var i=n.get(c),d=i.shouldAutoOpen,v=i.handleAutoOpen;if(d&&!Object(f.b)()){v?v():Object(b.b)(c),u(c),O=!0;break}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}}()}));Object(o.mutator)(a,(function(t){l().autoOpenRegistrationMap.set(t.autoOpenPaneId,t.autoOpenRegistration)}));n.d(e,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.MailBoot~WorkloadScenarioSettings.js.map
self.scriptsLoaded['owa.MailBoot~WorkloadScenarioSettings.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~WorkloadScenarioSettings.js'] = (new Date()).getTime();