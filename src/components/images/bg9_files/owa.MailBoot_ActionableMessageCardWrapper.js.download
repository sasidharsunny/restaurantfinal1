self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ActionableMessageCardWrapper.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[453],{112:function(e,t,n){"use strict";var r,a,i,o;n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(r||(r={})),function(e){e[e.January=0]="January",e[e.February=1]="February",e[e.March=2]="March",e[e.April=3]="April",e[e.May=4]="May",e[e.June=5]="June",e[e.July=6]="July",e[e.August=7]="August",e[e.September=8]="September",e[e.October=9]="October",e[e.November=10]="November",e[e.December=11]="December"}(a||(a={})),function(e){e[e.FirstDay=0]="FirstDay",e[e.FirstFullWeek=1]="FirstFullWeek",e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(i||(i={})),function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.WorkWeek=3]="WorkWeek"}(o||(o={}));var s=7},1245:function(e,t,n){"use strict";var r=n(450),a=n(744),i=n(0),o=n(14),s=n(342),l={root:"ms-Checkbox",label:"ms-Checkbox-label",checkbox:"ms-Checkbox-checkbox",checkmark:"ms-Checkbox-checkmark",text:"ms-Checkbox-text"};n.d(t,"a",(function(){return c}));var c=Object(r.a)(a.a,(function(e){var t,n,r,a,c,d,u,p,h,g,m,f,b,y,v,C,x,A,w=e.className,k=e.theme,S=e.reversed,E=e.checked,M=e.disabled,D=e.isUsingCustomLabelRender,O=e.indeterminate,P=k.semanticColors,I=k.effects,T=k.palette,R=k.fonts,_=Object(o.getGlobalClassNames)(l,k),F=P.inputForegroundChecked,j=T.neutralSecondary,H=T.neutralPrimary,V=P.inputBackgroundChecked,N=P.inputBackgroundChecked,B=P.disabledBodySubtext,W=P.inputBorderHovered,q=P.inputBackgroundCheckedHovered,L=P.inputBackgroundChecked,z=P.inputBackgroundCheckedHovered,U=P.inputBackgroundCheckedHovered,J=P.inputTextHovered,K=P.disabledBodySubtext,Y=P.bodyText,Z=P.disabledText,G=[(t={content:'""',borderRadius:I.roundedCorner2,position:"absolute",width:10,height:10,top:4,left:4,boxSizing:"border-box",borderWidth:5,borderStyle:"solid",borderColor:M?B:V,transitionProperty:"border-width, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)"},t[o.HighContrastSelector]={borderColor:"WindowText"},t)];return{root:[_.root,{position:"relative",display:"flex"},S&&"reversed",E&&"is-checked",!M&&"is-enabled",M&&"is-disabled",!M&&[!E&&(n={},n[":hover ."+_.checkbox]=(r={borderColor:W},r[o.HighContrastSelector]={borderColor:"Highlight"},r),n[":focus ."+_.checkbox]={borderColor:W},n[":hover ."+_.checkmark]=(a={color:j,opacity:"1"},a[o.HighContrastSelector]={color:"Highlight"},a),n),E&&!O&&(c={},c[":hover ."+_.checkbox]={background:z,borderColor:U},c[":focus ."+_.checkbox]={background:z,borderColor:U},c[o.HighContrastSelector]=(d={},d[":hover ."+_.checkbox]={background:"Highlight",borderColor:"Highlight"},d[":focus ."+_.checkbox]={background:"Highlight"},d[":focus:hover ."+_.checkbox]={background:"Highlight"},d[":focus:hover ."+_.checkmark]={color:"Window"},d[":hover ."+_.checkmark]={color:"Window"},d),c),O&&(u={},u[":hover ."+_.checkbox+", :hover ."+_.checkbox+":after"]=(p={borderColor:q},p[o.HighContrastSelector]={borderColor:"WindowText"},p),u[":focus ."+_.checkbox]={borderColor:q},u[":hover ."+_.checkmark]={opacity:"0"},u),(h={},h[":hover ."+_.text+", :focus ."+_.text]=(g={color:J},g[o.HighContrastSelector]={color:M?"GrayText":"WindowText"},g),h)],w],input:(m={position:"absolute",background:"none",opacity:0},m["."+s.a+" &:focus + label::before"]=(f={outline:"1px solid "+k.palette.neutralSecondary,outlineOffset:"2px"},f[o.HighContrastSelector]={outline:"1px solid ActiveBorder"},f),m),label:[_.label,k.fonts.medium,{display:"flex",alignItems:D?"center":"flex-start",cursor:M?"default":"pointer",position:"relative",userSelect:"none"},S&&{flexDirection:"row-reverse",justifyContent:"flex-end"},{"&::before":{position:"absolute",left:0,right:0,top:0,bottom:0,content:'""',pointerEvents:"none"}}],checkbox:[_.checkbox,Object(i.__assign)((b={position:"relative",display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:"20px",width:"20px",border:"1px solid "+H,borderRadius:I.roundedCorner2,boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)",overflow:"hidden",":after":O?G:null},b[o.HighContrastSelector]={borderColor:"WindowText"},b),Object(o.getEdgeChromiumNoHighContrastAdjustSelector)()),O&&{borderColor:V},S?{marginLeft:4}:{marginRight:4},!M&&!O&&E&&(y={background:L,borderColor:N},y[o.HighContrastSelector]={background:"Highlight",borderColor:"Highlight"},y),M&&(v={borderColor:B},v[o.HighContrastSelector]={borderColor:"GrayText"},v),E&&M&&(C={background:K,borderColor:B},C[o.HighContrastSelector]={background:"Window"},C)],checkmark:[_.checkmark,(x={opacity:E?"1":"0",color:F},x[o.HighContrastSelector]={color:M?"GrayText":"Window",MsHighContrastAdjust:"none"},x)],text:[_.text,Object(i.__assign)((A={color:M?Z:Y,fontSize:R.medium.fontSize,lineHeight:"20px"},A[o.HighContrastSelector]={color:M?"GrayText":"WindowText"},A),Object(o.getEdgeChromiumNoHighContrastAdjustSelector)()),S?{marginRight:4}:{marginLeft:4}]}}),void 0,{scope:"Checkbox"})},1250:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),a=n(1);function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=a.useCallback((function(t){n.current=t;for(var r=0,a=e;r<a.length;r++){var i=a[r];"function"==typeof i?i(t):i&&(i.current=t)}}),Object(r.__spreadArrays)(e));return n}},1253:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1),a=n(287);function i(e,t){var n=r.useRef(t);return n.current||(n.current=Object(a.a)(e)),n.current}},15120:function(e,t,n){(t=e.exports=n(130)(!1)).push([e.i,'._2R7wx7a9koHooJELbVyEWi{font-size:14px;font-weight:400;color:"[theme:white, default:#ffffff]"}._2p8I-DHLZpnIHT0vkKkDZM{position:fixed;bottom:30px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;z-index:1}._2p8I-DHLZpnIHT0vkKkDZM,._1EHVjHBO69jddHdTidAMN8{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}._1EHVjHBO69jddHdTidAMN8{max-width:460px;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}html[dir] ._1EHVjHBO69jddHdTidAMN8{padding:8px;-webkit-box-shadow:0 1px 12px 0 "[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]";box-shadow:0 1px 12px 0 "[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]";background-color:"[theme:neutralSecondary, default:#666666]"}._2jPIBkdCALUVmJh3k1zkvO{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:2;-ms-flex-positive:2;flex-grow:2;min-width:1px}html[dir] ._2jPIBkdCALUVmJh3k1zkvO{margin:0 8px}.iKqe_w_dK46ZPeqa2hzFB{font-size:18px}html[dir] .iKqe_w_dK46ZPeqa2hzFB{margin:8px}._1P08H1CEHzi04RDPSli-Fy{color:"[theme:white, default:#ffffff]";display:-webkit-box;display:-ms-flexbox;display:flex}._3TphKWxxta8paUeuXTArBr{font-size:10px;cursor:pointer}html[dir] ._3TphKWxxta8paUeuXTArBr{margin:8px}._1tED-VlMI_8p7Hayavw3uC{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;height:32px;line-height:32px}.YTDvfyvXnVtwubenDimsi{position:absolute;width:100%;height:100%;top:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;z-index:10}html[dir] .YTDvfyvXnVtwubenDimsi{background-color:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] .YTDvfyvXnVtwubenDimsi{left:0}html[dir=rtl] .YTDvfyvXnVtwubenDimsi{right:0}._3fMwgRYr-98s_kP5E3Ao3W{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex}._3-Htj7JisEpn8gzJcl29c4{font-size:14px;font-weight:400;color:"[theme:white, default:#ffffff]"}html[dir] ._10ihrqubqPBOeDgvsdd16B{background-color:"[theme:neutralLighter, default:#f4f4f4]"!important}._3Sbt6wl1scVqEHeZKFsDeC{position:relative}html[dir] ._3Sbt6wl1scVqEHeZKFsDeC{border-color:"[theme:neutralLighter, default:#f4f4f4]";border-width:1px;border-style:solid}html[dir] ._3Sbt6wl1scVqEHeZKFsDeC .ms-ChoiceField{margin-top:0!important}html[dir] ._3Sbt6wl1scVqEHeZKFsDeC .ms-Checkbox{margin:8px 0}html[dir] ._3Sbt6wl1scVqEHeZKFsDeC .ms-Checkbox:first-child{margin-top:0}html[dir] ._3Sbt6wl1scVqEHeZKFsDeC .ms-Checkbox:last-child{margin-bottom:0}._1qH63D22WLA3KpkfRF6EAf{width:100%}.ac-pushButton{overflow:hidden;text-overflow:ellipsis;vertical-align:middle;cursor:default;font-family:Segoe UI,sans-serif;font-size:14px;font-weight:600;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;height:31px}html[dir] .ac-pushButton{text-align:center;padding:4px 10px 5px 10px;border:1px solid;margin-top:1px;margin-bottom:1px}[data-ac-theme=none] .ac-pushButton{color:"[theme:themePrimary, default:#0078D4]"}html[dir] [data-ac-theme=none] .ac-pushButton{background-color:"[theme:white, default:#ffffff]";border-color:"[theme:themePrimary, default:#0078D4]"}[data-ac-theme=none] .ac-pushButton:hover{color:"[theme:white, default:#ffffff]"}html[dir] [data-ac-theme=none] .ac-pushButton:hover{background-color:"[theme:themePrimary, default:#0078D4]";border-color:"[theme:themePrimary, default:#0078D4]"}html[dir] .ac-pushButton.primary,html[dir] .ac-pushButton:hover{border:1px solid}[data-ac-theme=none] .ac-pushButton.primary{color:"[theme:white, default:#ffffff]"}html[dir] [data-ac-theme=none] .ac-pushButton.primary{background-color:"[theme:themePrimary, default:#0078D4]";border-color:"[theme:themePrimary, default:#0078D4]"}html[dir] [data-ac-theme=none] .ac-pushButton.primary:hover{background-color:"[theme:themeDark, default:#0D62AA]"}.ac-pushButton:active{cursor:pointer}html[dir] .ac-pushButton.expanded{border:1px solid}[data-ac-theme=none] .ac-pushButton.expanded{color:"[theme:white, default:#ffffff]"}html[dir] [data-ac-theme=none] .ac-pushButton.expanded{background-color:"[theme:themePrimary, default:#0078D4]";border-color:"[theme:themePrimary, default:#0078D4]"}.ac-pushButton.expandable:after{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-block;font-family:controlIcons;font-size:10px;font-style:normal;font-weight:900;content:"\\E70D"}html[dir=ltr] .ac-pushButton.expandable:after{margin:auto 0 auto 6px}html[dir=rtl] .ac-pushButton.expandable:after{margin:auto 6px auto 0}.ac-pushButton.expandable.expanded:after{content:"\\E70E"}.ac-image.ac-selectable{cursor:pointer}.ac-anchor{text-decoration:none;display:inline-block}html[dir] .ac-anchor{margin-top:1px;margin-bottom:1px}.ac-anchor:link,.ac-anchor:visited{color:"[theme:themeDark, default:#0D62AA]"}.ac-anchor:link:active,.ac-anchor:visited:active{color:"[theme:themeDarker, default:#004578]"}html[dir] .ac-container.ac-selectable{padding:0}html[dir] .ac-container.ac-selectable:hover{background-color:"[theme:neutralLight, default:#eaeaea]"!important}html[dir] .ac-container.ac-selectable:active{background-color:"[theme:neutralQuaternaryAlt, default:#dadada]"!important}html[dir] .ac-columnSet.ac-selectable:hover{background-color:"[theme:neutralLight, default:#eaeaea]"!important}html[dir] .ac-columnSet.ac-selectable:active{background-color:"[theme:neutralQuaternaryAlt, default:#dadada]"!important}html[dir] .ac-input{padding:4px 12px}.ac-hidden{display:none!important}.aaf-progress-overlay{position:absolute;top:0;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}html[dir] .aaf-progress-overlay{background-color:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] .aaf-progress-overlay{left:0}html[dir=rtl] .aaf-progress-overlay{right:0}@-webkit-keyframes _3ilbqWY3XudIKC4s2Ymqi7{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(-1turn);transform:rotate(-1turn)}}@-webkit-keyframes _1n_YmmDspFOJzaqxevLZPl{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes _3ilbqWY3XudIKC4s2Ymqi7{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(-1turn);transform:rotate(-1turn)}}@keyframes _1n_YmmDspFOJzaqxevLZPl{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.aaf-spinner{width:100%;height:100%;-webkit-animation-duration:1.5s;animation-duration:1.5s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-timing-function:cubic-bezier(.53,.21,.29,.67);animation-timing-function:cubic-bezier(.53,.21,.29,.67)}html[dir] .aaf-spinner{border-radius:50%;border-width:1.5px;border-style:solid;border-color:"[theme:themePrimary, default:#0078D4]" "[theme:themeLight, default:#C7E0F4]" "[theme:themeLight, default:#C7E0F4]" "[theme:themeLight, default:#C7E0F4]"}html[dir=ltr] .aaf-spinner{-webkit-animation-name:_1n_YmmDspFOJzaqxevLZPl;animation-name:_1n_YmmDspFOJzaqxevLZPl}html[dir=rtl] .aaf-spinner{-webkit-animation-name:_3ilbqWY3XudIKC4s2Ymqi7;animation-name:_3ilbqWY3XudIKC4s2Ymqi7}html[dir] .aaf-refreshButtonHost{border-top:1px solid "[theme:neutralLighter, default:#f4f4f4]"}',""]),t.locals={actionResponseMessage:"_2R7wx7a9koHooJELbVyEWi",actionResponseContainer:"_2p8I-DHLZpnIHT0vkKkDZM",actionResponseWrapper:"_1EHVjHBO69jddHdTidAMN8",actionResponseMessageContainer:"_2jPIBkdCALUVmJh3k1zkvO",actionResponseStatusIconContainer:"iKqe_w_dK46ZPeqa2hzFB",actionResponseIcon:"_1P08H1CEHzi04RDPSli-Fy",actionResponseCloseIconContainer:"_3TphKWxxta8paUeuXTArBr",acknowledgeButtonText:"_1tED-VlMI_8p7Hayavw3uC",actionInProgressOverlay:"YTDvfyvXnVtwubenDimsi",actionInProgressSpinner:"_3fMwgRYr-98s_kP5E3Ao3W",actionInProgressLabel:"_3-Htj7JisEpn8gzJcl29c4",compactCard:"_10ihrqubqPBOeDgvsdd16B",container:"_3Sbt6wl1scVqEHeZKFsDeC",inputElementWrapper:"_1qH63D22WLA3KpkfRF6EAf","aaf-spinner-rotate":"_1n_YmmDspFOJzaqxevLZPl","aaf-spinner-rotate-rtl":"_3ilbqWY3XudIKC4s2Ymqi7"}},15127:function(e,t,n){(e.exports=n(130)(!1)).push([e.i,'.compactMessageCard-ac-pushButton{overflow:hidden;text-overflow:ellipsis;vertical-align:middle;cursor:pointer;font-family:Segoe UI,sans-serif;font-size:12px;font-weight:600;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}html[dir] .compactMessageCard-ac-pushButton{text-align:center}[data-ac-theme=none] .compactMessageCard-ac-pushButton{color:"[theme:themePrimary, default:#0078D4]"}html[dir] [data-ac-theme=none] .compactMessageCard-ac-pushButton,html[dir] [data-ac-theme=none] .compactMessageCard-ac-pushButton:hover{background-color:transparent}.compactMessageCard-ac-pushButton:active{cursor:pointer}[data-ac-theme=none] .compactMessageCard-ac-pushButton.expanded{color:"[theme:white, default:#ffffff]"}.compactMessageCard-ac-pushButton.expandable:after{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-block;font-family:controlIcons;font-size:10px;font-style:normal;font-weight:900;content:"\\E70D"}html[dir=ltr] .compactMessageCard-ac-pushButton.expandable:after{margin:auto 0 auto 6px}html[dir=rtl] .compactMessageCard-ac-pushButton.expandable:after{margin:auto 6px auto 0}.compactMessageCard-ac-pushButton.expandable.expanded:after{content:"\\E70E"}.compactMessageCard-ac-image.ac-selectable{cursor:pointer}.compactMessageCard-ac-anchor{text-decoration:none}.compactMessageCard-ac-anchor:link,.compactMessageCard-ac-anchor:visited{color:"[theme:themeDark, default:#0D62AA]"}.compactMessageCard-ac-anchor:link:active,.compactMessageCard-ac-anchor:visited:active{color:"[theme:themeDarker, default:#004578]"}html[dir] .compactMessageCard-ac-container.ac-selectable{padding:0}html[dir] .compactMessageCard-ac-container.ac-selectable:hover{background-color:"[theme:neutralLight, default:#eaeaea]"!important}html[dir] .compactMessageCard-ac-container.ac-selectable:active{background-color:"[theme:neutralQuaternaryAlt, default:#dadada]"!important}html[dir] .compactMessageCard-ac-columnSet.ac-selectable:hover{background-color:"[theme:neutralLight, default:#eaeaea]"!important}html[dir] .compactMessageCard-ac-columnSet.ac-selectable:active{background-color:"[theme:neutralQuaternaryAlt, default:#dadada]"!important}html[dir] .compactMessageCard-ac-input{padding:4px 12px}.compactMessageCard-ac-textBlock{font-size:14px;font-weight:400}',""])},16626:function(e,t,n){"use strict";n.r(t);var r,a,i=n(0),o=n(1),s=n(721),l=n(83),c=n(942),d=n(949),u=n(314),p=n(1650),h=n(269),g=n(59),m=n(362),f=n(3520),b=n(6901);!function(e){e[e.Success=0]="Success",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(r||(r={})),function(e){e[e.AutoDismiss=0]="AutoDismiss",e[e.Freeze=1]="Freeze"}(a||(a={}));var y=n(49),v=n(335),C=n(753),x="action:",A="compact",w="amCardContent",k="640px",S="left",E="ActionCardExpanded",M="ActionCardCollapsed",D="MessageCardRendered",O="MessageCardHidden",P="MessageCardRemoved",I="MessageCardViewActionClicked",T="HttpPostActionExecuted",R="actionContext",_=6e5,F=1e3,j=n(263),H=n(1585),V=n(4325),N=Object(y.a)((function(e){var t=o.useRef(null),n=Object(i.__read)(o.useState(640),2),s=n[0],l=n[1],c=null;o.useEffect((function(){if(e.viewType===a.AutoDismiss){var t=e.autoDismissTimeout||8e3;c=setTimeout((function(){return e.onHideActionResponse()}),t)}return u(),function(){c&&clearTimeout(c)}}),[]);var d,u=function(){(null==t?void 0:t.current)&&l(t.current.parentNode.offsetWidth)};Object(H.a)("resize",u),d=e.type===r.Success?"Completed":"Info";var p={root:{backgroundColor:Object(j.h)().neutralLighter,borderColor:Object(j.h)().white,color:Object(j.h)().neutralPrimary,marginLeft:"8px",marginRight:"8px",paddingLeft:"4px",paddingRight:"4px"},rootHovered:{backgroundColor:Object(j.h)().neutralLighterAlt,borderColor:Object(j.h)().white,color:Object(j.h)().neutralPrimary},rootPressed:{backgroundColor:Object(j.h)().white,borderColor:Object(j.h)().white,color:Object(j.h)().neutralPrimary},textContainer:{overflow:"hidden"},label:V.acknowledgeButtonText};return e.message&&o.createElement("div",{style:{width:s},className:V.actionResponseContainer,ref:t},o.createElement("div",{className:V.actionResponseWrapper},o.createElement("div",{className:V.actionResponseStatusIconContainer},o.createElement(v.a,{iconName:d,className:V.actionResponseIcon})),o.createElement("div",{className:V.actionResponseMessageContainer},o.createElement("div",{className:V.actionResponseMessage},e.message)),e.acknowledgeButtonText&&e.onAcknowledgeActionResponse?o.createElement(C.a,{text:e.acknowledgeButtonText,title:e.acknowledgeButtonText,ariaLabel:e.acknowledgeButtonText,styles:p,onClick:e.onAcknowledgeActionResponse}):"",o.createElement("div",{className:V.actionResponseCloseIconContainer,onClick:function(){e.onHideActionResponse()}},o.createElement(v.a,{iconName:"ChromeClose",className:V.actionResponseIcon}))))})),B=n(6183),W=n(6902);function q(e,t){return void 0===t&&(t="default"),Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(i.__generator)(this,(function(a){switch(a.label){case 0:return e?[3,1]:(g.g.info("No download theme callback provided"),Object(W.a)(3),[3,5]);case 1:if(0!==f.a.themeStore.loadStatus)return[3,5];Object(W.a)(1),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,e(t)];case 3:return n=a.sent(),Object.keys(n).forEach((function(e){Object(B.a)(e,n[e])})),Object(W.a)(2),[3,5];case 4:return r=a.sent(),g.g.info("Error downloading theme definitions: "+r),Object(W.a)(3),[3,5];case 5:return[2]}}))}))}var L=function(e){function t(t){var n=e.call(this,t)||this;return n.cardHorizontalAlignment=t.cardHorizontalAlignment,n.cardMaximumWidth=t.cardMaximumWidth,n.cardHostBackgroundColor=t.cardHostBackgroundColor,n}return Object(i.__extends)(t,e),t}(p.HostConfig),z="640px";function U(){var e=new p.HostConfig({choiceSetInputValueSeparator:",",spacing:{small:10,default:12,medium:14,large:16,extraLarge:18,padding:8},separator:{lineThickness:1,lineColor:"#19000000"},supportsInteractivity:!0,fontFamily:"wf_segoe-ui_normal, sans-serif",fontSizes:{small:10,default:12,medium:14,large:16,extraLarge:18},fontWeights:{lighter:200,default:400,bolder:600},containerStyles:{default:{highlightBackgroundColor:"#f0f0f0",highlightForegroundColor:"#000000",backgroundColor:"#EAEAEA",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#FFD800",subtle:"#DDFFD800"},good:{default:"#00FF00",subtle:"#DD00FF00"},warning:{default:"#FF0000",subtle:"#DDFF0000"}}},emphasis:{backgroundColor:"#E0E0E0",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#FFD800",subtle:"#DDFFD800"},good:{default:"#00FF00",subtle:"#DD00FF00"},warning:{default:"#FF0000",subtle:"#DDFF0000"}}}},imageSizes:{small:16,medium:32,large:64},actions:{maxActions:5,spacing:p.Spacing.Default,buttonSpacing:20,showCard:{actionMode:p.ShowCardActionMode.Inline,inlineTopMargin:10},actionsOrientation:p.Orientation.Horizontal,actionAlignment:p.ActionAlignment.Left,preExpandSingleShowCardAction:!0},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:p.Size.Medium,maxImageHeight:100},factSet:{title:{color:p.TextColor.Default,size:p.TextSize.Default,isSubtle:!1,weight:p.TextWeight.Bolder,wrap:!0,maxWidth:150},value:{color:p.TextColor.Default,size:p.TextSize.Default,isSubtle:!1,weight:p.TextWeight.Default,wrap:!0},spacing:10}});return e.cardHorizontalAlignment="center",e.cardMaximumWidth=z,e.cssClassNamePrefix="compactMessageCard",e}function J(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){var r;return e=e.toLowerCase(),t={hostConfig:(r=new p.HostConfig({choiceSetInputValueSeparator:",",spacing:{small:8,default:16,medium:16,large:24,extraLarge:32,padding:16},separator:{lineThickness:1,lineColor:"#e1e1e1"},supportsInteractivity:!0,fontFamily:"Segoe UI, sans-serif",fontSizes:{small:12,default:14,medium:16,large:18,extraLarge:20},fontWeights:{lighter:200,default:400,bolder:600},containerStyles:{default:{highlightBackgroundColor:"#f0f0f0",highlightForegroundColor:"#000000",backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#212121",subtle:"#8e8e93"},dark:{default:"#1f1f1f",subtle:"#707070"},light:{default:"#707070",subtle:"#8e8e93"},accent:{default:"#0078d4",subtle:"#69AFE5"},attention:{default:"#E4252B",subtle:"#F17a7D"},good:{default:"#0A8533",subtle:"#5BA975"},warning:{default:"#FFA800",subtle:"#F2BE4D"}}},emphasis:{backgroundColor:"#F8F8F8",foregroundColors:{default:{default:"#212121",subtle:"#8e8e93"},dark:{default:"#1f1f1f",subtle:"#707070"},light:{default:"#707070",subtle:"#8e8e93"},accent:{default:"#0078d4",subtle:"#69AFE5"},good:{default:"#0a8031",subtle:"#5BA975"},warning:{default:"#FFA800",subtle:"#F2BE4D"},attention:{default:"#DA1b21",subtle:"#F17a7d"}}},customStyles:[{name:"outlookHeader",style:{foregroundColors:{default:{default:"#ffffff",subtle:"#8e8e93"},dark:{default:"#1f1f1f",subtle:"#707070"},light:{default:"#707070",subtle:"#8e8e93"},accent:{default:"#0078d4",subtle:"#69AFE5"},good:{default:"#0A8533",subtle:"#5BA975"},warning:{default:"#FFA800",subtle:"#F2BE4D"},attention:{default:"#E4252B",subtle:"#F17a7D"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#0078D4"}}]},imageSizes:{small:40,medium:160,large:320},actions:{maxActions:5,spacing:p.Spacing.Default,buttonSpacing:16,showCard:{actionMode:p.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:p.Orientation.Horizontal,actionAlignment:p.ActionAlignment.Left,preExpandSingleShowCardAction:!0},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:p.Size.Medium,maxImageHeight:100},factSet:{title:{color:p.TextColor.Default,size:p.TextSize.Default,isSubtle:!0,weight:p.TextWeight.Lighter,wrap:!0,maxWidth:150},value:{color:p.TextColor.Default,size:p.TextSize.Default,isSubtle:!1,weight:p.TextWeight.Default,wrap:!0},spacing:8}}),r.cardHorizontalAlignment="center",r.cardMaximumWidth=z,r),isResolved:!0,stylesheetUrl:null,themeConfigUrl:null},2!==f.a.themeStore.loadStatus?[2,Promise.resolve(t)]:"default"===e?[2,Promise.resolve(t)]:"compact"===e?[2,Promise.resolve({hostConfig:U(),isResolved:!0,stylesheetUrl:null,themeConfigUrl:null})]:[2,K(e).then((function(e){return Promise.resolve(e)})).catch((function(e){return g.g.info("Error resolving theme: "+e),Promise.resolve(t)}))]}))}))}function K(e){return new Promise((function(t,n){var r=f.a.themeStore.loadStatus;switch(g.g.info("Theme definitions load status: "+r),r){case 2:var a=f.a.themeStore.themeMapping[e];a?a.isResolved?t(a):function(e,t){return new Promise((function(n,r){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status)try{var i=JSON.parse(a.response),o={themeConfigUrl:t,hostConfig:new L(i.hostConfig),isResolved:!0,stylesheetUrl:i.stylesheet};Object(B.a)(e,o),n(o)}catch(e){r(new Error("downloadTheme: error parsing response json"))}else r(new Error("downloadTheme http error: received "+a.status))},a.ontimeout=function(){r(new Error("downloadTheme timeout"))},a.open("GET",t,!0),a.timeout=2e3,a.send()}))}(e,a.themeConfigUrl).then((function(e){t(e)})).catch((function(e){n(e)})):n("No theme matching name "+e+" found in store");break;case 3:n("Could not resolve theme. Themes were not loaded")}}))}var Y="#eeeeee";var Z=n(306),G=n(1381),X=n(1391),Q=n(1515),$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){this.personaElement=document.createElement("div");var e=o.createElement(ee,{emailAddress:this.email,name:""});return Z.render(e,this.personaElement),this.personaElement},t.prototype.remove=function(){return this.personaElement&&(Z.unmountComponentAtNode(this.personaElement),this.personaElement=null),e.prototype.remove.call(this)},t.prototype.getJsonTypeName=function(){return"Persona"},t.prototype.renderSpeech=function(){return this.email},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.email=t.email},t}(p.CardElement);function ee(e){var t=Object(Q.a)(e),n=e.emailAddress,r=e.name,a=e.mailBoxType;return o.createElement(t,null,o.createElement(G.a,{emailAddress:n,name:r,size:X.c.size48,showPersonaDetails:!1,mailboxType:a}))}var te,ne=n(1245),re=n(7342),ae=n(1279),ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.choices=[],t.isCompact=!1,t.isMultiSelect=!1,t.wrap=!1,t.isRequired=!1,t.onDropdownChanged=function(e,n){t.selectedChoiceIndices=[n]},t.onChoiceGroupChanged=function(e,n){t.selectedChoiceIndices=[n.index]},t}return Object(i.__extends)(t,e),t.prototype.renderCheckboxGroup=function(e){for(var t=this,n=[],r=function(r){n.push(o.createElement(ne.a,{defaultChecked:e.filter((function(e){return e===t.choices[r].value})).length>0,label:a.choices[r].title,onChange:a.getOnCheckboxChangedHandler(r)}))},a=this,i=0;i<this.choices.length;i++)r(i);return o.createElement(o.Fragment,null,n)},t.prototype.getOnCheckboxChangedHandler=function(e){var t=this;return function(n,r){r?t.selectedChoiceIndices.push(e):t.selectedChoiceIndices.splice(t.selectedChoiceIndices.indexOf(e),1)}},t.prototype.parseValueString=function(e){return e?e.split(this.hostConfig.choiceSetInputValueSeparator):[]},t.prototype.internalRender=function(){if(this.element=document.createElement("div"),this.element.style.width="100%",!this.initialized)return g.g.warn("[ActionableMessageDebug] CustomChoiceSetInput: Control not initialized before render"),this.element;if(this.isMultiSelect)Z.render(this.renderCheckboxGroup(this.parseValueString(this.defaultValue)),this.element);else if(this.isCompact){var e=this.placeholder||t.strings.placeholder.choiceSetInput;Z.render(o.createElement(o.StrictMode,null,o.createElement(ae.a,{onChanged:this.onDropdownChanged,label:this.title,options:this.mappedChoices,defaultSelectedKey:this.defaultValue,placeHolder:e,required:this.isRequired})),this.element)}else Z.render(o.createElement(o.StrictMode,null,o.createElement(re.a,{onChange:this.onChoiceGroupChanged,label:this.title,options:this.mappedChoices,defaultSelectedKey:this.defaultValue,required:this.isRequired})),this.element);return this.element},t.prototype.initialize=function(){var e=this;this.mappedChoices=this.choices.map((function(e,t){return{key:e.value,text:e.title,index:t}})),this.selectedChoiceIndices=[];for(var t=this.parseValueString(this.defaultValue),n=function(n){t.filter((function(t){return t===e.choices[n].value})).length>0&&r.selectedChoiceIndices.push(n)},r=this,a=0;a<this.choices.length;a++)n(a);this.initialized=!0},t.prototype.toJSON=function(){var t,n,r=e.prototype.toJSON.call(this);if(this.choices.length>0){var a=[];try{for(var o=Object(i.__values)(this.choices),s=o.next();!s.done;s=o.next()){var l=s.value;a.push(l.toJSON())}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}Object(p.setProperty)(r,"choices",a)}return this.isCompact||Object(p.setProperty)(r,"style","expanded",!1),Object(p.setProperty)(r,"isMultiSelect",this.isMultiSelect,!1),Object(p.setProperty)(r,"wrap",this.wrap,!1),Object(p.setProperty)(r,"placeholder",this.placeholder),Object(p.setProperty)(r,"isRequired",this.isRequired,!1),r},t.prototype.parse=function(t,n){if(e.prototype.parse.call(this,t,n),this.isCompact=!("expanded"===t.style),this.isMultiSelect=Object(p.getBoolValue)(t.isMultiSelect,this.isMultiSelect),this.placeholder=Object(p.getStringValue)(t.placeholder,this.placeholder),this.choices=[],null!=t.choices)for(var r=t.choices,a=0;a<r.length;a++){var i=new p.Choice;i.parse(r[a]),this.choices.push(i)}this.wrap=Object(p.getBoolValue)(t.wrap,this.wrap),this.isRequired=Object(p.getBoolValue)(t.isRequired,this.isRequired),this.initialize()},t.prototype.remove=function(){return this.element&&(Z.unmountComponentAtNode(this.element),this.element=null),e.prototype.remove.call(this)},t.prototype.internalValidateProperties=function(e){this.isRequired&&!this.value&&e.addFailure(this,{error:p.ValidationError.InvalidPropertyValue,message:t.strings.warning.missingRequiredInput})},t.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},Object.defineProperty(t.prototype,"value",{get:function(){var e="";if(this.selectedChoiceIndices)for(var t=0;t<this.selectedChoiceIndices.length;t++){""!==e&&(e+=this.hostConfig.choiceSetInputValueSeparator);var n=this.selectedChoiceIndices[t];this.choices[n].value?e+=this.choices[n].value:e+=this.choices[n].title}return e},enumerable:!1,configurable:!0}),t}(p.Input),oe=n(1304),se=n(112),le=n(4325),ce=n.n(le),de=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selectedDate=null,t.isRequired=!1,t.onSelectDate=function(e){e instanceof Date&&(t.selectedDate=e)},t.dateNotValid=function(){return t.isRequired&&null===t.selectedDate},t}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){this.datePickerElement=document.createElement("div"),this.datePickerElement.className=ce.a.inputElementWrapper;var e=new Date(Date.now()),n=this.defaultValue?new Date(this.defaultValue):null,r=this.min?new Date(this.min):null,a=this.max?new Date(this.max):null,i=this.placeholder||t.strings.placeholder.dateInput;return Z.render(o.createElement(o.StrictMode,null,o.createElement(oe.a,{strings:t.strings.datePicker,isMonthPickerVisible:!1,showMonthPickerAsOverlay:!0,firstDayOfWeek:se.c.Sunday,today:e,value:n,minDate:r,maxDate:a,isRequired:this.isRequired,placeholder:i,ariaLabel:i,onSelectDate:this.onSelectDate})),this.datePickerElement),this.datePickerElement},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return Object(p.setProperty)(t,"min",this.min),Object(p.setProperty)(t,"max",this.max),Object(p.setProperty)(t,"isRequired",this.isRequired,!1),Object(p.setProperty)(t,"placeholder",this.placeholder),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.min=Object(p.getStringValue)(t.min),this.max=Object(p.getStringValue)(t.max),this.isRequired=Object(p.getBoolValue)(t.isRequired,this.isRequired),this.placeholder=Object(p.getStringValue)(t.placeholder,this.placeholder),this.defaultValue&&(this.selectedDate=new Date(this.defaultValue))},t.prototype.remove=function(){return this.datePickerElement&&(Z.unmountComponentAtNode(this.datePickerElement),this.datePickerElement=null),e.prototype.remove.call(this)},t.prototype.internalValidateProperties=function(e){return this.dateNotValid()&&e.addFailure(this,{error:p.ValidationError.InvalidPropertyValue,message:t.strings.warning.missingRequiredInput}),[]},t.prototype.getJsonTypeName=function(){return"Input.Date"},Object.defineProperty(t.prototype,"min",{get:function(){return this._min},set:function(e){this._min=this.parseInputValue(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},set:function(e){this._max=this.parseInputValue(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.selectedDate?this.selectedDate.toISOString():null},enumerable:!1,configurable:!0}),t}(p.Input),ue=n(1270);function pe(e,t,n){if(null!=e){var r=Number(e);if(isNaN(r))return te.NotNumber;if(""!=e){if(n&&Number(n)<r)return te.MoreThanMax;if(t&&Number(t)>r)return te.LessThanMin}}return te.Ok}!function(e){e[e.Ok=0]="Ok",e[e.NotNumber=1]="NotNumber",e[e.LessThanMin=2]="LessThanMin",e[e.MoreThanMax=3]="MoreThanMax"}(te||(te={}));var he=Object(y.a)((function(e){var t=Object(i.__read)(o.useState(e.value),2),n=t[0],r=t[1],a=e.min,s=e.max;return o.createElement(ue.a,{type:"number",value:n,min:a,max:s,onChange:function(t,n){e.onValueChanged(n),r(n)},required:e.required,placeholder:e.placeholder,onGetErrorMessage:function(t){var n=e.strings,r=e.onValueChanged,i=pe(t,a,s);switch(r(t),i){case te.LessThanMin:return n.format(n.warning.inputNumberLessThanMin,a);case te.MoreThanMax:return n.format(n.warning.inputNumberMoreThanMax,s);case te.NotNumber:return n.warning.inputNumberNotNumeric;case te.Ok:default:return""}}})})),ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isRequired=!1,t.getNumberString=function(e){return"number"==typeof e?e.toString():e},t.onTextFieldValueChanged=function(e){t.currentValue=e},t}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){this.numberTextFieldElement=document.createElement("div"),this.numberTextFieldElement.className=ce.a.inputElementWrapper;var e=this.placeholder||t.strings.placeholder.numberInput;return Z.render(o.createElement(o.StrictMode,null,o.createElement(he,{placeholder:e,onValueChanged:this.onTextFieldValueChanged,min:this.min,max:this.max,required:this.isRequired,value:this.defaultValue,strings:t.strings})),this.numberTextFieldElement),this.numberTextFieldElement},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return Object(p.setProperty)(t,"min",this.min),Object(p.setProperty)(t,"max",this.max),Object(p.setProperty)(t,"placeholder",this.placeholder),Object(p.setProperty)(t,"isRequired",this.isRequired,!1),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.min=this.getNumberString(t.min),this.max=this.getNumberString(t.max),this.placeholder=Object(p.getStringValue)(t.placeholder),this.isRequired=Object(p.getBoolValue)(t.isRequired,this.isRequired)},t.prototype.remove=function(){return this.numberTextFieldElement&&(Z.unmountComponentAtNode(this.numberTextFieldElement),this.numberTextFieldElement=null),e.prototype.remove.call(this)},t.prototype.internalValidateProperties=function(e){this.isRequired&&!this.currentValue?e.addFailure(this,{error:p.ValidationError.InvalidPropertyValue,message:t.strings.warning.missingRequiredInput}):pe(this.value,this.min,this.max)!==te.Ok&&e.addFailure(this,{error:p.ValidationError.InvalidPropertyValue,message:t.strings.warning.invalidInput})},t.prototype.getJsonTypeName=function(){return"Input.Number"},Object.defineProperty(t.prototype,"min",{get:function(){return this._min},set:function(e){this._min=this.parseInputValue(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},set:function(e){this._max=this.parseInputValue(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.currentValue},enumerable:!1,configurable:!0}),t}(p.Input),me=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.isRequired=!1,n.setTextFieldRef=function(e){n.textField=e},n.textNotValid=function(e){return n.isRequired&&""===e},n.validateText=function(e){return n.textNotValid(e)?t.strings.warning.requiredField:""},n.getMaxLength=function(e){var t;return void 0===e||void 0===n.defaultValue?t:t=Math.max(e,n.defaultValue.length)},n}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){this.textFieldElement=document.createElement("div"),this.textFieldElement.className=ce.a.inputElementWrapper;var e=this.placeholder||t.strings.placeholder.textInput;return Z.render(o.createElement(o.StrictMode,null,o.createElement(ue.a,{required:this.isRequired,componentRef:this.setTextFieldRef,maxLength:this.maxLength,placeholder:e,multiline:this.isMultiline,onGetErrorMessage:this.validateText,defaultValue:this.defaultValue,title:e})),this.textFieldElement),this.textFieldElement},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return Object(p.setProperty)(t,"placeholder",this.placeholder),Object(p.setProperty)(t,"maxLength",this.maxLength,0),Object(p.setProperty)(t,"isMultiline",this.isMultiline,!1),Object(p.setProperty)(t,"isRequired",this.isRequired,!1),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.maxLength=this.getMaxLength(t.maxLength),this.isMultiline=Object(p.getBoolValue)(t.isMultiline,this.isMultiline),this.placeholder=Object(p.getStringValue)(t.placeholder),this.isRequired=Object(p.getBoolValue)(t.isRequired,this.isRequired)},t.prototype.remove=function(){return this.textFieldElement&&(Z.unmountComponentAtNode(this.textFieldElement),this.textFieldElement=null),e.prototype.remove.call(this)},t.prototype.internalValidateProperties=function(e){return this.textNotValid(this.value)&&e.addFailure(this,{error:p.ValidationError.InvalidPropertyValue,message:t.strings.warning.missingRequiredInput}),[]},t.prototype.getJsonTypeName=function(){return"Input.Text"},Object.defineProperty(t.prototype,"value",{get:function(){return this.textField?this.textField.value:""},enumerable:!1,configurable:!0}),t}(p.Input),fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checked=!1,t.valueOn="true",t.valueOff="false",t.wrap=!1,t.isRequired=!1,t.onCheckboxChanged=function(e,n){t.checked=n},t}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){return this.checkboxElement=document.createElement("div"),Z.render(o.createElement(o.StrictMode,null,o.createElement(ne.a,{defaultChecked:this.checked,onChange:this.onCheckboxChanged,label:this.title})),this.checkboxElement),this.checkboxElement},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return Object(p.setProperty)(t,"valueOn",this.valueOn,"true"),Object(p.setProperty)(t,"valueOff",this.valueOff,"false"),Object(p.setProperty)(t,"wrap",this.wrap),Object(p.setProperty)(t,"isRequired",this.isRequired,!1),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.title=Object(p.getStringValue)(t.title),this.checked=Object(p.getBoolValue)(t.value,this.checked),this.valueOn=Object(p.getStringValue)(t.valueOn,this.valueOn),this.valueOff=Object(p.getStringValue)(t.valueOff,this.valueOff),this.wrap=Object(p.getBoolValue)(t.wrap,this.wrap),this.isRequired=Object(p.getBoolValue)(t.isRequired,this.isRequired)},t.prototype.remove=function(){return this.checkboxElement&&(Z.unmountComponentAtNode(this.checkboxElement),this.checkboxElement=null),e.prototype.remove.call(this)},t.prototype.internalValidateProperties=function(e){return this.isRequired&&!this.checked&&e.addFailure(this,{error:p.ValidationError.InvalidPropertyValue,message:t.strings.warning.missingRequiredInput}),[]},t.prototype.getJsonTypeName=function(){return"Input.Toggle"},Object.defineProperty(t.prototype,"value",{get:function(){return this.checked?this.valueOn:this.valueOff},enumerable:!1,configurable:!0}),t}(p.Input),be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){if(!this.smtp||!Object(l.i)("rp-actionableMessages-lpc"))return e.prototype.internalRender.call(this);var t,n=window.LivePersonaCardHoverTargetV2;this.lpcElement=document.createElement("div");var r=o.createElement(n,{cardParameters:{personaInfo:{identifiers:{Smtp:this.smtp,PersonaType:"User"}},behavior:{locationToOpen:"Card"}}},o.createElement("div",{ref:function(e){return t=e}}));return Z.render(r,this.lpcElement),t.appendChild(e.prototype.internalRender.call(this)),this.lpcElement},t.prototype.remove=function(){return this.lpcElement&&(Z.unmountComponentAtNode(this.lpcElement),this.lpcElement=null),e.prototype.remove.call(this)},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.smtp=t.smtp},t}(p.Image),ye=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderLPC=function(e){var n=window.LivePersonaCardHoverTargetV2,r=o.createElement(n,{cardParameters:{personaInfo:{identifiers:{Smtp:e.smtp,PersonaType:"User"}},behavior:{locationToOpen:"Card"}}},o.createElement("span",{"data-debug":e.name,style:{display:"inline-block"}},e.name)),a=t.lpcElement.querySelector("[data-mention-name='"+e.name+"']");Z.render(r,a)},t}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){var t=this;return Object(l.i)("rp-actionableMessages-lpc")&&this.mentions&&0!=this.mentions.length?(this.lpcElement=e.prototype.internalRender.call(this),this.mentions.forEach((function(e){t.lpcElement.innerHTML=t.lpcElement.innerHTML.replace(new RegExp(e.name,"i"),'<span data-mention-name="'+e.name+'"></span>')})),this.mentions.forEach((function(e){return t.renderLPC(e)})),this.lpcElement):e.prototype.internalRender.call(this)},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.mentions=t.mentions},t}(p.TextBlock),ve=function(){var e;e=p.ImageSet.prototype.render,p.ImageSet.prototype.render=function(){var t=e.call(this);return t&&(t.style.overflow="auto"),t}},Ce=n(6778),xe=!1,Ae=function(e,t){var n=Ce().render(e);t.didProcess=!0,t.outputHtml=n},we=function(e){g.g.warn("[ActionableMessageDebug] parseError: Error parsing adaptive card. Error: "+e.message)},ke=function(e,t){var n;("boolean"==typeof t.isVisible&&(e.isVisible=t.isVisible),"Column"===e.getJsonTypeName()&&void 0!==t.pixelWidth&&(e.pixelWidth=t.pixelWidth),e instanceof p.Image&&"string"==typeof t.backgroundColor&&(e.backgroundColor=t.backgroundColor),e instanceof p.Container)&&((n=Se(t.padding))&&(e.padding=n));e instanceof p.ColumnSet&&((n=Se(t.padding))&&(e.padding=n))},Se=function(e){if("string"==typeof e){var t=Object(p.getEnumValue)(p.Spacing,e,p.Spacing.None);return new p.PaddingDefinition(t,t,t,t)}return"object"==typeof e?new p.PaddingDefinition(Object(p.getEnumValue)(p.Spacing,e.top,p.Spacing.None),Object(p.getEnumValue)(p.Spacing,e.right,p.Spacing.None),Object(p.getEnumValue)(p.Spacing,e.bottom,p.Spacing.None),Object(p.getEnumValue)(p.Spacing,e.left,p.Spacing.None)):null},Ee=function(e,t){xe||(xe=!0,p.AdaptiveCard.allowMarkForTextHighlighting=!0,p.AdaptiveCard.onParseError=we,p.AdaptiveCard.onProcessMarkdown=Ae,p.AdaptiveCard.onParseElement=ke,function(e){de.strings=e,p.AdaptiveCard.elementTypeRegistry.registerType("Input.Date",(function(){return new de})),me.strings=e,p.AdaptiveCard.elementTypeRegistry.registerType("Input.Text",(function(){return new me})),ge.strings=e,p.AdaptiveCard.elementTypeRegistry.registerType("Input.Number",(function(){return new ge})),fe.strings=e,p.AdaptiveCard.elementTypeRegistry.registerType("Input.Toggle",(function(){return new fe})),ie.strings=e,p.AdaptiveCard.elementTypeRegistry.registerType("Input.ChoiceSet",(function(){return new ie})),p.AdaptiveCard.elementTypeRegistry.registerType("TextBlock",(function(){return new ye})),p.AdaptiveCard.elementTypeRegistry.registerType("Image",(function(){return new be})),p.AdaptiveCard.elementTypeRegistry.registerType("Persona",(function(){return new $})),p.AdaptiveCard.elementTypeRegistry.registerType("ActionSet",(function(){return new p.ActionSet}))}(t),ve()),function(e){e.forEach((function(e){e&&e.registerActions()}))}(e)},Me=n(6459);function De(e,t,n,r,a){var o,s;try{if("string"==typeof t){o=JSON.parse(t);var l=Me.sha256().update(t).digest();s=btoa(String.fromCharCode.apply(null,new Uint8Array(l)))}else o=t}catch(e){throw new Error("[ActionableMessageCard] RenderCard: unable to cardSerialized property"+e.message)}return Object(i.__assign)(Object(i.__assign)({},e),{isAdaptiveCard:void 0===r?"AdaptiveCard"===o.type:r,cardSignature:n,card:o,cardHash:s,cardId:a||Object(m.a)()})}var Oe=function(e){function t(t){var n=e.call(this)||this;return n._logTelemetryForAction=t,n}return Object(i.__extends)(t,e),t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return Object(p.setProperty)(t,"rtl",this.rtl,!1),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.rtl=Object(p.getBoolValue)(t.rtl,this.rtl)},Object.defineProperty(t.prototype,"logTelemetryForAction",{get:function(){return this._logTelemetryForAction},enumerable:!1,configurable:!0}),t}(p.AdaptiveCard),Pe="article";function Ie(e,t,n){void 0===t&&(t=p.Size.Medium),void 0===n&&(n=p.ImageStyle.Default);var r=new p.Image;return r.url=e.image,r.size=e.size?e.size:t,r}function Te(e,t){var n=new p.Container;e.title&&((r=new p.TextBlock).text=e.title,r.size=p.TextSize.Medium,r.wrap=!0,n.addItem(r));if(e.startGroup?(n.separator=!0,n.spacing=p.Spacing.Large):n.spacing=p.Spacing.Medium,e.activityTitle||e.activitySubtitle||e.activityText||e.activityImage){var r,a=new p.ColumnSet,i=void 0;if(e.activityImage)i=new p.Column,(o=new p.Image).size=e.activityImageSize?e.activityImageSize:p.Size.Small,e.activityImageType&&e.activityImageType===Pe?(o.style=p.ImageStyle.Default,o.size=p.Size.Medium,i.width=new p.SizeAndUnit(80,p.SizeUnit.Pixel)):o.style=e.activityImageStyle?e.activityImageStyle:p.ImageStyle.Person,o.url=e.activityImage,i.addItem(o),a.addColumn(i);if(i=new p.Column,e.activityTitle)(r=new p.TextBlock).text=e.activityTitle,r.wrap=!0,r.spacing=p.Spacing.None,i.addItem(r);if(e.activitySubtitle)(r=new p.TextBlock).text=e.activitySubtitle,r.weight=p.TextWeight.Lighter,r.isSubtle=!0,r.wrap=!0,r.spacing=p.Spacing.None,i.addItem(r);if(e.activityText)(r=new p.TextBlock).text=e.activityText,r.wrap=!0,r.spacing=p.Spacing.None,i.addItem(r);a.addColumn(i),n.addItem(a)}var o,s=e.heroImage;s&&((o=Ie(s)).size=p.Size.Auto,n.addItem(o));if(e.text){var l=new p.TextBlock;l.text=e.text,l.wrap=!0,n.addItem(l)}if(e.facts){var c=function(e){for(var t=new p.FactSet,n=e,r=0;r<n.length;r++){var a=new p.Fact;a.name=n[r].name,a.value=n[r].value,t.facts.push(a)}return t}(e.facts);n.addItem(c)}if(e.images){var d=function(e){for(var t=new p.ImageSet,n=e,r=0;r<n.length;r++){var a=Ie(n[r],p.Size.Large);t.addImage(a)}return t}(e.images);n.addItem(d)}if(e.potentialAction){var u=Re(e.potentialAction,t);n.addItem(u)}return n}function Re(e,t){var n=new p.ActionSet;n.spacing=p.Spacing.Medium;for(var r=e,a=function(e){var a=r[e];t.forEach((function(e){if(e.parseLegacyMessageCardAction){var r=e.parseLegacyMessageCardAction(a,t);r&&n.addAction(r)}}))},i=0;i<r.length;i++)a(i);return n}var _e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.parse=function(t){var n,r;e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.targetElements={};var a=t.targetElements;if(a)try{for(var o=Object(i.__values)(a),s=o.next();!s.done;s=o.next()){var l=s.value;if("string"==typeof l)this.targetElements[l]=void 0;else if("object"==typeof l){var c=l.elementId;c&&"string"==typeof c&&(this.targetElements[c]=Object(p.getBoolValue)(l.isVisible,void 0))}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return Object(p.setProperty)(t,"isPrimary",this.isPrimary,!1),t},t.prototype.execute=function(){var t,n=null===(t=this.parent)||void 0===t?void 0:t.getRootElement();if(null==n?void 0:n.logTelemetryForAction){var r={id:this.id,type:this.getJsonTypeName()};n.logTelemetryForAction("ToggleVisibilityActionClick",r)}e.prototype.execute.call(this)},t}(p.ToggleVisibilityAction),Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return Object(p.setProperty)(t,"isPrimary",this.isPrimary,!1),t},t}(p.OpenUrlAction);function je(e,t,n,r,a,i){g.g.info("[ActionableMessageDebug] executeAction: cardActionExecuted");var o={id:e.id,type:e.getJsonTypeName()},s={messageContext:a,actionContext:e[R],cardDetails:t,elementDetails:o,eventName:void 0};if(e instanceof Fe){g.g.info("[ActionableMessageDebug] onExecuteAction: open url: "+e.url),s.eventName=I,i.logTelemetry(s);try{var l=new URL(e.url);if("http:"!==l.protocol.toLowerCase()&&"https:"!==l.protocol.toLowerCase()){var c="mailto:"===l.protocol.toLowerCase()?"Mailto action":"Invalid URL";return g.g.info("[ActionableMessageDebug] onExecuteAction: open url not executed."+c),!1}window.open(l.href,"_blank")}catch(e){g.g.info("[ActionableMessageDebug] onExecuteAction: open url not executed. Malformed URL")}return!0}return e instanceof _e&&(g.g.info("[ActionableMessageDebug] onExecuteAction: Toggle Visibility"),e.execute(),!0)}var He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return Object(p.setProperty)(t,"isPrimary",this.isPrimary,!1),t},t}(p.ShowCardAction);function Ve(e,t){switch(e["@type"]){case"OpenUri":case"ViewAction":return function(e){var t=new Fe;if(t.title=e.name,e.target)t.url=e.target;else if(e.targets&&e.targets instanceof Array)for(var n=0;n<e.targets.length;n++)if("default"===e.targets[n].os){t.url=e.targets[n].uri;break}return t}(e);case"ActionCard":return function(e,t){var n=new He;n.title=e.name;var r=e.inputs;if(r)for(var a=0;a<r.length;a++){var i=r[a],o=null;switch(i["@type"]?i["@type"].toLowerCase():""){case"textinput":o=Ne(i);break;case"dateinput":o=Be(i);break;case"multichoiceinput":o=We(i)}o&&n.card.addItem(o)}var s=e.actions;s&&n.card.addItem(Re(s,t));return n}(e,t)}return null}function Ne(e){var t=new me;return qe(t,e),t.placeholder=e.title,t.isMultiline=e.isMultiline,t}function Be(e){var t=new de;return qe(t,e),t.placeholder=e.title,t}function We(e){var t=new ie;qe(t,e),t.placeholder=e.title,t.spacing=p.Spacing.Medium;var n=e.choices;if(n)for(var r=0;r<n.length;r++){var a=new p.Choice;a.title=n[r].display,a.value=n[r].value,t.choices.push(a)}return t.isMultiSelect=e.isMultiSelect,t.isCompact=!("expanded"===e.style),t.initialize(),t}function qe(e,t){e.id=t.id,e.defaultValue=t.value}function Le(e){return[{registerActions:function(){p.AdaptiveCard.actionTypeRegistry.registerType(p.ToggleVisibilityAction.JsonTypeName,(function(){return new _e})),p.AdaptiveCard.actionTypeRegistry.registerType(p.ShowCardAction.JsonTypeName,(function(){return new He})),p.AdaptiveCard.actionTypeRegistry.registerType(p.OpenUrlAction.JsonTypeName,(function(){return new Fe}))},executeAction:je,parseLegacyMessageCardAction:Ve,registerHostCapabilities:null}].concat(e)}var ze={ComponentDidMount:"31",CardId:"32",ComponentDidUpdate:"33",ComponentDidUpdateUpdate:"34",ComponentWillUnmount:"35",Render:"36",SetCardContainer:"37",RemoveCardElement:"38",AddCardElement:"39",TryUpdateCardElementException:"310",UpdateCardElementStart:"311",UpdateCardElementSkippingRender:"312",UpdateCardElementThemeError:"313",UpdateCardElementNewCardElementCreated:"314",UpdateCardElementAddNewCardElement:"315",HideCard:"316",ShowCard:"317",SetCardVisibility:"318",CleanupCard:"319",ProcessAutoInvokeActionsNotAllowed:"320",ProcessAutoInvokeActionsHasAutoInvoke:"321",ProcessAutoInvokeActionsHideCardOnInvoke:"322",ProcessAutoInvokeActionsCardIdUndefined:"323",ProcessAutoInvokeActionsExecuting:"324",ProcessAutoInvokeActionsException:"325",ExecuteAutoInvokeActionNoProvider:"326",HandleActionResponseStart:"327",HandleActionResponseStopUpdate:"328",HandleActionSuccessResponseStart:"329",HandleActionSuccessResponseOnCardDetailsUpdated:"330",HandleActionSuccessResponseHideCard:"331",HandleActionSuccessResponseShowCard:"332",HandleActionErrorResponseStart:"333",HandleActionErrorResponseHideCard:"334",HandleActionErrorResponseShowMessage:"335",HandleActionErrorResponseHandleAuth:"336",HandleActionErrorResponseShowErrorMessage:"337"},Ue=function(){var e={width:640,height:520,left:(window.screen.width-640)/2,top:(window.screen.height-520)/2,modal:"yes",alwaysRaised:"yes",menubar:"no",status:"no",scrollbars:"no",titlebar:"no",toolbar:"no",resizable:"yes"};return Object.keys(e).map((function(t){return t+"="+e[t]})).join(",")},Je=n(6900);n(8973);var Ke,Ye=n(4325),Ze=function(e){function t(t){var n=e.call(this,t)||this;return n.isRetryHttpActionFlow=!1,n.previousHttpResponse=null,n.authenticationWindow=null,n.authenticationWindowTimeout=null,n.initializeCardProperties=function(){var e=n.props,t=e.actionProviders,i=e.actionableMessageCardStrings;n.actionProviders=Le(t),n.responseMessage={message:"",type:r.Error,viewType:a.AutoDismiss},n.cardElementId=w+Object(m.a)(),Ee(n.actionProviders,i)},n.logTelemetryForAction=function(e,t){var r=n.props,a=r.telemetryHandler,i=r.cardDetails;a.logTelemetryProvider(i,e,null,t)},n.cancelAuthenticationFlow=function(e,t){var a;if(void 0===e&&(e=!1),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper cancelAuthenticationFlow"),n.closeAuthenticationWindow(),!e){var i=t||(null===(a=n.previousHttpResponse)||void 0===a?void 0:a.displayMessage);i?(g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper cancelAuthenticationFlow: Showing error message"),n.displayActionStatusMessage(i,r.Error)):n.setState({cardState:1})}n.clearActionRetryData()},n.closeAuthenticationWindow=function(){n.authenticationWindow&&(g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper closeAuthenticationWindow"),clearTimeout(n.authenticationWindowTimeout),n.authenticationWindow.close())},n.handlePostMessage=function(e){return Object(i.__awaiter)(n,void 0,void 0,(function(){var t,n,r,a,o,s,l;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(t=e.origin,!this.props.isTrustedDomain||!this.props.isTrustedDomain(t))return[2];if(!(n=e.data))return[2];r=null;try{r=JSON.parse(n)}catch(e){g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handlePostMessage: Unable to parse message data")}if(!r)return[2];switch(a=r.type,g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handlePostMessage: Received event of type: "+a),a){case"ActionableMessagePreConsentCancelled":return[3,1];case"ActionableMessageListeningForToken":return[3,2];case"ActionableMessagePostAuthenticate":return[3,5]}return[3,6];case 1:return this.cancelAuthenticationFlow(),[3,6];case 2:return this.authenticationWindow&&this.props.getClientAuthToken?[4,this.props.getClientAuthToken()]:[3,4];case 3:(o=i.sent())?(s={type:"ActionableMessageAuthenticateUsingToken",data:{authToken:o}},g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handlePostMessage: Posting auth token to iframe"),this.authenticationWindow.postMessage(JSON.stringify(s),t)):(g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handlePostMessage: token is empty"),this.cancelAuthenticationFlow(!1,this.props.actionableMessageCardStrings.error.generic)),i.label=4;case 4:return[3,6];case 5:return this.closeAuthenticationWindow(),"Success"===(null===(l=null==r?void 0:r.data)||void 0===l?void 0:l.status)?(g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handlePostMessage: Retrying execute action"),this.isRetryHttpActionFlow=!0,this.executeAction(this.previousHttpAction,!1)):this.cancelAuthenticationFlow(),[3,6];case 6:return[2]}}))}))},n.isValidCardDetails=function(){return!!n.cardDetails&&!!n.cardDetails.cardId},n.renderActionResponse=function(){return n.isValidCardDetails()&&o.createElement(N,{message:n.responseMessage.message,type:n.responseMessage.type,viewType:n.responseMessage.viewType,autoDismissTimeout:n.props.snackBarTimeout,onHideActionResponse:n.setShowCard,acknowledgeButtonText:n.responseMessage.acknowledgeButtonText,onAcknowledgeActionResponse:n.responseMessage.onAcknowledgeActionResponse})},n.renderActionSpinner=function(){return n.isValidCardDetails()&&o.createElement("div",{className:Ye.actionInProgressOverlay},o.createElement(d.a,{size:u.a.large,className:Ye.actionInProgressSpinner}),o.createElement(c.a,{className:Ye.actionInProgressLabel},n.props.actionableMessageCardStrings.information.actionInProgress))},n.setCardContainer=function(e){n.cardContainer||(n.props.loggingHandler.log(ze.SetCardContainer),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper: setCardContainer"),n.cardContainer=e,n.pendingCardToShow&&n.addCardElementToDOM(n.pendingCardToShow))},n.removeCardElementFromDOM=function(){var e=document.getElementById(n.cardElementId);e&&n.cardContainer&&n.cardContainer.contains(e)&&(n.props.loggingHandler.log(ze.RemoveCardElement),g.g.info("[ActionableMessageDebug] ActionableMessageCard: removing old card from container"),n.cardContainer.removeChild(e),n.currentCardElement=null)},n.addCardElementToDOM=function(e){n.cardContainer?(n.pendingCardToShow=null,n.removeCardElementFromDOM(),n.props.loggingHandler.log(ze.AddCardElement),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper: adding card element to DOM"),n.currentCardElement=e,n.applyConstrainWidthToCardContainer(),n.cardContainer.appendChild(n.currentCardElement)):n.pendingCardToShow=e},n.getTheme=function(){return Object(i.__awaiter)(n,void 0,void 0,(function(){var e,t,n,r,a,o,s;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return e=this.props,t=e.telemetryHandler,n=e.downloadThemeCallback,Object(l.i)("rp-actionableMessagesThemeConfig")||0!==f.a.themeStore.loadStatus?[3,2]:(r=new h.a("MCActionableCardLoadThemeDefinitions"),t.stampPerfCheckpoint(b.a.ThemeDefinitionsLoadStart),[4,q(n)]);case 1:i.sent(),r.end(),t.stampPerfCheckpoint(b.a.ThemeDefinitionsLoadEnd),i.label=2;case 2:return a=this.cardDetails.card,o=new h.a("MCActionableCardResolveThemeFile"),t.stampPerfCheckpoint(b.a.ThemeResolveStart),[4,J(a.theme?a.theme:"default")];case 3:return s=i.sent(),o.end(),t.stampPerfCheckpoint(b.a.ThemeResolveEnd),[2,s]}}))}))},n.setAdaptiveCardHandlers=function(){var e=n.props,t=e.actionableMessageContentHandler,r=e.telemetryHandler,a=e.cardDetails;n.adaptiveCard.onExecuteAction=function(e){n.executeAction(e,!1)},n.adaptiveCard.onInlineCardExpanded=function(e,i){t&&t.onApply(e.card.renderedElement);var o=document.getElementById(n.cardElementId);o&&o.scrollIntoView(!0);var s={id:e.id,type:e.getJsonTypeName()};r.logTelemetryProvider(a,i?E:M,null,s)}},n.tryUpdateCardElement=function(e,t){return void 0===t&&(t=!0),Object(i.__awaiter)(n,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){try{this.updateCardElement(e,t)}catch(e){this.props.loggingHandler.log(ze.TryUpdateCardElementException),g.g.warn("[ActionableMessageDebug] ActionableMessageCardWrapper: exception encountered during updateCardElement: "+e.message),this.setHideCard(!0)}return[2]}))}))},n.updateCardElement=function(e,t){return void 0===t&&(t=!0),Object(i.__awaiter)(n,void 0,void 0,(function(){var n,r,a,o,s,l,c,d,u,p,m,y;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return n=this.props,r=n.actionableMessageContentHandler,a=n.telemetryHandler,o=n.adjustCardElementBeforeRenderCallback,s=n.cardDetails,this.props.loggingHandler.log(ze.UpdateCardElementStart+":"+(e?null===(y=e.cardId)||void 0===y?void 0:y.slice(0,8):" ")),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper updateCardElement: start. cardId: "+e.cardId),this.cardDetails==e?(this.props.loggingHandler.log(ze.UpdateCardElementSkippingRender),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper updateCardElement: card details unchanged. Skipping re-render. cardId: "+e.cardId),[2]):(this.cardDetails=e,f.a.cards.has(this.cardDetails.cardId)||Object(Je.a)(this.cardDetails.cardId),a.stampPerfCheckpoint(b.a.LoadStart,a.perfData.loadStartTime),a.setTotalFetchTimeForCard(),a.stampPerfCheckpoint(b.a.CardRenderStart),l=new h.a("MCActionableCardLoadThemeTotal"),a.stampPerfCheckpoint(b.a.ThemeLoadTotalStart),[4,this.getTheme()]);case 1:return(c=i.sent())?(this.currentHostConfig=c.hostConfig,l.end(),a.stampPerfCheckpoint(b.a.ThemeLoadTotalEnd),(d=this.cardDetails.card)?(u=new h.a("MCActionableCardInitializeCardLibrary"),a.stampPerfCheckpoint(b.a.CardCreateStart),this.cardDetails.isAdaptiveCard?this.initializeAdaptiveCard(d,c):this.initializeMessageCard(d),u.end(),a.stampPerfCheckpoint(b.a.CardCreateEnd),this.processAutoInvokeActions(d,t)?this.setHideCard(!1):(this.setAdaptiveCardHandlers(),a.stampPerfCheckpoint(b.a.CardLibraryRenderStart),(p=this.adaptiveCard.render())&&(this.props.loggingHandler.log(ze.UpdateCardElementNewCardElementCreated),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper: newCardElement is created. cardId: "+s.cardId),a.stampPerfCheckpoint(b.a.CardLibraryRenderEnd),m=new h.a("MCActionableCardPrepareCard"),a.stampPerfCheckpoint(b.a.PrepareCardStart),p.id=this.cardElementId,this.applySpecialStyling(d,p),o&&o(p),this.processInlineActions(p),this.updateParentProperties(d),r&&r.onApply(p),m.end(),a.stampPerfCheckpoint(b.a.PrepareCardEnd),this.props.loggingHandler.log(ze.UpdateCardElementAddNewCardElement),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper: adding newCardElement to the DOM. cardId: "+s.cardId),this.addCardElementToDOM(p),this.setShowCard()),a.stampPerfCheckpoint(b.a.CardRenderEnd),this.cardDetails&&a.logTelemetryProvider(s,D))):this.setHideCard(!0),[2]):(l.endWithError("ClientError"),this.props.loggingHandler.log(ze.UpdateCardElementThemeError),g.g.warn("[ActionableMessageDebug] ActionableMessageCardWrapper updateCardElement: Error loading theme for card"),this.setHideCard(!0),[2])}}))}))},n.setHideCard=function(e){n.props.loggingHandler.log(ze.HideCard+":"+(e?1:0)),g.g.info("[ActionableMessageDebug] hideCard. wasError: "+e+". cardId: "+n.cardDetails.cardId),n.props.showMessageBodyCallback&&n.props.showMessageBodyCallback(!0),e?n.setState({cardState:3}):n.setState({cardState:2})},n.setShowCard=function(){n.props.loggingHandler.log(""+ze.ShowCard),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper setCardVisibility: setting card visibility to true "),n.setState({cardState:1}),n.props.onCardRendered&&n.props.onCardRendered(n.currentCardElement)},n.cleanupCard=function(){var e,t=n.props.actionableMessageContentHandler;n.props.loggingHandler.log(ze.CleanupCard+":"+(n.cardDetails?null===(e=n.cardDetails)||void 0===e?void 0:e.cardId.slice(0,8):" ")),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper cleanupCard: cardId: "+n.cardDetails.cardId),n.detachInlineActionAnchorHandlers(n.currentCardElement),n.adaptiveCard&&n.adaptiveCard.getAllInputs().forEach((function(e){e.remove()})),n.currentHostConfig=null,t&&t.onUndo()},n.initializeAdaptiveCard=function(e,t){var r,a,i;n.adaptiveCard=new Oe(n.logTelemetryForAction),n.adaptiveCard.hostConfig=t.hostConfig,r=n.adaptiveCard.hostConfig,a=n.actionProviders,i={},a.forEach((function(e){(null==e?void 0:e.registerHostCapabilities)&&e.registerHostCapabilities(i)})),r.hostCapabilities.capabilities=i,n.adaptiveCard.parse(e),t.stylesheetUrl&&Ge(e.theme,t.stylesheetUrl),n.processInlineActionDefinitions(e)},n.initializeMessageCard=function(e){var t;n.adaptiveCard=function(e,t,n){var r,a=new Oe(n);if(e.title&&((r=new p.TextBlock).text=e.title,r.size=p.TextSize.Large,r.wrap=!0,a.addItem(r)),e.text&&((r=new p.TextBlock).text=e.text,r.wrap=!0,a.addItem(r)),e.sections)for(var i=e.sections,o=0;o<i.length;o++){var s=Te(i[o],t);a.addItem(s)}if(e.potentialAction){var l=Re(e.potentialAction,t);a.addItem(l)}return a}(e,n.actionProviders,n.logTelemetryForAction),e.style===A?n.adaptiveCard.hostConfig=((t=new p.HostConfig({supportsInteractivity:!0,choiceSetInputValueSeparator:";",spacing:{small:5,default:5,medium:5,large:5,extraLarge:5,padding:5},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontFamily:"wf_segoe-ui_normal, sans-serif",fontSizes:{small:10,normal:12,medium:14,large:16,extraLarge:18},fontWeights:{lighter:200,normal:400,bolder:600},containerStyles:{default:{backgroundColor:"#eaeaea",foregroundColors:{default:{default:"#767676",subtle:"#EE767676"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#FFD800",subtle:"#DDFFD800"},good:{default:"#00FF00",subtle:"#00DD00"},warning:{default:"#FF0000",subtle:"#DD0000"}}},emphasis:{backgroundColor:"#F8F8F8",foregroundColors:{default:{default:"#767676",subtle:"#EE767676"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#FFD800",subtle:"#DDFFD800"},good:{default:"#00FF00",subtle:"#00DD00"},warning:{default:"#FF0000",subtle:"#DD0000"}}}},imageSizes:{small:16,medium:32,large:64},actions:{maxActions:5,buttonSpacing:20,spacing:p.Spacing.Default,showCard:{actionMode:p.ShowCardActionMode.Inline,inlineTopMargin:16,style:"emphasis"},preExpandSingleShowCardAction:!0,actionsOrientation:p.Orientation.Horizontal,actionAlignment:p.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:p.Size.Medium,maxImageHeight:100},factSet:{title:{color:p.TextColor.Default,size:p.TextSize.Default,isSubtle:!1,weight:p.TextWeight.Bolder,wrap:!0},value:{color:p.TextColor.Default,size:p.TextSize.Default,isSubtle:!1,weight:p.TextWeight.Default,wrap:!0},spacing:5}})).cssClassNamePrefix="compactMessageCard",t):n.adaptiveCard.hostConfig=new p.HostConfig({supportsInteractivity:!0,choiceSetInputValueSeparator:";",fontFamily:"Segoe UI, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"},attention:{default:"#cc3300",subtle:"#DDcc3300"}},backgroundColor:"#FFFFFF"},emphasis:{foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"},attention:{default:"#cc3300",subtle:"#DDcc3300"}},backgroundColor:"#08000000"}},spacing:{small:3,default:8,medium:20,large:30,extraLarge:40,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},actions:{maxActions:5,spacing:"Default",buttonSpacing:10,showCard:{actionMode:"Inline",inlineTopMargin:16,style:"emphasis"},preExpandSingleShowCardAction:!0,actionsOrientation:"Horizontal",actionAlignment:"Left"},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:"Medium",maxImageHeight:"maxImageHeight"},factSet:{title:{size:"Default",color:"Default",isSubtle:!1,weight:"Bolder",warp:!0},value:{size:"Default",color:"Default",isSubtle:!1,weight:"Default",warp:!0},spacing:10}})},n.applySpecialStyling=function(e,t){n.cardDetails.isAdaptiveCard||function(e,t){e.style.borderWidth="1px 1px 1px 3px",e.style.borderStyle="solid",t.themeColor?e.style.borderLeftColor="#"+t.themeColor.replace(/[^0-9A-F]/gi,""):(e.style.borderLeftColor=Y,e.style.borderLeftWidth="1px"),e.style.borderTopColor=Y,e.style.borderRightColor=Y,e.style.borderBottomColor=Y}(t,e),e.style!==A&&e.theme!==A||(t.className=Ye.compactCard);var r=e.theme&&e.theme!==A?e.theme:"none";t.setAttribute("data-ac-theme",r)},n.processAutoInvokeActions=function(e,t){var r,a=n.props.telemetryHandler,i=!1,o=f.a.cards.get(n.cardDetails.cardId);e.autoInvokeAction&&(n.props.loggingHandler.log(ze.ProcessAutoInvokeActionsHasAutoInvoke+":"+(n.cardDetails?null===(r=n.cardDetails.cardId)||void 0===r?void 0:r.slice(0,8):" ")),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper processAutoInvokeActions: Card does have auto invoke action. cardId: "+n.cardDetails.cardId),t&&(!o||!o.autoInvokeActionAlreadyRan)?(e.autoInvokeAction.hideCardOnInvoke&&(n.props.loggingHandler.log(ze.ProcessAutoInvokeActionsHideCardOnInvoke),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper processAutoInvokeActions: HideCardOnInvoke is true, so card will be hidden cardId: "+n.cardDetails.cardId),i=!0,n.showMessageBody()),e.autoInvokeOptions&&(n.showCardOnFailure=e.autoInvokeOptions.showCardOnFailure),a.stampPerfCheckpoint(b.a.AutoInvokeActionStart),Object(Je.c)(n.cardDetails.cardId,!0),n.cardDetails.cardId||n.props.loggingHandler.log(ze.ProcessAutoInvokeActionsCardIdUndefined),n.props.loggingHandler.log(ze.ProcessAutoInvokeActionsExecuting),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper processAutoInvokeActions: Executing auto invoke action for cardId: "+n.cardDetails.cardId),n.executeAutoInvokeAction(e.autoInvokeAction)):(n.props.loggingHandler.log(ze.ProcessAutoInvokeActionsException),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper processAutoInvokeActions: Auto invoke actions not allowed for card. cardId: "+n.cardDetails.cardId)));return i},n.showMessageBody=function(){n.props.showMessageBodyCallback&&n.props.showMessageBodyCallback(!0)},n.hideMessageBody=function(){n.props.showMessageBodyCallback&&n.props.showMessageBodyCallback(!1)},n.processInlineActions=function(e){n.inlineActionDefinitions&&n.attachInlineActionAnchorHandlers(e)},n.updateParentProperties=function(e){e.style!==A&&e.hideOriginalBody?e.hideOriginalBody&&n.hideMessageBody():n.showMessageBody()},n.processInlineActionDefinitions=function(e){var t;if(n.inlineActionDefinitions={},null===(t=e.resources)||void 0===t?void 0:t.actions)for(var r=e.resources.actions,a=0;a<r.length;a++)n.inlineActionDefinitions[r[a].id]=r[a]},n.executeAction=function(e,t){if(!e||!n.adaptiveCard)return!1;!t&&e instanceof p.HttpAction&&(n.setState({cardState:4}),n.isRetryHttpActionFlow||(n.previousHttpAction=e));for(var r=!1,a=0;a<n.actionProviders.length;a++){if(r=n.actionProviders[a].executeAction(e,n.cardDetails,Xe(e)||[],(function(e){return n.handleActionResponse(e,t)}),n.props.telemetryHandler.messageContext,n.props.telemetryHandler.telemetryProvider,t))break}return r},n.executeAutoInvokeAction=function(e){if(e){for(var t=!1,r=0;r<n.actionProviders.length;r++){var a=n.actionProviders[r];if(a.processAutoInvokeAction){var i=a.processAutoInvokeAction(e,n.cardDetails);if(i){n.props.loggingHandler.logAutoInvokeExecution(),n.executeAction(i,!0),t=!0;break}}}t||(n.props.loggingHandler.log(ze.ExecuteAutoInvokeActionNoProvider),g.g.warn("[ActionableMessageDebug] ActionableMessageCardWrapper executeAutoInvokeAction: no action provider supplied that can process auto invoke actions"))}},n.attachInlineActionAnchorHandlers=function(e){var t=e.querySelectorAll('a[href^="'+x+'"]');if(t)for(var r=0;r<t.length;r++){t.item(r).addEventListener("click",n.onInlineActionAnchorClicked)}},n.detachInlineActionAnchorHandlers=function(e){if(e){var t=e.querySelectorAll('a[href^="'+x+'"]');if(t)for(var r=0;r<t.length;r++){t.item(r).removeEventListener("click",n.onInlineActionAnchorClicked)}}},n.handleActionResponse=function(e,t){var r;n.props.loggingHandler.log(ze.HandleActionResponseStart+":"+(n.cardDetails?null===(r=n.cardDetails.cardId)||void 0===r?void 0:r.slice(0,8):" ")),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionResponse started. cardId: "+n.cardDetails.cardId);var a=n.props.telemetryHandler;if(t||a.logTelemetryProvider(n.cardDetails,T),3===n.state.cardState)return n.props.loggingHandler.log(ze.HandleActionResponseStopUpdate),void g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionResponse: card was hidden because of a processing error, so stop update");t&&(a.stampPerfCheckpoint(b.a.AutoInvokeActionEnd),a.updatePerfCheckpointsBeforeUpdatingAutoInvokeResponse()),n.previousHttpResponse=e,e.success?n.handleActionSuccessResponse(e,t):n.handleActionErrorResponse(e,t),(n.isRetryHttpActionFlow||e.success)&&n.clearActionRetryData()},n.handleActionSuccessResponse=function(e,t){n.props.loggingHandler.log(ze.HandleActionSuccessResponseStart),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionSuccessResponse: Start");var a=n.props,i=a.telemetryHandler,o=a.onCardDetailsUpdated;if(e.newCardPayload&&"function"==typeof o){var s=De(n.cardDetails,e.newCardPayload,e.newCardSignature,void 0,n.cardDetails.cardId);n.props.loggingHandler.log(ze.HandleActionSuccessResponseOnCardDetailsUpdated),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionSuccessResponse: New card payload available and onCardDetailsUpdated being called."),o([s])}n.isCardVisible()?e.hideCard||e.removeCard?(i.logTelemetryProvider(n.cardDetails,e.hideCard?O:P),n.props.loggingHandler.log(ze.HandleActionSuccessResponseHideCard),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionSuccessResponse: Hiding card"),n.setHideCard(!1),n.showMessageBody()):t||(g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionSuccessResponse: Showing action result message"),n.displayActionStatusMessage(e.displayMessage,r.Success)):e.newCardPayload||e.showOriginalCard?(n.props.loggingHandler.log(ze.HandleActionSuccessResponseShowCard),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionSuccessResponse: Showing card"),n.setState({cardState:1})):(n.setHideCard(!1),n.showMessageBody())},n.handleActionErrorResponse=function(e,t){if(n.props.loggingHandler.log(ze.HandleActionErrorResponseStart),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionErrorResponse: Start"),t)!1===n.showCardOnFailure&&(n.props.loggingHandler.log(ze.HandleActionErrorResponseHideCard),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionErrorResponse: hiding card"),n.setHideCard(!1),n.showMessageBody());else if(!Object(l.i)("rp-actionableMessages-identity-linking")||n.isRetryHttpActionFlow||e.status&&"completed"===e.status.toLowerCase())n.props.loggingHandler.log(ze.HandleActionErrorResponseShowMessage),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionErrorResponse: displaying action message - either completed or retry failed"),n.displayActionStatusMessage(e.displayMessage,r.Error);else{var i=null;if(e.errors&&e.errors.length>0&&(i=e.errors[0]),n.shouldHandleAuthErrors(e,i)){var o=null;"401"===(null==i?void 0:i.httpStatusCode)&&i.url?o=i.url:e.authenticationUrl&&(o=e.authenticationUrl),n.authenticationUrl=n.addAuthenticationUrlEssentials(o),n.props.loggingHandler.log(ze.HandleActionErrorResponseHandleAuth),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionErrorResponse: Handling authentication error");var s=n.props.actionableMessageCardStrings.information.authenticationFlowAcknowledgeMessage,c=n.props.actionableMessageCardStrings.information.authenticationFlowAcknowledgeButtonText;n.displayActionStatusMessage(s,r.Warning,a.Freeze,c,n.handleAuthenticationFlow)}else{var d=e.displayMessage;(null==i?void 0:i.message)&&(d=i.message),n.props.loggingHandler.log(ze.HandleActionErrorResponseShowErrorMessage),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleActionErrorResponse: Display error message"),n.displayActionStatusMessage(d,r.Error)}}},n.clearActionRetryData=function(){g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper clearActionRetryData: Start"),n.isRetryHttpActionFlow=!1,n.authenticationUrl=null,n.previousHttpAction=null,n.previousHttpResponse=null,n.authenticationWindow=null},n.checkAuthenticationWindow=function(e){return function(){n.authenticationWindow&&(n.authenticationWindow.closed?n.cancelAuthenticationFlow():e<_?n.setAuthenticationWindowTimeout(e+F):n.cancelAuthenticationFlow())}},n.setAuthenticationWindowTimeout=function(e){n.authenticationWindowTimeout=setTimeout(n.checkAuthenticationWindow(e),F)},n.handleAuthenticationFlow=function(){g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper handleAuthenticationFlow: Start"),n.setState({cardState:4});var e=Ue();n.authenticationWindow=window.open(n.authenticationUrl,"_blank",e),n.authenticationWindow?n.setAuthenticationWindowTimeout(0):n.cancelAuthenticationFlow()},n.displayActionStatusMessage=function(e,t,r,i,o){void 0===r&&(r=a.AutoDismiss),void 0===i&&(i=null),void 0===o&&(o=null),n.responseMessage.message=e,n.responseMessage.type=t,n.responseMessage.viewType=r,n.responseMessage.acknowledgeButtonText=i,n.responseMessage.onAcknowledgeActionResponse=o,n.setState({cardState:5})},n.isCardVisible=function(){var e=n.state.cardState;return 2!==e&&3!==e},n.onInlineActionAnchorClicked=function(e){if(n.inlineActionDefinitions){var t=e.target.href.substr(x.length),r=n.inlineActionDefinitions[t];if(r){e.preventDefault();var a=n.parseCustomAction(r);n.executeAction(a,!1)}}},n.parseCustomAction=function(e){var t=p.AdaptiveCard.actionTypeRegistry.createInstance(e.type);return t.parse(e),t.setParent(n.adaptiveCard),t},n.applyConstrainWidthToCardContainer=function(){var e=n.props.cardDetails;if((null==e?void 0:e.isAdaptiveCard)&&!1!==e.card.constrainWidth){var t=k,r=S,a=n.currentHostConfig;(null==a?void 0:a.cardMaximumWidth)&&"number"==typeof(t=a.cardMaximumWidth)&&(t+="px"),(null==a?void 0:a.cardHorizontalAlignment)&&(r=a.cardHorizontalAlignment),(null==a?void 0:a.cardHostBackgroundColor)&&n.cardContainer.parentElement&&(n.cardContainer.parentElement.style.backgroundColor=a.cardHostBackgroundColor),n.cardContainer.style.maxWidth=t,"center"===r&&(n.cardContainer.style.margin="auto")}},n.state={cardState:2},n.initializeCardProperties(),n}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.loggingHandler.log(ze.ComponentDidMount),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper mount."),this.tryUpdateCardElement(this.props.cardDetails),window.addEventListener("message",this.handlePostMessage)},t.prototype.componentDidUpdate=function(e){var t,n=this.props,r=n.actionableMessageContentHandler,a=n.contentHandlerUndoMode,i=n.cardDetails;this.props.loggingHandler.log(ze.ComponentDidUpdate+":"+(this.cardDetails?null===(t=this.cardDetails.cardId)||void 0===t?void 0:t.slice(0,8):" ")),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper update. cardId: "+this.cardDetails.cardId),a===e.contentHandlerUndoMode&&r===e.actionableMessageContentHandler||(a?r&&r.onUndo():this.currentCardElement&&r&&r.onApply(this.currentCardElement)),i!==e.cardDetails&&(this.props.loggingHandler.log(ze.ComponentDidUpdateUpdate),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper update and updateCardElement. cardId: "+this.cardDetails.cardId),this.tryUpdateCardElement(i,!1))},t.prototype.componentWillUnmount=function(){var e;this.props.loggingHandler.log(ze.ComponentWillUnmount+":"+(this.cardDetails?null===(e=this.cardDetails.cardId)||void 0===e?void 0:e.slice(0,8):" ")),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper unmount."),this.cardDetails&&Object(Je.b)(this.cardDetails.cardId),this.currentCardElement&&this.cleanupCard(),this.cancelAuthenticationFlow(!0),window.removeEventListener("message",this.handlePostMessage)},t.prototype.render=function(){var e=this;this.props.loggingHandler.log(ze.Render),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper render");var t=this.state.cardState;return function(e){return 1===e||4===e||5===e}(t)&&o.createElement("div",{className:Ye.container+" allowTextSelection",ref:function(t){return e.setCardContainer(t)}},function(e,t){return 5===e&&!!t&&!!t.message}(t,this.responseMessage)&&this.renderActionResponse(),function(e){return 4===e}(t)&&this.renderActionSpinner())},t.prototype.addAuthenticationUrlEssentials=function(e){return e?e+"&client=webviewbasedamclients":e},t.prototype.shouldHandleAuthErrors=function(e,t){return!(null==t||!t.httpStatusCode||"401"!==t.httpStatusCode&&"403"!==t.httpStatusCode)||!!e.authenticationUrl},t=Object(i.__decorate)([s.observer],t)}(o.Component),Ge=function(e,t){if(!document.querySelector("#ac-"+e+"-styles")){var n=document.createElement("link");n.type="text/css",n.id="#ac-"+e+"-styles",n.rel="stylesheet",n.href=t,document.head.appendChild(n)}},Xe=function(e){if(e.parent){var t=e.getReferencedInputs();return Object.values(t).map((function(e){return e}))}return e.getAllInputs()},Qe=n(20),$e=n(3814),et=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.isRequired=!1,n.isMultiline=!1,n.style=$e.InputTextStyle.Text,n.isFocusedAtLeastOnce=!1,n.setTextFieldRef=function(e){n.textField=e},n.textNotValid=function(e){return n.isRequired&&""===e},n.validateText=function(e){return n.isFocusedAtLeastOnce&&n.textNotValid(e)?t.strings.warning.requiredField:""},n.setFocused=function(){n.isFocusedAtLeastOnce=!0},n.getMaxLength=function(e){var t;return void 0===e||void 0===n.defaultValue?t:t=Math.max(e,n.defaultValue.length)},n}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){this.textFieldElement=document.createElement("div"),this.textFieldElement.className=ce.a.inputElementWrapper;var e=this.placeholder||t.strings.placeholder.textInput;return Z.render(o.createElement(o.StrictMode,null,o.createElement(ue.a,{required:this.isRequired,componentRef:this.setTextFieldRef,maxLength:this.getMaxLength(this.maxLength),placeholder:e,multiline:this.isMultiline,onFocus:this.setFocused,onGetErrorMessage:this.validateText,defaultValue:this.defaultValue,title:e})),this.textFieldElement),this.textFieldElement},t.prototype.internalValidateProperties=function(e){this.textNotValid(this.value)&&e.addFailure(this,$e.ValidationEvent.InvalidPropertyValue,t.strings.warning.missingRequiredInput)},t.prototype.getJsonTypeName=function(){return"Input.Text"},t.prototype.isSet=function(){return!(!this.textField||!this.textField.value)},t.prototype.remove=function(){return this.textFieldElement&&(Z.unmountComponentAtNode(this.textFieldElement),this.textFieldElement=null),e.prototype.remove.call(this)},Object.defineProperty(t.prototype,"value",{get:function(){return this.textField?this.textField.value:""},enumerable:!1,configurable:!0}),t.valueProperty=new $e.StringProperty($e.Versions.v1_0,"value"),t.isRequiredProperty=new $e.BoolProperty($e.Versions.v1_2,"isRequired",!1),t.maxLengthProperty=new $e.NumProperty($e.Versions.v1_0,"maxLength"),t.isMultilineProperty=new $e.BoolProperty($e.Versions.v1_0,"isMultiline",!1),t.placeholderProperty=new $e.StringProperty($e.Versions.v1_0,"placeholder"),t.styleProperty=new $e.EnumProperty($e.Versions.v1_0,"style",$e.InputTextStyle,$e.InputTextStyle.Text),t.inlineActionProperty=new $e.ActionProperty($e.Versions.v1_0,"inlineAction",["Action.ShowCard"]),t.regexProperty=new $e.StringProperty($e.Versions.v1_3,"regex",!0),Object(i.__decorate)([Object($e.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),Object(i.__decorate)([Object($e.property)(t.isRequiredProperty)],t.prototype,"isRequired",void 0),Object(i.__decorate)([Object($e.property)(t.maxLengthProperty)],t.prototype,"maxLength",void 0),Object(i.__decorate)([Object($e.property)(t.isMultilineProperty)],t.prototype,"isMultiline",void 0),Object(i.__decorate)([Object($e.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),Object(i.__decorate)([Object($e.property)(t.styleProperty)],t.prototype,"style",void 0),Object(i.__decorate)([Object($e.property)(t.inlineActionProperty)],t.prototype,"inlineAction",void 0),Object(i.__decorate)([Object($e.property)(t.regexProperty)],t.prototype,"regex",void 0),t}($e.Input);!function(e){e[e.Ok=0]="Ok",e[e.RequiredIsEmpty=1]="RequiredIsEmpty",e[e.NotNumber=2]="NotNumber",e[e.LessThanMin=3]="LessThanMin",e[e.MoreThanMax=4]="MoreThanMax"}(Ke||(Ke={}));var tt=function(e,t,n,r){if(r&&null===e)return Ke.RequiredIsEmpty;if(null!==e){if("number"!=typeof e)return Ke.NotNumber;if("number"==typeof n&&n<e)return Ke.MoreThanMax;if("number"==typeof t&&t>e)return Ke.LessThanMin}return Ke.Ok},nt=Object(y.a)((function(e){var t,n=Object(i.__read)(o.useState(e.value),2),r=n[0],a=n[1],s=Object(i.__read)(o.useState(!1),2),l=s[0],c=s[1],d=e.min,u=e.max;return o.createElement(ue.a,{type:"number",value:(t=r,"number"==typeof t?t.toString():t),min:d,max:u,onFocus:function(){c(!0)},onChange:function(t,n){var r=n?Number(n):null;e.onValueChanged(r),a(r)},required:e.required,placeholder:e.placeholder,onGetErrorMessage:function(t){if(!l)return"";var n=t?Number(t):null,r=e.strings,a=e.onValueChanged,i=tt(n,d,u,e.required);switch(a(n),i){case Ke.RequiredIsEmpty:return r.warning.requiredField;case Ke.LessThanMin:return r.format(r.warning.inputNumberLessThanMin,d);case Ke.MoreThanMax:return r.format(r.warning.inputNumberMoreThanMax,u);case Ke.NotNumber:return r.warning.inputNumberNotNumeric;case Ke.Ok:default:return""}}})})),rt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isRequired=!1,t.currentValue=null,t.onTextFieldValueChanged=function(e){t.currentValue=e},t}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){this.numberTextFieldElement=document.createElement("div"),this.numberTextFieldElement.className=ce.a.inputElementWrapper;var e=this.placeholder||t.strings.placeholder.numberInput;return Z.render(o.createElement(o.StrictMode,null,o.createElement(nt,{placeholder:e,onValueChanged:this.onTextFieldValueChanged,min:this.min,max:this.max,required:this.isRequired,value:this.defaultValue,strings:t.strings})),this.numberTextFieldElement),this.numberTextFieldElement},t.prototype.internalValidateProperties=function(e){this.isRequired&&!this.currentValue?e.addFailure(this,$e.ValidationEvent.InvalidPropertyValue,t.strings.warning.missingRequiredInput):tt(this.value,this.min,this.max,this.isRequired)!==Ke.Ok&&e.addFailure(this,$e.ValidationEvent.InvalidPropertyValue,t.strings.warning.invalidInput)},t.prototype.getJsonTypeName=function(){return"Input.Number"},t.prototype.isSet=function(){return null!==this.currentValue},t.prototype.remove=function(){return this.numberTextFieldElement&&(Z.unmountComponentAtNode(this.numberTextFieldElement),this.numberTextFieldElement=null),e.prototype.remove.call(this)},Object.defineProperty(t.prototype,"value",{get:function(){return this.currentValue},enumerable:!1,configurable:!0}),t.valueProperty=new $e.NumProperty($e.Versions.v1_0,"value"),t.isRequiredProperty=new $e.BoolProperty($e.Versions.v1_2,"isRequired",!1),t.placeholderProperty=new $e.StringProperty($e.Versions.v1_0,"placeholder"),t.minProperty=new $e.NumProperty($e.Versions.v1_0,"min"),t.maxProperty=new $e.NumProperty($e.Versions.v1_0,"max"),Object(i.__decorate)([Object($e.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),Object(i.__decorate)([Object($e.property)(t.isRequiredProperty)],t.prototype,"isRequired",void 0),Object(i.__decorate)([Object($e.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),Object(i.__decorate)([Object($e.property)(t.minProperty)],t.prototype,"min",void 0),Object(i.__decorate)([Object($e.property)(t.maxProperty)],t.prototype,"max",void 0),t}($e.Input),at=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isRequired=!1,t.selectedDate=null,t.onSelectDate=function(e){e instanceof Date&&(t.selectedDate=e)},t.dateNotValid=function(){return t.isRequired&&null===t.selectedDate},t}return Object(i.__extends)(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.defaultValue&&(this.selectedDate=new Date(this.defaultValue))},t.prototype.internalRender=function(){this.datePickerElement=document.createElement("div"),this.datePickerElement.className=ce.a.inputElementWrapper;var e=new Date(Date.now()),n=this.defaultValue?new Date(this.defaultValue):null,r=this.min?new Date(this.min):null,a=this.max?new Date(this.max):null,i=this.placeholder||t.strings.placeholder.dateInput;return Z.render(o.createElement(o.StrictMode,null,o.createElement(oe.a,{strings:t.strings.datePicker,isMonthPickerVisible:!1,showMonthPickerAsOverlay:!0,firstDayOfWeek:se.c.Sunday,today:e,value:n,minDate:r,maxDate:a,isRequired:this.isRequired,placeholder:i,ariaLabel:i,onSelectDate:this.onSelectDate})),this.datePickerElement),this.datePickerElement},t.prototype.internalValidateProperties=function(e){this.dateNotValid()&&e.addFailure(this,$e.ValidationEvent.InvalidPropertyValue,t.strings.warning.missingRequiredInput)},t.prototype.getJsonTypeName=function(){return"Input.Date"},t.prototype.isSet=function(){return null!==this.selectedDate},t.prototype.remove=function(){return this.datePickerElement&&(Z.unmountComponentAtNode(this.datePickerElement),this.datePickerElement=null),e.prototype.remove.call(this)},Object.defineProperty(t.prototype,"value",{get:function(){return this.selectedDate?this.selectedDate.toISOString():null},enumerable:!1,configurable:!0}),t.valueProperty=new $e.StringProperty($e.Versions.v1_0,"value"),t.isRequiredProperty=new $e.BoolProperty($e.Versions.v1_2,"isRequired",!1),t.placeholderProperty=new $e.StringProperty($e.Versions.v1_0,"placeholder"),t.minProperty=new $e.StringProperty($e.Versions.v1_0,"min"),t.maxProperty=new $e.StringProperty($e.Versions.v1_0,"max"),Object(i.__decorate)([Object($e.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),Object(i.__decorate)([Object($e.property)(t.isRequiredProperty)],t.prototype,"isRequired",void 0),Object(i.__decorate)([Object($e.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),Object(i.__decorate)([Object($e.property)(t.minProperty)],t.prototype,"min",void 0),Object(i.__decorate)([Object($e.property)(t.maxProperty)],t.prototype,"max",void 0),t}($e.Input),it=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isRequired=!1,t.valueOn="true",t.valueOff="false",t.wrap=!1,t.checked=!1,t.onCheckboxChanged=function(e,n){t.checked=!!n},t}return Object(i.__extends)(t,e),t.prototype.internalRender=function(){return this.checkboxElement=document.createElement("div"),Z.render(o.createElement(o.StrictMode,null,o.createElement(ne.a,{defaultChecked:this.checked,onChange:this.onCheckboxChanged,label:this.title})),this.checkboxElement),this.checkboxElement},t.prototype.internalValidateProperties=function(e){this.isRequired&&!this.checked&&e.addFailure(this,$e.ValidationEvent.InvalidPropertyValue,t.strings.warning.missingRequiredInput)},t.prototype.getJsonTypeName=function(){return"Input.Toggle"},t.prototype.isSet=function(){return this.isRequired?this.value===this.valueOn:!!this.value},t.prototype.remove=function(){return this.checkboxElement&&(Z.unmountComponentAtNode(this.checkboxElement),this.checkboxElement=null),e.prototype.remove.call(this)},Object.defineProperty(t.prototype,"value",{get:function(){return this.checked?this.valueOn:this.valueOff},enumerable:!1,configurable:!0}),t.valueProperty=new $e.StringProperty($e.Versions.v1_0,"value"),t.isRequiredProperty=new $e.BoolProperty($e.Versions.v1_2,"isRequired",!1),t.titleProperty=new $e.StringProperty($e.Versions.v1_0,"title"),t.valueOnProperty=new $e.StringProperty($e.Versions.v1_0,"valueOn",!0,void 0,"true",(function(e){return"true"})),t.valueOffProperty=new $e.StringProperty($e.Versions.v1_0,"valueOff",!0,void 0,"false",(function(e){return"false"})),t.wrapProperty=new $e.BoolProperty($e.Versions.v1_2,"wrap",!1),Object(i.__decorate)([Object($e.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),Object(i.__decorate)([Object($e.property)(t.isRequiredProperty)],t.prototype,"isRequired",void 0),Object(i.__decorate)([Object($e.property)(t.titleProperty)],t.prototype,"title",void 0),Object(i.__decorate)([Object($e.property)(t.valueOnProperty)],t.prototype,"valueOn",void 0),Object(i.__decorate)([Object($e.property)(t.valueOffProperty)],t.prototype,"valueOff",void 0),Object(i.__decorate)([Object($e.property)(t.wrapProperty)],t.prototype,"wrap",void 0),t}($e.Input),ot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.choices=[],t.isMultiSelect=!1,t.wrap=!1,t.isRequired=!1,t.onDropdownChanged=function(e,n){t.selectedChoiceIndices=[n]},t.onChoiceGroupChanged=function(e,n){t.selectedChoiceIndices=[n.index]},t}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"isCompact",{get:function(){return"expanded"!==this.style},set:function(e){this.style=e?void 0:"expanded"},enumerable:!1,configurable:!0}),t.prototype.initialize=function(){var e=this;this.mappedChoices=this.choices.map((function(e,t){return{key:e.value,text:e.title,index:t}})),this.selectedChoiceIndices=[];for(var t=this.parseValueString(this.defaultValue),n=function(n){t.filter((function(t){return t===e.choices[n].value})).length>0&&r.selectedChoiceIndices.push(n)},r=this,a=0;a<this.choices.length;a++)n(a);this.initialized=!0},t.prototype.renderCheckboxGroup=function(e){for(var t=this,n=[],r=function(r){n.push(o.createElement(ne.a,{defaultChecked:e.filter((function(e){return e===t.choices[r].value})).length>0,label:a.choices[r].title,onChange:a.getOnCheckboxChangedHandler(r)}))},a=this,i=0;i<this.choices.length;i++)r(i);return o.createElement(o.Fragment,null,n)},t.prototype.getOnCheckboxChangedHandler=function(e){var t=this;return function(n,r){r?t.selectedChoiceIndices.push(e):t.selectedChoiceIndices.splice(t.selectedChoiceIndices.indexOf(e),1)}},t.prototype.parseValueString=function(e){return e?e.split(this.hostConfig.choiceSetInputValueSeparator):[]},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.initialize()},t.prototype.internalRender=function(){if(this.element=document.createElement("div"),this.element.style.width="100%",!this.initialized)return g.g.warn("[ActionableMessageDebug] CustomChoiceSetInput: Control not initialized before render"),this.element;if(this.isMultiSelect)Z.render(this.renderCheckboxGroup(this.parseValueString(this.defaultValue)),this.element);else if(this.isCompact){var e=this.placeholder||t.strings.placeholder.choiceSetInput;Z.render(o.createElement(o.StrictMode,null,o.createElement(ae.a,{onChanged:this.onDropdownChanged,options:this.mappedChoices,defaultSelectedKey:this.defaultValue,placeHolder:e,required:this.isRequired})),this.element)}else Z.render(o.createElement(o.StrictMode,null,o.createElement(re.a,{onChange:this.onChoiceGroupChanged,options:this.mappedChoices,defaultSelectedKey:this.defaultValue,required:this.isRequired})),this.element);return this.element},t.prototype.internalValidateProperties=function(e){this.isRequired&&!this.value&&e.addFailure(this,$e.ValidationEvent.InvalidPropertyValue,t.strings.warning.missingRequiredInput)},t.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},t.prototype.isSet=function(){return void 0!==this.value},t.prototype.remove=function(){return this.element&&(Z.unmountComponentAtNode(this.element),this.element=null),e.prototype.remove.call(this)},Object.defineProperty(t.prototype,"value",{get:function(){var e=void 0;if(this.selectedChoiceIndices)for(var t=0;t<this.selectedChoiceIndices.length;t++){""!==e&&(e+=this.hostConfig.choiceSetInputValueSeparator);var n=this.selectedChoiceIndices[t];this.choices[n].value?e+=this.choices[n].value:e+=this.choices[n].title}return e},enumerable:!1,configurable:!0}),t.valueProperty=new $e.StringProperty($e.Versions.v1_0,"value"),t.choicesProperty=new $e.SerializableObjectCollectionProperty($e.Versions.v1_0,"choices",$e.Choice),t.styleProperty=new $e.ValueSetProperty($e.Versions.v1_0,"style",[{value:"compact"},{value:"expanded"}],"compact"),t.isMultiSelectProperty=new $e.BoolProperty($e.Versions.v1_0,"isMultiSelect",!1),t.placeholderProperty=new $e.StringProperty($e.Versions.v1_0,"placeholder"),t.wrapProperty=new $e.BoolProperty($e.Versions.v1_2,"wrap",!1),t.isRequiredProperty=new $e.BoolProperty($e.Versions.v1_2,"isRequired",!1),Object(i.__decorate)([Object($e.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),Object(i.__decorate)([Object($e.property)(t.choicesProperty)],t.prototype,"choices",void 0),Object(i.__decorate)([Object($e.property)(t.styleProperty)],t.prototype,"style",void 0),Object(i.__decorate)([Object($e.property)(t.isMultiSelectProperty)],t.prototype,"isMultiSelect",void 0),Object(i.__decorate)([Object($e.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),Object(i.__decorate)([Object($e.property)(t.wrapProperty)],t.prototype,"wrap",void 0),Object(i.__decorate)([Object($e.property)(t.isRequiredProperty)],t.prototype,"isRequired",void 0),t}($e.Input),st=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderLivePersonaControlCard=function(e){var n=window.LivePersonaCardHoverTargetV2,r=o.createElement(n,{cardParameters:{personaInfo:{identifiers:{Smtp:e.smtp,PersonaType:"User"}},behavior:{locationToOpen:"Card"}}},o.createElement("span",{"data-debug":e.name,style:{display:"inline-block"}},e.name)),a=t.lpcElement.querySelector("[data-mention-name='"+e.name+"']");Z.render(r,a)},t}return Object(i.__extends)(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.mentions=t.mentions},t.prototype.internalRender=function(){var t=this;return Object(l.i)("rp-actionableMessages-lpc")&&this.mentions&&0!=this.mentions.length?(this.lpcElement=e.prototype.internalRender.call(this),this.mentions.forEach((function(e){t.lpcElement.innerHTML=t.lpcElement.innerHTML.replace(new RegExp(e.name,"i"),'<span data-mention-name="'+e.name+'"></span>')})),this.mentions.forEach((function(e){return t.renderLivePersonaControlCard(e)})),this.lpcElement):e.prototype.internalRender.call(this)},t}($e.TextBlock),lt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.smtp=t.smtp},t.prototype.internalRender=function(){if(!this.smtp||!Object(l.i)("rp-actionableMessages-lpc"))return e.prototype.internalRender.call(this);var t,n=window.LivePersonaCardHoverTargetV2;this.lpcElement=document.createElement("div");var r=o.createElement(n,{cardParameters:{personaInfo:{identifiers:{Smtp:this.smtp,PersonaType:"User"}},behavior:{locationToOpen:"Card"}}},o.createElement("div",{ref:function(e){return t=e}}));return Z.render(r,this.lpcElement),t.appendChild(e.prototype.internalRender.call(this)),this.lpcElement},t.prototype.remove=function(){return this.lpcElement&&(Z.unmountComponentAtNode(this.lpcElement),this.lpcElement=null),e.prototype.remove.call(this)},t}($e.Image),ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.email=t.email},t.prototype.internalRender=function(){this.personaElement=document.createElement("div");var e=o.createElement(dt,{emailAddress:this.email,name:""});return Z.render(e,this.personaElement),this.personaElement},t.prototype.remove=function(){return this.personaElement&&(Z.unmountComponentAtNode(this.personaElement),this.personaElement=null),e.prototype.remove.call(this)},t.prototype.getJsonTypeName=function(){return"Persona"},t.prototype.renderSpeech=function(){return this.email},t}($e.CardElement);function dt(e){var t=Object(Q.a)(e),n=e.emailAddress,r=e.name,a=e.mailBoxType;return o.createElement(t,null,o.createElement(G.a,{emailAddress:n,name:r,size:X.c.size48,showPersonaDetails:!1,mailboxType:a}))}var ut=!1,pt=function(e,t){var n=Ce().render(e);t.didProcess=!0,t.outputHtml=n},ht=function(e){ut||(ut=!0,$e.GlobalSettings.allowMarkForTextHighlighting=!0,$e.AdaptiveCard.onProcessMarkdown=pt,function(e){et.strings=e,$e.AdaptiveApplet.elementsRegistry.register("Input.Text",et),rt.strings=e,$e.AdaptiveApplet.elementsRegistry.register("Input.Number",rt),at.strings=e,$e.AdaptiveApplet.elementsRegistry.register("Input.Date",at),it.strings=e,$e.AdaptiveApplet.elementsRegistry.register("Input.Toggle",it),ot.strings=e,$e.AdaptiveApplet.elementsRegistry.register("Input.ChoiceSet",ot),$e.AdaptiveApplet.elementsRegistry.register("TextBlock",st),$e.AdaptiveApplet.elementsRegistry.register("Image",lt),$e.AdaptiveApplet.elementsRegistry.register("Persona",ct)}(e))};n(8973);var gt=n(4325),mt=function(e){function t(t){var n=e.call(this,t)||this;return n.initializeCardProperties=function(){var e=n.props.actionableMessageCardStrings;n.responseMessage={message:"",type:r.Error,viewType:a.AutoDismiss},n.cardElementId=w+Object(m.a)(),ht(e)},n.renderActionResponse=function(){return o.createElement(N,{message:n.responseMessage.message,type:n.responseMessage.type,viewType:n.responseMessage.viewType,autoDismissTimeout:n.props.snackBarTimeout,onHideActionResponse:n.setShowCard,acknowledgeButtonText:n.responseMessage.acknowledgeButtonText,onAcknowledgeActionResponse:n.responseMessage.onAcknowledgeActionResponse})},n.setCardContainer=function(e){n.cardContainer!==e&&(g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper: setCardContainer"),n.cardContainer=e,n.pendingCardToShow&&n.addCardElementToDOM(n.pendingCardToShow))},n.removeCardElementFromDOM=function(){var e=document.getElementById(n.cardElementId);e&&n.cardContainer&&n.cardContainer.contains(e)&&(g.g.info("[ActionableMessageDebug] ActionableMessageCard: removing old card from container"),n.cardContainer.removeChild(e),n.currentCardElement=null)},n.addCardElementToDOM=function(e){n.cardContainer?(n.pendingCardToShow=null,n.removeCardElementFromDOM(),g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper: adding card element to DOM"),n.currentCardElement=e,n.cardContainer.appendChild(n.currentCardElement)):n.pendingCardToShow=e},n.setHideCard=function(){g.g.info("[ActionableMessageDebug] hideCard. cardId: "+n.props.cardDetails.cardId),n.setState({cardState:2}),n.props.showMessageBodyCallback&&n.props.showMessageBodyCallback(!0)},n.setShowCard=function(){g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper setCardVisibility: setting card visibility to true "),n.setState({cardState:1}),n.props.onCardRendered&&n.props.onCardRendered(n.currentCardElement)},n.cleanupCard=function(){var e;g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper cleanupCard: cardId: "+n.props.cardDetails.cardId),(null===(e=n.adaptiveApplet)||void 0===e?void 0:e.card)&&n.adaptiveApplet.card.getAllInputs().forEach((function(e){e.remove()})),n.props.actionableMessageContentHandler&&n.props.actionableMessageContentHandler.onUndo()},n.onInlineCardExpanded=function(e,t){n.props.actionableMessageContentHandler&&n.props.actionableMessageContentHandler.onApply(e.card.renderedElement);var r=document.getElementById(n.cardElementId);r&&r.scrollIntoView(!0)},n.activityRequestFailed=function(e,t){var a=n.props.actionableMessageCardStrings.error.generic;return"string"==typeof t.content&&(a=t.content),n.displayActionStatusMessage(a,r.Error),-1},n.activityRequestSucceeded=function(e,t){"string"==typeof t.content&&n.displayActionStatusMessage(t.content,r.Success)},n.initializeAdaptiveCard=function(e){n.adaptiveApplet=new $e.AdaptiveApplet,n.adaptiveApplet.setCard(e),n.adaptiveApplet.channelAdapter=n.props.httpChannelAdapter,n.adaptiveApplet.onActivityRequestFailed=n.activityRequestFailed,n.adaptiveApplet.onActivityRequestSucceeded=n.activityRequestSucceeded,n.adaptiveApplet.card.onInlineCardExpanded=n.onInlineCardExpanded},n.displayActionStatusMessage=function(e,t,r,i,o){void 0===r&&(r=a.AutoDismiss),void 0===i&&(i=null),void 0===o&&(o=null),n.responseMessage.message=e,n.responseMessage.type=t,n.responseMessage.viewType=r,n.responseMessage.acknowledgeButtonText=i,n.responseMessage.onAcknowledgeActionResponse=o,n.setState({cardState:3})},n.state={cardState:2},n.initializeCardProperties(),n}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){try{var e=this.props.cardDetails.card;e||this.setHideCard(),this.initializeAdaptiveCard(Object(Qe.toJS)(e)),this.adaptiveApplet.renderedElement||this.setHideCard(),this.addCardElementToDOM(this.adaptiveApplet.renderedElement),this.setShowCard()}catch(e){this.setHideCard()}},t.prototype.componentWillUnmount=function(){g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper unmount"),this.currentCardElement&&this.cleanupCard()},t.prototype.render=function(){var e=this;g.g.info("[ActionableMessageDebug] ActionableMessageCardWrapper render");var t=this.state.cardState;return function(e){return 1===e||3===e}(t)&&o.createElement("div",{className:gt.container+" allowTextSelection",ref:function(t){return e.setCardContainer(t)}},function(e,t){return 3===e&&!!t&&!!t.message}(t,this.responseMessage)&&this.renderActionResponse())},t=Object(i.__decorate)([s.observer],t)}(o.Component);n(8973);var ft=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.render=function(){if(!t.hasCardDetails(t.props.cardDetails))return null;var e=t.getCardVersion(t.props.cardDetails.card);return"V2"!==e||Object(l.i)("rp-actionableMessages-ACv2-support")?"V2"===e?o.createElement(mt,{key:t.props.cardDetails.cardId,cardDetails:t.props.cardDetails,httpChannelAdapter:t.props.httpChannelAdapter,snackBarTimeout:t.props.snackBarTimeout,telemetryHandler:t.props.telemetryHandler,contentHandlerUndoMode:t.props.contentHandlerUndoMode,actionableMessageContentHandler:t.props.actionableMessageContentHandler,actionableMessageCardStrings:t.props.actionableMessageCardStrings,onCardRendered:t.props.onCardRendered,showMessageBodyCallback:t.props.showMessageBodyCallback}):o.createElement(Ze,{key:t.props.cardDetails.cardId,cardDetails:t.props.cardDetails,snackBarTimeout:t.props.snackBarTimeout,loggingHandler:t.props.loggingHandler,telemetryHandler:t.props.telemetryHandler,contentHandlerUndoMode:t.props.contentHandlerUndoMode,actionableMessageContentHandler:t.props.actionableMessageContentHandler,actionProviders:t.props.actionProviders,actionableMessageCardStrings:t.props.actionableMessageCardStrings,getClientAuthToken:t.props.getClientAuthToken,isTrustedDomain:t.props.isTrustedDomain,showMessageBodyCallback:t.props.showMessageBodyCallback,adjustCardElementBeforeRenderCallback:t.props.adjustCardElementBeforeRenderCallback,downloadThemeCallback:t.props.downloadThemeCallback,onCardRendered:t.props.onCardRendered,onCardDetailsUpdated:t.props.onCardDetailsUpdated}):(t.props.showMessageBodyCallback(!0),null)},t}return Object(i.__extends)(t,e),t.prototype.hasCardDetails=function(e){return!!e},t.prototype.getCardVersion=function(e){var t;return(null===(t=null==e?void 0:e.version)||void 0===t?void 0:t.startsWith("2."))?"V2":"V1"},t=Object(i.__decorate)([s.observer],t)}(o.Component);n.d(t,"ActionableMessageCardWrapper",(function(){return ft})),n.d(t,"parseCardFromStringOrObject",(function(){return De}))},1717:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(230);var a=Object(r.a)((function(e){return Object(r.a)((function(t){var n=Object(r.a)((function(e){return function(n){return t(n,e)}}));return function(r,a){return e(r,a?n(a):t)}}))}));function i(e,t){return a(e)(t)}},4325:function(e,t,n){var r=n(15120),a=n(131);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},744:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(0),a=n(1),i=n(273),o=n(448),s=n(445),l=n(309),c=n(287),d=n(335),u=n(431),p=Object(i.a)(),h=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i._checkBox=a.createRef(),i._renderContent=function(e,t,n){void 0===n&&(n={});var l=i.props,c=l.disabled,u=l.inputProps,p=l.name,h=l.ariaLabel,g=l.ariaLabelledBy,m=l.ariaDescribedBy,f=l.onRenderLabel,b=void 0===f?i._onRenderLabel:f,y=l.checkmarkIconProps,v=l.ariaPositionInSet,C=l.ariaSetSize,x=l.title,A=l.label;return a.createElement("div",{className:i._classNames.root,title:x},a.createElement(o.a,null),a.createElement("input",Object(r.__assign)({type:"checkbox"},u,{"data-ktp-execute-target":n["data-ktp-execute-target"],checked:e,disabled:c,className:i._classNames.input,ref:i._checkBox,name:p,id:i._id,title:x,onChange:i._onChange,onFocus:i._onFocus,onBlur:i._onBlur,"aria-disabled":c,"aria-label":h||A,"aria-labelledby":g,"aria-describedby":Object(s.a)(m,n["aria-describedby"]),"aria-posinset":v,"aria-setsize":C,"aria-checked":t?"mixed":e?"true":"false"})),a.createElement("label",{className:i._classNames.label,htmlFor:i._id},a.createElement("div",{className:i._classNames.checkbox,"data-ktp-target":n["data-ktp-target"]},a.createElement(d.a,Object(r.__assign)({iconName:"CheckMark"},y,{className:i._classNames.checkmark}))),b(i.props,i._onRenderLabel)))},i._onFocus=function(e){var t=i.props.inputProps;t&&t.onFocus&&t.onFocus(e)},i._onBlur=function(e){var t=i.props.inputProps;t&&t.onBlur&&t.onBlur(e)},i._onChange=function(e){var t=i.props.onChange,n=i.state,r=n.isChecked;n.isIndeterminate?(t&&t(e,r),void 0===i.props.indeterminate&&i.setState({isIndeterminate:!1})):(t&&t(e,!r),void 0===i.props.checked&&i.setState({isChecked:!r}))},i._onRenderLabel=function(e){var t=e.label,n=e.title;return t?a.createElement("span",{"aria-hidden":"true",className:i._classNames.text,title:n},t):null},Object(l.a)(i),i._id=i.props.id||Object(c.a)("checkbox-"),i.state={isChecked:!!(void 0!==t.checked?t.checked:t.defaultChecked),isIndeterminate:!!(void 0!==t.indeterminate?t.indeterminate:t.defaultIndeterminate)},i}return Object(r.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){var n={};return void 0!==e.indeterminate&&(n.isIndeterminate=!!e.indeterminate),void 0!==e.checked&&(n.isChecked=!!e.checked),Object.keys(n).length?n:null},t.prototype.render=function(){var e=this,t=this.props,n=t.className,r=t.disabled,i=t.boxSide,o=t.theme,s=t.styles,l=t.onRenderLabel,c=void 0===l?this._onRenderLabel:l,d=t.keytipProps,h=this.state,g=h.isChecked,m=h.isIndeterminate;return this._classNames=p(s,{theme:o,className:n,disabled:r,indeterminate:m,checked:g,reversed:"start"!==i,isUsingCustomLabelRender:c!==this._onRenderLabel}),d?a.createElement(u.a,{keytipProps:d,disabled:r},(function(t){return e._renderContent(g,m,t)})):this._renderContent(g,m)},Object.defineProperty(t.prototype,"indeterminate",{get:function(){return!!this.state.isIndeterminate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checked",{get:function(){return!!this.state.isChecked},enumerable:!0,configurable:!0}),t.prototype.focus=function(){this._checkBox.current&&this._checkBox.current.focus()},t.defaultProps={boxSide:"start"},t}(a.Component)},8973:function(e,t,n){var r=n(15127),a=n(131);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)}}]);
//# sourceMappingURL=owa.MailBoot~ActionableMessageCardWrapper.js.map
self.scriptsLoaded['owa.MailBoot~ActionableMessageCardWrapper.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ActionableMessageCardWrapper.js'] = (new Date()).getTime();