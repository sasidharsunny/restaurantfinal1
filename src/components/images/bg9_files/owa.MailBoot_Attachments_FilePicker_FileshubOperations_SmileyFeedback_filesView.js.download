self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Attachments~FilePicker~FileshubOperations~SmileyFeedback~filesView.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[103],{2875:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3),a=Object(r.action)("__DIAGNOSTICS_ADD_E2E_TIME_TO_DIAGNOSTICS_STORE",(function(e,t){return{jsEndToEndTime:e,jsRenderingTime:t}}))},3574:function(e,t,n){"use strict";var r=n(2875),a=n(77),i=new a.c((function(){return Promise.all([n.e(1),n.e(11),n.e(15),n.e(45),n.e(46),n.e(57),n.e(106),n.e(127),n.e(715)]).then(n.bind(null,17033))})),u=new a.b(i,(function(e){return e.addSearchRequestInstrumentation})),o=new a.b(i,(function(e){return e.addResourceTimingEntry})),c=new a.b(i,(function(e){return e.searchDiagnostics})),s=function(){var e=c.tryImportForRender(),t=e?e.getIfInitialized():null;return t?t.searchInstrumentationList:[]};n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return o}))},4492:function(e,t,n){"use strict";var r=n(1437),a=n(3);t.a=Object(a.mutatorAction)("setCurrentSearchQueryId",(function(e,t){Object(r.a)(t).currentSearchQueryId=e}))},4671:function(e,t,n){"use strict";var r=n(0);function a(e){return Object(r.__assign)({__type:"AttachmentItemsPagingDetails:#Exchange"},e)}var i=n(1469),u=n(29);function o(e){return Object(r.__assign)({__type:"SearchAttachmentDataProviderItemsRequest:#Exchange"},e)}var c=n(59);function s(e,t,n,r){return e?n(e):(c.g.warn(t.statusText),404===t.status?r(4):401===t.status||403===t.status?r(2):r(1))}var l=Object.freeze({SortColumn:2,SortOrder:1}),d="maxResults=1000&fields=nextPageToken,files(id,mimeType,name,size,modifiedTime,thumbnailLink,webViewLink,webContentLink,createdTime,fileExtension)",m="GDriveDataProviderItem:#Exchange",f="FacebookDataProviderItem:#Exchange",h="FileAttachmentDataProviderItem:#Exchange",b="FolderAttachmentDataProviderItem:#Exchange",v="OneDriveProScope:#Exchange",_="OneDriveProItemSkipTokenPagingMetadata:#Client",p=n(2697);function g(e,t){return{TotalItemCount:e.length,ResultCode:0,Items:e.map((function(e){return t(e)}))}}function O(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}var j="application/vnd.google-apps.folder";function y(e){return{__type:m,Name:e.name,Size:parseInt(e.size),Thumbnail:{Url:e.thumbnailLink},Preview:{Url:e.thumbnailLink+"2"},CreatedTime:e.createdTime,DownloadUrl:e.webContentLink,WebViewLink:e.webViewLink,FileExtension:e.fileExtension,Modified:e.modifiedTime,MimeType:e.mimeType,Location:e.id,Id:e.id,AttachmentProviderId:null,ProviderType:5,Type:e.mimeType===j?1:0}}function T(e){return Object(r.__assign)(Object(r.__assign)({},g(e.files,y)),{NextPageToken:e.nextPageToken})}function w(e){return Object(r.__assign)(Object(r.__assign)({},O(e)),{NextPageToken:null})}function I(e,t){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(p.m)(e,t)];case 1:return n=r.sent(),a=n.errorResponse,(i=n.result)?[2,s(i,null,T,w)]:[2,s(null,a,T,w)]}}))}))}var S=n(4492),P=n(4106);function k(e){var t;return(null===(t=e.From)||void 0===t?void 0:t.Mailbox)?e.From.Mailbox.Name:null}function D(e){return{__type:e.__type,Id:e.ItemId.Id,AttachmentProviderId:null,ProviderType:10,Type:0,Size:e.Size,From:k(e),Subject:e.Subject,ReceivedDate:e.DateTimeSent,MessagePreview:e.Preview,IsRead:e.IsRead}}var x=function(e){return g(e,D)};function C(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(p.n)(e,t)];case 1:return n=r.sent(),a=n.errorResponse,(i=n.result)?[2,s(i,null,x,O)]:[2,s(null,a,x,O)]}}))}))}var E=n(362),R=n(319),F=n(1344),M=n(3574),A=n(1501),q=n(1802),L=200;function N(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a,i,u,o,l,d,m,f,h,b,v,_;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:if(0==e.length)throw new Error("FilePicker - Mail Messages: StartSearch should not be called with an empty search!!");return t=Object(F.n)(F.e.FilesPicker),Object(S.a)(t.nextSearchQueryId,F.e.FilesPicker),Object(P.a)(Object(E.a)(),F.e.FilesPicker),n=Object(R.b)(),a={Cvid:Object(E.a)(),Scenario:{Name:A.a.MailEmailAttachmentPicker},TimeZone:Object(A.x)(n),TextDecorations:"Off",EntityRequests:(g=e,{Field:"Time",SortDirection:"Desc"},j=[{EntityType:"Message",Filter:null,From:0,PropertySet:"ProvenanceOptimized",Provenances:["Exchange"],Query:{QueryString:g},RefiningQueries:null,Size:50,Sort:[{Field:"Time",SortDirection:"Desc"}]}],j)},i=0,u=0,o=new Date,[4,Object(A.I)(a,t.searchSessionGuid)];case 1:return(l=p.sent())&&2==l.length?(d=l[0].status,f=(m=d==L)?null:l[0].statusText,h=function(e,t,n,r,a,i,u){if(!e||2!=e.length)return null;var o=Object(A.d)(e[0],t,n,"SubstrateSearch",r,new Date,a.currentSearchQueryId,new Headers(e[1]),0,A.a.MailEmailAttachmentPicker);return o.ClientJSPreRequestTime=i,o.ClientJSRequestThreadTime=u,Object(F.Q)(o.SearchTraceID,F.e.FilesPicker,!1),M.d.import().then((function(e){return e(o)})),q.j.importAndExecute(o.SearchTraceID,o.ClientNetworkTime,o.ClientHttpStatus,new Date),o}(l,e,f,o,t,i,u),m?[4,l[0].json()]:[3,3]):(c.g.warn("3S Response for search mail messages failed"),[2,s(null,_={body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},x,O)]);case 2:return b=p.sent(),v=function(e,t){var n,a;if(e&&e.Results&&0!==e.Results.length){var i=[],u=e.Results;try{for(var o=Object(r.__values)(u),c=o.next();!c.done;c=o.next()){var s=c.value,l=Object(A.h)(s.Source,t);l.InstanceKey=s.ReferenceId,i.push(l)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return i}return[]}(Object(A.u)(b),a),q.l.importAndExecute(h.SearchTraceID,new Date,A.a.MailEmailAttachmentPicker),[2,s(v,null,x,O)];case 3:return c.g.warn("3S Response for search mail messages failed with "+f),_={body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:f,type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},q.i.importAndExecute(h.SearchTraceID,A.a.MailEmailAttachmentPicker),[2,s(null,_,x,O)]}var g,j}))}))}function z(e,t,n,c,s,m,f){if(void 0===m&&(m=null),5===e)return function(e,t){return void 0===t&&(t=""),Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){return n=d+"&q=mimeType!='application/octet-stream' and trashed=false and fullText contains '"+e+"'",t&&(n=n+" and '"+t+"' in parents"),[2,I(n)]}))}))}(n,s);if(10===e)return N(n);var h,b,v,_=o({AttachmentDataProviderId:t,Query:n,Paging:a({Sort:f||(h=l,Object(r.__assign)({__type:"AttachmentItemsSort:#Exchange"},h)),FolderId:c,Location:s,RequestedData:Object(i.a)({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:100}),PagingMetadata:m})});return void 0===(b={request:_}).request||b.request.__type||(b.request=o(b.request)),Object(u.a)("SearchAttachmentDataProviderItems",b,v)}var U=n(12),B=n(269),Q=n(2908);function G(e){return null!==e&&e.__type===v}function H(e){return e&&e.__type===_}function W(e,t){return 0===e&&t&&G(t)?t.Type:null}function V(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:n="FPAccessTokenUnavailable",a=[e],r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(Q.c)(e,!1,t)];case 2:return i=r.sent(),Object(U.f)(i)?(Object(B.p)(n,a),[2,!1]):[2,!0];case 3:return r.sent(),Object(B.p)(n,a),[2,!1];case 4:return[2]}}))}))}function J(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(e){case 3:case 2:case 6:return[3,1];case 5:case 10:return[3,3];case 0:return[3,4]}return[3,6];case 1:return[4,V(e,null)];case 2:return[2,r.sent()];case 3:return[2,!0];case 4:return 0!==W(e,n)?[2,!1]:[4,V(e,t)];case 5:return[2,r.sent()];case 6:return[2,!1]}}))}))}function $(e){return e.__type===b||1===e.Type}function K(e){var t=e.filter($),n=e.filter((function(e){return!$(e)}));return t.concat(n)}var Z=n(270);function X(e,t,n){var a,i,u=null,o=null;switch(e){case"asc":u=(a=Object(r.__read)([t,n],2))[0],o=a[1];break;case"desc":u=(i=Object(r.__read)([n,t],2))[0],o=i[1];break;default:Object(Z.a)(e)}return u<o?-1:u>o?1:0}function Y(e,t,n){switch(t){case 2:e.sort((function(e,t){var r=e.Modified,a=t.Modified,i=r?new Date(r):new Date(0),u=a?new Date(a):new Date(0);return X(0===n?"asc":"desc",i,u)}));break;case 1:e.sort((function(e,t){var r=e.Size||0,a=t.Size||0;return 0===n?r-a:a-r}));break;default:e.sort((function(e,t){var r=e.Name.toLowerCase(),a=t.Name.toLowerCase();return X(0===n?"asc":"desc",r,a)}))}}function ee(e){return{__type:Object(p.r)(e)?b:h,Id:e.id,AttachmentProviderId:null,Location:(t=e.path_collection,"/"+(t.entries||[]).map((function(e){return e.name})).join("/")+"/"+e.name),Modified:e.modified_at,ModifiedBy:e.modified_by?e.modified_by.name:null,Name:e.name,ProviderType:3,Size:e.size,Type:Object(p.r)(e)?1:0};var t}var te=function(e){return g(e,ee)};function ne(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i,u,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(p.h)(e)];case 1:return a=r.sent(),i=a.errorResponse,(u=a.result)?(Y((o=s(u,null,te,O)).Items,t,n),o.Items=K(o.Items),[2,o]):[2,s(null,i,te,O)]}}))}))}function re(e){return{__type:Object(p.u)(e)?b:h,Id:Object(p.s)(e)?null:e.id,AttachmentProviderId:null,Location:Object(p.s)(e)?"":e.path_lower,Modified:Object(p.t)(e)?e.server_modified:"",Name:e.name,ProviderType:2,Size:Object(p.t)(e)?e.size:0,Type:Object(p.u)(e)?1:0}}var ae=function(e){return g(e,re)};function ie(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i,u,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(p.j)({path:e})];case 1:return a=r.sent(),i=a.errorResponse,(u=a.result)?(Y((o=s(u,null,ae,O)).Items,t,n),o.Items=K(o.Items),[2,o]):[2,s(null,i,ae,O)]}}))}))}function ue(e){return Object(r.__assign)({__type:"AttachmentThumbnailInfo:#Exchange"},e)}var oe=150,ce=200;function se(e){var t,n=(t=e.images,Object(r.__read)(Object(r.__spread)(t).reverse().filter((function(e){return e.width>=ce&&e.height>=oe})),1)[0]||t[0]);return ue({Url:n.source,Height:n.height,Width:n.width})}function le(e){var t=se(e),n=e.images[0],r=ue({Url:n.source,Height:n.height,Width:n.width});return{__type:f,Id:e.id,Name:"Photo "+e.id+".jpg",AttachmentProviderId:null,ProviderType:6,Location:n.source,DownloadUrl:n.source+"&dl=1",Thumbnail:t,Preview:r,From:e.from?e.from.name:null,PlaceName:e.place?e.place.name:null,AlbumName:e.album?e.album.name:null,CreatedTime:e.created_time||null,PostUrl:e.link,Type:0}}var de=function(e){return g(e,le)};function me(e){return e?function(e){switch(e){case 1:return p.c.Uploaded;case 0:return p.c.Tagged;default:return Object(Z.a)(e)}}(e.Type):p.c.Tagged}function fe(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=me(e),[4,Object(p.k)(t)];case 1:return n=r.sent(),a=n.errorResponse,(i=n.result)?[2,s(i,null,de,O)]:[2,s(null,a,de,O)]}}))}))}function he(e){return e.file?e.file.mimeType:e.package&&"oneNote"===e.package.type?"application/onenote":null}var be=n(313);function ve(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}function _e(e,t,n,a,i,u){var o,c=void 0;if(i)switch(a){case 0:var s=u?u.totalItemsFetched+e.length:e.length;o={skipToken:i,totalItemsFetched:s},c=Object(r.__assign)(Object(r.__assign)({},o),{__type:"OneDriveProItemSkipTokenPagingMetadata:#Client"});break;case 1:throw new Error("We do not support skip token based paging for OneDriveConsumer");default:Object(Z.a)(a)}var l=e.length;return i&&c?l=c.totalItemsFetched+1:c&&(l=c.totalItemsFetched),{TotalItemCount:l,ResultCode:0,Items:e.map((function(e){return function(e,t,n,a){var i,u,o,c=Object(r.__read)(e.folder?[b,null,e.folder.childCount,1,0]:[h,he(e),0,0,e.size],5),s=c[0],l=c[1],d=c[2],m=c[3],f=c[4];return{__type:s,Id:e.id,Name:e.name,Size:f,Thumbnail:{Url:(null===(u=null===(i=e.thumbnails)||void 0===i?void 0:i[0])||void 0===u?void 0:u.medium)?e.thumbnails[0].medium.url:null},Modified:e.lastModifiedDateTime,ModifiedBy:(null===(o=e.lastModifiedBy)||void 0===o?void 0:o.user)?e.lastModifiedBy.user.displayName:null,MimeType:l,Location:e.webDavUrl,ProviderEndpointUrl:t,ChildCount:d,AttachmentProviderId:n,ProviderType:a,Type:m}}(e,t,n,a)})),PagingMetadata:c}}function pe(e,t,n,r,a,i,u){return t?s(t,null,(function(e){return _e(e,n,r,a,i,u)}),ve):s(null,e,(function(e){return _e(e,n,r,a,i,u)}),ve)}function ge(e,t,n,a,i,u){return void 0===u&&(u=null),Object(r.__awaiter)(this,void 0,void 0,(function(){var o,c,s,l,d,m,f,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=Object(be.parse)(e),c=o.protocol+"//"+o.host,s=u?{maxEntries:u.maxEntries,skipToken:u.metadata?u.metadata.skipToken:null}:null,[4,Object(p.o)(c,0,n,a,i,void 0,s)];case 1:return l=r.sent(),d=l.errorResponse,m=l.result,f=m.items,h=m.skipToken,[2,pe(d,f,e,t,0,h,u?u.metadata:null)]}}))}))}var Oe="maxResults=1000&fields=files(id,mimeType,name,size,modifiedTime,thumbnailLink)";function je(e,t){var n="modifiedTime";t&&0===t.SortColumn?n="name":t&&1===t.SortColumn&&(n="quotaBytesUsed");var r=t&&0===t.SortOrder?"asc":"desc";return Oe+"&orderBy=folder,"+n+" "+r+'&q=mimeType!="application/octet-stream" and trashed=false and "'+(e||"root")+'" in parents'}function ye(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(r.__assign)({__type:"GetAttachmentDataProviderItemsRequest:#Exchange"},n))),Object(u.a)("GetAttachmentDataProviderItems",e,t)}var Te,we=(Te={Type:0,DisplayName:"Files",AriaLabel:"Files"},Object(r.__assign)({__type:"OneDriveProScope:#Exchange"},Te));function Ie(e,t,n,r,u,o,c,s,d){return ye({request:{AttachmentDataProviderId:e,Paging:a({Sort:d||l,FolderId:r||"",Location:o||"",ItemsEndpointUrl:u||"",FilterBy:n,RequestedData:Object(i.a)({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100}),PagingMetadata:s}),Scope:null==c?we:c}})}function Se(e,t,n,a,i,u,o,s,d,m,f){return void 0===i&&(i=null),void 0===u&&(u=null),void 0===d&&(d=null),void 0===f&&(f=null),Object(r.__awaiter)(this,void 0,void 0,(function(){var h,b,v,_,p,g;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,26,,27]),[4,J(e,u,i)];case 1:return h=r.sent(),b=void 0,v=!1,h?5!==e?[3,3]:(v=!0,[4,I(je(s,m))]):[3,20];case 2:return b=r.sent(),[3,20];case 3:if(2!==e)return[3,8];_=m?m.SortColumn:l.SortColumn,p=m?m.SortOrder:l.SortOrder,v=!0,r.label=4;case 4:return r.trys.push([4,6,,7]),[4,ie(s,_,p)];case 5:return b=r.sent(),[3,7];case 6:return r.sent(),[3,7];case 7:return[3,20];case 8:if(3!==e)return[3,13];_=m?m.SortColumn:l.SortColumn,p=m?m.SortOrder:l.SortOrder,v=!0,r.label=9;case 9:return r.trys.push([9,11,,12]),[4,ne(o,_,p)];case 10:return b=r.sent(),[3,12];case 11:return r.sent(),[3,12];case 12:return[3,20];case 13:if(6!==e)return[3,18];v=!0,r.label=14;case 14:return r.trys.push([14,16,,17]),[4,fe(i)];case 15:return b=r.sent(),[3,17];case 16:return r.sent(),[3,17];case 17:return[3,20];case 18:return 10!==e?[3,20]:(v=!0,[4,C(o,n)]);case 19:b=r.sent(),r.label=20;case 20:if(0!==W(e,i))return[3,24];if(d&&!H(d))throw new Error("The paging metadata is not of type OneDriveProItemsSkipTokenPagingMetadata");v=h,r.label=21;case 21:return r.trys.push([21,23,,24]),[4,ge(u,t,m?m.SortColumn:l.SortColumn,m?m.SortOrder:l.SortOrder,o,{metadata:d,maxEntries:100})];case 22:return b=r.sent(),[3,24];case 23:return r.sent(),[3,24];case 24:return b&&0===b.ResultCode?(Object(B.p)("FPgetItemsClientCall",[!0,e]),[2,b]):(v&&Object(B.p)("FPgetItemsClientCall",[!1,e]),[4,Ie(t,n,a,o,f,s,i,d,m)]);case 25:return[2,r.sent()];case 26:throw g=r.sent(),c.g.warn("FilePicker: getFileProviderItems got error: "+g.message),g;case 27:return[2]}}))}))}n.d(t,"f",(function(){return z})),n.d(t,"b",(function(){return Se})),n.d(t,"a",(function(){return J})),n.d(t,"e",(function(){return G})),n.d(t,"d",(function(){return H})),n.d(t,"c",(function(){return he}))}}]);
//# sourceMappingURL=owa.MailBoot~Attachments~FilePicker~FileshubOperations~SmileyFeedback~filesView.js.map
self.scriptsLoaded['owa.MailBoot~Attachments~FilePicker~FileshubOperations~SmileyFeedback~filesView.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Attachments~FilePicker~FileshubOperations~SmileyFeedback~filesView.js'] = (new Date()).getTime();