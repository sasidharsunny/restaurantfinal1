self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Addins~Editor~InboxForMeSurface.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[148],{1361:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(1383),i=n(3),a={tabs:[{id:"primaryTab",type:r.a.Primary,state:2,blink:!1,sxsId:"primaryTab"}],tabBarWidth:0,isOverflowMenuShown:!1},o=Object(i.createStore)("tab",a),c=(o(),o().tabs[0])},1362:function(e,t,n){"use strict";function r(){return{isDragOver:!1,draggableItemType:null}}n.d(t,"a",(function(){return r}))},1377:function(e,t,n){"use strict";var r=Object.prototype;t.a=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},1383:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.Compose=3]="Compose",e[e.FloatingChat=4]="FloatingChat",e[e.SxS=5]="SxS"}(r||(r={}))},1401:function(e,t,n){"use strict";var r=9007199254740991,i=/^(?:0|[1-9]\d*)$/;t.a=function(e,t){var n=typeof e;return!!(t=null==t?r:t)&&("number"==n||"symbol"!=n&&i.test(e))&&e>-1&&e%1==0&&e<t}},1410:function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e[e.None=0]="None",e[e.Cache=1]="Cache",e[e.FindPeople=2]="FindPeople",e[e.SearchDirectory=3]="SearchDirectory",e[e.MixedCacheLive=4]="MixedCacheLive"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Manual=2]="Manual"}(i||(i={}))},1426:function(e,t,n){"use strict";var r=n(1433);t.a=function(e,t,n){"__proto__"==t&&r.a?Object(r.a)(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},1441:function(e,t,n){"use strict";var r=n(1511),i=n(1477),a=n(1334),o=n(1448),c=n(1401),s=n(1478),u=Object.prototype.hasOwnProperty;t.a=function(e,t){var n=Object(a.a)(e),d=!n&&Object(i.a)(e),l=!n&&!d&&Object(o.a)(e),p=!n&&!d&&!l&&Object(s.a)(e),f=n||d||l||p,m=f?Object(r.a)(e.length,String):[],b=m.length;for(var v in e)!t&&!u.call(e,v)||f&&("length"==v||l&&("offset"==v||"parent"==v)||p&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||Object(c.a)(v,b))||m.push(v);return m}},1442:function(e,t,n){"use strict";t.a=function(e,t){return function(n){return e(t(n))}}},1447:function(e,t,n){"use strict";var r=n(1441),i=n(1535),a=n(1358);t.a=function(e){return Object(a.a)(e)?Object(r.a)(e):Object(i.a)(e)}},1448:function(e,t,n){"use strict";(function(e){var r=n(618),i=n(1544),a="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=a&&"object"==typeof e&&e&&!e.nodeType&&e,c=o&&o.exports===a?r.a.Buffer:void 0,s=(c?c.isBuffer:void 0)||i.a;t.a=s}).call(this,n(1360)(e))},1451:function(e,t,n){"use strict";var r=n(77),i=n(1361),a=n(1738),o=n(0),c=n(1383);function s(e){var t,n,r=Object(i.a)();try{for(var a=Object(o.__values)(r.tabs),s=a.next();!s.done;s=a.next()){var u=s.value;if(u.type!==c.a.Primary&&u.type!==c.a.SxS&&u.data==e)return u}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return null}function u(e){var t,n,r=Object(i.a)();try{for(var a=Object(o.__values)(r.tabs),c=a.next();!c.done;c=a.next()){var s=c.value;if(s.sxsId===e)return s.id}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return null}var d=n(1862);function l(e){var t,n,r=function(e){var t=Object(d.a)(e);return t?t.tabId:null}(e);if(r){var a=Object(i.a)();try{for(var c=Object(o.__values)(a.tabs),s=c.next();!s.done;s=c.next()){var u=s.value;if(u.id===r)return u.sxsId}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}}return null}function p(e){var t,n,r,a,s=Object(i.a)();try{for(var u=Object(o.__values)(s.tabs),d=u.next();!d.done;d=u.next()){var l=d.value;if(l.type!==c.a.Primary&&l.type!==c.a.SxS&&(null===(a=null===(r=l.data)||void 0===r?void 0:r.id)||void 0===a?void 0:a.Id)==e)return!0}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return!1}var f=n(1764);n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return v})),n.d(t,"i",(function(){return O})),n.d(t,"k",(function(){return g})),n.d(t,"j",(function(){return y})),n.d(t,"e",(function(){return i.a})),n.d(t,"l",(function(){return i.b})),n.d(t,"d",(function(){return a.a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"n",(function(){return p})),n.d(t,"a",(function(){return c.a})),n.d(t,"m",(function(){return f.b}));var m=new r.c((function(){return Promise.all([n.e(0),n.e(2),n.e(3),n.e(41),n.e(43),n.e(174),n.e(270),n.e(275),n.e(742)]).then(n.bind(null,16943))})),b=new r.a(m,(function(e){return e.activateTab})),v=new r.a(m,(function(e){return e.addTab})),O=new r.a(m,(function(e){return e.closeTab})),g=new r.a(m,(function(e){return e.setTabIsShown})),y=new r.b(m,(function(e){return e.getTabById}))},1460:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(0),i=n(1551);function a(e){var t=Object(i.b)(e.EmailAddress,e.DisplayName);return Object(r.__assign)(Object(r.__assign)({},t),{isPendingResolution:!1,persona:e})}t.a=a},1463:function(e,t,n){"use strict";t.a=function(e){return function(t){return e(t)}}},1477:function(e,t,n){"use strict";var r=n(724),i=n(725),a="[object Arguments]";var o=function(e){return Object(i.a)(e)&&Object(r.a)(e)==a},c=Object.prototype,s=c.hasOwnProperty,u=c.propertyIsEnumerable,d=o(function(){return arguments}())?o:function(e){return Object(i.a)(e)&&s.call(e,"callee")&&!u.call(e,"callee")};t.a=d},1478:function(e,t,n){"use strict";var r=n(724),i=n(1393),a=n(725),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1;var c=function(e){return Object(a.a)(e)&&Object(i.a)(e.length)&&!!o[Object(r.a)(e)]},s=n(1463),u=n(1487),d=u.a&&u.a.isTypedArray,l=d?Object(s.a)(d):c;t.a=l},1487:function(e,t,n){"use strict";(function(e){var r=n(734),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,o=a&&a.exports===i&&r.a.process,c=function(){try{var e=a&&a.require&&a.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(e){}}();t.a=c}).call(this,n(1360)(e))},1520:function(e,t,n){"use strict";var r=n(1426),i=n(1364),a=Object.prototype.hasOwnProperty;t.a=function(e,t,n){var o=e[t];a.call(e,t)&&Object(i.a)(o,n)&&(void 0!==n||t in e)||Object(r.a)(e,t,n)}},1535:function(e,t,n){"use strict";var r=n(1377),i=n(1442),a=Object(i.a)(Object.keys,Object),o=Object.prototype.hasOwnProperty;t.a=function(e){if(!Object(r.a)(e))return a(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},1544:function(e,t,n){"use strict";t.a=function(){return!1}},1550:function(e,t,n){"use strict";function r(e){var t;if("SMTP"===e.RoutingType||void 0===e.RoutingType)return e.EmailAddress;var n="MAPIPDL"===e.RoutingType&&(null===(t=e.ItemId)||void 0===t?void 0:t.Id)||e.EmailAddress;return e.RoutingType+":"+n}n.d(t,"a",(function(){return r}))},1551:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(0),i=n(1728),a=n(1695),o={isContextMenuOpen:!1,isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1,expansionStatus:i.a.None,members:[]};function c(e,t){return Object(r.__assign)(Object(r.__assign)({},o),{isValid:!0,displayText:Object(a.a)(e,t)})}},1573:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(295),i={};function a(e){var t=e.toLocaleLowerCase();if(!i[t]){var n={type:"GroupMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:e};i[t]=n}return i[t]}},1588:function(e,t,n){"use strict";var r=n(3),i=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{},usedFindPeopleFallback:!1})();t.a=i},1593:function(e,t,n){"use strict";var r=n(1520),i=n(1426);t.a=function(e,t,n,a){var o=!n;n||(n={});for(var c=-1,s=t.length;++c<s;){var u=t[c],d=a?a(n[u],e[u],u,n,e):void 0;void 0===d&&(d=e[u]),o?Object(i.a)(n,u,d):Object(r.a)(n,u,d)}return n}},1596:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2228),i=n(1693);function a(e){var t=Object(r.a)(),n=Object(i.b)(e);return t.sharingLinks.get(n)}},1617:function(e,t,n){"use strict";var r=n(1364),i=n(1358),a=n(1401),o=n(546);t.a=function(e,t,n){if(!Object(o.a)(n))return!1;var c=typeof t;return!!("number"==c?Object(i.a)(n)&&Object(a.a)(t,n.length):"string"==c&&t in n)&&Object(r.a)(n[t],e)}},1671:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n(0),i=n(1588),a=n(1703);function o(e,t,n,r){return u(l(e),t,n,r)}function c(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a.c.import().then((function(r){return r(e,t,(function(e){return d(n,e,i)}))}))];case 1:return[2,r.sent()]}}))}))}function s(e,t,n,r){return u(e,t,n,r)}function u(e,t,n,r){for(var a=[],o=0;a.length<t&&i.a.recipientCache&&o<i.a.recipientCache.length;){var c=i.a.recipientCache[o];if(e(c))d(n,c.EmailAddress,r)||a.push(c);o++}return a}function d(e,t,n){var r=!1;return e&&function(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}(t,e)&&(r=!0),n&&n.indexOf(t.MailboxType)>=0&&(r=!0),r}var l=function(e){return function(t){var n=t.EmailAddress;if(n.EmailAddress&&0==n.EmailAddress.toLowerCase().indexOf(e))return!0;if(n.Name){if(0==n.Name.toLowerCase().indexOf(e))return!0;for(var r=n.Name.toLowerCase().split(" "),i=0;i<r.length;i++)if(0==r[i].indexOf(e))return!0}return!1}}},1693:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(83),i="_ODSPPSL";function a(e){return Object(r.i)("doc-link-savePermission")&&e&&-1!==e.indexOf(i)?e.substring(0,e.length-i.length):e}function o(e){return!!Object(r.i)("doc-link-savePermission")&&e.lastIndexOf(i)===e.length-i.length}function c(e,t){return!Object(r.i)("doc-link-savePermission")||2!==t&&1!==t?e:e+i}},1695:function(e,t,n){"use strict";var r=n(1629),i=n(1550),a=n(320);var o=function(e,t){var n=t||e.Name;if(!n)return!0;var i,o,c=Object(r.a)(n),s=(i=n,o=e.EmailAddress,i==o||i&&o&&i.toLowerCase()==o.toLowerCase()),u=-1!==n.indexOf("@"),d=!Object(a.a)()&&("ExternalMailbox"===e.MailboxType||"LinkedIn"===e.MailboxType),l="OneOff"===e.MailboxType||"Unknown"===e.MailboxType;return e.EmailAddress&&!("SMTP"===e.RoutingType&&s)&&(c||u||d||l)};t.a=function(e,t){var n=t||e.Name,a=!n||Object(r.a)(n);return o(e,t)?a?Object(i.a)(e):n+" <"+Object(i.a)(e)+">":n}},1703:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(77),i=new r.c((function(){return Promise.all([n.e(9),n.e(449)]).then(n.bind(null,2392))})),a=new r.b(i,(function(e){return e.searchCacheTrie})),o=new r.b(i,(function(e){return e.compareFeatureData})),c=new r.a(i,(function(e){return e.initializeSuggestionTrie}))},1706:function(e,t,n){"use strict";var r=n(83),i=n(1460),a=n(1671),o=function(e){var t=Object(a.c)((function(t){return"SMTP"===t.EmailAddress.RoutingType&&t.EmailAddress.EmailAddress&&t.EmailAddress.EmailAddress.toLowerCase()===e.toLowerCase()}),1);return t.length?t[0]:null},c=n(59),s=function(e){var t=void 0!==e.EmailAddress;return t||c.g.warn("Recipient cache contained a persona that had no EmailAddress"),t};function u(e){if(Object(r.i)("cmp-resolveRecipsFromCache")&&"SMTP"===e.RoutingType&&e.EmailAddress){var t=o(e.EmailAddress);if(t&&s(t))return Object(i.b)(t)}return null}n.d(t,"a",(function(){return u}))},1728:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(r||(r={})),t.b=r},1738:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(1383),a=n(1361),o=n(59);function c(){var e,t,n=Object(a.a)();try{for(var c=Object(r.__values)(n.tabs),s=c.next();!s.done;s=c.next()){var u=s.value;if(2==u.state&&u.type!=i.a.FloatingChat)return u}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}return o.d("There is no active tab. Something went very wrong."),null}},1739:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"Message:#Exchange"},e)}},1764:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r=n(1383),i={};function a(e,t){i[r.a[e]]=t}function o(e){return i[r.a[e]]}},1778:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ExtendedPropertyType:#Exchange"},e)}},1862:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(764);function i(e){var t;return null===(t=r.a.projections)||void 0===t?void 0:t.filter((function(t){return t.tabId==e||t.window==e}))[0]}},1866:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemChange:#Exchange"},e)}},1875:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o}));var r={};function i(e,t,n){r[e.editorId]={htmlEditor:t,plainTextEditor:n}}function a(e,t,n){var i=r[e.editorId];i&&(i.htmlEditor==t&&(i.htmlEditor=null),i.plainTextEditor==n&&(i.plainTextEditor=null),i.htmlEditor||i.plainTextEditor||delete r[e.editorId])}function o(e,t,n,i){if(e){var a=e.bodyType,o=void 0===a||"HTML"===a,c="Text"===a,s=r[e.editorId]||{},u=s.htmlEditor,d=s.plainTextEditor;o&&t&&(u&&!u.isDisposed()||i)?t(u):c&&n&&(d||i)&&n(d)}}},1885:function(e,t,n){"use strict";var r=n(1543),i=n(1617);t.a=function(e){return Object(r.a)((function(t,n){var r=-1,a=n.length,o=a>1?n[a-1]:void 0,c=a>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(a--,o):void 0,c&&Object(i.a)(n[0],n[1],c)&&(o=a<3?void 0:o,a=1),t=Object(t);++r<a;){var s=n[r];s&&e(t,s,r,o)}return t}))}},1944:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"SetItemField:#Exchange"},e)}},1945:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1362),i=n(1410),a=0;function o(e,t){return{userIdentity:t,recipientWellId:"rw-"+ ++a,queryString:"",recipients:[],isDirty:!1,shouldShowContactPicker:!1,findResultSet:[],findResultType:i.b.None,isSearching:!1,directorySearchType:i.a.None,dropViewState:Object(r.a)(),findPeopleFeedbackManager:e,numberOfCacheResults:0}}},1975:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(2117),a=n(1945),o=n(20);function c(e,t,n,c){var s,u,d=Object(a.a)(e,n);if(c&&(d.recipients=Object(o.toJS)(c)),t)try{for(var l=Object(r.__values)(t),p=l.next();!p.done;p=l.next()){var f=p.value;d.recipients.push(Object(i.a)(f))}}catch(e){s={error:e}}finally{try{p&&!p.done&&(u=l.return)&&u.call(l)}finally{if(s)throw s.error}}return d}},1986:function(e,t,n){"use strict";var r=n(29),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",e,t)}n.d(t,"a",(function(){return a}))},2010:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"UpdateItemRequest:#Exchange"},e)}},2043:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1326);function i(e){var t=(Object(r.a)(e)||"").toLowerCase();return!!e&&".fluid"===t}},2088:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1),i=n(306),a=n(519),o=0;function c(e,t){var n=(t||window).document,c=n.createElement("div");c.id="owa-modal-"+o++,n.body.appendChild(c);var s,u=!1,d=function(){u||(u=!0,i.unmountComponentAtNode(c),n.body.removeChild(c))};return[new Promise((function(t,n){s=n,i.render(r.createElement(a.a,{type:a.b.None,onError:function(){d(),n()}},r.createElement(e,{onDismiss:function(e){d(),t(e)}})),c)})),function(){d(),s()}]}},2107:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(20),i=n(3),a={legacySignature:{html:null,txt:null},roamingSignatureMap:new r.ObservableMap,defaultSignatureName:"",defaultReplySignatureName:""},o=Object(i.createStore)("signature",a),c=o()},2117:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(1551),a=n(1706);function o(e){var t=Object(a.a)(e);if(t)return t;var n=Object(i.b)(e);return Object(r.__assign)(Object(r.__assign)({},n),{isPendingResolution:!0,persona:{EmailAddress:e}})}},2134:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(30);function i(){var e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},2172:function(e,t,n){"use strict";n.d(t,"c",(function(){return j})),n.d(t,"e",(function(){return I})),n.d(t,"f",(function(){return S})),n.d(t,"d",(function(){return E})),n.d(t,"a",(function(){return M}));var r=n(0),i=n(1612),a=n(1644),o=n(3841),c=n(3074),s=n(4900),u=n(6037),d=n(6534),l=n(2876),p=n(3933),f=n(30),m=n(74),b=n(3075),v=n(2663),O=n(83),g={};function y(e){var t=g[e.composeId];return t||(t={activeSaveAction:null,hasPendingSaveAction:!1},g[e.composeId]=t),t}function j(e){var t=g[e.composeId];return t&&!!t.activeSaveAction}function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(t=y(e)).activeSaveAction?[3,1]:[2,Promise.resolve(!0)];case 1:return t.hasPendingSaveAction?[4,t.activeSaveAction]:[3,3];case 2:return n.sent(),[2,Promise.resolve(!1)];case 3:return t.hasPendingSaveAction=!0,[4,t.activeSaveAction];case 4:return n.sent(),t.hasPendingSaveAction=!1,[2,Promise.resolve(!0)]}}))}))}function I(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(n=y(e)).activeSaveAction=t,[4,t.then((function(e){return n.activeSaveAction=null,Promise.resolve(e)})).catch((function(e){return n.activeSaveAction=null,Promise.reject(e)}))];case 1:return r.sent(),[2]}}))}))}function S(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(null==(t=g[e.composeId])?void 0:t.activeSaveAction)?[4,t.activeSaveAction]:[3,2];case 1:return n.sent(),[2,Promise.resolve(!0)];case 2:return[2,Promise.resolve(!1)]}}))}))}function E(e){var t=g[e.composeId];return t&&!!t.activeSaveAction}function M(e){g[e.composeId]&&delete g[e.composeId]}t.b=Object(m.d)("trySaveMessage",c.b.MailComposeSave)((function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,h(e)];case 1:return r.sent()?e?e.isSending||E(e)?[2,Promise.resolve()]:(t||(Object(a.a)(e,s.a),e.isManuallySaved=!0),function(e){return Object(l.a)(e)<=Object(f.a)().MaxRecipientsPerMessage}(e)?[2,I(e,Object(d.b)(e).then((function(n){return e.isSending||(Object(d.a)(n,e),Object(p.a)()&&Object(o.a)(e,t?2:4),Object(b.a)()&&Object(O.i)("cmp-clp-auto-labeling")&&v.g.import().then((function(t){t(e,e.protectionViewState.clpViewState,e.itemId,e.content)}))),Promise.resolve()})).catch((function(r){if(!t&&!e.isSending){var a=Object(u.a)(r?r.message:null,!1);Object(i.a)(e,a)}return n&&!e.isSending?Promise.reject(r):Promise.resolve()})))]:(t||Object(i.a)(e,"warningMessageMaxRecipientsExceed"),[2,Promise.resolve()])):[2,Promise.reject("could not save message if view state does not exist")]:[2,Promise.resolve()]}}))}))}))},2190:function(e,t,n){"use strict";var r=n(2088);n.d(t,"a",(function(){return r.a}))},2228:function(e,t,n){"use strict";var r=n(20),i=n(3),a={sharingLinks:new r.ObservableMap({})},o=Object(i.createStore)("sharingLinkStore",a);t.a=o},2259:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"CreateItemJsonRequest:#Exchange"},e)}},2260:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"CreateItemRequest:#Exchange"},e)}},2276:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1875),i=n(2379);function a(e){Object(r.b)(e,(function(t){Object(i.a)(e,t.getContent())}),(function(t){Object(i.a)(e,t.value)}))}},2379:function(e,t,n){"use strict";var r=n(285),i=n(2878);t.a=Object(r.action)("updateContent")((function(e,t,n){e.content!=t&&(e.content=t,n||Object(i.a)(e,!0))}))},2448:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r=n(6036),i=function(e){return[e.toRecipientWell,e.ccRecipientWell,e.bccRecipientWell]},a=function(e){var t=i(e);return Object(r.a)(t).map((function(e){return e.persona.EmailAddress.EmailAddress}))},o=function(e){var t=i(e);return Object(r.a)(t).map((function(e){return e.persona.EmailAddress}))}},2487:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(29),i=n(2259);function a(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("CreateItem",e,t)}},2828:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"DeleteItemField:#Exchange"},e)}},2876:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(6041);function i(e){var t,n,r;return e.isDirty||(null===(t=e.toRecipientWell)||void 0===t?void 0:t.isDirty)||(null===(n=e.ccRecipientWell)||void 0===n?void 0:n.isDirty)||(null===(r=e.bccRecipientWell)||void 0===r?void 0:r.isDirty)}function a(e){return Object(r.a)(e.toRecipientWell)+Object(r.a)(e.ccRecipientWell)+Object(r.a)(e.bccRecipientWell)}},2878:function(e,t,n){"use strict";var r=n(285);t.a=Object(r.action)("setIsDirty")((function(e,t){e.isDirty=t}))},2952:function(e,t,n){"use strict";function r(e){return void 0!==e.publicFolderId}n.d(t,"a",(function(){return r}))},3074:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4899),i=n(3332),a="MailComposeSend";t.b={MailComposeReply:{name:"MailComposeReply",options:{},customData:function(e){return[e.actionSource,e.useFullCompose]},actionSource:function(e){return e.actionSource},cosmosOnlyData:function(e){return e.referenceItemId}},MailComposeReplyAll:{name:"MailComposeReplyAll",options:{},customData:function(e){return[e.actionSource,e.useFullCompose]},actionSource:function(e){return e.actionSource},cosmosOnlyData:function(e){return e.referenceItemId}},MailComposeForward:{name:"MailComposeForward",options:{},customData:function(e,t,n,r){return[t]},actionSource:function(e,t,n,r){return t},cosmosOnlyData:function(e,t,n,r){return e&&e.toString()}},MailComposeSendE2E:{name:"MailComposeSendE2E",customData:function(e){return{composeTraceId:e.logTraceId,operation:e.operation,isGroupScenario:Object(i.b)(e)}}},MailComposeSave:{name:"MailComposeSave"},MailComposeUpConvert:{name:"MailComposeUpConvert"},ComposeCommandDiscardCompose:{name:"ComposeCommandDiscardCompose",customData:function(e){return{composeTraceId:e.logTraceId}},options:{isCore:!0},cosmosOnlyData:function(e){return JSON.stringify({smartReplyExtractionId:Object(r.a)(e,"smartReply"),smartDocExtractionId:Object(r.a)(e,"smartDoc")})}},ComposeCommandShowFrom:{name:"ComposeCommandShowFrom"},ComposeCommandSetImportance:{name:"ComposeCommmandSetImportance",customData:function(e,t){return[t]}}}},3332:function(e,t,n){"use strict";function r(e){return i(e)&&(2==(t=e).operation||t.toRecipientWell.recipients.some((function(e){return e.persona.EmailAddress.EmailAddress.toLowerCase()===t.groupId.toLowerCase()})));var t}function i(e){return!!e.groupId}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},3333:function(e,t,n){"use strict";n.d(t,"f",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return p})),n.d(t,"g",(function(){return f})),n.d(t,"a",(function(){return m})),n.d(t,"k",(function(){return b})),n.d(t,"i",(function(){return v})),n.d(t,"j",(function(){return O}));var r=n(0),i=n(269),a=n(9),o=n(30);function c(e,t){var n=g(e.selectedCLPLabel,"Change"),a=e.originalCLPLabel,o=e.selectedCLPLabel,c=Object(r.__assign)(Object(r.__assign)({},n),{IsLabelChanged:!0,LabelIdBefore:a?a.id:null,IsProtectionChanged:!(!a||!o)&&a.isEncryptingLabel!=o.isEncryptingLabel,ProtectedBefore:null==a?void 0:a.isEncryptingLabel,UserJustification:t});i.k.importAndExecute(c)}function s(e){var t=g(e,"Discover");i.k.importAndExecute(t)}function u(e){(null==e?void 0:e.value)&&e.value.length>0&&Object(i.p)("LoadCLPLabelOnBoot",{labelCount:e.value.length})}function d(e){e&&Object(i.p)("LoadCLPLabelComposeUsage",{isDefaultLabel:e.isDefault,isEncryptingLabel:e.isEncryptingLabel})}function l(e,t){t&&e?Object(i.p)("LoadCLPLabelChange",{isDowngrade:e.settingOrder>t.settingOrder,isOriginalLabelDefault:e.isDefault}):e&&Object(i.p)("LoadCLPLabelUnselect",{isOriginalLabelDefault:e.isDefault,isOriginalLabelEncrypting:e.isEncryptingLabel})}function p(e){401!=e.status&&Object(i.p)("CLPAutoLabelEnabled")}function f(){Object(i.p)("CLPMandatoryLabelDialogShown")}function m(){Object(i.p)("CLPAutoLabelAutomaticApplied")}function b(){Object(i.p)("CLPAutoLabelRecommendedShown")}function v(){Object(i.p)("CLPAutoLabelRecommendedApplied")}function O(){Object(i.p)("CLPAutoLabelRecommendedDismissed")}function g(e,t){var n=Object(o.a)().SessionSettings,r=n.ExternalDirectoryTenantGuid,i=n.UserEmailAddress;return{CreationTime:Object(a.tb)(Object(a.Pb)()),Version:"1.1",Operation:t,OrganizationId:r,UserId:i,ApplicationId:"00000002-0000-0ff1-ce00-000000000000",ApplicationName:"Outlook Web",DataState:"Use",LabelId:e?e.id:null,Protected:e?e.isEncryptingLabel:null}}},3334:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1739),i=n(1332),a=n(1944);function o(e,t){var n;return Object(a.a)({Path:Object(i.a)({FieldURI:e}),Item:Object(r.a)((n={},n[e]=t,n))})}},3499:function(e,t,n){"use strict";function r(e){return e.policyMatchDetails.slice().sort((function(e,t){var n=i(t.Action)-i(e.Action);return 0==n?null==e.MatchPriority?null==t.MatchPriority?n:1:null==t.MatchPriority?-1:e.MatchPriority-t.MatchPriority:n}))[0]}function i(e){switch(e){case 1:return 0;case 4:case 2:case 3:return 1;case 5:return 2;default:return 3}}n.d(t,"a",(function(){return r}))},3725:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1596),i=n(2043),a=n(83);function o(e){var t=[];return null==e||e.forEach((function(e){var n=Object(r.a)(e),o=function(e){switch(e){case 4:return 4;case 3:return 3;case 6:return 6;case 5:return 5;case 2:return 2;case 1:return 1;default:return 0}}(n.permissionLevel),c=Object(a.i)("cmp-prague")&&function(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}(o)&&Object(i.a)(n.fileName);if(1===o||2===o||c){var s={ProviderType:"OneDrivePro",Url:n.url,PermissionType:o};t.push(s)}})),t}},3726:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Manual="manual",e.Automatic="automatic",e.Default="default"}(r||(r={}))},3841:function(e,t,n){"use strict";var r=n(12),i=n(6035),a=n(1612),o=n(5716),c=n(29),s=n(0);function u(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(s.__assign)({__type:"GetDlpPolicyTipsRequest:#Exchange"},n)),Object(c.a)("GetDlpPolicyTips",e,t)}var d=n(320),l=n(1644),p=n(285),f=n(2448),m=n(3499),b=n(59);n.d(t,"b",(function(){return y}));var v=Object(p.action)("triggerPolicyTips")((function(e,t,n,r,a){var o,c=e.policyTipsViewState;if(!(c.handlerDisabled||(null===(o=e.protectionViewState)||void 0===o?void 0:o.IRMData))){var s,d=c.inProgressPolicyMatch,p=c.succeededPolicyMatch,m=c.pendingPolicyMatch;if(n||(n=j(e.subject)),r||(r=j(e.content)),a||(a=Object(i.a)(e)),c.isRequestInProgress)c.pendingRequests=!0,m.itemId=e.itemId,m.subjectChecksum=n,m.contentChecksum=r,m.eventTrigger=t,m.attachmentIds=a;else{if(c.pendingRequests=!1,d.itemId=e.itemId,d.subjectChecksum=n,d.contentChecksum=r,d.eventTrigger=t,d.attachmentIds=a,0==(s=d).subjectChecksum&&0==s.contentChecksum&&0==s.attachmentIds.length)return p.policyMatchDetails=[],p.subjectChecksum=0,p.contentChecksum=0,p.attachmentIds=[],void Object(l.a)(e,"dlpPolicyTips");(h(d,p)||function(e,t){if(e.attachmentIds.length!=t.attachmentIds.length)return!0;for(var n=0;n<e.attachmentIds.length;n++)if(null!=e.attachmentIds[n]&&null!=t.attachmentIds[n]&&e.attachmentIds[n].Id!=t.attachmentIds[n].Id)return!0;return!1}(d,p)||1==t)&&function(e){var t=e.policyTipsViewState,n=t.succeededPolicyMatch,r=t.inProgressPolicyMatch,i=e.itemId;if(null==i?void 0:i.Id){var a={ItemId:i,ClientSupportsScanResultData:!0,ScanResultData:n.scanResultData,ScanResultMetadata:n.scanResultMetaData,BodyOrSubjectChanged:h(r,n),NeedToReclassify:!n.itemId,CustomizedStringsNeeded:!0,Recipients:Object(f.a)(e),EventTrigger:r.eventTrigger};e.policyTipsViewState.isRequestInProgress=!0,u(a).then((function(t){!function(e,t,n,r){var i=t.policyTipsViewState,a=i.pendingPolicyMatch;i.isRequestInProgress=!1,i.pendingRequests&&a&&v(t,a.eventTrigger,a.subjectChecksum,a.contentChecksum,a.attachmentIds);0==e.EvaluationResult||1==e.OptimizationResult||2==e.EvaluationResult?n(t,e):r(t,e)}(t,e,O,g)}))}}(e)}}}));t.a=v;function O(e,t){var n=e.policyTipsViewState,r=n.succeededPolicyMatch,i=n.inProgressPolicyMatch;r.itemId=i.itemId,r.attachmentIds=i.attachmentIds,r.subjectChecksum=i.subjectChecksum,r.contentChecksum=i.contentChecksum,r.policyMatchDetails=t.Matches,t.ScanResultData&&(r.scanResultData=t.ScanResultData),t.ScanResultMetadata&&(r.scanResultMetaData=t.ScanResultMetadata),1==t.OptimizationResult&&(n.handlerDisabled=!0),function(e,t){if(t){var n=e.policyTipsViewState,r={complianceUrl:t.ComplianceURL,blockString:t.PolicyTipMessageBlockString,notifyString:t.PolicyTipMessageNotifyString,overrideString:t.PolicyTipMessageOverrideString};Object(o.a)(n,r,(function(e,t){return t||e}))}}(e,t.CustomizedStrings),y(e)}function g(e,t){var n=e.policyTipsViewState;t?(b.g.warn(Object(r.c)("PolicyTips failed with EvaluationResult code of: {0}",t.EvaluationResult)+" Diagnostic: "+t.DiagnosticData),4!=t.EvaluationResult&&7!=t.EvaluationResult&&1!=t.EvaluationResult&&6!=t.EvaluationResult&&8!=t.EvaluationResult||(b.g.warn("Disabling further PolicyTips requests because of the failure"),n.handlerDisabled=!0)):(b.g.warn("PolicyTipsResponse is null (PolicyTipsRequest is timed out)"),n.handlerDisabled=!0),Object(l.a)(e,"dlpPolicyTips")}function y(e){Object(l.a)(e,["consumerDlpPolicyTips","enterpriseDlpPolicyTips"]),Object(m.a)(e.policyTipsViewState.succeededPolicyMatch)&&(Object(d.a)()?Object(a.a)(e,"consumerDlpPolicyTips"):Object(a.a)(e,"enterpriseDlpPolicyTips"))}function j(e){var t=0;if(e)for(var n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}function h(e,t){return e.subjectChecksum!=t.subjectChecksum||e.contentChecksum!=t.contentChecksum}},3932:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(30);function i(e){return e===Object(r.a)().SessionSettings.UserEmailAddress}},3933:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(30);function i(){return Object(r.a)().PolicyTipsEnabled}},4035:function(e,t,n){"use strict";var r=n(5332),i=n(4213),a=n(1482),o=n(30),c=n(320);var s=n(6039);function u(){var e,t,n=(e=Object(o.a)(),t=Object(c.a)()?e.SessionSettings.DefaultFromAddress:e.UserOptions.SendAddressDefault,Object(a.c)(t)?t:Object(i.a)()),u=Object(i.a)();if(u===n&&Object(s.a)(n)){var d=Object(r.b)(u,!0);if(d&&d.length>0)return d[0]}return n}var d=n(6789),l=n(1323);function p(e){var t;if(e){var n=Object(l.g)(),r=null==n?void 0:n.items,i=r&&r.has(e.Id)&&r.get(e.Id);t=i&&Object(d.a)(i.ToRecipients,i.CcRecipients)}return{MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:t||u(),Name:Object(o.a)().SessionSettings.UserDisplayName}}n.d(t,"a",(function(){return p}))},4213:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(30);function i(){return Object(r.a)().SessionSettings.UserEmailAddress}},4215:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(622),i=n(1568),a=n(1332),o=n(1545),c=n(1943),s=n(83),u=n(4904);function d(e){var t=Object(r.a)({BaseShape:"IdOnly",ClientSupportsIrm:!0,FilterHtmlContent:!0,InlineImageCustomDataTemplate:i.e,InlineImageUrlOnLoadTemplate:"",InlineImageUrlTemplate:i.f,AdditionalProperties:[Object(a.a)({FieldURI:"ItemLastModifiedTime"})]});return Object(u.a)(t),e&&(t.BodyType=e),t.ImageProxyCapability=Object(s.i)("rp-replyImageProxy")&&Object(o.a)()?c.a.OwaConnectorsProxyAndCompose:c.a.None,t}},4222:function(e,t,n){"use strict";var r=n(285);t.a=Object(r.action)("setIsDirty")((function(e,t){void 0===t&&(t=!0),e.isDirty=t}))},4526:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r="<div id=appendonsend></div>";function i(e){var t="";return"HTML"==e&&(t+=r),t}},4527:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r={Name:{id:34230,propertyType:"String"},Description:{id:34231,propertyType:"String"},Id:{id:34232,propertyType:"String"},IsClassified:{id:34229,propertyType:"Boolean"}},i="messageClassification"},4899:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1323);function i(e,t){var n,i,a,o="";if(e){var c=r.u.items.get(null===(n=e.referenceItemId)||void 0===n?void 0:n.Id);switch(t){case"smartReply":(null===(i=null==c?void 0:c.SmartReplyData)||void 0===i?void 0:i.ExtractionID)&&(o=c.SmartReplyData.ExtractionID);break;case"smartDoc":(null===(a=null==c?void 0:c.SmartDocData)||void 0===a?void 0:a.EntityId)&&(o=c.SmartDocData.EntityId)}}return o}},4900:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade","errorMessageExceededHourlyMessageLimit","errorMessageExceededMaxRecipientLimit","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimit","errorMessageExceededMessageLimitShowTierUpgrade","errorMessageMessageSubmissionBlocked","errorMessageMessageBlocked","errorMessageTimeout","errorMessageThrottled","errorMessageTransientError","errorMessageItemNoLongerExistToSave","errorMessageItemNoLongerExistToSend","errorMessageQuotaExceededMessageCanNotBeSaved","errorMessageQuotaExceededMessageCanNotBeSent","errorMessageSubmissionQuotaExceededMessageCanNotBeSent","errorMessageMessageCanNotBeSaved","errorMessageMessageCanNotBeSent","errorMessageNoPermissionToSendAs","errorMessageNoRecipentsMailCanNotBeSend","errorMessageInvalidSenderMailCanNotBeSend","warningMessageMaxRecipientsExceed","warningMessageNoPermissionToPerformAction","error500","error503","errorFailedToFetch","errorSessionTimeout","errorMailboxStoreUnavailable","errorMessageErrorWithDetail","smimeEncodeError","smimeBccForkingFailedError"]},4903:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return c}));var r="msip_labels",i="X-MS-Exchange-Organization-ModifySensitivityLabel",a="00000000-0000-0000-0000-000000000000",o="Standard",c="Privileged"},4904:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(83),i=n(472);function a(e){var t;Object(r.i)("cmp-clp")&&(null===(t=e.AdditionalProperties)||void 0===t||t.push(Object(i.a)({PropertyName:"msip_labels",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"})))}},4905:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1778),i=n(472),a=n(1739),o=n(1944);function c(e){return Object(o.a)({Path:Object(i.a)(e.ExtendedFieldURI),Item:Object(a.a)({ExtendedProperty:[Object(r.a)(e)]})})}},5332:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(4213),i=n(6039),a=n(30),o=n(320);function c(e){var t=[],n=Object(r.a)();Object(i.a)(n)||t.push(n);var o=s(n,e);return t=function(e){var t=Object(a.a)().SessionSettings.ConnectedAccountInfos;t&&t.length>0&&t.forEach((function(t){-1==e.lastIndexOf(t.EmailAddress)&&e.push(t.EmailAddress)}));return e}(t=t.concat(o))}function s(e,t){var n=[];if(Object(o.a)()||t){var r=function(e){return u(e,Object(a.a)().SessionSettings.UserProxyAddresses)}(e);n=n.concat(r)}if(Object(o.a)()){var i=function(e){return u(e,Object(a.a)().SessionSettings.NotManagedEmailAddresses)}(e);n=n.concat(i)}return n}function u(e,t){var n=[];return t&&t.length>0&&t.forEach((function(t){e==t||Object(i.a)(t)||n.push(t)})),n}},5333:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(1577),i=n(77),a=new i.c((function(){return Promise.all([n.e(0),n.e(6),n.e(32),n.e(35),n.e(39),n.e(244),n.e(588)]).then(n.bind(null,9178))})),o=Object(r.a)(a,(function(e){return e.AtMentionPickerPlugin}),"AtMentionsPicker",(function(e){return 11==e.eventType})),c=new i.b(a,(function(e){return e.loadAtMentionsData}))},5340:function(e,t,n){"use strict";var r=n(1975),i=n(3);t.a=Object(i.mutatorAction)("showCcWell",(function(e){e.ccRecipientWell||(e.ccRecipientWell=Object(r.a)(e.toRecipientWell.findPeopleFeedbackManager,[]))}))},5614:function(e,t,n){"use strict";var r=n(0),i=n(4215),a=n(83),o=n(1788),c=n(1572),s=n(30),u=n(2260),d=n(547),l=n(622),p=n(1332),f=n(1382),m=n(2487),b=n(319),v=n(2134),O=n(440);function g(e,t,n,g,y,j,h,I,S){var E,M,R=function(e,t,n,o,c,s,m,b,O){var g="PostItem:#Exchange"==e.__type?"newPost":"newMail",y=m?Object(f.a)({BaseFolderId:Object(d.a)({Id:m})}):null,j=Object(u.a)(Object(r.__assign)({ClientSupportsIrm:!0,ComposeOperation:g,MessageDisposition:n?"SendAndSaveCopy":"SaveOnly",Items:[e],TimeFormat:o,SendOnNotFoundError:!0,RemoteExecute:b,ItemShape:Object(l.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(p.a)({FieldURI:"ItemLastModifiedTime"})]}),SavedItemFolderId:null!=y?y:void 0,SuppressMarkAsReadOnReplyOrForward:Object(a.i)("tri-suppressMarkReadBehaviorOnRF")&&O},Object(v.a)()));return(null==s?void 0:s.IsOwner)&&(j.ComplianceId=s.RmsTemplateId?s.RmsTemplateId.toUpperCase():"0"),n?c&&j.ItemShape&&(j.ItemShape.ReturnOnlyInternetMessageId=!0):(j.ItemShape=Object(i.a)(t),j.ShapeName="MailCompose"),j}(e,t,n,g,y,j,h,I,S);if("PostItem:#Exchange"==e.__type&&h){var P=c.a.folderTable.get(h);if(P){var x=P.ReplicaList?P.ReplicaList[0]:null===(E=Object(s.a)().SessionSettings)||void 0===E?void 0:E.DefaultPublicFolderMailbox;if(x){var T=Object(o.a)(x);M=Object(O.a)(T)}}}return Object(m.a)({Header:Object(b.b)(),Body:R},M).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}n.d(t,"a",(function(){return g}))},5716:function(e,t,n){"use strict";var r=n(1593),i=n(1885),a=n(1447),o=Object(i.a)((function(e,t,n,i){Object(r.a)(t,Object(a.a)(t),e,i)}));t.a=o},6035:function(e,t,n){"use strict";function r(e){var t=[],n=e.attachmentWell;return n&&(n.docViewAttachments.forEach((function(e){t.push(e.attachmentId)})),n.inlineAttachments.forEach((function(e){t.push(e.attachmentId)})),n.imageViewAttachments.forEach((function(e){t.push(e.attachmentId)}))),t}n.d(t,"a",(function(){return r}))},6036:function(e,t,n){"use strict";var r=n(0);t.a=function(e){return e&&0!==e.length?e.filter((function(e){return!!e})).reduce((function(e,t){return Object(r.__spread)(e,(null==(n=t)?void 0:n.recipients)?n.recipients.slice():[]);var n}),[]):[]}},6037:function(e,t,n){"use strict";function r(e,t){if(e){if(e.indexOf("500")>=0)return"error500";if(e.indexOf("503")>=0)return"error503";if(e.indexOf("Failed to fetch")>=0)return"errorFailedToFetch"}switch(e){case"ErrorSessionTimeout":return"errorSessionTimeout";case"ErrorMailboxStoreUnavaiable":return"errorMailboxStoreUnavailable";case"ErrorSendAsDenied":return"errorMessageNoPermissionToSendAs";case"ErrorRightsManagementPermanentException":return null;case"ErrorSubmissionQuotaExceeded":return"errorMessageSubmissionQuotaExceededMessageCanNotBeSent";case"ErrorAccountSuspend":return"errorMessageAccountSuspend";case"ErrorExceededMaxRecipientLimit":return"errorMessageExceededMaxRecipientLimit";case"ErrorExceededMessageLimit":return"errorMessageExceededMessageLimit";case"ErrorExceededHourlyMessageLimit":return"errorMessageExceededHourlyMessageLimit";case"ErrorMessageBlocked":return"errorMessageMessageBlocked";case"ErrorMessageSubmissionBlocked":return"errorMessageMessageSubmissionBlocked";case"ErrorAccountSuspendShowTierUpgrade":return"errorMessageAccountSuspendShowTierUpgrade";case"ErrorExceededMaxRecipientLimitShowTierUpgrade":return"errorMessageExceededMaxRecipientLimitShowTierUpgrade";case"ErrorExceededMessageLimitShowTierUpgrade":return"errorMessageExceededMessageLimitShowTierUpgrade";case"ErrorMessageTimeout":return"errorMessageTimeout";case"ErrorMessageThrottled":return"errorMessageThrottled";case"ErrorMessageTransientError":return"errorMessageTransientError";case"ErrorItemNotFound":return t?"errorMessageItemNoLongerExistToSend":"errorMessageItemNoLongerExistToSave";case"ErrorAccessDenied":return"warningMessageNoPermissionToPerformAction";case"SmimeEncodeError":return"smimeEncodeError";case"ErrorQuotaExceeded":return t?"errorMessageQuotaExceededMessageCanNotBeSent":"errorMessageQuotaExceededMessageCanNotBeSaved";default:return t?"errorMessageMessageCanNotBeSent":"errorMessageMessageCanNotBeSaved"}}n.d(t,"a",(function(){return r}))},6038:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(723);function i(e){return e?Object(r.a)({Id:e.Id,ChangeKey:e.ChangeKey}):null}},6039:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(30),i=n(320);function a(e){var t=!1;if(Object(i.a)()){var n=Object(r.a)();t=0==(e=e.toLowerCase()).indexOf("outlook_"+n.HexCID)||-1!=e.indexOf("@shadow.outlook.com")}return t}},6040:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(77),i=new r.c((function(){return Promise.all([n.e(0),n.e(2),n.e(3),n.e(4),n.e(667)]).then(n.bind(null,10857))})),a=Object(r.d)(i,(function(e){return e.HipCheckModal}))},6041:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.recipients)?e.recipients.length:0}n.d(t,"a",(function(){return r}))},6534:function(e,t,n){"use strict";var r=n(0),i=n(6038),a=n(4035),o=n(4214),c=n(4902),s=n(6790);var u=new RegExp("<img[^>]*\\s+src=[\"']data:image\\/[^<]+;base64,\\s*[a-zA-Z0-9+\\/=&#;]+[\"'][^>]*>","gi");function d(e){var t=0;if(e){var n=e.match(u);t=n?n.length:0}return t}var l=new RegExp('<IMG[^>]+?ORIGINALSRC\\s*=\\s*"[\\s\\S]+?"[\\s\\S]*?>',"gim"),p=new RegExp('\\sSRC\\s*=\\s*"DATA:[\\s\\S]+?"',"im"),f=new RegExp('\\sORIGINALSRC\\s*=\\s*"',"im");function m(e,t){return e?e.replace(l,(function(e){return e=e.replace(p,""),t&&(e=e.replace(f,' src="')),e})):e}var b=n(30),v=n(2940),O=n(1778),g=n(472),y=35356;var j=n(9),h="0x3FEF";function I(e,t){if(t.ExtendedProperty)for(var n=e.length;n--&&t.ExtendedProperty.length>0;)for(var r=t.ExtendedProperty.length;r--;)if(e[n]===t.ExtendedProperty[r].ExtendedFieldURI.PropertyName){t.ExtendedProperty.splice(r,1);break}}function S(e,t,n){var r,i;n?I(["AppendOnSend"],t):e.appendOnSend&&e.appendOnSend.length>0&&(r=e.appendOnSend,(i=t).ExtendedProperty||(i.ExtendedProperty=[]),i.ExtendedProperty.push(Object(O.a)({Value:JSON.stringify(r),ExtendedFieldURI:Object(g.a)({DistinguishedPropertySetId:"Common",PropertyName:"AppendOnSend",PropertyType:"String"})})))}function E(e,t){e.internetHeaders.size>0&&function(e,t){var n,i;t.ExtendedProperty||(t.ExtendedProperty=[]);try{for(var a=Object(r.__values)(e.keys()),o=a.next();!o.done;o=a.next()){var c=o.value;t.ExtendedProperty.push(Object(O.a)({Value:e.get(c),ExtendedFieldURI:Object(g.a)({DistinguishedPropertySetId:"InternetHeaders",PropertyName:c,PropertyType:"String"})}))}}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}}(e.internetHeaders,t),e.keysOfInternetHeadersToBeRemoved.length>0&&I(e.keysOfInternetHeadersToBeRemoved,t)}function M(e,t,n){n?I(["ComposeType"],t):null!==e.draftComposeType&&function(e,t){t.ExtendedProperty||(t.ExtendedProperty=[]);t.ExtendedProperty.push(Object(O.a)({Value:e,ExtendedFieldURI:Object(g.a)({DistinguishedPropertySetId:"Common",PropertyName:"ComposeType",PropertyType:"String"})}))}(e.draftComposeType,t)}var R=n(3332),P=n(6791),x=n(3),T=Object(x.mutatorAction)("clearKeysOfInternetHeadersToBeRemoved",(function(e){e.keysOfInternetHeadersToBeRemoved=[]})),C=n(723),_=n(285);function w(e){e&&(e.isDirty=!1)}var A=Object(_.action)("updateComposeItemId")((function(e,t,n,r){e&&(e.itemId?e.itemId.ChangeKey=n:e.itemId=Object(C.a)({Id:t,ChangeKey:n}),r&&(e.lastSaveTimeStamp=r,e.isDirty=!1,w(e.toRecipientWell),w(e.ccRecipientWell),w(e.bccRecipientWell)))})),D=n(2160),L=n(4526),k=n(1512),F=n(83),N=n(1325),U=n(1773),B=n(3725),V=n(12),W=n(3726),q=n(4903),G=function(e){switch(e.labelApplyMethod){case W.a.Manual:return q.d;case W.a.Default:case W.a.Automatic:default:return q.e}},H=n(3333),z="MSIP_Label";function J(e){var t=e.selectedCLPLabel,n=e.nonTenantLabelString,r=Object(b.a)().SessionSettings.ExternalDirectoryTenantGuid,i="";t&&(i=function(e,t){return Object.keys(e).map((function(n){return z+"_"+t.id+"_"+n+"="+e[n]+";"})).join("")}({Enabled:"True",SiteId:r,SetDate:Object(j.tb)(Object(j.Pb)()),Name:t.displayName,ContentBits:0,Method:G(e)},t));return n?n+i:i}function K(e){var t=e.selectedCLPLabel,n=e.originalCLPLabel;if(t||n){var r=t&&!n&&t.isDefault;if(!t||!n||t.id!=n.id||n.isDefault)return(n&&!r?n.id:q.a)+";"+(t?t.id:q.a)}}function Q(e,t,n){var r=Object(O.a)({ExtendedFieldURI:Object(g.a)({PropertyName:e,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}),Value:t});n.ExtendedProperty?n.ExtendedProperty.push(r):n.ExtendedProperty=[r]}var X=n(2952),$=n(1392),Z=n(4527);var Y=n(5614),ee=n(7289),te=n(1418),ne=n(622);var re=n(1332),ie=n(29);function ae(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"PostGroupItemJsonRequest:#Exchange"},n)),Object(ie.a)("PostGroupItem",e,t)}var oe=n(319),ce=n(2134);function se(e,t,n,i,a,o){var c,s=(c=Object(r.__assign)({ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:"SendAndSaveCopy",Items:[t],TimeFormat:i,ItemShape:Object(ne.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(re.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(ce.a)()),Object(r.__assign)({__type:"PostGroupItemRequest:#Exchange"},c));return o&&(s.ItemShape.ReturnOnlyInternetMessageId=!0),(null==a?void 0:a.IsOwner)&&(s.ComplianceId=a.RmsTemplateId?a.RmsTemplateId.toUpperCase():"0"),s}function ue(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"PostUnifiedGroupItemJsonRequest:#Exchange"},n)),Object(ie.a)("PostUnifiedGroupItem",e,t)}function de(e,t,n,i,a){var o,c=(o={ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},SkipGroupSyncDelivery:!0,ClientSupportsIrm:!0,Item:t,ItemShape:Object(ne.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(re.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(r.__assign)({__type:"PostUnifiedGroupItemRequest:#Exchange"},o));return a&&(c.ItemShape.ReturnOnlyInternetMessageId=!0),c}var le=n(4905),pe=n(3334),fe=n(2828);function me(e,t){return Object(fe.a)({Path:Object(g.a)({DistinguishedPropertySetId:e,PropertyName:t,PropertyType:"String"})})}var be=n(1866),ve=n(2010),Oe=n(1986);function ge(e,t,n,i){var a=function(e,t,n,i){var a,o=[];e.MimeContent&&o.push(Object(pe.a)("MimeContent",e.MimeContent));var c=[Object(pe.a)("ToRecipients",e.ToRecipients),Object(pe.a)("CcRecipients",e.CcRecipients),Object(pe.a)("BccRecipients",e.BccRecipients),Object(pe.a)("Subject",e.Subject),Object(pe.a)("Body",e.Body),Object(pe.a)("Importance",e.Importance),Object(pe.a)("IsReadReceiptRequested",e.IsReadReceiptRequested),Object(pe.a)("IsDeliveryReceiptRequested",e.IsDeliveryReceiptRequested)];(null===(a=e.Attachments)||void 0===a?void 0:a.length)&&c.push(Object(pe.a)("Attachments",e.Attachments)),e.ItemClass&&c.push(Object(pe.a)("ItemClass",e.ItemClass)),e.From&&c.push(Object(pe.a)("From",e.From)),i.length>0&&i.map((function(e){c.push(me("InternetHeaders",e))})),t&&c.push(me("Common","AppendOnSend")),e.MentionsEx&&c.push(Object(pe.a)("MentionsEx",e.MentionsEx)),e.Sensitivity&&c.push(Object(pe.a)("Sensitivity",e.Sensitivity)),e.ExtendedProperty&&e.ExtendedProperty.map((function(e){c.push(Object(le.a)(e))})),t&&e.DocLinks&&e.DocLinks.length>0&&c.push(Object(pe.a)("DocLinks",e.DocLinks));var s=Object(be.a)({Updates:Object(r.__spread)(o,c),ItemId:Object(C.a)({Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey})}),u=Object(ve.a)(Object(r.__assign)({ItemChanges:[s],ConflictResolution:"AlwaysOverwrite",ClientSupportsIrm:!0,SendCalendarInvitationsOrCancellations:"SendToNone",MessageDisposition:t?"SendAndSaveCopy":"SaveOnly",SuppressReadReceipts:!1,ComposeOperation:"newMail",PromoteInlineAttachments:!1,SendOnNotFoundError:!0,ItemShape:Object(ne.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(re.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(ce.a)()));return(null==n?void 0:n.IsOwner)&&(u.ComplianceId=n.RmsTemplateId?n.RmsTemplateId.toUpperCase():"0"),u}(e,t,n,i);return Object(Oe.a)({Header:Object(oe.b)(),Body:a}).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}var ye=n(1440),je=n(1319),he="InternetHeaders",Ie="X-Ms-Exchange-Organization-Dlp-SenderOverrideJustification",Se="X-Ms-Exchange-Organization-Dlp-FalsePositive";var Ee=n(1976);function Me(e){if(!e)return null;var t=e.IRMData;return!t||t.RmsTemplateId&&!Ee.b.rmsTemplates.get(t.RmsTemplateId)?null:t}function Re(e){return Object(r.__assign)({__type:"ApproveRequestItem:#Exchange"},e)}var Pe=n(1687),xe=n(1739);function Te(e){return Object(r.__assign)({__type:"RejectRequestItem:#Exchange"},e)}var Ce=n(6792),_e=n(6793),we=n(320),Ae=n(2759),De=n(2674),Le=n(2203),ke=n(5333),Fe=n(3932),Ne="X-MS-Exchange-Organization-ClientSubmitSmtp-OriginalFrom";var Ue=n(1871),Be={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CreateDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"timeFormat"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"timeFormat"},value:{kind:"Variable",name:{kind:"Name",value:"timeFormat"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"Body"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"},arguments:[],directives:[]}]}}]}}]}}]},Ve=n(340);function We(e){switch(e){case 0:return"New";case 1:return"Reply";case 2:return"ReplyAll";case 3:return"Forward";case 4:case 5:case 6:throw new Error("Unexpected compose operation. ")}}function qe(e){var t=e.mentionsPicker.atMentionTuples,n=[];return Object.keys(t).forEach((function(e){var r=t[e];n.push({key:e,emailAddress:r.EmailAddress})})),n}function Ge(e){var t=e.fromViewState.from,n=Object(b.a)().SessionSettings.ConnectedAccountInfos;if(n)for(var r=0;r<n.length;r++){var i=n[r];if(i.EmailAddress==t.email.EmailAddress)return i.SubscriptionGuid}}function He(e){var t=e.protectionViewState.classificationViewState;return t.messageClassification?Object(r.__assign)(Object(r.__assign)({},t.messageClassification),{isClassified:!0}):void 0}function ze(e){var t,n,r,i=null===(r=null===(n=null===(t=e.fromViewState)||void 0===t?void 0:t.from)||void 0===n?void 0:n.email)||void 0===r?void 0:r.EmailAddress;if(i&&!Object(Fe.a)(i))return i}var Je=n(440);n.d(t,"c",(function(){return tt})),n.d(t,"b",(function(){return nt})),n.d(t,"a",(function(){return rt}));var Ke='<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css" style="display:none;"> P {{margin-top:0;margin-bottom:0;}} </style></head><body dir="{0}">{1}</body></html>',Qe="IPM.Note";function Xe(e){var t=e.content,n=0;if("HTML"==e.bodyType){var i=it(e);n=d(t=m(t)),t=Object(V.c)(Ke,i,t)}var a,o=Object(Pe.a)({BodyType:e.bodyType,Value:t});o.DataUriCount=n;var c,s={Subject:e.subject||"",Importance:e.importance,Sensitivity:e.sensitivity};return c=Object(r.__assign)(Object(r.__assign)({},s),{Body:o}),a=Object(r.__assign)({__type:"PostItem:#Exchange"},c),e.itemId&&(a.ItemId=e.itemId),e.fromViewState&&function(e,t){var n=e.from;t.From=Object(v.a)({Mailbox:n.email})}(e.fromViewState,a),a}var $e=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(De.a)(e.smimeViewState)?[2,null]:[4,k.h.import()];case 1:return(null==(t=r.sent()(e.attachmentWell,e.content,e.bodyType,!0))?void 0:t.length)?[4,Ue.i.import()]:[3,3];case 2:return n=r.sent()(t),[3,4];case 3:n=null,r.label=4;case 4:return[2,n]}}))}))};function Ze(e){var t=e.content,n=0,a=Object(De.a)(e.smimeViewState);if(e.useSmartResponse&&(t+=Object(L.a)(e.bodyType)),"HTML"==e.bodyType){var c=it(e);n=d(t=m(t,a)),t=Object(V.c)(Ke,c,t)}var s=Object(Pe.a)({BodyType:e.bodyType,Value:t});s.DataUriCount=n;var u,l=Object(i.a)(e.itemId),p=Object(i.a)(e.referenceItemId),f=[],I=[],S=[];if(e.smimeViewState&&0!=e.smimeViewState.smimeBccForkingMode)switch(e.smimeViewState.smimeBccForkingMode){case 1:f=Object(o.a)(e.toRecipientWell),I=Object(o.a)(e.ccRecipientWell);break;case 2:if(e.bccRecipientWell){var E=e.smimeViewState.currentBccRecipientIndex;S=[Object(o.a)(e.bccRecipientWell)[E]]}break;case 3:e.bccRecipientWell&&(S=Object(o.a)(e.bccRecipientWell))}else f=Object(o.a)(e.toRecipientWell),I=Object(o.a)(e.ccRecipientWell),S=Object(o.a)(e.bccRecipientWell);var M={Subject:e.subject||"",Importance:e.importance,IsReadReceiptRequested:e.isReadReceiptRequested,IsDeliveryReceiptRequested:e.isDeliveryReceiptRequested,ToRecipients:f,CcRecipients:I,BccRecipients:S,Sensitivity:e.sensitivity};return e.useSmartResponse?u=(2==e.operation?Ce.a:_e.a)(Object(r.__assign)(Object(r.__assign)({},M),{UpdateResponseItemId:l,ReferenceItemId:p,ReferenceItemDocumentId:e.referenceItemDocumentId||0,NewBodyContent:s})):5==e.operation||6==e.operation?u=(5==e.operation?Re:Te)(Object(r.__assign)(Object(r.__assign)({},M),{ReferenceItemId:p,ItemId:l,Body:s})):(u=Object(xe.a)(Object(r.__assign)(Object(r.__assign)({},M),{Body:s})),e.itemId&&(u.ItemId=e.itemId)),e.fromViewState&&function(e,t){var n=e.from;if(n){var r=!1,i=Object(b.a)().SessionSettings.ConnectedAccountInfos;if(i)for(var a=0;a<i.length;a++){var o=i[a];if(o.EmailAddress==n.email.EmailAddress){r=!0;var c=Object(O.a)({Value:o.SubscriptionGuid,ExtendedFieldURI:Object(g.a)({PropertyId:y,DistinguishedPropertySetId:"Sharing",PropertyType:"CLSID"})});t.ExtendedProperty?t.ExtendedProperty.push(c):t.ExtendedProperty=[c],t.From=Object(v.a)({Mailbox:{MailboxType:n.email.MailboxType,RoutingType:"SMTP",EmailAddress:n.email.EmailAddress,Name:o.DisplayName}});break}}r||(t.From=Object(v.a)({Mailbox:n.email}))}}(e.fromViewState,u),e.deferredSendTime&&function(e,t){if(e){var n=Object(O.a)({Value:Object(j.tb)(e),ExtendedFieldURI:Object(g.a)({PropertyTag:h,PropertyType:"SystemTime"})});t.ExtendedProperty?t.ExtendedProperty.push(n):t.ExtendedProperty=[n]}}(e.deferredSendTime,u),u}function Ye(e,t){var n,i;return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,d,l,p,f,m,v,y,j,h,I,x,C;return Object(r.__generator)(this,(function(_){switch(_.label){case 0:return l=Object(b.a)().UserOptions.TimeFormat,Object(X.a)(e)?(p=e,u=Xe(e),[4,Object(Y.a)(u,e.bodyType,t,l,e.isInlineCompose,Me(e.protectionViewState),p.publicFolderId)]):[3,2];case 1:return d=_.sent(),[3,14];case 2:return u=Ze(e),f=u,[4,$e(e)];case 3:return f.Attachments=_.sent(),E(e.addin,u),S(e.addin,u,t),M(e.addin,u,t),m=e.protectionViewState,Object(F.i)("cmp-clp")&&!Object(R.a)(e)&&function(e,t){var n=e.selectedCLPLabel,r=e.nonTenantLabelString,i=K(e);if(i&&Q(q.b,i,t),n||r){var a=J(e);Q(q.c,a,t),Object(H.c)(n)}}(m.clpViewState,u),(null==m?void 0:m.classificationViewState)&&function(e,t){var n=e.messageClassification;if(n){t.ExtendedProperty||(t.ExtendedProperty=[]),Object.keys(n).forEach((function(e){var r=Z.b[e];r&&t.ExtendedProperty.push(Object(O.a)({ExtendedFieldURI:Object(g.a)({PropertyId:r.id,DistinguishedPropertySetId:"Common",PropertyType:r.propertyType}),Value:n[e]}))}));var r=Z.b.IsClassified;t.ExtendedProperty.push(Object(O.a)({ExtendedFieldURI:Object(g.a)({PropertyId:r.id,DistinguishedPropertySetId:"Common",PropertyType:r.propertyType}),Value:"true"}))}}(m.classificationViewState,u),(Object(F.i)("cmp-proxy-address")||Object(F.i)("cmp-proxy-address-sendas-param"))&&function(e,t){var n,r,i=null===(r=null===(n=null==e?void 0:e.from)||void 0===n?void 0:n.email)||void 0===r?void 0:r.EmailAddress;if(i&&!Object(Fe.a)(i)){var a=Object(O.a)({ExtendedFieldURI:Object(g.a)({PropertyName:Ne,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}),Value:i});t.ExtendedProperty?t.ExtendedProperty.push(a):t.ExtendedProperty=[a]}}(e.fromViewState,u),(null===(n=e.mentionsPicker)||void 0===n?void 0:n.atMentionTuples)&&Object.keys(e.mentionsPicker.atMentionTuples).length>0?[4,ke.b.import()]:[3,5];case 4:return y=_.sent(),[3,6];case 5:y=null,_.label=6;case 6:if(null==(v=y)||v(e.mentionsPicker,t,u),!Object(De.a)(e.smimeViewState))return[3,11];_.label=7;case 7:return _.trys.push([7,9,,10]),j=function(e,t,n){var i,u=e.smimeViewState||Object(c.a)(),d=e.attachmentWell,l=d.docViewAttachments,p=d.inlineAttachments,f=Object(s.a)(u);return(i=l.slice(0)).push.apply(i,Object(r.__spread)(p)),{smimeViewState:u,message:t,fromAddress:Object(a.a)(),isSend:n,composeId:e.composeId,toRecipients:f?Object(o.a)(e.toRecipientWell):[],ccRecipients:f?Object(o.a)(e.ccRecipientWell):[],attachments:i}}(e,u,t),[4,Ue.p.import().then((function(e){return e(j)}))];case 8:return _.sent(),[3,10];case 9:return h=_.sent(),(C=new Error).message=h.message==Ae.a?Ae.a:"SmimeEncodeError",[2,Promise.reject(C)];case 10:return[3,12];case 11:e.itemId&&(I=Object(je.b)().items.get(e.itemId.Id))&&Object(Le.b)(I.ItemClass)&&(u.ItemClass=Qe),_.label=12;case 12:return t&&function(e){var t=[];if(e.isReportedFalsePositive){var n={ExtendedFieldURI:{PropertyName:Se,PropertyType:"String",DistinguishedPropertySetId:he},Value:""};t.push(n)}if(e.isOverridden){n={ExtendedFieldURI:{PropertyName:Ie,PropertyType:"String",DistinguishedPropertySetId:he},Value:e.overrideJustification};t.push(n)}return t}(e.policyTipsViewState).map((function(e){return function(e,t){null==e.ExtendedProperty?e.ExtendedProperty=[t]:e.ExtendedProperty.push(t)}(u,e)})),[4,et(e,u,l,t)];case 13:d=_.sent(),_.label=14;case 14:return T(e.addin),(x=(null===(i=null==d?void 0:d.ResponseMessages)||void 0===i?void 0:i.Items)?d.ResponseMessages.Items[0]:d&&!d.ResponseMessages?d:null)&&"Success"==x.ResponseClass?[2,Promise.resolve(x)]:(Object(P.d)(d,e),C=void 0,x?(C=new Error(x.ResponseCode)).messageText=x.MessageText:C=new Error("Unrecognized response"),[2,Promise.reject(C)])}}))}))}function et(e,t,n,i){var a,o,c,s,u,d,l;if(Object(R.a)(e)){if(i&&3!=e.operation){if(Object(we.a)()||e.itemId||t.RightsManagementLicenseData||(null===(a=e.protectionViewState)||void 0===a?void 0:a.IRMData))return function(e,t,n,r,i,a){var o=se(e,t,0,r,i,a),c={headers:Object(te.e)(null,"GroupMailbox")};return ae({Header:Object(oe.b)(),Body:o},c).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}(e.groupId,t,e.bodyType,n,Me(e.protectionViewState),e.isInlineCompose);var p=Object(U.m)(e.groupId);return c=e.groupId,s=t,e.bodyType,u=Object(Je.a)(p),d=e.isInlineCompose,l=de(c,s,0,0,d),ue({Header:Object(oe.b)(),Body:l},u).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}var f=1==e.operation||2==e.operation;if(!e.itemId&&f||e.useSmartResponse)return Object(ee.a)(e.groupId,t,e.bodyType,!1,n,e.isInlineCompose)}var m=Object($.c)(),b=!(!m||m.treeType!==N.k&&m.treeType!==N.c);if(i){var v=Object(B.a)(null===(o=e.attachmentWell)||void 0===o?void 0:o.sharingLinkIds);v&&v.length>0&&(t.DocLinks=v)}return e.useSmartResponse||!e.itemId?Object(F.i)("mon-cmp-experimentalGraphQLCompose")&&!i&&function(e){switch(e){case 0:case 1:case 2:case 3:return!0;case 4:case 5:case 6:return!1}}(e.operation)?function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(Ve.a)()];case 1:return[4,a.sent().mutate({variables:{draft:{ToRecipients:e.ToRecipients,CcRecipients:e.CcRecipients,BccRecipients:e.BccRecipients,Subject:e.Subject,Body:{Value:e.Body.Value,DataUriCount:e.Body.DataUriCount,BodyType:e.Body.BodyType},Importance:e.Importance,IsReadReceiptRequested:e.IsReadReceiptRequested,IsDeliveryReceiptRequested:e.IsDeliveryReceiptRequested,UpdateResponseItemId:e.UpdateResponseItemId,ReferenceItemId:e.ReferenceItemId,ReferenceItemDocumentId:e.ReferenceItemDocumentId,atMentionedRecipients:qe(n),recipientsAddedViaAtMention:n.mentionsPicker.mentionsAddedRecipients,connectedAccountSharingGuid:Ge(n),deferredSendTime:n.deferredSendTime?Object(j.tb)(n.deferredSendTime):void 0,clpLabelModifificationHeader:K(n.protectionViewState.clpViewState),clpLabelProperty:J(n.protectionViewState.clpViewState),messageClassification:He(n),originalSmtpFromAddress:ze(n),operation:We(n.operation)},timeFormat:t},mutation:Be})];case 2:return i=a.sent(),[2,{ResponseMessages:{Items:[{Items:[Object(r.__assign)({},i.data.createDraft.draft)],ResponseClass:"Success"}]}}]}}))}))}(t,n,e):Object(Y.a)(t,e.bodyType,i,n,e.isInlineCompose,Me(e.protectionViewState),null,b):ge(t,i,Me(e.protectionViewState),e.addin.keysOfInternetHeadersToBeRemoved)}function tt(e){return Ye(e,!0)}function nt(e){return Ye(e,!1)}function rt(e,t){if(Object(ye.a)(e)){var n=function(e){var t;if(null==e?void 0:e.Items)return e.Items[0];if(null===(t=e)||void 0===t?void 0:t.Item)return e.Item;return null}(e);return n&&(Object(De.a)(t.smimeViewState)||k.h.import().then((function(e){var r=e(t.attachmentWell,t.content,t.bodyType,!0);r.length&&Ue.r.import().then((function(e){return e(r,n.Attachments,Object(C.a)({Id:t.composeId}))}))})),n.ItemId&&(A(t,n.ItemId.Id,n.ItemId.ChangeKey,n.LastModifiedTime),n.Body&&Object(R.a)(t)&&(t.lastSavedMessageBody=n.Body.Value)),n.InternetMessageId&&Object(D.a)(t.conversationId,t.itemId?t.itemId.Id:null,n.InternetMessageId)),!0}return!1}function it(e){return e.textDirection||(Object(b.a)().SessionSettings.IsUserCultureRightToLeft?"rtl":"ltr")}},6789:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(5332),a=n(4901);function o(e,t){return function(e,t){for(var n=0;n<t.length;n++)if(c(t[n],e))return t[n];return null}((e||[]).concat(t||[]),Object(i.a)(!0))}function c(e,t){var n,i;if(t&&t.length>0)try{for(var o=Object(r.__values)(t),c=o.next();!c.done;c=o.next()){var s=c.value;if(s&&Object(a.a)(e,s.EmailAddress))return!0}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return!1}},6791:function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return v}));var r=n(0),i=n(7903),a=n(12),o=n(1644),c=n(2172),s=n(6040),u=n(2190),d="",l="";function p(e,t){var n;if(e){e.WasclUpgradeToPremiumUrl&&(d=e.WasclUpgradeToPremiumUrl),e.AccountRecoveryFlowUrl&&(l=e.AccountRecoveryFlowUrl);var r=(null===(n=e.ResponseMessages)||void 0===n?void 0:n.Items)?e.ResponseMessages.Items[0]:null;!r||"ErrorExceededMessageLimit"!=r.ResponseCode&&"ErrorExceededHourlyMessageLimit"!=r.ResponseCode&&"ErrorExceededMessageLimitShowTierUpgrade"!=r.ResponseCode||Object(c.b)(t,!0)}}function f(e){return{text:Object(a.b)(i.a),action:function(){Object(o.a)(e,["errorMessageExceededMessageLimit","errorMessageExceededMaxRecipientLimit"]),window.open(d)}}}var m=null;function b(e,t){return{text:Object(a.b)(i.b),action:function(){var n;null===m&&(n=Object(r.__read)(Object(u.a)(s.a,t),1),(m=n[0]).then((function(t){var n=t.success;m=null,n&&function(e){Object(o.a)(e,["errorMessageMessageSubmissionBlocked","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimitShowTierUpgrade"])}(e)}),(function(e){m=null})))}}}function v(e){return{text:Object(a.b)(i.b),action:function(){Object(o.a)(e,["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade"]),window.open(l)}}}},6792:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ReplyAllToItem:#Exchange"},e)}},6793:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ReplyToItem:#Exchange"},e)}},7289:function(e,t,n){"use strict";var r=n(0),i=n(4215);var a=n(622),o=n(1332),c=n(29);function s(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"CreateResponseFromModernGroupJsonRequest:#Exchange"},n)),Object(c.a)("CreateResponseFromModernGroup",e,t)}var u=n(319),d=n(2134);function l(e,t,n,c,s,u){var l,p=(l=Object(r.__assign)({ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:c?"SendAndSaveCopy":"SaveOnly",Items:[t],TimeFormat:s,ItemShape:Object(a.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(o.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(d.a)()),Object(r.__assign)({__type:"CreateResponseFromModernGroupRequest:#Exchange"},l));return c?u&&(p.ItemShape.ReturnOnlyInternetMessageId=!0):(p.ItemShape=Object(i.a)(n),p.ShapeName="MailCompose"),p.GroupSmtpAddress=e,p}function p(e,t,n,r,i,a){var o=l(e,t,n,r,i,a);return s({Header:Object(u.b)(),Body:o}).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}n.d(t,"a",(function(){return p}))},764:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(3),i=Object(r.createStore)("popoutParent",{projections:[],isAvailable:!1}),a=i();t.a=a},7903:function(e){e.exports=JSON.parse('{"a":"cka","b":"dka"}')}}]);
//# sourceMappingURL=owa.MailBoot~Addins~Editor~InboxForMeSurface.js.map
self.scriptsLoaded['owa.MailBoot~Addins~Editor~InboxForMeSurface.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Addins~Editor~InboxForMeSurface.js'] = (new Date()).getTime();