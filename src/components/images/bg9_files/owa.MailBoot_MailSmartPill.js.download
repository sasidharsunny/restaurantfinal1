self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailSmartPill.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[632],{10328:function(e){e.exports=JSON.parse('{"a":"Dec","b":"Eec","c":"Fec"}')},10329:function(e){e.exports=JSON.parse('{"d":"Jec","e":"Kec","c":"Lec","a":"Mec","b":"Nec"}')},1505:function(e,t,n){"use strict";var r=n(3),o=n(20),i=n(1604),a={providers:new o.ObservableMap,loadState:i.a.NotLoaded,removalPending:new o.ObservableMap},c=Object(r.createStore)("fileProviderStore",a);t.a=c},1506:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a}));var r=n(3),o=Object(r.action)("FILE_PROVIDER_ADDED",(function(e){return{providerViewState:e}})),i=Object(r.action)("FILE_PROVIDER_REMOVED",(function(e){return{providerType:e}})),a=Object(r.action)("PROVIDERS_LOADED",(function(e){return{providers:e}}))},15130:function(e){e.exports=JSON.parse('{"b":"Gec","c":"Hec","a":"Iec"}')},15131:function(e,t,n){var r=n(15132),o=n(131);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},15132:function(e,t,n){(t=e.exports=n(130)(!1)).push([e.i,'._3Jtu3QV20_qLz8g_h0KpQb{position:relative;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;color:inherit;width:100%;height:48px;line-height:32px;display:block;cursor:pointer;outline:transparent}html[dir] ._3Jtu3QV20_qLz8g_h0KpQb{background-color:transparent;padding-top:0;padding-bottom:0;border-width:initial;border-style:none;border-color:initial;-o-border-image:initial;border-image:initial}html[dir=ltr] ._3Jtu3QV20_qLz8g_h0KpQb{padding-right:12px;padding-left:12px;text-align:left}html[dir=rtl] ._3Jtu3QV20_qLz8g_h0KpQb{padding-left:12px;padding-right:12px;text-align:right}html[dir] ._3Jtu3QV20_qLz8g_h0KpQb:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._3Jtu3QV20_qLz8g_h0KpQb:active{background-color:"[theme:neutralLight, default:#eaeaea]"}._1v60Zw1heoE7AYHV2rZARo{white-space:nowrap;height:inherit;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%}.Nf0DroQfbZfcaaSjQ53MC{display:inline-block;color:"[theme:themePrimary, default:#0078D4]";height:32px;width:32px;vertical-align:middle;-ms-flex-negative:0;flex-shrink:0;overflow:hidden}html[dir=ltr] .Nf0DroQfbZfcaaSjQ53MC{margin-right:8px}html[dir=rtl] .Nf0DroQfbZfcaaSjQ53MC{margin-left:8px}._1V-pZ1TukzFi3FL2_U4Y5X{max-width:216px;width:100%;height:100%}._3TAbxFid2sTMSQ8v8sIeQH{font-size:14px;color:"[theme:neutralPrimary, default:#333333]";line-height:19px;max-width:100%}._3TAbxFid2sTMSQ8v8sIeQH,._1XRoVhbyaxndQhy7cIo11E{font-weight:400;display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}._1XRoVhbyaxndQhy7cIo11E{font-size:11px;color:"[theme:neutralSecondary, default:#666666]";line-height:15px;width:216px}html[dir] ._1XRoVhbyaxndQhy7cIo11E{padding-top:1px}._1LIdXVeATDTlAL3Wafn6_V{position:absolute;top:20px}html[dir=ltr] ._1LIdXVeATDTlAL3Wafn6_V{left:24px}html[dir=rtl] ._1LIdXVeATDTlAL3Wafn6_V{right:24px}html[dir] ._16x5oaOekVnuCtNTMKxz1I{margin:0}',""]),t.locals={attachmentSuggestionButton:"_3Jtu3QV20_qLz8g_h0KpQb",attachmentSuggestionButtonContent:"_1v60Zw1heoE7AYHV2rZARo",attachmentSuggestionButtonImageContainer:"Nf0DroQfbZfcaaSjQ53MC",attachmentSuggestionButtonTextContainer:"_1V-pZ1TukzFi3FL2_U4Y5X",attachmentSuggestionPrimaryText:"_3TAbxFid2sTMSQ8v8sIeQH",attachmentSuggestionSecondaryText:"_1XRoVhbyaxndQhy7cIo11E",fileIcon:"_1LIdXVeATDTlAL3Wafn6_V",cloudyIcon:"_16x5oaOekVnuCtNTMKxz1I"}},15133:function(e,t,n){var r=n(15134),o=n(131);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},15134:function(e,t,n){(t=e.exports=n(130)(!1)).push([e.i,'._10Wqk-jLsMonGEHBVbj5cP{position:relative;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;color:inherit;width:100%;height:48px;line-height:32px;display:block;cursor:pointer;outline:transparent}html[dir] ._10Wqk-jLsMonGEHBVbj5cP{background-color:transparent;padding-top:0;padding-bottom:0;border-width:initial;border-style:none;border-color:initial;-o-border-image:initial;border-image:initial}html[dir=ltr] ._10Wqk-jLsMonGEHBVbj5cP{padding-right:12px;padding-left:12px;text-align:left}html[dir=rtl] ._10Wqk-jLsMonGEHBVbj5cP{padding-left:12px;padding-right:12px;text-align:right}html[dir] ._10Wqk-jLsMonGEHBVbj5cP:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._10Wqk-jLsMonGEHBVbj5cP:active{background-color:"[theme:neutralLight, default:#eaeaea]"}._3JeDFTJ3xdeMl09fLnBdDf{width:280px}._2BZ4VACg11pKrXUPK6KPZI{font-size:12px;font-weight:400;font-weight:600;color:"[theme:themePrimary, default:#0078D4]";max-width:280px}html[dir=ltr] ._2BZ4VACg11pKrXUPK6KPZI{margin-left:1px}html[dir=rtl] ._2BZ4VACg11pKrXUPK6KPZI{margin-right:1px}._1-XgaiCZX8v0t7SQi_ioKl{font-size:16px;height:16px;line-height:31px;width:16px;color:"[theme:neutralSecondary, default:#666666]"!important}html[dir=ltr] ._1-XgaiCZX8v0t7SQi_ioKl{margin-left:16px;margin-right:12px}html[dir=rtl] ._1-XgaiCZX8v0t7SQi_ioKl{margin-right:16px;margin-left:12px}html[dir] ._2JVEtFeqc7Qfi1U140m4t1{padding-bottom:16px}html[dir] ._2vktARVhhq-4yqVPWNwm4Q{padding-bottom:14px}html[dir] ._3OS-O1SA6lAPPKXCdnExMV{padding-bottom:16px}html[dir] ._1r7Jlygmjk0ZDdxQRHy9ZR{margin-bottom:3px;margin-top:3px}html[dir=ltr] ._1r7Jlygmjk0ZDdxQRHy9ZR{margin-right:10px}html[dir=rtl] ._1r7Jlygmjk0ZDdxQRHy9ZR{margin-left:10px}',""]),t.locals={attachmentSuggestionButton:"_10Wqk-jLsMonGEHBVbj5cP",attachmentSuggestionButtonRoot:"_3JeDFTJ3xdeMl09fLnBdDf",replyWithHeaderForBottomBar:"_2BZ4VACg11pKrXUPK6KPZI",iconRoot:"_1-XgaiCZX8v0t7SQi_ioKl",iconRootComputer:"_2JVEtFeqc7Qfi1U140m4t1",iconRootCloud:"_2vktARVhhq-4yqVPWNwm4Q",iconRootUploadAndShare:"_3OS-O1SA6lAPPKXCdnExMV",loadingSpinner:"_1r7Jlygmjk0ZDdxQRHy9ZR"}},15135:function(e){e.exports=JSON.parse('{"a":"Oec","b":"Pec"}')},15136:function(e,t,n){var r=n(15137),o=n(131);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},15137:function(e,t,n){(t=e.exports=n(130)(!1)).push([e.i,"._3YAl0KkiE16JbPH0r6SRWf{font-size:12px}",""]),t.locals={menuButton:"_3YAl0KkiE16JbPH0r6SRWf"}},15138:function(e){e.exports=JSON.parse('{"f":"jec","t":"kec","n":"lec","g":"mec","h":"nec","i":"oec","j":"pec","k":"qec","l":"rec","m":"sec","o":"tec","p":"uec","q":"vec","r":"wec","s":"xec","a":"yec","b":"zec","c":"Aec","d":"Bec","e":"Cec"}')},15139:function(e,t,n){var r=n(15140),o=n(131);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},15140:function(e,t,n){(t=e.exports=n(130)(!1)).push([e.i,"html[dir] ._1BIi6rH1j5rnLh1OlF1NvI{padding-top:10px}html[dir=ltr] ._1BIi6rH1j5rnLh1OlF1NvI{margin-left:52px}html[dir=rtl] ._1BIi6rH1j5rnLh1OlF1NvI{margin-right:52px}",""]),t.locals={bar:"_1BIi6rH1j5rnLh1OlF1NvI"}},1536:function(e,t,n){"use strict";n.d(t,"l",(function(){return g})),n.d(t,"n",(function(){return f})),n.d(t,"k",(function(){return b})),n.d(t,"m",(function(){return p}));var r=n(77),o=n(1754);n.d(t,"b",(function(){return o.a}));var i=n(1700);n.d(t,"i",(function(){return i.a}));n(1505);var a=n(1506);n.d(t,"d",(function(){return a.a})),n.d(t,"e",(function(){return a.b})),n.d(t,"o",(function(){return a.c}));var c=n(1701);n.d(t,"a",(function(){return c.b}));var u=n(1567);n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return u.b}));var l=n(1691);n.d(t,"j",(function(){return l.a}));var s=n(1604);n.d(t,"c",(function(){return s.a}));var d=n(1680);n.d(t,"f",(function(){return d.b}));var m=new r.c((function(){return Promise.all([n.e(1),n.e(549)]).then(n.bind(null,2984))})),g=new r.b(m,(function(e){return e.loadProviders})),f=new r.b(m,(function(e){return e.removeFileProvider})),b=new r.b(m,(function(e){return e.addFileProvider})),p=new r.b(m,(function(e){return e.removeAndAddFileProvider}))},1567:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(0),o=n(1505),i=function(){return Object(r.__spread)(Object(o.a)().providers.values())},a=function(e){return Object(o.a)().providers.get(e)||null}},1604:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded",e[e.Throttled=3]="Throttled"}(r||(r={}))},16612:function(e,t,n){"use strict";n.r(t);var r=n(3),o=Object(r.action)("setSmartPillBlockVisibility",(function(e,t){return{viewState:e,smartPillBlockVisible:t}})),i=Object(r.action)("setSmartPillFeedbackSubmitted",(function(e,t){return{item:e,smartPillFeedbackSubmitted:t}})),a=(Object(r.mutator)(o,(function(e){e.viewState.smartPillBlockVisible=e.smartPillBlockVisible})),Object(r.mutator)(i,(function(e){e.item.smartPillFeedbackSubmitted=e.smartPillFeedbackSubmitted})),Object(r.action)("updateItemLanguageAction",(function(e){return{item:e}}))),c=n(59),u=n(5508);function l(e){var t=function(e){var t=e.ExtendedProperty;if(t){var n=t.filter((function(e){return e.ExtendedFieldURI.PropertyName===u.a}));if(n.length>0)return n[0]}return null}(e),n=void 0,r=void 0,o=0,i=void 0;try{if(t){var a=JSON.parse(t.Value)[0],l=a[u.c],s=a[u.d];i=a[u.b],r=Object.keys(s)[0],n=(null==l?void 0:l[u.e])&&l[u.e].toLowerCase(),o=parseInt(Object.values(s)[0])}}catch(e){c.g.info("[getStampedLanguage] Failed to parse property, error: "+e.message)}return{locale:n,language:r,confidenceScore:o,entityId:i}}Object(r.mutator)(a,(function(e){var t=e.item;t.stampedLanguage=l(t)}));var s=n(0),d=n(49),m=n(745),g=n(83);function f(e){var t=e.featureName;return"SmartReply"===t?Object(g.i)("mc-smartReply"):"SmartTime"===t?Object(g.i)("mc-smartReplyWithCustomMeeting"):"SmartDoc"===t?Object(g.i)("mc-smartReplyWithDoc"):(c.g.info("[isPillTypeEnabled] Unknown pill type: "+t),!1)}function b(e){if(e){if("SmartDoc"===e.featureName)return!0;null==e.confidenceScore&&c.g.info("[isConfidenceScoreAcceptable] confidence score is null. Feature: "+e.featureName+" EntityId: "+e.logData.mainPayload.EID);var t=e.confidenceScore;if(t>0){if(Object(g.i)("mc-smartPillConfidenceLevel_LOW"))return!0;if(Object(g.i)("mc-smartPillConfidenceLevel_MID"))switch(e.featureName){case"SmartTime":return t>=70;default:return!0}else switch(e.featureName){case"SmartTime":return t>=90;default:return!0}}}return!1}function p(){var e=Object(g.i)("mc-smartReplyWithTextPositionThird");return[{aggregation:{SmartReply:2,SmartTime:1},arrangement:e?["SmartTime","SmartReply"]:["SmartReply","SmartTime"]},{aggregation:{SmartTime:1},arrangement:["SmartTime"]},{aggregation:{SmartReply:2,SmartDoc:1},arrangement:e?["SmartDoc","SmartReply"]:["SmartReply","SmartDoc"]},{aggregation:{SmartDoc:1},arrangement:["SmartDoc"]},{aggregation:{SmartReply:3},arrangement:["SmartReply"]}]}function h(e){if(e)for(var t=function(e){var t,n,r={};try{for(var o=Object(s.__values)(e),i=o.next();!i.done;i=o.next()){var a=i.value;r[a.featureName]=void 0===r[a.featureName]?1:r[a.featureName]+1}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}(e),n=p(),r=0;r<n.length;r++){for(var o=!0,i=n[r],a=0;a<i.arrangement.length;a++){if(i.aggregation[i.arrangement[a]]>(void 0===t[i.arrangement[a]]?0:t[i.arrangement[a]])){o=!1;break}}if(o)return i}return null}var S={selectPills:function(e){return function(e,t){var n=[];return t&&e.length>0&&t.arrangement.forEach((function(r){n.push.apply(n,Object(s.__spread)(function(e,t,n){return e.filter((function(e){return e.featureName===t})).slice(0,n)}(e,r,t.aggregation[r])))})),n}(e,h(e))}};function v(e,t,n,r){var o=[];return e.forEach((function(e){n(e)?o.push(e):(e.logData.mainPayload.renderStory|=r,t.push(e))})),o}var O={arbitratePills:function(e){var t=[],n=[];if(e){var r=v(e,n,f,1),o=v(r,n,b,4);if(o.length>0){var i=S;t.push.apply(t,Object(s.__spread)(i.selectPills(o)));for(var a=function(e){var r=o[e];t.some((function(e){return e===r}))||(r.logData.mainPayload.renderStory|=2,n.push(r))},c=0;c<o.length;c++)a(c)}}return{pillsToShow:t,pillsToHide:n,arbitratorId:"complexArbitrator"}}};var y=Object(r.action)("createMessageWithAttachmentAction",(function(e,t,n){return{item:e,attachment:t,option:n}})),j=n(1443),P=n(1536);function I(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return n=null,Object(P.j)()!==P.c.NotLoaded?[3,2]:[4,P.l.import()];case 1:return r.sent()((function(r){n=C(Object(P.h)(),e),t(n)})),[3,3];case 2:n=C(Object(P.h)(),e),t(n),r.label=3;case 3:return[2]}}))}))}function C(e,t){var n=function(e){for(var t=0;t<e.length;t++)if(0===e[t].type)return e[t].model.Id;return c.g.warn("createCloudFileFromAttachmentData: Could not get OneDrive Pro provider ID. Attachment will not upload."),""}(e);return{fileType:j.a.CloudSuggestion,name:t.FileName,size:null,providerId:n,providerType:0,location:t.Url,providerEndpointUrl:null,isFolder:!1,fileId:t.Id,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:null}}var x=n(2148),k=n(1495);function _(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return(n=Object(x.a)(e.ConversationId.Id))?[3,3]:[4,k.p.import()];case 1:return[4,r.sent()({referenceItemOrId:e,isReplyAll:!0,useFullCompose:!1,instrumentationContexts:null,conversationId:e.ConversationId.Id,body:null,smartDocOption:t})];case 2:n=r.sent(),r.label=3;case 3:return[2,n]}}))}))}var w=n(2699),T=n(269);Object(r.orchestrator)(y,(function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,i=this;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return t=e.item,n=e.attachment,r=e.option,n?[3,2]:[4,_(t,r)];case 1:return a.sent(),[3,5];case 2:return a.trys.push([2,4,,5]),[4,I(n,(function(e){return Object(s.__awaiter)(i,void 0,void 0,(function(){return Object(s.__generator)(this,(function(n){return function(e,t,n){Object(s.__awaiter)(this,void 0,void 0,(function(){var r;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return t?[4,_(e,n)]:[3,3];case 1:return r=o.sent(),[4,k.c.import()];case 2:o.sent()([t],r,{isInline:!1,isHiddenInline:!1,shouldShare:!0,isAddedFromSmartDoc:!0},(function(){return function(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(n){return Object(T.p)("SmartDocAttachmentsAdded",{smartDocExtractionId:e.SmartDocData.EntityId},{isCore:!0,isCosmosDatapoint:!0}),t.smartPillViewState.smartDocOption=w.b.None,[2]}))}))}(e,r)}),null,null,null),o.label=3;case 3:return[2]}}))}))}(t,e,r),[2]}))}))}))];case 3:return a.sent(),[3,5];case 4:return o=a.sent(),c.d("[createMessageWithAttachmentOrchestrator] Error when creating cloud file: "+o.message),[3,5];case 5:return[2]}}))}))}));var E=Object(r.action)("cacheSmartDocDataAction",(function(e,t,n){return{item:e,validPropertyExists:t,entityId:n}})),R=(Object(r.mutator)(E,(function(e){var t={EntityId:void 0},n=e.item,r=e.validPropertyExists,o=e.entityId;r&&(t.EntityId=o),n.SmartDocData=t})),n(1)),D=n(2613);var F=n(469),A=n(2223),M=n(3569),N=Object(r.createStore)("smartDocStatusAndSuggestionStore",{status:0,suggestions:[]}),B=N,L=Object(r.mutatorAction)("SET_SMART_DOC_SUGGESTION_STATUS",(function(e){N().status=e})),U=Object(r.mutatorAction)("SET_SMART_DOC_SUGGESTIONS",(function(e,t){N().suggestions=e,N().status=t})),V="application/json;charset=utf-8",H="/search/api/v1/recommendations";function G(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i,a,u,l,d;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:n=null,r="",L(1),s.label=1;case 1:return s.trys.push([1,7,8,9]),[4,W()];case 2:return o=s.sent(),i=function(e,t){var n={};n.headers=new Headers,n.headers.set("Authorization","Bearer "+e),n.headers.set("Content-Type",V),n.method="POST";var r=Object(A.b)();r&&n.headers.append("X-AnchorMailbox",r);n.headers.set("X-Client-LocalTime",(new Date).toISOString());var o=[];o.length&&n.headers.set("X-Client-Flights",o.join(","));var i=Object(g.i)("mc-smartReplyWithDoc-SmartAttachments"),a={EntityRequests:[t?{Context:{EntityId:t}}:{}],Scenario:{Name:i?"SmartAttachments":"AttachFile"}};return n.body=JSON.stringify(a),n}(o,e),[4,fetch(H,i)];case 3:return(a=s.sent())&&200==a.status?[4,a.text()]:[3,5];case 4:return u=s.sent(),l=JSON.parse(u),n=function(e){try{return e.EntitySets[0].ResultSets[0].Results.map((function(e,t){return function(e,t){var n,r;try{var o=!!e.Source.LastShared&&!e.Source.WebUrl;return{DateAccessed:e.Source.LastAccessDateTime||(null===(n=e.Source.UserRelationship)||void 0===n?void 0:n.LastAccessDateTime),DateModified:e.Source.LastModifiedDateTime,Endpoint:"Implicit"===(null===(r=e.SubstrateSearchExtendedProperties)||void 0===r?void 0:r.RelevanceRelationship)?o?D.a.MRUClassicContextual:D.a.MRUContextual:o?D.a.MRUClassic:D.a.MRUCloudy,FileExtension:e.Source.FileExtension,FileName:e.Source.FileName,FileSize:e.Source.FileSize,FileSourceType:e.ContentSource||e.Provenance,Id:o?e.Source.LastShared.AttachmentId:e.Id,Position:t,ReferenceId:e.ReferenceId,SourceTitle:e.Source.SiteTitle||e.Source.LastShared.SharingSubject,Url:e.Source.Url,TraceId:null}}catch(e){return c.g.info("[convertMRUAttachmentToReplyWithAttachmentSuggestion] Error accessing MRUAttachment properties: "+e.message),null}}(e,t)}))}catch(e){return c.g.info("[fetchMRUSuggestions_getAttachmentsFromResponse] Error: "+e.message),[]}}(l),[3,6];case 5:r=a?a.status+"-"+a.statusText:"No response",s.label=6;case 6:return[3,9];case 7:return d=s.sent(),r=d.message,[3,9];case 8:return r?(c.g.info("getMRUSuggestions: Error "+r),L(3)):U(n,2),Object(M.n)("SmartDocSuggestionRequestSent",{EID:t,isSuccessful:!r,numOfFileSuggestions:null==n?void 0:n.length}),[2,n];case 9:return[2]}}))}))}function W(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return e=Object(s.__read)(Object(F.getAccessTokenforResourceAsLazy)(window.location.origin),2),t=e[0],n=e[1],t?[3,2]:[4,n];case 1:t=r.sent(),r.label=2;case 2:return[2,t]}}))}))}var Q=n(12),Z="@EntityId";function J(e,t){var n=!1;if(e){if(t)try{n=function(e,t){var n=!1,r=t[Z];if(!r)throw c.g.info("[extractAndCacheSmartDocDataFromProperty] Cannot parse entity ID. Aborting..."),new Error("NoEntityIdOnProperty");return E(e,n=!0,r),n}(e,JSON.parse(t.Value)[0])}catch(e){throw c.g.warn("[parseSmartDocProperty] Malformed property, cannot parse. Error: "+e.message),e.networkError=!0,e}else c.g.info("[parseSmartDocProperty] No property found.");n||E(e,n)}else c.g.info("[parseSmartDocProperty] No item.")}var z=n(188),q=n(9),K=n(2006),X=n(15130),Y=n(662),$="...",ee=30,te=n(15131);function ne(e){var t,n,r,o=e.item,i=e.suggestion,a=e.smartPillLogData,u=e.onAttachmentClicked,l=e.dismissMenu,s=R.useCallback((function(){Object(M.j)(M.a,a,{subtype:"FileSuggestion"+i.Position,clickedSuggestion:{endpoint:D.a[i.Endpoint],fileSourceType:i.FileSourceType}}),Object(M.k)(a.mainPayload.EID,a.mainPayload.position,a.mainPayload.loggableText,"SmartDoc",a.mainPayload.language,a.mainPayload.locale,a.cosmosOnlyData),u(o,i,w.b.FileSuggestion),l()}),[o,i,l]);try{t=function(e){var t=null;try{t=[e.FileName,ie(e),re(e),oe(e)].filter((function(e){return e})).join("\n")}catch(e){c.g.info("[SmartDocMenuItemBuilder] Failed to parse attachment tooltip data, message: "+e.message)}finally{return t}}(i),n=function(e){return e.Endpoint===D.a.MRUClassic||e.Endpoint===D.a.MRUClassicContextual?ie(e):re(e)}(i),r=function(e){if(e.length<=ee)return e;var t=ee-$.length,n=Math.ceil(t/2),r=Math.floor(t/2),o=e.substr(0,n),i=e.substr(e.length-r);return""+o+$+i}(function(e){var t="."+e.FileExtension;return e.FileName.indexOf(t)>=0?e.FileName.replace(t,""):e.FileName}(i)+ae(i))}catch(e){throw c.g.warn("[SmartDocMenuItemBuilder] Error: "+e.message),e.networkError=!0,e}return R.createElement("button",{className:te.attachmentSuggestionButton,title:t,name:i.FileName,"aria-label":Object(Q.c)(Object(Q.b)(X.b),i.FileName),"aria-posinset":1,"aria-setsize":7,"aria-disabled":"false",role:"menuitem",onClick:s,tabIndex:0},R.createElement("div",{className:te.attachmentSuggestionButtonContent},R.createElement("div",{className:te.attachmentSuggestionButtonImageContainer,role:"presentation","aria-hidden":"true"},function(e){var t=e.FileName+ae(e);return R.createElement(K.a,{fileName:t,contentType:null,isBlocked:!1,isFolder:!1,embeddedItemClass:null,cloudyIconStyle:te.cloudyIcon,fileIconStyle:te.fileIcon})}(i)),R.createElement("div",null,R.createElement("div",{className:te.attachmentSuggestionButtonTextContainer},R.createElement("div",{className:te.attachmentSuggestionPrimaryText},r)),R.createElement("div",{className:te.attachmentSuggestionSecondaryText},n))))}function re(e){if(e.Endpoint===D.a.MRUClassic||e.Endpoint===D.a.MRUClassicContextual)return null;var t=e.DateAccessed;t||c.d('[SmartDocMenuItemBuilder] Access date is not available for suggestion "'+e.Id+'"');var n=Object(q.Qb)("UTC",t),r=Object(q.N)(n,Object(Y.i)());return Object(Q.c)(Object(Q.b)(X.a),r)}function oe(e){var t=e.DateModified;t||c.d('[SmartDocMenuItemBuilder] Modified date is not available for suggestion "'+e.Id+'"');var n=Object(q.Qb)("UTC",t),r=Object(q.Y)(n);return Object(Q.c)(Object(Q.b)(X.c),r)}function ie(e){var t=null,n=document.createElement("a");n.href=e.Url,t=decodeURIComponent(n.hostname);for(var r=Object(z.a)(),o=decodeURIComponent(n.pathname).split("/"),i=1;i<o.length-1;i++)r?t=o[i]+" < "+t:t+=" > "+o[i];return t}function ae(e){return"."+e.FileExtension}var ce=3;var ue=n(270),le=n(460),se=n(10328),de=n(949),me=n(314),ge=n(4950),fe=n(184),be=n(15133),pe=n(387).bind(be),he=Object(d.a)((function(e){var t,n=e.store,r=e.item,o=e.logData,i=e.pillsToShowTypes,a=R.useRef(!1),u=R.useRef(),l=[],d=[];switch(l.push({key:"replyWithHeader",name:Object(Q.b)(se.b),title:Object(Q.b)(se.b),itemType:fe.a.Header,iconProps:{iconName:null,styles:{root:{margin:"0px",width:"0px"}}},className:be.replyWithHeaderForBottomBar}),n.status){case 0:case 2:if(null===(t=n.suggestions)||void 0===t?void 0:t.length)(function(e,t){void 0===t&&(t=ce);var n=[],r=null;if(e)for(var o=0;o<e.length&&n.length<t;o++)(r=e[o])?n.push(r):c.g.info("[extractAttachmentSuggestions] mru suggestion is null");return n})(n.suggestions).forEach((function(e,t){l.push(function(e,t,n,r){return{key:"fileSuggestion"+t,className:be.attachmentSuggestionButtonRoot,onRender:function(t,o){return R.createElement(ne,{item:n,suggestion:e,smartPillLogData:r,onAttachmentClicked:y,dismissMenu:o})}}}(e,t,r,o)),d.push(function(e){return{endpoint:D.a[e.Endpoint],fileSourceType:e.FileSourceType}}(e))}));l.push(Se());break;case 1:l.push({key:"spinner",className:be.attachmentSuggestionButtonRoot,onRender:function(){return R.createElement(de.a,{size:me.a.medium,className:be.loadingSpinner})}}),l.push(Se());break;case 3:l.pop();break;default:Object(ue.a)(n.status)}l.push(ve(r,o,Object(Q.b)(ge.b),Object(Q.b)(ge.b),{iconName:"System",styles:{root:pe(be.iconRoot,be.iconRootComputer)}},w.b.LocalFiles)),l.push(ve(r,o,Object(Q.b)(ge.a),Object(Q.b)(ge.a),{iconName:"Cloud",styles:{root:pe(be.iconRoot,be.iconRootCloud)}},w.b.CloudFiles)),l.push(ve(r,o,Object(Q.b)(ge.c),Object(Q.b)(ge.d),{iconName:"CloudUpload",styles:{root:pe(be.iconRoot,be.iconRootUploadAndShare)}},w.b.UploadAndShare));var m=function(e,t){if(e){var n=(new Date).toISOString(),r={data:[Object(s.__assign)(Object(s.__assign)({},o.mainPayload),{timeClicked:n,numOfFileSuggestions:d.length,isSuccessful:t})]};e.addCustomData([JSON.stringify(r)]),e.addCosmosOnlyData(o.cosmosOnlyData),e.end()}};R.useEffect((function(){!a.current||2!==n.status&&3!==n.status||m(u.current,2===n.status)}));var f={items:l,onMenuOpened:function(){a.current=!0,Object(M.j)(M.d,o,{numOfFileSuggestions:d.length,numOfPillsShown:i.length,typesOfPillsShown:i}),1===n.status&&(u.current=new T.a(M.c,{isCore:!0,isCosmosDatapoint:!0}))},onMenuDismissed:function(){a.current=!1,Object(M.j)(M.b,o,{numOfFileSuggestions:d.length,suggestions:d}),1===n.status&&m(u.current,!1),u.current=null}},b=Object(Q.b)(se.a);return R.createElement(le.a,{ariaDescription:b,title:Object(g.i)("mc-smartPillsTooltipV2")?Object(Q.b)(se.c):b,iconProps:{iconName:"Attach"},key:e.position,split:!1,styles:e.menuItemStyle,text:b,menuProps:f})}));function Se(){return{key:"replyWithSeparator",iconProps:{iconName:null,styles:{root:{margin:"0px",width:"0px"}}},className:be.replyWithSeparator,itemType:fe.a.Divider}}function ve(e,t,n,r,o,i){var a=w.b[i];return{key:a,name:n,ariaLabel:r,title:r,iconProps:o,onClick:function(){Object(M.j)(M.a,t,{subtype:a}),y(e,null,i)}}}var Oe=n(3367),ye="EntityExtraction/SendContentRequestV21.0",je="Attach a file";function Pe(e){var t;return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return e.SmartDocData&&!e.SmartDocData.EntityId?[2,[]]:e.SmartDocData?[3,3]:[4,Oe.c.import()];case 1:return[4,o.sent()(e.ItemId.Id,w.a.SmartDoc)];case 2:(n=o.sent())&&(r=function(e,t){var n=e.ExtendedProperty;if(n)for(var r=n.length,o=0;o<r;o++){var i=n[o];if(i.ExtendedFieldURI.PropertyName===t)return i}return null}(n,ye),J(n,r)),o.label=3;case 3:return(null===(t=e.SmartDocData)||void 0===t?void 0:t.EntityId)?[2,[Ie(e)]]:[2,[]]}}))}))}function Ie(e){var t,n=Object(M.i)("SmartDoc",je,e.SmartDocData.EntityId);return G(Object(g.i)("mc-smartReplyWithDoc-ContextualMRU")?null===(t=e.ItemId)||void 0===t?void 0:t.Id:null,e.SmartDocData.EntityId),{onRender:function(t,r,o){return R.createElement(he,{store:B(),item:e,logData:n,position:t,menuItemStyle:r,pillsToShowTypes:o})},ariaLabel:Object(Q.b)(se.a),featureName:"SmartDoc",index:0,logData:n,onClick:null}}function Ce(e){var t=this;return{buildPills:function(){return Object(s.__awaiter)(t,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return[2,Pe(e)]}))}))},getName:function(){return"SmartDoc"}}}var xe=Object(r.action)("cacheSmartReplyDataAction",(function(e,t,n,r,o){return{item:e,validPropertyExists:t,smartReplies:n,loggableSmartReplies:r,smartReplyExtractionID:o}})),ke=n(20),_e=(Object(r.mutator)(xe,(function(e){var t={SmartReplies:null,LoggableSmartReplies:null,ExtractionID:null,SuggestionAppropriatenessMap:null,FeedbackSubmitted:!1},n=e.item,r=e.validPropertyExists,o=e.smartReplies,i=e.loggableSmartReplies,a=e.smartReplyExtractionID;if(r){t={SmartReplies:o,LoggableSmartReplies:i,ExtractionID:a,SuggestionAppropriatenessMap:new ke.ObservableMap,FeedbackSubmitted:!1};for(var c=0;c<o.length;c++){var u=String(c);t.SuggestionAppropriatenessMap.set(u,"")}}n.SmartReplyData=t})),Object(r.action)("updateSIGSDataOnClickAction",(function(e,t,n){return{composeViewState:e,timeClicked:t,clickIndex:n}}))),we=(Object(r.mutator)(_e,(function(e){var t=e.composeViewState,n=e.timeClicked,r=e.clickIndex;t&&(t.smartPillViewState.smartReplyComposeSIGSData={isSmartSuggestionsClicked:!0,suggestionsClickedTime:n,clickIndex:r})})),"EntityExtraction/SmartReplyForEmail"),Te=n(15135),Ee=n(1894),Re=n(15136);function De(e,t,n){return t.suggestions.slice(1).map((function(t){return{key:t,name:t,ariaLabel:t,title:Object(g.i)("mc-smartPillsTooltipV2")?Object(Q.b)(Te.b):t,itemProps:{styles:{root:Re.menuButton}},onClick:function(){Object(M.j)(M.f,n,{subtype:t}),Object(M.k)(n.mainPayload.EID,n.mainPayload.position,n.mainPayload.loggableText,"SmartReply",n.mainPayload.language,n.mainPayload.locale,n.cosmosOnlyData,t),Ee.j.importAndExecute(e.ItemId.Id,e.ConversationId.Id,t,1)}}}))}var Fe="2018-06-20T00:00:00.0000000Z",Ae="@extractionTimeUtc",Me="@EntityId",Ne=3,Be="SmartReplyForEmail",Le="SmartReplyForEmail_Group";function Ue(e,t){var n=!1;if(e){if(t)try{var r=JSON.parse(t.Value)[0],o=r[Ae];if(!o){c.g.warn("[getSmartRepliesForItem_parseSmartReplyProperty] Time stamp not found on property, aborting smart reply parsing.");var i=new Error("NoTimeStamp");throw i.networkError=!0,i}Date.parse(o)>=Date.parse(Fe)&&(n=function(e,t){for(var n=t[Me],r=[],o=[],i=!1,a=t.entities.length,u=0;u<a;u++){var l=Ve(t.entities[u]),s=l.smartReply,d=l.loggableSmartReply;r.push(s),o.push(d)}if(!n||r.length!=Ne){c.g.info("[getSmartRepliesForItem_extractAndCacheSmartRepliesFromProperty] Unexpected number of smart replies on item. Expected "+Ne+" but found "+r.length);var m=new Error("NumberOfSmartRepliesIs"+r.length);throw m.networkError=!0,m}xe(e,i=!0,r,o,n);return i}(e,r))}catch(e){throw c.g.warn("[getSmartRepliesForItem_parseSmartReplyProperty] Malformed property, cannot parse. Error: "+e.message),e.networkError=!0,e}else c.g.info("[getSmartRepliesForItem_parseSmartReplyProperty] No property found.");n||xe(e,n,null)}else c.g.info("[getSmartRepliesForItem_parseSmartReplyProperty] No item.")}function Ve(e){var t=null,n=null;switch(e["@type"]){case Be:t={type:0,suggestions:e.value},n=e.valueRaw||e.value;break;case Le:t={type:1,suggestions:e.values},n=JSON.stringify(e.values);break;default:c.g.warn("[getSmartRepliesForItem_parseSmartReplyProperty] Unexpected entity type. Expected "+Be+" or "+Le+" but found "+e["@type"])}return{smartReply:t,loggableSmartReply:n}}function He(e){var t;return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return e?e.SmartReplyData?[3,3]:[4,Oe.c.import()]:[3,4];case 1:return[4,o.sent()(e.ItemId.Id,w.a.SmartReply)];case 2:(n=o.sent())&&(r=function(e,t){var n=e.ExtendedProperty;if(n)for(var r=n.length,o=0;o<r;o++){var i=n[o];if(i.ExtendedFieldURI.PropertyName===t)return i}return null}(n,we),Ue(n,r)),o.label=3;case 3:return(null===(t=e.SmartReplyData)||void 0===t?void 0:t.ExtractionID)?[2,e.SmartReplyData.SmartReplies.map((function(t,n){return function(e,t,n,r,o){var i=this,a=Object(M.i)("SmartReply",n,r,o+1),c=null,u=null;if(0==t.type)c=t.suggestions;else if(1==t.type)switch(t.suggestions.length){case 0:c="";break;case 1:c=t.suggestions[0];break;default:c=t.suggestions[0],u={items:De(e,t,a)}}return{ariaLabel:Object(Q.c)(Object(Q.b)(Te.a),c),featureName:"SmartReply",icon:Object(g.i)("mc-smartPillsDesignV2")?{iconName:"Edit"}:null,onClick:function(t){return Object(s.__awaiter)(i,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return[4,Ee.j.importAndExecute(e.ItemId.Id,e.ConversationId.Id,c,1)];case 1:return n=r.sent(),_e(n,t.logData.mainPayload.timeClicked,t.logData.mainPayload.position),[2]}}))}))},logData:a,index:o,text:c,toolTip:Object(g.i)("mc-smartPillsTooltipV2")?Object(Q.b)(Te.b):c,confidenceScore:a.mainPayload.confidenceScore,menuProps:u}}(e,t,e.SmartReplyData.LoggableSmartReplies[n],e.SmartReplyData.ExtractionID,n)}))]:[3,5];case 4:c.g.info("[getSmartRepliesForItem] No item, cannot produce smart replies."),o.label=5;case 5:return[2,[]]}}))}))}function Ge(e){var t=this;return{buildPills:function(){return Object(s.__awaiter)(t,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return[2,He(e)]}))}))},getName:function(){return"SmartReply"}}}var We=Object(r.action)("cacheSmartTimeExtendedPropertyAction",(function(e,t,n){return{item:e,validPropertyExists:t,smartTimesExtendedProp:n}})),Qe=(Object(r.mutator)(We,(function(e){var t={beginingOfTimeRange:null,endOfTimeRange:null,duration:null,entityId:null,hasIntent:!1,confidenceScore:0,scheduler:"",rawConfidenceScores:null},n=e.item,r=e.validPropertyExists,o=e.smartTimesExtendedProp;r&&o&&(t=Object(s.__assign)(Object(s.__assign)({},o),{hasIntent:!0})),n.SmartTimeExtendedProperty=t})),n(10329));var Ze="EntityExtraction/Events1.0",Je="EntityExtraction/CalendarRelated1.0";var ze=n(538),qe=n(785);var Ke="@EntityId",Xe="confidence",Ye="SenderSchedulerConfidence",$e="RecipientSchedulerConfidence",et="UnclearSchedulerConfidence",tt="AvailabilityConfidence",nt="times";function rt(e,t){if(t){var n=null,r=!1;try{var o=JSON.parse(t.Value),i=-1/0,a=null;o.forEach((function(e){var t,n=(t=e,Object(g.i)("mc-smartReplyWithMeeting-MeetingScheduler")?Math.max(t[$e]?t[$e]:0,t[et]?t[et]:0,t[tt]?t[tt]:0):t[Xe]?+t[Xe]:0);n>i&&(i=n,a=e)}));var u=a[Ke],l=a[nt][0],s={confidence:a[Xe],AvailabilityConfidence:a[tt],RecipientSchedulerConfidence:a[$e],SenderSchedulerConfidence:a[Ye],UnclearSchedulerConfidence:a[et]},d=function(e,t){var n="";if(Object(g.i)("mc-smartReplyWithMeeting-MeetingScheduler")&&e&&t>0){var r=0;e[$e]>r&&(r=e[$e],n="Recipient"),e[et]>r&&(r=e[et],n="Unclear"),e[tt]>r&&(r=e[tt],n="Availability")}return n}(a,i);n={beginingOfTimeRange:l.beginingOfTimeRange,endOfTimeRange:l.endOfTimeRange,duration:l.duration,entityId:u,hasIntent:!0,confidenceScore:i,scheduler:d,rawConfidenceScores:s},r=!0}catch(e){throw c.g.warn("[getSmartTimeForItem_parseSmartTimeProperty] Malformed property, cannot parse. Error: "+e.message),e.networkError=!0,e}finally{We(e,r,n)}}else c.g.info("[getSmartTimeForItem_parseSmartTimeProperty] No smart time extended property found.")}var ot=n(1724),it=n(285),at=n(1456),ct=n(1756),ut=Object(it.action)("setCalendarInlineComposeViewState")((function(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return n=e,[4,k.i.import()];case 1:return[4,a.sent()(n,!0)];case 2:return r=s.__read.apply(void 0,[a.sent(),2]),o=r[0],i=r[1],Object(at.a)(e.ConversationId.Id).calendarInlineComposeViewState=Object(s.__assign)(Object(s.__assign)({},Object(ct.a)()),{referenceItemId:e.ItemId.Id,subject:e.Subject,location:null,smartTimeSuggestion:t,toRecipients:o,ccRecipients:i}),[2]}}))}))})),lt=n(1318);function st(){var e=Object(g.i)("mc-smartReplyWithMeeting-Cortana"),t=Object(lt.d)(lt.a.CalendarHelp).calendarHelpEnabled;return e&&t}var dt=n(9754);function mt(e){var t;return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i,a,u,l,d,m,f,b,p,h,S;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return n=[],e?e.SmartTimeExtendedProperty?[3,3]:[4,Oe.c.import()]:[3,7];case 1:return[4,s.sent()(e.ItemId.Id,w.a.SmartTime)];case 2:(r=s.sent())&&(o=function(e){var t=null,n=Object(g.i)("mc-smartReplyWithMeeting-MeetingScheduler")?Je:Ze;if(e){var r=e.ExtendedProperty;r&&r.some((function(e){return e.ExtendedFieldURI.PropertyName==n&&(t=e,!0)}))}return t}(r),rt(r,o)),s.label=3;case 3:return(i=e.SmartTimeExtendedProperty)?(a=i.entityId,u=100*i.confidenceScore,l=i.scheduler,d=i.rawConfidenceScores,m=function(e){var t;if(null===(t=null==e?void 0:e.SmartTimeExtendedProperty)||void 0===t?void 0:t.beginingOfTimeRange)try{var n=Object(q.lc)(e.SmartTimeExtendedProperty.beginingOfTimeRange);if(Object(Y.e)(n)){var r=Number(e.SmartTimeExtendedProperty.duration);r<=0&&(r=Object(qe.a)());var o=Object(q.h)(n,r),i=Object(ze.g)(n,o);return{startTime:i.start,endTime:i.end}}}catch(e){throw c.g.warn("[getSmartTimeSuggestion] Unable to parse suggested time. Error: "+e.message),e.networkError=!0,e}return null}(e),f=null,m?[4,ut(e,m)]:[3,5]):[3,6];case 4:s.sent(),f=Object(at.a)(null===(t=e.ConversationId)||void 0===t?void 0:t.Id).calendarInlineComposeViewState,s.label=5;case 5:b=e,p=st(),h=function(e,t,n,r,o,i,a){var c=Object(M.i)("SmartTime",Object(Q.b)(Qe.d),e,t),u=null!=i,l=o.ToRecipients?o.ToRecipients.length:0,s=o.CcRecipients?o.CcRecipients.length:0;c.mainPayload.rawConfidenceScores=r,c.mainPayload.scheduler=n,c.mainPayload.hasSuggestedTime=u,c.mainPayload.NumToRecipient=l,c.mainPayload.NumCCRecipient=s,c.mainPayload.isCalendarHelpEnabled=a,c.cosmosOnlyData=o.InternetMessageId,u&&(c.mainPayload.suggestedStartTime=i.startTime,c.mainPayload.suggestedEndTime=i.endTime);return c}(a,u,l,d,b,m,p),S=null,p&&(S={items:ft(e,f,a,b,h)}),n.push(function(e,t,n,r,o,i,a){return{ariaLabel:Object(Q.b)(Qe.d),featureName:"SmartTime",onClick:n,index:e,logData:r,text:t,toolTip:Object(g.i)("mc-smartPillsTooltipV2")?Object(Q.b)(Qe.e):t,icon:i,confidenceScore:o,menuProps:a}}(n.length,Object(Q.b)(Qe.d),(function(){return gt(e,f,a,b,{SuggestionsClickedTime:(new Date).toISOString()})}),h,u,{iconName:"DateTime2"},S)),s.label=6;case 6:return[3,8];case 7:c.g.info("[getSmartTimesForItem] No item, cannot produce smart times."),s.label=8;case 8:return[2,n]}}))}))}function gt(e,t,n,r,o){window.addEventListener("message",bt),ot.r.importAndExecute(e.ItemId.Id,t,!1,null,n,r.InternetMessageId,o)}function ft(e,t,n,r,o){var i=[];return i.push({key:"OutlookMeeting",text:Object(Q.b)(Qe.c),onClick:function(){Object(M.j)(M.g,o,{subtype:"OutlookMeeting"});var i=(new Date).toISOString();gt(e,t,n,r,{SuggestionsClickedTime:i,IsSmartTimeSuggestionsClicked:i?"True":"False"})}}),i.push({key:"CortanaMeeting",text:Object(Q.b)(Qe.a),onClick:function(){Object(M.j)(M.g,o,{subtype:"CortanaMeeting"}),function(e){Ee.j.importAndExecute(e.ItemId.Id,e.ConversationId.Id,Object(Q.b)(Qe.b),2)}(e)}}),i}var bt=function(e){if((null==e?void 0:e.data)&&"string"==typeof e.data){var t=JSON.parse(e.data);t&&"calDraftItem"===t.source&&dt.a.importAndExecute({featureName:"SmartTime"})}};function pt(e){var t=this;return{buildPills:function(){return Object(s.__awaiter)(t,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return[2,mt(e)]}))}))},getName:function(){return"SmartTime"}}}function ht(e){var t=this;return{updateLogData:function(n){return Object(s.__awaiter)(t,void 0,void 0,(function(){var t,r,o,i,a;return Object(s.__generator)(this,(function(c){return e&&(t=null===(i=e.stampedLanguage)||void 0===i?void 0:i.language,r=null===(a=e.stampedLanguage)||void 0===a?void 0:a.locale,o=e.InternetMessageId,n.forEach((function(e){e.logData.mainPayload.language=t,e.logData.mainPayload.locale=r,e.logData.cosmosOnlyData=o}))),[2]}))}))},getName:function(){return"ItemLevelDataUpdater"}}}function St(e){var t=this;return{preRun:function(){return Object(s.__awaiter)(t,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,Oe.c.import()];case 1:return[4,n.sent()(e.ItemId.Id,w.a.LanguageAndLocale)];case 2:return(t=n.sent())&&!t.stampedLanguage&&a(t),[2]}}))}))},getName:function(){return"LanguagePreRunner"}}}var vt=n(15138),Ot={SmartPillFeedbackGenericOption1:"Not relevant",SmartPillFeedbackGenericOption2:"Too similar",SmartPillFeedbackGenericOption3:"No reply needed",SmartPillFeedbackGenericOption4:"Doesn't sound like me",SmartPillFeedbackGenericOption5:"Offensive or rude",SmartPillFeedbackGenericOption6:"Not in the correct language",SmartPillFeedbackGenericOption7:"Other",SmartPillFeedbackMeetingOption1:"The meeting is already on my calendar",SmartPillFeedbackMeetingOption2:"A meeting suggestion isn't relevant",SmartPillFeedbackMeetingOption3:"I'm not the person who should schedule the meeting",SmartPillFeedbackMeetingOption4:"I want to schedule the meeting later",SmartPillFeedbackMeetingOption5:"I don't want help scheduling a meeting",SmartPillFeedbackFileOption1:'"Attach a file" suggestion isn\'t relevant',SmartPillFeedbackFileOption2:"I'm not the one who needs to attach a file",SmartPillFeedbackFileOption3:"Didn't find the file I was looking for",SmartPillFeedbackFileOption4:"Didn't get any file suggestions",SmartPillFeedbackFileOption5:"Want to attach a file later"};function yt(e,t){var n;t.UniqueBody?n=t.UniqueBody.Value:t.NormalizedBody&&(n=t.NormalizedBody.Value);var r={subtitle:void 0,dSATOptions:void 0,donationJson:{messageBody:n}},o=e.some((function(e){return"SmartTime"===e.featureName})),i=e.some((function(e){return"SmartDoc"===e.featureName})),a=e.some((function(e){return"SmartReply"===e.featureName}));return o&&i&&c.g.warn("[SmartPillFeedbackData] feedback options not defined for Smart Time + Smart Doc"),a?(r.subtitle=Object(Q.b)(vt.n),r.dSATOptions=o?[{logString:Ot.SmartPillFeedbackGenericOption1,uiString:Object(Q.b)(vt.g)},{logString:Ot.SmartPillFeedbackGenericOption4,uiString:Object(Q.b)(vt.j)},{logString:Ot.SmartPillFeedbackGenericOption5,uiString:Object(Q.b)(vt.k)},{logString:Ot.SmartPillFeedbackMeetingOption3,uiString:Object(Q.b)(vt.q)},{logString:Ot.SmartPillFeedbackMeetingOption5,uiString:Object(Q.b)(vt.s)},{logString:Ot.SmartPillFeedbackGenericOption7,uiString:Object(Q.b)(vt.m)}]:i?[{logString:Ot.SmartPillFeedbackGenericOption1,uiString:Object(Q.b)(vt.g)},{logString:Ot.SmartPillFeedbackGenericOption5,uiString:Object(Q.b)(vt.k)},{logString:Ot.SmartPillFeedbackFileOption2,uiString:Object(Q.b)(vt.b)},{logString:Ot.SmartPillFeedbackFileOption3,uiString:Object(Q.b)(vt.c)},{logString:Ot.SmartPillFeedbackFileOption5,uiString:Object(Q.b)(vt.e)},{logString:Ot.SmartPillFeedbackGenericOption7,uiString:Object(Q.b)(vt.m)}]:[{logString:Ot.SmartPillFeedbackGenericOption1,uiString:Object(Q.b)(vt.g)},{logString:Ot.SmartPillFeedbackGenericOption2,uiString:Object(Q.b)(vt.h)},{logString:Ot.SmartPillFeedbackGenericOption3,uiString:Object(Q.b)(vt.i)},{logString:Ot.SmartPillFeedbackGenericOption4,uiString:Object(Q.b)(vt.j)},{logString:Ot.SmartPillFeedbackGenericOption5,uiString:Object(Q.b)(vt.k)},{logString:Ot.SmartPillFeedbackGenericOption6,uiString:Object(Q.b)(vt.l)},{logString:Ot.SmartPillFeedbackGenericOption7,uiString:Object(Q.b)(vt.m)}]):o?(r.subtitle=Object(Q.b)(vt.t),r.dSATOptions=[{logString:Ot.SmartPillFeedbackMeetingOption1,uiString:Object(Q.b)(vt.o)},{logString:Ot.SmartPillFeedbackMeetingOption2,uiString:Object(Q.b)(vt.p)},{logString:Ot.SmartPillFeedbackMeetingOption3,uiString:Object(Q.b)(vt.q)},{logString:Ot.SmartPillFeedbackMeetingOption4,uiString:Object(Q.b)(vt.r)},{logString:Ot.SmartPillFeedbackMeetingOption5,uiString:Object(Q.b)(vt.s)},{logString:Ot.SmartPillFeedbackGenericOption7,uiString:Object(Q.b)(vt.m)}]):i?(r.subtitle=Object(Q.b)(vt.f),r.dSATOptions=[{logString:Ot.SmartPillFeedbackFileOption1,uiString:Object(Q.b)(vt.a)},{logString:Ot.SmartPillFeedbackFileOption2,uiString:Object(Q.b)(vt.b)},{logString:Ot.SmartPillFeedbackFileOption3,uiString:Object(Q.b)(vt.c)},{logString:Ot.SmartPillFeedbackFileOption4,uiString:Object(Q.b)(vt.d)},{logString:Ot.SmartPillFeedbackFileOption5,uiString:Object(Q.b)(vt.e)},{logString:Ot.SmartPillFeedbackGenericOption7,uiString:Object(Q.b)(vt.m)}]):r.subtitle=Object(Q.b)(vt.n),r}var jt=n(4553);var Pt=n(7087),It=n(8900),Ct=n(15139),xt=Object(d.a)((function(e){var t,n=this;R.useEffect((function(){return f(),function(){r.current=null,i.current=null,l.current=null,u.current=null,o(e.viewState,!1)}}),[]),R.useEffect((function(){d.current||(d.current=Object(Pt.b)(e.item))}));var r=R.useRef(function(e){return[pt(e),Ce(e),Ge(e)]}(e.item)),i=R.useRef(O),a=R.useRef(function(e){return[ht(e)]}(e.item)),u=R.useRef(function(e){return[St(e)]}(e.item)),l=R.useRef(),d=R.useRef(!1),g=Object(m.a)((function(){var t,n=e.item;return!(null===(t=null==n?void 0:n.ItemId)||void 0===t||!t.Id)&&null!=Object(x.a)(n.ItemId.Id,1)})),f=function(){return Object(s.__awaiter)(n,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return c.g.info("[MailSmartPillBlock] Running smart pill builders"),t=l,[4,Object(M.h)(r.current,i.current,u.current,a.current,3e3)];case 1:return t.current=n.sent(),function(e,t){var n=t?t.pillsToShow.filter((function(e){return"SmartReply"===e.featureName})):[],r=n.length>0?n[0].logData.mainPayload.EID:"",o=t&&t.pillsToShow.length>0?"True":"False",i="True"===o?t.pillsToShow.map((function(e){return e.featureName})).toString():"",a="True"===o?t.pillsToShow.map((function(e){return e.text})).join("$"):"";Object(jt.a)(e.ItemId.Id,o,i,a,r)}(e.item,l.current),l.current&&l.current.pillsToShow.length>0&&o(e.viewState,!0),[2]}}))}))},b=e.item,p=e.viewState.smartPillBlockVisible,h=!!b.RightsManagementLicenseData,S=(null===(t=b.adaptiveCardDetails)||void 0===t?void 0:t.length)>0&&"3f0a4969-053e-44be-9931-ca62d0c32bde"!==b.adaptiveCardDetails[0].connectorSenderGuid;if(h||!p||!l.current||0==l.current.pillsToShow.length&&0==l.current.pillsToHide.length||g.get()||S)return null;var v=l.current.pillsToShow.length>0;return R.createElement("div",{className:v?Ct.bar:void 0},R.createElement(It.a,{arbitratedPills:l.current,enableFeedbackForm:!b.smartPillFeedbackSubmitted,feedbackData:yt(l.current.pillsToShow,b)}))}));n.d(t,"MailSmartPillBlock",(function(){return xt}))},1680:function(e,t,n){"use strict";var r=n(0),o=n(29);function i(e){return Object(r.__assign)({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}function a(e){var t,n,r=i({ProviderType:e});return void 0===(t=r)||t.__type||(t=i(t)),Object(o.a)("GetNewAttachmentDataProviderCreationInfo",t,n)}function c(e){return Object(r.__assign)({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}function u(e){var t,n,r=c({ProviderType:e});return void 0===(t=r)||t.__type||(t=c(t)),Object(o.a)("GetAttachmentDataProviderCreator",t,n)}var l=n(2026),s=n(1953);n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return y}));var d="code",m="token",g=3e3,f=3;function b(e){return{state:e}}function p(e){return e.state}function h(e){return e.code}function S(e,t,n,o,i){var c={providerType:e,getAuthUrlInfo:null,getCSRFToken:p,getOAuthCode:h};return function e(t,n,o,i,c,s,d){return Object(r.__awaiter)(this,void 0,void 0,(function(){var m,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),m=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,u(t)];case 1:return f=r.sent(),m=f.AttachmentDataProviderCreator.ProviderAppKey,o=f.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,a(t)];case 3:f=r.sent(),m=f.ProviderAppKey,r.label=4;case 4:return n.getAuthUrlInfo=Object(l.d)(t,o,i,m,c,s),[3,6];case 5:return r.sent(),d>0&&setTimeout((function(){return e(t,n,o,i,c,s,--d)}),g),[3,6];case 6:return[2]}}))}))}(e,c,t,n,o,i,f),c}var v=null;function O(){if(!v){if(v={},Object(s.a)(3)&&(v[3]=S(3,"https://app.box.com/api/oauth2/authorize",Object(l.c)(3),d,b)),Object(s.a)(2)&&(v[2]=S(2,"https://www.dropbox.com/oauth2/authorize",Object(l.b)(2),d,b)),Object(s.a)(6)){var e=S(6,"https://www.facebook.com/dialog/oauth",Object(l.b)(6),m,(function(e){return{state:e,scope:"user_photos,email"}}));e.getCSRFToken=p,e.getOAuthCode=function(e){return e.access_token},v[6]=e}if(Object(s.a)(5)){var t=S(5,"https://accounts.google.com/o/oauth2/auth",l.a+"/ADPRedirect.aspx",d,(function(e){var t={state:e,provider:5..toString(),url:Object(l.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}}));t.getCSRFToken=function(e){return JSON.parse(e.state).state},v[5]=t}Object(s.a)(1)&&(v[1]=S(1,"https://login.live.com/oauth20_authorize.srf",Object(l.c)(1),d,(function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}))),Object(s.a)(7)&&(v[7]=S(7,"",Object(l.c)(7),d,b)),Object(s.a)(8)&&(v[8]=S(8,"",Object(l.c)(8),d,b)),Object(s.a)(9)&&(v[9]=S(9,"",Object(l.c)(9),d,b))}return v}function y(e){var t=O();return e in t?t[e]:null}},1691:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1505);function o(){return Object(r.a)().loadState}},1700:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2077),o=n(1973),i=n(2041),a=n(12),c=n(270);function u(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:return Object(a.b)(i.b);case 1:return Object(a.b)(i.a);case 2:case 9:return Object(a.b)(r.b);case 3:case 7:return Object(a.b)(r.a);case 5:return Object(a.b)(r.e);case 6:return Object(a.b)(r.d);case 4:return Object(a.b)(r.f);case 10:return Object(a.b)(o.b);case 8:return Object(a.b)(r.c);default:return Object(c.a)(e)}}},1701:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a}));var r,o=n(0);!function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));var i=Object.freeze([1,3,2,6,5,7,8,9]),a=Object.freeze(Object(o.__spread)(i,[0,4,10]))},1724:function(e,t,n){"use strict";var r=n(77),o=n(2256),i=n(1849),a=n(1712),c=n(1816),u=n(1966),l=n(1967),s=n(2160),d=n(2205),m=n(2131),g=n(1402),f=n(83),b=n(1319);function p(e,t){return!!e&&(1!==t&&!!b.a.conversations.get(e))}function h(e,t){return 2!=t&&(Object(f.i)("rp-persistedReadingPaneTabs")?g.a.loadedItemReadingPaneViewStates.has(e):g.a.itemReadingPaneViewState&&g.a.itemReadingPaneViewState.itemId==e)}var S=n(1899),v=n(1900),O=n(1832),y=n(1456);n.d(t,"l",(function(){return P})),n.d(t,"p",(function(){return I})),n.d(t,"m",(function(){return C})),n.d(t,"q",(function(){return x})),n.d(t,"s",(function(){return k})),n.d(t,"n",(function(){return _})),n.d(t,"o",(function(){return w})),n.d(t,"i",(function(){return T})),n.d(t,"j",(function(){return E})),n.d(t,"k",(function(){return R})),n.d(t,"g",(function(){return D})),n.d(t,"r",(function(){return F})),n.d(t,"h",(function(){return A})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return h})),n.d(t,"f",(function(){return S.a})),n.d(t,"a",(function(){return v.a})),n.d(t,"t",(function(){return g.a})),n.d(t,"c",(function(){return O.a})),n.d(t,"b",(function(){return y.a}));var j=new r.c((function(){return Promise.all([n.e(1),n.e(6),n.e(8),n.e(14),n.e(16),n.e(18),n.e(21),n.e(19),n.e(26),n.e(34),n.e(43),n.e(61),n.e(74),n.e(119),n.e(174),n.e(179),n.e(181),n.e(260),n.e(270),n.e(256),n.e(693)]).then(n.bind(null,16618))})),P=new r.a(j,(function(e){return e.loadConversationReadingPane})),I=new r.a(j,(function(e){return e.moveReadingPaneToTab})),C=new r.a(j,(function(e){return e.loadConversationReadingPaneForSingleMailItemSelected})),x=new r.a(j,(function(e){return e.print})),k=new r.a(j,(function(e){return e.setItemIdToScrollTo})),_=new r.a(j,(function(e){return e.loadItemReadingPane})),w=new r.a(j,(function(e){return e.loadItemReadingPaneForSingleMailItemSelected})),T=new r.a(j,(function(e){return e.expandCollapseAllItemParts}));Object(r.f)(a.a,j,(function(e){return e.deleteItemsStoreUpdateOrchestrator})),Object(r.f)(u.a,j,(function(e){return e.markConversationsAsReadStoreUpdateOrchestrator})),Object(r.f)(l.a,j,(function(e){return e.markItemsAsReadStoreUpdateOrchestrator})),Object(r.f)(c.a,j,(function(e){return e.markAllAsReadOrchestrator})),Object(r.f)(o.a,j,(function(e){return e.applyConversationFlagStateStoreUpdateOrchestrator})),Object(r.f)(i.a,j,(function(e){return e.deleteConversationStoreUpdateOrchestrator})),Object(r.f)(m.a,j,(function(e){return e.conversationReadyToLoadOrchestrator})),Object(r.f)(m.b,j,(function(e){return e.updateAttachmentsOrchestrator})),Object(r.f)(m.c,j,(function(e){return e.updateItemMandatoryPropertiesOrchestrator})),Object(r.f)(s.a,j,(function(e){return e.updateInternetMessageIdOrchestrator})),Object(r.f)(d.a,j,(function(e){return e.initializeExtendedCardForItemReadingPaneOrchestrator}));new r.b(j,(function(e){return e.getLastestNonDraftItemId}));var E=new r.b(j,(function(e){return e.getLatestNonDraftItemIdFromConversation})),R=new r.b(j,(function(e){return e.isUnsupportedItem})),D=new r.a(j,(function(e){return e.clearReadingPaneStore})),F=new r.a(j,(function(e){return e.replyByMeeting})),A=new r.a(j,(function(e){return e.ensureSecondaryReadingPaneTabHandler}))},1751:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(3),o=Object(r.action)("NEW_MESSAGE_V3",(function(e,t,n,r,o){return{actionSource:e,groupId:t,toEmailAddressWrappers:n,subject:r,body:o}})),i=Object(r.action)("ON_CLOSE_COMPOSE",(function(e){return{closeReason:e}}))},1754:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},1756:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=0;function o(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),{editorId:(r++).toString(),content:e,isDirty:t,textDirection:null,keyStrokeCount:0,selectedImage:null}}},1894:function(e,t,n){"use strict";var r=n(3),o=n(1751);Object(r.orchestrator)(o.a,(function(e){u.importAndExecute(e.actionSource,e.groupId,e.toEmailAddressWrappers,e.subject,e.body)}));var i=n(2200),a=(Object(r.orchestrator)(i.a,(function(e){var t=e.source,n=e.groupId,r=e.toRecipients,i=e.subject,a=e.body;Object(o.a)(t,n,r,i,a)})),n(77));n.d(t,"c",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return d})),n.d(t,"i",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"g",(function(){return f})),n.d(t,"k",(function(){return b})),n.d(t,"j",(function(){return p})),n.d(t,"e",(function(){return h})),n.d(t,"d",(function(){return S}));var c=new a.c((function(){return Promise.all([n.e(28),n.e(32),n.e(39),n.e(41),n.e(626)]).then(n.bind(null,16689))})),u=new a.a(c,(function(e){return e.newMessage}),{captureBundleTime:!0}),l=new a.a(c,(function(e){return e.replyToConversation})),s=new a.a(c,(function(e){return e.forwardConversation})),d=new a.a(c,(function(e){return e.printConversation})),m=new a.a(c,(function(e){return e.replyToItem})),g=new a.a(c,(function(e){return e.forwardItem})),f=new a.a(c,(function(e){return e.printItem})),b=new a.a(c,(function(e){return e.showConversationInImmersiveReader})),p=new a.a(c,(function(e){return e.replyWithText})),h=new a.a(c,(function(e){return e.onKeyboardReply})),S=new a.a(c,(function(e){return e.onKeyboardForward}))},191:function(e,t,n){"use strict";var r=n(77),o=n(634),i=n(635),a=n(428);function c(){return Object(a.a)().endShortEventsBy}function u(){return Object(a.a)().endLongEventsBy}var l=n(632),s=n(633),d=n(768),m=n(628),g=n(629),f=n(83),b=5;function p(){if(!Object(f.i)("cal-mf-shouldEventsEndEarlySetting")&&!Object(f.i)("cal-mf-shortenEventsDuration"))return 0;var e=c();return null!=e?e:b}var h=10;function S(){if(!Object(f.i)("cal-mf-shouldEventsEndEarlySetting")&&!Object(f.i)("cal-mf-shortenEventsDuration"))return 0;var e=u();return null!=e?e:h}var v=n(769),O=n(470);n.d(t,"o",(function(){return j})),n.d(t,"n",(function(){return P})),n.d(t,"m",(function(){return o.a})),n.d(t,"l",(function(){return i.a})),n.d(t,"k",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"i",(function(){return l.a})),n.d(t,"e",(function(){return s.a})),n.d(t,"f",(function(){return d.a})),n.d(t,"g",(function(){return m.a})),n.d(t,"h",(function(){return g.a})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return S})),n.d(t,"d",(function(){return v.a})),n.d(t,"a",(function(){return O.a}));var y=new r.c((function(){return n.e(488).then(n.bind(null,16768))})),j=new r.a(y,(function(e){return e.saveCalendarCloudSettings})),P=new r.a(y,(function(e){return e.initCalendarCloudSettings}))},1953:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1384),o=n(320),i=n(270),a=n(83);function c(e){var t=Object(r.a)();switch(e){case 5:return(null==t?void 0:t.GoogleDriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(a.i)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return(null==t?void 0:t.BoxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(a.i)("doc-fileProvider-box");case 2:return(null==t?void 0:t.DropboxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(a.i)("doc-fileProvider-dropbox");case 6:return(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(a.i)("doc-fileProvider-facebook");case 1:return!!Object(o.a)()||(null==t?void 0:t.OnedriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled);case 10:return Object(a.i)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(a.i)("doc-fileProvider-wopiClient");default:return Object(i.a)(e)}}},1973:function(e){e.exports=JSON.parse('{"a":"cga","b":"dga"}')},2026:function(e,t,n){"use strict";var r=n(722),o=n(2);function i(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+n:e+"?"+t+"="+n}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l}));var a=Object(o.G)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(e){var t=e?encodeURIComponent("?provider="+e):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.l)()+"/mail/"+n+t}function u(e){var t=Object(r.l)()+"/mail/AddFileProvider.html",n=encodeURIComponent("provider="+e+"&url="+t);return a+"/ADPRedirect.aspx?"+n}function l(e,t,n,r,o,a){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[],r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}(),c=i(t,"client_id",r);if(c=i(c,"redirect_uri",n),c=i(c,"response_type",o),a){var u=a(e);c=Object.keys(u).reduce((function(e,t){return i(e,t,u[t])}),c)}return{authUrl:c,redirectUrl:n,csrfToken:e}}}},2041:function(e){e.exports=JSON.parse('{"b":"qga","a":"rga"}')},2077:function(e){e.exports=JSON.parse('{"b":"kga","a":"lga","e":"mga","d":"nga","f":"oga","c":"pga"}')},2200:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("createFeedbackForCortana",(function(e,t,n,r,o){return{source:e,groupId:t,toRecipients:n,subject:r,body:o}}))},2223:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(33),o=n(24),i=n(96);function a(){var e=Object(r.a)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(r.a)(t)}function c(){var e,t,n=(e="",(t=Object(o.a)().pathname.split("/").filter((function(e){return e.length}))).length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e);if(0===n.length){var r=Object(i.h)();if(null==r?void 0:r.SessionSettings){var c=r.SessionSettings.ExternalDirectoryTenantGuid,u=r.SessionSettings.UserPuid;u&&c&&(n="PUID:"+u+"@"+c)}}return 0===n.length&&(n=a()),n}},2613:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return d}));var r=n(77),o=n(2763);n.d(t,"a",(function(){return o.a}));var i=new r.c((function(){return Promise.all([n.e(1),n.e(30),n.e(471)]).then(n.bind(null,6537))})),a=new r.b(i,(function(e){return e.clearCachedAttachmentSuggestions})),c=new r.b(i,(function(e){return e.getAttachmentSuggestionsAction})),u=new r.b(i,(function(e){return e.createCloudFileFromAttachmentData})),l=new r.b(i,(function(e){return e.getAttachmentSuggestionsMenuItems})),s=(new r.b(i,(function(e){return e.getAttachmentSuggestionsTraceId})),new r.b(i,(function(e){return e.getAttachmentSuggestionsTraceIdByComposeId}))),d=new r.a(i,(function(e){return e.logEntitiesFromFilePicker}))},2699:function(e,t,n){"use strict";var r,o,i=n(77),a=n(4553),c=n(3),u=n(1323);Object(c.mutator)(a.a,(function(e){var t=e.itemId,n=e.isSmartSuggestionsRendered,r=e.suggestionTypesRendered,o=e.suggestionsRendered,i=e.extractionId,a=Object(u.g)().items.get(t);(null==a?void 0:a.SIGSData)&&(a.SIGSData.SmartPillData={IsSmartSuggestionsRendered:n,SuggestionTypesRendered:r,SuggestionsRendered:o,ExtractionId:i})}));function l(e){return{smartReplyComposeSIGSData:{isSmartSuggestionsClicked:!1,suggestionsClickedTime:null,clickIndex:-1},smartDocOption:e||r.None}}!function(e){e[e.None=0]="None",e[e.FileSuggestion=1]="FileSuggestion",e[e.LocalFiles=2]="LocalFiles",e[e.CloudFiles=3]="CloudFiles",e[e.UploadAndShare=4]="UploadAndShare"}(r||(r={})),function(e){e.LanguageAndLocale="SmartPill_LanguageAndLocale",e.SmartDoc="SmartPill_SmartDoc",e.SmartReply="SmartPill_SmartReply",e.SmartTime="SmartPill_SmartTime"}(o||(o={})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return l}));var s=new i.c((function(){return n.e(905).then(n.bind(null,16554))}));new i.a(s,(function(e){return e.logToSIGSOnMessageSent}))},2763:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Contextual=0]="Contextual",e[e.MRUCloudy=1]="MRUCloudy",e[e.MRUClassic=2]="MRUClassic",e[e.MRUContextual=3]="MRUContextual",e[e.MRUClassicContextual=4]="MRUClassicContextual"}(r||(r={}))},3569:function(e,t,n){"use strict";var r=n(0),o=2500,i=n(269),a=n(324);function c(e,t,n){var r=new a.a(e,t,{isCore:!0,isCosmosDatapoint:!0});n&&r.addCosmosOnlyData(n),i.l.importAndExecute(r)}function u(e,t,n,a,u){return Object(r.__awaiter)(this,void 0,void 0,(function(){var l,s,d,m,g,f,b,p,h,S;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return l={},s=u||o,n?[4,Promise.all(n.map((function(e){return e.preRun().catch((function(t){l[e.getName()]=new Error(t)}))})))]:[3,2];case 1:r.sent(),r.label=2;case 2:return(d=new i.a("SmartPillPerformance",{sessionSampleRate:10})).addCustomProperty("preDefinedTimeout",s),[4,Promise.all(e.map((function(e){return Promise.race([e.buildPills(),(t=s,new Promise((function(e,n){setTimeout((function(){var e=new Error("timeout");e.networkError=!0,n(e)}),t)})))]).catch((function(t){return l[e.getName()]=new Error(t),[]}));var t}))).then((function(e){return d.end(),e}))];case 3:return m=r.sent(),g=[].concat.apply([],m),f=g.length,a?[4,Promise.all(a.map((function(e){return e.updateLogData(g).catch((function(t){l[e.getName()]=new Error(t)}))})))]:[3,5];case 4:r.sent(),r.label=5;case 5:b={pillsToShow:[],pillsToHide:[],arbitratorId:""};try{b=t.arbitratePills(g)}catch(e){l.arbitrator=new Error(e)}return(p=Object.keys(l)).length>0&&(h=[],S=[],p.forEach((function(e){var t=l[e];t.hasOwnProperty("networkError")?h.push(e+"_"+t.message):S.push(e+"_"+t.message)})),c("SmartPillError",[h.toString(),S.toString(),f])),[2,b]}}))}))}function l(e,t,n,r,o){return{mainPayload:{renderStory:0,loggableText:t,type:e,position:-1,EID:n,confidenceScore:r},cosmosOnlyData:o}}function s(e,t,n){var r=void 0;e.concat(t).forEach((function(e){!r&&e.logData.cosmosOnlyData&&(r=e.logData.cosmosOnlyData)}));var o={data:e.map((function(e){return e.logData.mainPayload}))},i={data:t.map((function(e){return e.logData.mainPayload}))};c("SmartPillsRendered",[e.length,t.length,JSON.stringify(o),JSON.stringify(i),n],r)}function d(e,t,n,r,o,i,a){c("SmartReply_Rendered",[e,!1,t.join("$"),!1,n.toString(),r.toString(),o,i],a)}function m(e,t,n){var o=(new Date).toISOString(),i={data:[Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},t.mainPayload),{timeClicked:o}),n)]};c(e,[JSON.stringify(i)],t.cosmosOnlyData)}function g(e,t,n,r,o,i,a,u){c("SmartReply_Clicked",[e,t,n,!1,r,o,i,u],a)}n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"l",(function(){return s})),n.d(t,"m",(function(){return d})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return g})),n.d(t,"n",(function(){return c})),n.d(t,"d",(function(){return"SmartPillClicked"})),n.d(t,"e",(function(){return"SmartPillMenuOpened"})),n.d(t,"g",(function(){return"SmartTimeMenuClicked"})),n.d(t,"a",(function(){return"SmartDocMenuClicked"})),n.d(t,"b",(function(){return"SmartDocMenuClosed"})),n.d(t,"c",(function(){return"SmartDocSpinnerDisposed"})),n.d(t,"f",(function(){return"SmartReplyMenuClicked"}))},396:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(0),o=n(14),i=n(342),a=function(){return{position:"absolute",width:1,right:31,top:8,bottom:8}};function c(e){var t,n,i,c,u,l=e.semanticColors,s=e.palette,d=l.buttonBackground,m=l.buttonBackgroundPressed,g=l.buttonBackgroundHovered,f=l.buttonText,b=l.buttonTextHovered,p=l.buttonTextChecked,h=l.buttonTextCheckedHovered;return{root:{backgroundColor:d,color:f},rootHovered:{backgroundColor:g,color:b,selectors:(t={},t[o.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},t)},rootPressed:{backgroundColor:m,color:p},rootExpanded:{backgroundColor:m,color:p},rootChecked:{backgroundColor:m,color:p},rootCheckedHovered:{backgroundColor:m,color:h},rootDisabled:{selectors:(n={},n[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},n)},splitButtonContainer:{selectors:(i={},i[o.HighContrastSelector]={border:"none"},i)},splitButtonMenuButton:{color:s.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:s.neutralLight,selectors:(c={},c[o.HighContrastSelector]={color:"Highlight"},c)}}},splitButtonMenuButtonDisabled:{backgroundColor:l.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:l.buttonBackgroundDisabled}}},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},a()),{backgroundColor:s.neutralTertiaryAlt,selectors:(u={},u[o.HighContrastSelector]={backgroundColor:"WindowText"},u)}),splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:s.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:s.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:s.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:s.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:l.buttonText},splitButtonMenuIconDisabled:{color:l.buttonTextDisabled}}}function u(e){var t,n,c,u,l,s,d,m,g,f=e.palette,b=e.semanticColors;return{root:{backgroundColor:b.primaryButtonBackground,border:"1px solid "+b.primaryButtonBackground,color:b.primaryButtonText,selectors:(t={},t[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},t["."+i.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:f.white}}},t)},rootHovered:{backgroundColor:b.primaryButtonBackgroundHovered,border:"1px solid "+b.primaryButtonBackgroundHovered,color:b.primaryButtonTextHovered,selectors:(n={},n[o.HighContrastSelector]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},n)},rootPressed:{backgroundColor:b.primaryButtonBackgroundPressed,border:"1px solid "+b.primaryButtonBackgroundPressed,color:b.primaryButtonTextPressed,selectors:(c={},c[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},c)},rootExpanded:{backgroundColor:b.primaryButtonBackgroundPressed,color:b.primaryButtonTextPressed},rootChecked:{backgroundColor:b.primaryButtonBackgroundPressed,color:b.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:b.primaryButtonBackgroundPressed,color:b.primaryButtonTextPressed},rootDisabled:{selectors:(u={},u[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},u)},splitButtonContainer:{selectors:(l={},l[o.HighContrastSelector]={border:"none"},l)},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},a()),{backgroundColor:f.white,selectors:(s={},s[o.HighContrastSelector]={backgroundColor:"Window"},s)}),splitButtonMenuButton:{backgroundColor:b.primaryButtonBackground,color:b.primaryButtonText,selectors:(d={},d[o.HighContrastSelector]={backgroundColor:"WindowText"},d[":hover"]={backgroundColor:b.primaryButtonBackgroundHovered,selectors:(m={},m[o.HighContrastSelector]={color:"Highlight"},m)},d)},splitButtonMenuButtonDisabled:{backgroundColor:b.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:b.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:b.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:b.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:b.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:b.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:b.primaryButtonText},splitButtonMenuIconDisabled:{color:f.neutralTertiary,selectors:(g={},g[o.HighContrastSelector]={color:"GrayText"},g)}}}},428:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),o={shouldEventsEndEarly:void 0,shortenEventScope:void 0,endShortEventsBy:void 0,endLongEventsBy:void 0,enableOnlineMeetingsByDefault:void 0},i=Object(r.createStore)("CalendarCloudSettings",o)},4553:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("initializeSIGSDataAction",(function(e,t,n,r,o){return{itemId:e,isSmartSuggestionsRendered:t,suggestionTypesRendered:n,suggestionsRendered:r,extractionId:o}}))},460:function(e,t,n){"use strict";var r=n(0),o=n(1),i=n(391),a=n(458),c=n(457),u=n(14),l=n(230),s=n(392),d=n(425),m=n(396),g=Object(l.c)((function(e,t,n){var r=Object(s.a)(e),o=Object(d.a)(e),i={root:{minWidth:"80px",height:"32px"},label:{fontWeight:u.FontWeights.semibold}};return Object(u.concatStyleSets)(r,i,n?Object(m.a)(e):Object(m.b)(e),o,t)}));n.d(t,"a",(function(){return f}));var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.primary,n=void 0!==t&&t,c=e.styles,u=e.theme;return o.createElement(i.a,Object(r.__assign)({},this.props,{variantClassName:n?"ms-Button--primary":"ms-Button--default",styles:g(u,c,n),onRenderDescription:a.b}))},t=Object(r.__decorate)([Object(c.a)("DefaultButton",["theme","styles"],!0)],t)}(o.Component)},470:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.EndEarly="End_Early",e.StartLate="Start_Late",e.None="None"}(r||(r={}))},4950:function(e){e.exports=JSON.parse('{"b":"pbb","a":"qbb","c":"rbb","d":"sbb"}')},538:function(e,t,n){"use strict";var r=n(191);function o(e){return Object(r.f)()&&0!==e?e<60?Object(r.c)():Object(r.b)():0}var i=n(785);function a(){var e=Object(i.a)(),t=o(e);return Math.max(e-t,0)}var c,u=n(9);function l(e,t){if(!Object(r.g)())return t;var n=o(Object(u.x)(t,e)),i=n?Object(u.ec)(t,n):t;return Object(u.Gb)(e,i)?i:t}function s(e,t){if(!Object(r.h)())return e;var n=o(Object(u.x)(t,e)),i=n?Object(u.h)(e,n):e;return Object(u.Gb)(i,t)?i:e}function d(e,t){return{start:s(e,t),end:l(e,t)}}function m(e,t,n,o){var i=Object(u.x)(t,e),a=Object(u.x)(o,n),l=60-Object(r.b)();return 0===i&&0!==a&&a<l?c.ZeroToShort:0===i&&a>=l?c.ZeroToLong:0===a&&0!==i&&i<l?c.ShortToZero:0===a&&i>=l?c.LongToZero:i<l&&a<l||i>=l&&a>=l?c.None:i<l&&a>=l?c.ShortToLong:i>=l&&a<l?c.LongToShort:null}function g(e,t,n,o,i,a){if(!Object(r.h)())return n;var l=m(e,t,n,o),s=i?n:e,d=n;return l===c.ShortToLong?d=Object(u.h)(Object(u.ec)(s,Object(r.c)()),Object(r.b)()):l===c.LongToShort?d=Object(u.h)(Object(u.ec)(s,Object(r.b)()),Object(r.c)()):l!==c.ZeroToShort||a?l!==c.ZeroToLong||a||(d=Object(u.h)(s,Object(r.b)())):d=Object(u.h)(s,Object(r.c)()),Object(u.Gb)(d,o)?d:n}function f(e,t,n,o){if(!Object(r.g)())return o;var i=m(e,t,n,o),a=o;return i===c.ShortToLong?a=Object(u.ec)(Object(u.h)(o,Object(r.c)()),Object(r.b)()):i===c.LongToShort?a=Object(u.ec)(Object(u.h)(o,Object(r.b)()),Object(r.c)()):i===c.ZeroToShort?a=Object(u.ec)(o,Object(r.c)()):i===c.ZeroToLong&&(a=Object(u.ec)(o,Object(r.b)())),Object(u.Gb)(n,a)?a:o}function b(e,t){if(!Object(r.h)())return t;var n=Object(r.c)(),o=Object(r.b)();return e>=60-o?Object(u.h)(t,o):Object(u.h)(t,n)}function p(e,t,n,r){return Object(u.Hb)(t,r)?f(e,t,n,r):l(n,r)}function h(e,t,n,r){return Object(u.Hb)(e,n)?g(e,t,n,r):s(n,r)}function S(e,t,n,r){return{start:h(e,t,n,r),end:p(e,t,n,r)}}!function(e){e[e.None=0]="None",e[e.ShortToLong=1]="ShortToLong",e[e.LongToShort=2]="LongToShort",e[e.ZeroToShort=3]="ZeroToShort",e[e.ZeroToLong=4]="ZeroToLong",e[e.ShortToZero=5]="ShortToZero",e[e.LongToZero=6]="LongToZero"}(c||(c={})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"f",(function(){return g})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"h",(function(){return S}))},5508:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return g})),n.d(t,"g",(function(){return f}));var r=n(472),o=n(83),i="Language",a="Locale",c="LanguageScores",u="@EntityId",l="EntityExtraction/ExtractLanguage1.0",s=Object(r.a)({PropertyName:l,DistinguishedPropertySetId:"Common",PropertyType:"String"}),d=Object(r.a)({PropertyName:"EntityExtraction/SmartReplyForEmail",DistinguishedPropertySetId:"Common",PropertyType:"String"}),m=Object(o.i)("mc-smartReplyWithMeeting-MeetingScheduler")?"EntityExtraction/CalendarRelated1.0":"EntityExtraction/Events1.0",g=Object(r.a)({PropertyName:m,DistinguishedPropertySetId:"Common",PropertyType:"String"}),f=Object(r.a)({PropertyName:"EntityExtraction/SendContentRequestV21.0",DistinguishedPropertySetId:"Common",PropertyType:"String"})},628:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(637),o=n(633),i=n(470);function a(){var e=Object(r.a)();return e?e===i.a.EndEarly:Object(o.a)()}},629:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(637),o=n(470);function i(){return Object(r.a)()===o.a.StartLate}},632:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(428);function o(){return Object(r.a)().enableOnlineMeetingsByDefault}},633:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(634),o=n(83),i=!1;function a(){if(!Object(o.i)("cal-mf-shouldEventsEndEarlySetting"))return!1;var e=Object(r.a)();return null!=e?e:i}},634:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(428);function o(){return Object(r.a)().shouldEventsEndEarly}},635:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(428);function o(){return Object(r.a)().shortenEventScope}},637:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(470),o=n(635),i=n(83),a=r.a.None;function c(){if(!Object(i.i)("cal-mf-shortenEventsDuration"))return null;var e=Object(o.a)();return null!=e?e:a}},7087:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n(0),o=n(269),i=n(1323),a=n(59),c=4e3;function u(e){var t,n;if(e.SIGSData&&e.SIGSData.SmartPillData){var r=e.SIGSData.SmartPillData,i=r.IsSmartSuggestionsRendered,u=r.SuggestionTypesRendered,l=r.SuggestionsRendered,s=r.ExtractionId,d=e.InternetMessageId,m=(null===(t=e.UniqueBody)||void 0===t?void 0:t.Value)||(null===(n=e.NormalizedBody)||void 0===n?void 0:n.Value);if(m&&(m=m.substring(0,c)),"True"===i){var g={InternetMessageId:d,MessageBody:m,SuggestionTypesRendered:u,SuggestionsRendered:l,ExtractionId:s};return o.m.importAndExecute("SmartSuggestionsRendered",{compliance:"CustomerContent",customProperties:g}),!0}}else a.g.warn("SIGSData object not initialized on item.");return!1}function l(e,t,n){var u,l,s;try{if(e){var d=Object(i.g)().items.get(e);if(null===(u=null==d?void 0:d.SIGSData)||void 0===u?void 0:u.SmartPillData){var m=d.InternetMessageId,g=(null===(l=d.NormalizedBody)||void 0===l?void 0:l.Value)||(null===(s=d.UniqueBody)||void 0===s?void 0:s.Value);g&&(g=g.substring(0,c));var f=t.substring(0,c);o.m.importAndExecute("SmartSuggestionsClicked",{compliance:"CustomerContent",customProperties:Object(r.__assign)(Object(r.__assign)({InternetMessageId:m,MessageBody:g},d.SIGSData.SmartPillData),{IsSmartSuggestionsClicked:n&&n.isSmartSuggestionsClicked?"True":"False",SuggestionsClickedTime:null==n?void 0:n.suggestionsClickedTime,ClickIndex:n&&n.clickIndex.toString(),ReplyBody:f})})}}}catch(e){a.d("[logToSIGSOnMessageSent] Error: "+e.message)}}},768:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(628),o=n(629);function i(){return Object(o.a)()||Object(r.a)()}},769:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(632),o=n(83),i=!1;function a(){if(!Object(o.i)("cal-mf-enableDefaultOnlineMeetingSetting"))return!1;var e=Object(r.a)();return null!=e?e:i}},8900:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(77),o=new r.c((function(){return n.e(906).then(n.bind(null,10897))})),i=(Object(r.d)(o,(function(e){return e.SmartPill})),Object(r.d)(o,(function(e){return e.SmartPillBlock})))},947:function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}}}]);
//# sourceMappingURL=owa.MailBoot~MailSmartPill.js.map
self.scriptsLoaded['owa.MailBoot~MailSmartPill.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailSmartPill.js'] = (new Date()).getTime();