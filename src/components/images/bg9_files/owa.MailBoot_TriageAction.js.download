self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~TriageAction.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[764],{112:function(e,t,n){"use strict";var r,i,a,o;n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c})),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(r||(r={})),function(e){e[e.January=0]="January",e[e.February=1]="February",e[e.March=2]="March",e[e.April=3]="April",e[e.May=4]="May",e[e.June=5]="June",e[e.July=6]="July",e[e.August=7]="August",e[e.September=8]="September",e[e.October=9]="October",e[e.November=10]="November",e[e.December=11]="December"}(i||(i={})),function(e){e[e.FirstDay=0]="FirstDay",e[e.FirstFullWeek=1]="FirstFullWeek",e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(a||(a={})),function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.WorkWeek=3]="WorkWeek"}(o||(o={}));var c=7},11887:function(e){e.exports=JSON.parse('{"a":"ODb","b":"PDb","c":"QDb","d":"RDb"}')},11888:function(e){e.exports=JSON.parse('{"a":"wEb","b":"xEb","c":"yEb","d":"zEb"}')},11889:function(e){e.exports=JSON.parse('{"a":"cGb","b":"dGb"}')},11890:function(e){e.exports=JSON.parse('{"a":"aGb","b":"bGb"}')},11891:function(e){e.exports=JSON.parse('{"a":"$Fb"}')},11892:function(e){e.exports=JSON.parse('{"b":"EFb","a":"FFb"}')},11893:function(e){e.exports=JSON.parse('{"a":"GFb"}')},11894:function(e){e.exports=JSON.parse('{"a":"zFb","b":"AFb"}')},11895:function(e){e.exports=JSON.parse('{"a":"$Eb","b":"aFb","c":"bFb","d":"cFb"}')},11896:function(e){e.exports=JSON.parse('{"b":"jFb","a":"kFb"}')},11897:function(e){e.exports=JSON.parse('{"a":"fFb","c":"gFb","b":"hFb","d":"iFb"}')},11898:function(e){e.exports=JSON.parse('{"h":"HFb","t":"IFb","p":"JFb","e":"KFb","l":"LFb","g":"MFb","s":"NFb","o":"OFb","d":"PFb","k":"QFb","f":"RFb","r":"SFb","n":"TFb","c":"UFb","j":"VFb","a":"WFb","q":"XFb","m":"YFb","b":"ZFb","i":"_Fb"}')},11899:function(e){e.exports=JSON.parse('{"b":"BFb","a":"CFb"}')},119:function(e,t,n){"use strict";var r=n(4),i=n(2);function a(){return!!Object(r.d)("hostApp",window.location)&&Object(r.a)("hostApp").toLowerCase()==i.e}var o,c=n(187);function u(){return Object(c.b)()||Object(r.d)("hostApp",window.location)||a()}function s(){return u()&&Object(i.u)()===i.e}!function(e){e[e.AddIns=0]="AddIns",e[e.ComposeFormHeader=1]="ComposeFormHeader",e[e.DiscardInFullCompose=2]="DiscardInFullCompose",e[e.SaveInFullCompose=3]="SaveInFullCompose",e[e.SchedulingAssistant=4]="SchedulingAssistant",e[e.Settings=5]="Settings",e[e.MultiAccounts=6]="MultiAccounts"}(o||(o={})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return c.a})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return s}))},11900:function(e){e.exports=JSON.parse('{"b":"pFb","a":"qFb","c":"rFb","d":"sFb"}')},11901:function(e){e.exports=JSON.parse('{"b":"nFb","a":"oFb"}')},11902:function(e){e.exports=JSON.parse('{"b":"lFb","a":"mFb"}')},11903:function(e){e.exports=JSON.parse('{"b":"tFb","c":"uFb","e":"vFb","f":"wFb","a":"xFb","d":"yFb"}')},11904:function(e){e.exports=JSON.parse('{"a":"qEb","b":"rEb"}')},1245:function(e,t,n){"use strict";var r=n(450),i=n(744),a=n(0),o=n(14),c=n(342),u={root:"ms-Checkbox",label:"ms-Checkbox-label",checkbox:"ms-Checkbox-checkbox",checkmark:"ms-Checkbox-checkmark",text:"ms-Checkbox-text"};n.d(t,"a",(function(){return s}));var s=Object(r.a)(i.a,(function(e){var t,n,r,i,s,d,l,b,f,v,O,m,j,p,h,k,g,y,I=e.className,S=e.theme,w=e.reversed,C=e.checked,_=e.disabled,T=e.isUsingCustomLabelRender,N=e.indeterminate,F=S.semanticColors,A=S.effects,x=S.palette,E=S.fonts,R=Object(o.getGlobalClassNames)(u,S),M=F.inputForegroundChecked,D=x.neutralSecondary,V=x.neutralPrimary,P=F.inputBackgroundChecked,B=F.inputBackgroundChecked,L=F.disabledBodySubtext,U=F.inputBorderHovered,W=F.inputBackgroundCheckedHovered,K=F.inputBackgroundChecked,J=F.inputBackgroundCheckedHovered,H=F.inputBackgroundCheckedHovered,Q=F.inputTextHovered,G=F.disabledBodySubtext,q=F.bodyText,z=F.disabledText,X=[(t={content:'""',borderRadius:A.roundedCorner2,position:"absolute",width:10,height:10,top:4,left:4,boxSizing:"border-box",borderWidth:5,borderStyle:"solid",borderColor:_?L:P,transitionProperty:"border-width, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)"},t[o.HighContrastSelector]={borderColor:"WindowText"},t)];return{root:[R.root,{position:"relative",display:"flex"},w&&"reversed",C&&"is-checked",!_&&"is-enabled",_&&"is-disabled",!_&&[!C&&(n={},n[":hover ."+R.checkbox]=(r={borderColor:U},r[o.HighContrastSelector]={borderColor:"Highlight"},r),n[":focus ."+R.checkbox]={borderColor:U},n[":hover ."+R.checkmark]=(i={color:D,opacity:"1"},i[o.HighContrastSelector]={color:"Highlight"},i),n),C&&!N&&(s={},s[":hover ."+R.checkbox]={background:J,borderColor:H},s[":focus ."+R.checkbox]={background:J,borderColor:H},s[o.HighContrastSelector]=(d={},d[":hover ."+R.checkbox]={background:"Highlight",borderColor:"Highlight"},d[":focus ."+R.checkbox]={background:"Highlight"},d[":focus:hover ."+R.checkbox]={background:"Highlight"},d[":focus:hover ."+R.checkmark]={color:"Window"},d[":hover ."+R.checkmark]={color:"Window"},d),s),N&&(l={},l[":hover ."+R.checkbox+", :hover ."+R.checkbox+":after"]=(b={borderColor:W},b[o.HighContrastSelector]={borderColor:"WindowText"},b),l[":focus ."+R.checkbox]={borderColor:W},l[":hover ."+R.checkmark]={opacity:"0"},l),(f={},f[":hover ."+R.text+", :focus ."+R.text]=(v={color:Q},v[o.HighContrastSelector]={color:_?"GrayText":"WindowText"},v),f)],I],input:(O={position:"absolute",background:"none",opacity:0},O["."+c.a+" &:focus + label::before"]=(m={outline:"1px solid "+S.palette.neutralSecondary,outlineOffset:"2px"},m[o.HighContrastSelector]={outline:"1px solid ActiveBorder"},m),O),label:[R.label,S.fonts.medium,{display:"flex",alignItems:T?"center":"flex-start",cursor:_?"default":"pointer",position:"relative",userSelect:"none"},w&&{flexDirection:"row-reverse",justifyContent:"flex-end"},{"&::before":{position:"absolute",left:0,right:0,top:0,bottom:0,content:'""',pointerEvents:"none"}}],checkbox:[R.checkbox,Object(a.__assign)((j={position:"relative",display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:"20px",width:"20px",border:"1px solid "+V,borderRadius:A.roundedCorner2,boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)",overflow:"hidden",":after":N?X:null},j[o.HighContrastSelector]={borderColor:"WindowText"},j),Object(o.getEdgeChromiumNoHighContrastAdjustSelector)()),N&&{borderColor:P},w?{marginLeft:4}:{marginRight:4},!_&&!N&&C&&(p={background:K,borderColor:B},p[o.HighContrastSelector]={background:"Highlight",borderColor:"Highlight"},p),_&&(h={borderColor:L},h[o.HighContrastSelector]={borderColor:"GrayText"},h),C&&_&&(k={background:G,borderColor:L},k[o.HighContrastSelector]={background:"Window"},k)],checkmark:[R.checkmark,(g={opacity:C?"1":"0",color:M},g[o.HighContrastSelector]={color:_?"GrayText":"Window",MsHighContrastAdjust:"none"},g)],text:[R.text,Object(a.__assign)((y={color:_?z:q,fontSize:E.medium.fontSize,lineHeight:"20px"},y[o.HighContrastSelector]={color:_?"GrayText":"WindowText"},y),Object(o.getEdgeChromiumNoHighContrastAdjustSelector)()),w?{marginRight:4}:{marginLeft:4}]}}),void 0,{scope:"Checkbox"})},136:function(e,t,n){"use strict";var r=n(112),i={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,SecondsInOneMinute:60,DaysInOneWeek:7,AllDaysOfWeek:[r.c.Sunday,r.c.Monday,r.c.Tuesday,r.c.Wednesday,r.c.Thursday,r.c.Friday,r.c.Saturday]};t.a=i},1382:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"TargetFolderId:#Exchange"},e)}},1404:function(e,t,n){"use strict";var r=n(0),i=n(20),a=n(3),o=n(2357);function c(e){return Math.floor(Math.random()*e+1)}var u=n(2358);n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return f}));var s=4,d=8,l={toDate:null,fromDate:null,includeAttachments:!1,initialSearchScope:null,isSearchHistoryDirty:!1,isAnswerInitialized:!1,isAnswerLocalizationCompleted:!1,isUnread:!1,previousNode:null,searchNumber:0,staticSearchScope:null,staticSearchScopeList:null,shouldShowAdvancedSearch:!1,shouldShowTimeFilterCallout:!1,advancedSearchViewState:Object(o.a)(),initialAdvancedSearchViewState:Object(o.a)(),legacySuggestions:new i.ObservableMap({}),recipientForPersonalizedGhostTextIndex:c(u.a-1),generalizedGhostTextBankIndex:c(s-1),personalizedGhostTextBankIndex:c(d-1),usePersonalGhostText:!1},b=Object(r.__assign)({},l),f=Object(a.createStore)("mailSearchStore",b),v=f();t.c=v},1423:function(e,t,n){"use strict";n.d(t,"k",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return f})),n.d(t,"l",(function(){return v})),n.d(t,"n",(function(){return O})),n.d(t,"h",(function(){return m})),n.d(t,"f",(function(){return j})),n.d(t,"g",(function(){return p})),n.d(t,"e",(function(){return h})),n.d(t,"m",(function(){return k})),n.d(t,"i",(function(){return g})),n.d(t,"j",(function(){return y}));var r=n(77),i=n(1896),a=n(1787),o=n(1897),c=n(1914),u=new r.c((function(){return Promise.all([n.e(1),n.e(5),n.e(6),n.e(7),n.e(8),n.e(11),n.e(13),n.e(14),n.e(16),n.e(18),n.e(21),n.e(19),n.e(29),n.e(37),n.e(40),n.e(43),n.e(45),n.e(50),n.e(49),n.e(54),n.e(64),n.e(69),n.e(82),n.e(100),n.e(827)]).then(n.bind(null,3822))})),s=new r.c((function(){return Promise.all([n.e(1),n.e(6),n.e(14),n.e(16),n.e(18),n.e(25),n.e(24),n.e(27),n.e(31),n.e(33),n.e(40),n.e(42),n.e(43),n.e(45),n.e(49),n.e(55),n.e(56),n.e(58),n.e(62),n.e(63),n.e(67),n.e(175),n.e(257),n.e(631)]).then(n.bind(null,3829))})),d=Object(r.d)(u,(function(e){return e.SearchHeaderFirstRowContent})),l=Object(r.d)(u,(function(e){return e.SearchFiltersContainer})),b=Object(r.d)(u,(function(e){return e.AdvancedSearchWrapper})),f=Object(r.d)(u,(function(e){return e.FolderScopePicker})),v=new r.b(u,(function(e){return e.setStaticSearchScopeData})),O=new r.b(u,(function(e){return e.startSearchWithCategory})),m=new r.a(u,(function(e){return e.findEmailFromSender})),j=(new r.b(u,(function(e){return e.initializeLivePersonaCard})),new r.b(u,(function(e){return e.personaControlStore})),new r.b(u,(function(e){return e.createFallbackPersonaSearchTableQuery}))),p=new r.b(u,(function(e){return e.createFallbackPrivateDistributionListSearchTableQuery})),h=new r.b(u,(function(e){return e.createFallbackCategorySearchTableQuery})),k=new r.b(u,(function(e){return e.shouldShowInScopeSelector}));Object(r.f)(i.a,u,(function(e){return e.getSuggestionsOrchestrator})),Object(r.f)(a.a,u,(function(e){return e.searchSessionStartedOrchestrator})),Object(r.f)(o.a,u,(function(e){return e.startSearchOrchestrator}),{captureBundleTime:!0}),Object(r.f)(c.a,s,(function(e){return e.startAnswerSearchSessionOrchestrator}));var g=new r.b(u,(function(e){return e.getNaturalLanguageGhostText})),y=new r.a(u,(function(e){return e.initializeSearch}))},1431:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return d}));var r=n(1814),i=n(30),a=n(1494);function o(){return s(r.a.Bottom)}function c(){return s(r.a.Off)}function u(){return s(r.a.Right)}function s(e){var t=Object(a.a)();return null!==t.clientReadingPanePosition?t.clientReadingPanePosition===e:Object(i.a)().UserOptions.GlobalReadingPanePositionReact==e}function d(){var e=Object(i.a)().UserOptions.GlobalReadingPanePositionReact;return e==r.a.Off||e==r.a.Bottom}},1461:function(e,t,n){"use strict";n.d(t,"q",(function(){return a})),n.d(t,"y",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"t",(function(){return u})),n.d(t,"w",(function(){return s})),n.d(t,"x",(function(){return d})),n.d(t,"v",(function(){return l})),n.d(t,"u",(function(){return b})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return v})),n.d(t,"h",(function(){return O})),n.d(t,"m",(function(){return m})),n.d(t,"z",(function(){return j})),n.d(t,"j",(function(){return p})),n.d(t,"r",(function(){return h})),n.d(t,"s",(function(){return k})),n.d(t,"a",(function(){return g})),n.d(t,"l",(function(){return y})),n.d(t,"p",(function(){return I})),n.d(t,"i",(function(){return S})),n.d(t,"b",(function(){return w})),n.d(t,"n",(function(){return C})),n.d(t,"c",(function(){return _})),n.d(t,"g",(function(){return T})),n.d(t,"o",(function(){return N})),n.d(t,"k",(function(){return F}));var r=n(77),i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(6),n.e(8),n.e(14),n.e(19),n.e(24),n.e(28),n.e(41),n.e(61),n.e(80),n.e(120),n.e(115),n.e(119),n.e(148),n.e(208),n.e(457)]).then(n.bind(null,3226))})),a=new r.b(i,(function(e){return e.removeExtensibilityNotification})),o=new r.b(i,(function(e){return e.updatePersistentNotifications})),c=new r.b(i,(function(e){return e.closeTaskPaneAddinCommand})),u=new r.b(i,(function(e){return e.triggerAppointmentTimeChangedEvent})),s=new r.b(i,(function(e){return e.triggerRecipientsChangedEvent})),d=new r.b(i,(function(e){return e.triggerRecurrenceChangedEvent})),l=new r.b(i,(function(e){return e.triggerLocationsChangedEvent})),b=new r.b(i,(function(e){return e.triggerAttachmentsChangedEvent})),f=new r.b(i,(function(e){return e.deinitializeAddinsForItem})),v=new r.b(i,(function(e){return e.initializeAddinsForItem})),O=new r.a(i,(function(e){return e.initializeExtensibilityContext})),m=new r.b(i,(function(e){return e.onHostItemChanged})),j=new r.b(i,(function(e){return e.whenItemHasContextualAddinKeywords})),p=new r.b(i,(function(e){return e.launchTranslateCommand})),h=new r.b(i,(function(e){return e.setPersistedAddin})),k=new r.b(i,(function(e){return e.shouldForceOnSendCompliantBehavior})),g=(Object(r.d)(i,(function(e){return e.AddinBarView})),Object(r.d)(i,(function(e){return e.TaskPaneCollection}))),y=new r.b(i,(function(e){return e.onComposeClose})),I=new r.b(i,(function(e){return e.openContextualCallout})),S=new r.b(i,(function(e){return e.launchAddinCommand})),w=new r.b(i,(function(e){return e.observeAddinCommandSurfaceItems})),C=new r.b(i,(function(e){return e.onItemNavigation})),_=new r.b(i,(function(e){return e.allowItemSendEvent})),T=new r.a(i,(function(e){return e.ExecuteEntryPoint})),N=new r.a(i,(function(e){return e.onLaunchEventTriggered})),F=new r.a(i,(function(e){return e.logAppTeachingUICalloutTelemetry}))},1494:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.createStore)("maillayout",{clientReadingPanePosition:null,showReadingPane:!1,showListPane:!0,showFolderPane:!0})},1523:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var r,i=n(119),a=n(96);function o(){var e,t,n=d();return s()&&n?r.ToDo:(t=Object(a.h)(),(null===(e=t.SessionSettings)||void 0===e?void 0:e.IsShadowMailbox)||n?r.None:r.LegacyTasks)}function c(){return s()&&d()}function u(){return s()&&d(!0)}function s(){var e,t,n=Object(a.h)(),r=!Object(i.d)()&&(null===(e=n.SessionSettings)||void 0===e?void 0:e.IsExplicitLogon),o=null===(t=n.SessionSettings)||void 0===t?void 0:t.IsShadowMailbox;return!r&&!o}function d(e){var t=Object(a.h)(),n=t.UserOptions,r=t.PolicySettings;return!!((null==n?void 0:n.ReactOptinSettings)&&(n.ReactOptinSettings.TasksGraduatedFromBeta||n.ReactOptinSettings.TasksEnabled&&(e||function(e){var t;return(null===(t=null==e?void 0:e.ReactOptinSettings)||void 0===t?void 0:t.TasksShouldUseSharedToggle)?1!==e.ClientTypeOptInState:1!==e.TasksClientTypeOptInState}(n))&&function(e){if(e&&!1===e.OutlookBetaToggleEnabled)return!1;return!0}(r))&&null!==n.ReactOptinSettings.TasksRedirectUrl)}!function(e){e[e.None=0]="None",e[e.LegacyTasks=1]="LegacyTasks",e[e.ToDo=2]="ToDo"}(r||(r={}))},1531:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return d}));var r=n(3),i=Object(r.action)("CLEAR_SEARCH_SCOPE",(function(e,t,n){return{actionSource:e,shouldStartSearch:t,searchScopeKind:n}})),a=Object(r.action)("LOAD_MESSAGE_SUGGESTION_INTO_TABLE",(function(e,t,n,r,i,a){return{actionSource:e,row:t,searchTableQuery:n,referenceId:r,traceId:i,itemPartId:a}})),o=Object(r.action)("LOAD_TABLE_VIEW_FROM_SEARCH_TABLE_QUERY",(function(e,t,n){return{searchTableQuery:e,searchEndToEndPerformanceDatapoint:t,actionSource:n}})),c=Object(r.action)("SET_STATIC_SEARCH_SCOPE",(function(e){return{searchScope:e}})),u=Object(r.action)("START_SEARCH_WITH_CATEGORY",(function(e,t){return{actionSource:e,categoryName:t}})),s=Object(r.action)("FIND_EMAIL_FROM_SENDER_CLICKED",(function(e,t){return{senderName:e,senderEmail:t}})),d=Object(r.action)("ON_ANSWER_RENDERED")},1538:function(e,t,n){"use strict";var r=n(77),i={sequentialIndex:"0",nonSequentialIndex:"-1"};n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return i}));var a=new r.c((function(){return n.e(817).then(n.bind(null,16995))})),o=new r.a(a,(function(e){return e.registerComponent})),c=new r.a(a,(function(e){return e.resetFocus})),u=new r.a(a,(function(e){return e.setFocusToSynchronous}))},1590:function(e,t,n){"use strict";var r=n(1762),i=n(77),a=n(1600);function o(){var e=Object(a.a)();return{isFullOptionsShown:e.isFullOptionsShown,areAllAllowedSubCategoriesLoaded:e.areAllAllowedSubCategoriesLoaded,currentCategoryKey:e.currentCategoryKey,currentSubCategoryKey:e.currentSubCategoryKey,currentOptionKey:e.currentOptionKey}}n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return o}));var c=new i.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5),n.e(6),n.e(7),n.e(8),n.e(11),n.e(13),n.e(14),n.e(16),n.e(18),n.e(21),n.e(19),n.e(26),n.e(27),n.e(29),n.e(28),n.e(37),n.e(41),n.e(50),n.e(54),n.e(845)]).then(n.bind(null,16869))})),u=new i.a(c,(function(e){return e.mountAndShowFullOptions})),s=new i.b(c,(function(e){return e.hideFullOptions})),d=new i.b(c,(function(e){return e.confirmDirtyOptionsAndPerformAction})),l=new i.b(c,(function(e){return e.exitOptionsFullPage})),b=Object(i.d)(c,(function(e){return e.QuickOptions}));Object(i.f)(r.a,c,(function(e){return e.mountFullOptionsOrchestrator}))},1600:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3),i=n(20),a=Object(r.createStore)("optionsViewState",{isFullOptionsShown:!1,areAllAllowedSubCategoriesLoaded:!1,isSaving:!1,currentCategoryKey:null,currentSubCategoryKey:null,subCategoryLoadState:new i.ObservableMap,currentOptionKey:null,allowedOptions:[]})},1644:function(e,t,n){"use strict";var r=n(0),i=n(2105),a=n(3);var o=Object(a.mutatorAction)("removeInfoBarMessages",(function(e,t){e&&(Array.isArray(t)?t:t?[t]:e.infoBarIds?Object(r.__spread)(e.infoBarIds):[]).forEach((function(t){return function(e,t){var n=e.infoBarIds&&e.infoBarIds.indexOf(t);n>=0&&e.infoBarIds.splice(n,1);var r=e.infoBarHostKey;i.b[r]&&(delete i.b[r][t],0===Object.keys(i.b[r]).length&&delete i.b[r])}(e,t)}))}));t.a=o},1659:function(e,t,n){"use strict";var r=n(77),i=n(2061),a=n(1404),o=n(1531);function c(e){var t=e.tableQuery;return 0===t.type?t.folderId:function(e){if(1!=e.type)return!1;var t=e.searchScope;return["PrimaryMailbox","ArchiveMailbox","SharedFolders"].indexOf(t.kind)>-1}(t)?t.searchScope.folderId:null}var u=n(1994),s=n(1963),d=n(1423);n.d(t,"a",(function(){return b})),n.d(t,"m",(function(){return f})),n.d(t,"c",(function(){return i.b})),n.d(t,"q",(function(){return a.c})),n.d(t,"i",(function(){return a.e})),n.d(t,"f",(function(){return o.a})),n.d(t,"s",(function(){return o.f})),n.d(t,"r",(function(){return o.e})),n.d(t,"g",(function(){return c})),n.d(t,"j",(function(){return u.a})),n.d(t,"h",(function(){return s.a})),n.d(t,"n",(function(){return d.k})),n.d(t,"e",(function(){return d.d})),n.d(t,"d",(function(){return d.c})),n.d(t,"b",(function(){return d.b})),n.d(t,"o",(function(){return d.l})),n.d(t,"p",(function(){return d.n})),n.d(t,"k",(function(){return d.h})),n.d(t,"l",(function(){return d.j}));var l=new r.c((function(){return Promise.all([n.e(1),n.e(6),n.e(14),n.e(16),n.e(18),n.e(25),n.e(24),n.e(27),n.e(31),n.e(33),n.e(40),n.e(42),n.e(43),n.e(45),n.e(49),n.e(55),n.e(56),n.e(58),n.e(62),n.e(63),n.e(67),n.e(175),n.e(257),n.e(631)]).then(n.bind(null,3829))})),b=Object(r.d)(l,(function(e){return e.AnswersContainer})),f=new r.a(l,(function(e){return e.initializeAndWarmupAnswers}))},1676:function(e,t,n){"use strict";function r(e,t){var n=Math.pow(2,32);if(e>=n||t>=n){var r=e%n,i=t%n;return(((e-=r)/n&(t-=i)/n)>>>0)*n+((r&i)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},1739:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"Message:#Exchange"},e)}},1762:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("mountFullOptions",(function(e,t,n){return{category:e,subcategory:t,option:n}}))},1787:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("SEARCH_SESSION_STARTED",(function(e,t,n){return{actionSource:e,shouldStartSearch:t,scenarioId:n}}))},1814:function(e,t,n){"use strict";var r;!function(e){e[e.Off=0]="Off",e[e.Right=1]="Right",e[e.Bottom=2]="Bottom"}(r||(r={})),t.a=r},1815:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r=1,i=16},1828:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1494);function i(){return Object(r.a)().showReadingPane}},1829:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Keywords=0]="Keywords",e[e.People=1]="People",e[e.PrivateDistributionList=2]="PrivateDistributionList",e[e.File=3]="File",e[e.Category=4]="Category",e[e.Message=5]="Message",e[e.Event=6]="Event",e[e.TrySuggestion=7]="TrySuggestion",e[e.Setting=8]="Setting"}(r||(r={}))},1866:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemChange:#Exchange"},e)}},187:function(e,t,n){"use strict";var r;function i(){if(!r)throw new Error("OpxHostApi has not been initialized yet.");return r}function a(){return!!r}function o(e){r=e}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o}))},1881:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1431),i=n(1828);function a(){return Object(r.c)()&&Object(i.a)()}},1896:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3),i=n(74),a=Object(r.action)("GET_SUGGESTIONS",(function(e){return Object(i.c)({name:"Search_SuggestionsE2E"},{scenarioId:e})}))},1897:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("START_SEARCH",(function(e,t,n,r,i,a){return void 0===n&&(n=!1),void 0===r&&(r=[]),void 0===a&&(a="All"),{actionSource:e,scenarioId:t,explicitSearch:n,connectedAccountInfo:r,searchProvider:i,filter:a}}))},1914:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("START_SEARCH_SESSION",(function(e,t,n){return{actionSource:e,shouldStartSearch:t,scenarioId:n}}))},1944:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"SetItemField:#Exchange"},e)}},1963:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1404),i=n(83),a=n(2062),o=n(96),c=n(1325),u=n(1368);function s(){var e=Object(r.e)().staticSearchScope,t=null==e?void 0:e.kind;if(Object(o.h)().SessionSettings.IsExplicitLogon)return"ArchiveMailbox"===t?2:1;if("PrimaryMailbox"===t)return Object(a.a)()?0:1;if("ArchiveMailbox"===t){var n=Object(u.a)(e.folderId);return Object(i.i)("sea-archive-mailbox-3S")&&Object(a.a)()&&n==c.d?0:1}return"Group"===t?1:"SharedFolders"===t?2:null}},1986:function(e,t,n){"use strict";var r=n(29),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",e,t)}n.d(t,"a",(function(){return a}))},1994:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(83),i=n(2062),a=n(368);function o(){return Object(i.a)()&&(Object(r.i)("sea-fetchPeople")||Object(r.i)("sea-fetchEvents")||Object(r.i)("sea-calendarTriggerControl")||Object(r.i)("sea-fetchFlights")||Object(r.i)("sea-flightTriggerControl")||Object(r.i)("sea-fetchFiles3")||Object(r.i)("sea-fileTriggerControl3")||Object(r.i)("sea-peopleTriggerControl"))||Object(i.a)()&&Object(a.a)()&&(Object(r.i)("sea-fetchBookmarks")||Object(r.i)("sea-bookmarkTriggerControl")||Object(r.i)("sea-fetchAcronyms")||Object(r.i)("sea-fetchLinks")||Object(r.i)("sea-linkTriggerControl")||Object(r.i)("sea-acronymTriggerControl"))}},2010:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"UpdateItemRequest:#Exchange"},e)}},2061:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(1829),i=[r.a.File,r.a.People,r.a.Keywords],a=[r.a.File,r.a.People,r.a.Keywords,r.a.Message,r.a.Event,r.a.Category,r.a.TrySuggestion,r.a.Setting]},2062:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(30);function i(){return Object(r.a)().SessionSettings.IsSubstrateSearchServiceAvailable}},2105:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r={};function i(e,t){var n,i=e.infoBarHostKey;return null===(n=r[i])||void 0===n?void 0:n[t]}},2134:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(30);function i(){var e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},2175:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("updateMailtips",(function(e,t,n){return{composeId:e,fromEmailAddress:t,recipients:n}}))},2275:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("onMailTipRetrieved",(function(e,t){return{composeId:e,fromAddress:t}}))},2288:function(e,t,n){"use strict";var r=n(319),i=n(29),a=n(0);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"GetMailTipsJsonRequest:#Exchange"},n)),Object(i.a)("GetMailTips",e,t)}var c=n(440),u=n(295);function s(e,t){var n,i=Object(c.a)(Object(u.d)(e));return o({Header:Object(r.b)(),Body:(n={MailTipsRequested:1,SendingAs:{EmailAddress:e},Recipients:t.map((function(e){return{EmailAddress:e}}))},Object(a.__assign)({__type:"GetMailTipsRequest:#Exchange"},n))},i).then((function(e){return(null==e?void 0:e.Body)&&"Success"==e.Body.ResponseClass?e.Body:null})).catch((function(e){return Promise.resolve(null)}))}n.d(t,"a",(function(){return s}))},2293:function(e,t,n){"use strict";var r;!function(e){e.CustomMailTip="CustomMailTip",e.DeliveryRestricted="DeliveryRestricted",e.ExternalMemberCount="ExternalMemberCount",e.GuestMailTipStatus="GuestMailTipStatus",e.IsModerated="IsModerated",e.MailboxFull="MailboxFull",e.MaxMessageSize="MaxMessageSize",e.OutOfOffice="OutOfOffice",e.PreferAccessibleContent="PreferAccessibleContent",e.RecipientAddress="RecipientAddress",e.TotalMemberCount="TotalMemberCount"}(r||(r={}));var i=r,a=n(2378);n.d(t,"a",(function(){return u}));var o=/<!--((.|\n)*?)-->/gi,c=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t};function u(e){if(!e)return null;var t=(new DOMParser).parseFromString(e,"text/xml").firstChild.childNodes;return c(t).reduce((function(e,t){switch(t.localName){case i.RecipientAddress:t.childNodes.length>1&&(e.RecipientAddress=t.childNodes[1].textContent);break;case i.MailboxFull:e.MailboxFull="true"===t.textContent;break;case i.IsModerated:e.IsModerated="true"===t.textContent;break;case i.TotalMemberCount:e.TotalMemberCount=parseInt(t.textContent)||0;break;case i.ExternalMemberCount:e.ExternalMemberCount=parseInt(t.textContent)||0;break;case i.MaxMessageSize:e.MaxMessageSize=parseInt(t.textContent)||0;break;case i.DeliveryRestricted:e.DeliveryRestricted="true"===t.textContent;break;case i.PreferAccessibleContent:e.PreferAccessibleContent="true"===t.textContent;break;case i.OutOfOffice:e.OutOfOffice=s(t);break;case i.CustomMailTip:e.CustomMailTip=b(t);break;case i.GuestMailTipStatus:e.GuestStatus=l(t.textContent)}return e}),{})}var s=function(e){return e.childNodes?b(c(e.childNodes).filter((function(e){return"ReplyBody"===e.localName}))[0]):""},d=function(e){return e.replace(o,"")},l=function(e){var t=e.split(" "),n=a.a.None;return t.map((function(e){n|=a.a[e]})),n};function b(e){var t;if(e){var n=d(e.textContent).replace(/<\/a>/gi,"</a> "),r=(new DOMParser).parseFromString(n,"text/html");if((null===(t=null==r?void 0:r.childNodes)||void 0===t?void 0:t.length)&&r.childNodes[0].textContent)return r.childNodes[0].textContent.replace(/\s\s+/g," ").trim()}return""}},2299:function(e,t,n){"use strict";var r=n(2650);t.a=function(e){var t=function(e){var t;return(null===(t=null==e?void 0:e.Attachments)||void 0===t?void 0:t.length)&&e.Attachments[0]}(e);return Object(r.a)(t)?t:null}},2355:function(e){e.exports=JSON.parse('{"a":"iKa"}')},2357:function(e,t,n){"use strict";function r(){return{selectedSearchScope:null,subjectFieldText:"",keywordsFieldText:"",fromDate:null,toDate:null,hasAttachments:null,fromPeopleSuggestions:[],toPeopleSuggestions:[],ccPeopleSuggestions:[]}}n.d(t,"a",(function(){return r}))},2358:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=10},2378:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.IsCalculated=1]="IsCalculated",e[e.GuestsEnabled=2]="GuestsEnabled",e[e.GroupHasGuests=4]="GroupHasGuests"}(r||(r={}))},2453:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ApplyConversationActionRequest:#Exchange"},e)}},2454:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ConversationAction:#Exchange"},e)}},2482:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("EMPTY_FOLDER_STORE_UPDATE",(function(e,t,n,r){return{folder:e,clientLastSyncTime:t,deletedItemsFolderId:n,rowKeysToExclude:r}}))},2562:function(e,t,n){"use strict";var r=n(29),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"ApplyConversationActionJsonRequest:#Exchange"},n)),Object(r.a)("ApplyConversationAction",e,t)}n.d(t,"a",(function(){return a}))},2649:function(e,t,n){"use strict";function r(e){var t=e?e.RightsManagementLicenseData:null,n={ReplyAllowed:!0,ReplyAllAllowed:!0,ForwardAllowed:!0,PrintAllowed:!0,CopyAllowed:!0};!t||t.RightsManagedMessageDecryptionStatus&&0!=t.RightsManagedMessageDecryptionStatus||(n={ReplyAllowed:t.ReplyAllowed,ReplyAllAllowed:t.ReplyAllAllowed,ForwardAllowed:t.ForwardAllowed,PrintAllowed:t.PrintAllowed,CopyAllowed:t.ExtractAllowed});var r=e,i=null==r?void 0:r.DoNotForwardMeeting;return n.ForwardAllowed=n.ForwardAllowed&&!i,n}n.d(t,"a",(function(){return r}))},2650:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1592),i=function(e,t){return e.substring(0,t.length)===t},a=function(e,t){return e.substring(e.length-t.length)===t},o=function(e){return e.ContentType&&(i(e.ContentType,r.v)||i(e.ContentType,r.l))},c=function(e){return e.ContentType&&e.ContentType===r.j};function u(e){return(null==e?void 0:e.Name)&&a(e.Name,r.t)&&(o(e)||c(e))}},2769:function(e,t,n){"use strict";var r=n(2293);n.d(t,"a",(function(){return r.a}));var i=n(2288);n.d(t,"b",(function(){return i.a}));var a=n(2175);n.d(t,"d",(function(){return a.a}));var o=n(2275);n.d(t,"c",(function(){return o.a}))},2828:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"DeleteItemField:#Exchange"},e)}},2985:function(e,t,n){"use strict";var r=n(0);function i(e){return e>0}var a=n(3),o=n(74),c=Object(a.action)("UNSUBSCRIBE_FROM_BRAND_SUBSCRIPTION",(function(e,t,n,r,i,a){return Object(o.c)({name:"UnsubscribeSubscription",customData:{unsubscribeSourceType:e}},{unsubscribeSourceType:e,smtpAddress:t,smtpIdentifier:n,unsubscribeSilentUris:r,unsubscribeHttpUri:i,completedCallback:a})})),u=Object(a.action)("AFTER_UNSUBSCRIBE",(function(e,t,n,r,i){return{smtpIdentifier:e,unsubscribeSourceType:t,responseType:n,debugMessage:r,completedCallback:i}})),s=n(12),d=n(321),l="ows/api/beta/subscriptions/{0}/unsubscribe";var b,f=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(d.c)(Object(s.c)(l,e),{unsubscribeSilentUris:t},null,!0)];case 1:return[2,n.sent()]}}))}))};!function(e){e[e.Fail=0]="Fail",e[e.Success=1]="Success"}(b||(b={}));var v=b,O=n(20),m=Object(a.createStore)("BrandSubscription",{subscriptions:new O.ObservableMap({}),unsubscribedSubscriptions:new O.ObservableMap({})})();function j(e){return e&&m.subscriptions.has(e.toLowerCase())?m.subscriptions.get(e.toLowerCase()):null}var p=Object(a.mutatorAction)("unsubscribeFromCache",(function(e){var t=Object(r.__assign)({},j(e));t?(m.subscriptions.delete(e.toLowerCase()),m.unsubscribedSubscriptions.set(e.toLowerCase(),t)):y()})),h=n(337);Object(a.orchestrator)(c,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,o,c,s,d,l,b,O,m,j;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.unsubscribeSourceType,n=e.smtpAddress,a=e.smtpIdentifier,o=e.unsubscribeSilentUris,c=e.unsubscribeHttpUri,s=e.completedCallback,c&&0!==c.length||o&&0!==o.length?(o&&i(o.length)||!c?d="No unsubscribe URIs provided":(window.open(c,"_blank"),d="Opened unsubscribe URI in new tab"),[4,f(a,o)]):(d="No unsubscribe URIs or SilentURIs provided",l=v.Fail,u(a,t,l,d,s),[2,Promise.reject("No unsubscribe URIs or SilentURIs provided")]);case 1:return b=r.sent(),O=null,Object(h.a)(b.status)?(d="Unsubscribe service called successfully. "+d,l=v.Success,p(n),[3,4]):[3,2];case 2:return d="Unsubscribe service failed. "+d,l=v.Fail,[4,b.text().then((function(e){return e?JSON.parse(e):{}}))];case 3:m=r.sent(),(O=new Error("ResponseCode="+b.status+", ErrorMessage="+(null===(j=null==m?void 0:m.error)||void 0===j?void 0:j.message))).fetchErrorType="ServerFailure",r.label=4;case 4:return u(a,t,l,d,s),O?[2,Promise.reject(O)]:[2,Promise.resolve()]}}))}))}));Object(a.mutator)(u,(function(e){var t=e.unsubscribeSourceType,n=e.responseType,r=e.debugMessage,i=e.completedCallback;"BrandCard"===t&&i&&i(n===v.Success,r)}));var k=Object(a.mutatorAction)("populateSubscriptionStore",(function(e){e.subscriptions.forEach((function(e){var t;(null===(t=null==e?void 0:e.smtpInfo)||void 0===t?void 0:t.smtpAddress)&&m.subscriptions.set(e.smtpInfo.smtpAddress.toLowerCase(),e)})),e.unsubscribedSubscriptions.forEach((function(e){var t;(null===(t=null==e?void 0:e.smtpInfo)||void 0===t?void 0:t.smtpAddress)&&m.unsubscribedSubscriptions.set(e.smtpInfo.smtpAddress.toLowerCase(),e)}))})),g="ows/api/beta/subscriptions?orderBy=name, asc";var y=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(d.b)(e?g+"&noResolveBrand=true":g,void 0,!0)];case 1:return t=r.sent(),Object(h.a)(t.status)?[4,t.json()]:[3,3];case 2:return n=r.sent(),k(n),[2,n];case 3:return[2,null]}}))}))};n.d(t,"b",(function(){return y})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return j})),n.d(t,"f",(function(){return i}))},3004:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c}));var r=n(77),i=new r.c((function(){return n.e(944).then(n.bind(null,6574))})),a=new r.a(i,(function(e){return e.getAccountInformation})),o=new r.b(i,(function(e){return e.getStore})),c=new r.b(i,(function(e){return e.tryValidateDumpsterQuota}))},3008:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("UPDATE_FOLDER_COUNTS",(function(e,t,n,r){return{unreadCount:e,totalCount:t,folderId:n,isDeltaChange:r}}))},3085:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(3),i=Object(r.createStore)("mruFolderCache",{mruFolders:[],isInitialized:!1}),a=i();t.a=a},321:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return d}));var r=n(77),i=new r.c((function(){return Promise.all([n.e(1),n.e(23),n.e(860)]).then(n.bind(null,944))})),a=new r.a(i,(function(e){return e.makePostRequest})).importAndExecute,o=new r.a(i,(function(e){return e.makePatchRequest})).importAndExecute,c=new r.a(i,(function(e){return e.makePutRequest})).importAndExecute,u=new r.a(i,(function(e){return e.makeGetRequest})).importAndExecute,s=new r.a(i,(function(e){return e.makeDeleteRequest})).importAndExecute,d=new r.a(i,(function(e){return e.sendOwsPrimeRequest})).importAndExecute},3269:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3613),i=n(2649),a=n(3614);function o(e,t){var n=Object(i.a)(e),o=Object(a.a)(e,t),c=Object(r.c)(e);return[!n.ReplyAllowed||c||o,!n.ReplyAllAllowed||c||o,!n.ForwardAllowed||o]}},3334:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1739),i=n(1332),a=n(1944);function o(e,t){var n;return Object(a.a)({Path:Object(i.a)({FieldURI:e}),Item:Object(r.a)((n={},n[e]=t,n))})}},337:function(e,t,n){"use strict";var r=n(726);n.d(t,"a",(function(){return r.a}))},3516:function(e,t,n){"use strict";var r=n(4251),i=n(3),a={sweepDestinationFolderId:null,isSweepDialogShown:!1,sweepOptionType:r.a.All,sweepRequestStatus:0};t.a=Object(i.createStore)("sweepStore",a)()},3613:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r="report",i="report.ipm.note.ndr",a="report.ipm.note.dr";function o(e){return!!e&&(e.ItemClass&&0==e.ItemClass.toLowerCase().indexOf(r))}function c(e){return!!e&&(e.ItemClass&&0==e.ItemClass.toLowerCase().indexOf(i))}function u(e){return!!e&&(e.ItemClass&&0==e.ItemClass.toLowerCase().indexOf(a))}},3614:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2299),i=n(1683);function a(e,t){return Object(i.a)(e)&&t&&!!Object(r.a)(e)}},3837:function(e,t,n){"use strict";var r=n(77),i=n(29);function a(){return Object(i.a)("GetFolderMruConfiguration",{},e).then((function(e){return e}));var e}var o=n(3085),c=n(1322),u=n(285),s=Object(u.action)("getMoveToMruList")((function(){o.a.isInitialized||a().then((function(e){return function(e){if(null==e.FolderMruEntries||0==e.FolderMruEntries.length)o.a.mruFolders.push(Object(c.a)("inbox")),o.a.mruFolders.push(Object(c.a)("deleteditems")),o.a.mruFolders.push(Object(c.a)("archive"));else for(var t=0;t<e.FolderMruEntries.length;t++){var n=e.FolderMruEntries[t].EwsFolderIdEntry;o.a.mruFolders.push(n)}o.a.isInitialized=!0}(e)}))}));n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return s}));var d=new r.c((function(){return n.e(836).then(n.bind(null,16802))})),l=new r.a(d,(function(e){return e.addFolderIdToMoveToMruList})),b=new r.a(d,(function(e){return e.removeFolderIdFromMoveToMruList}))},3896:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"MoveItemRequest:#Exchange"},e)}},4044:function(e,t,n){"use strict";var r=n(29),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"MoveItemJsonRequest:#Exchange"},n)),Object(r.a)("MoveItem",e,t)}n.d(t,"a",(function(){return a}))},4235:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(29);function i(e){return Object(r.a)("GetMailboxJunkEmailConfiguration",{},e)}},4251:function(e,t,n){"use strict";var r;!function(e){e[e.All=0]="All",e[e.AllCurrentAndFuture=1]="AllCurrentAndFuture",e[e.AllButOne=2]="AllButOne",e[e.AllOlderThan=3]="AllOlderThan"}(r||(r={})),t.a=r},4569:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(59),i=n(30);function a(e){var t=Object(i.a)().SessionSettings,n=t.UserEmailAddress;return n?!e||(e.toLowerCase()==n.toLowerCase()||t.UserProxyAddresses&&t.UserProxyAddresses.some((function(t){return t.toLowerCase()==e}))):(r.d("User email address from session data is null."),!1)}},4669:function(e,t,n){"use strict";n.r(t);var r=n(74),i=n(3),a=Object(i.action)("ADD_MAILBOX_TO_SAFE_SENDERS",(function(e,t,n){return Object(r.c)({name:"TnS_AddToSafeSenders",customData:[n],cosmosOnlyData:JSON.stringify({itemId:t}),actionSource:"ReadingPane"},{mailbox:e,itemId:t,actionSource:n})})),o=Object(i.action)("ADD_MAILBOX_TO_TRUSTED_SENDERS_LIST",(function(e,t){return{mailbox:e,junkEmailConfiguration:t}})),c=n(6153),u=n(7330),s=n(2452),d=n(3515),l=n(9810),b=n(1712),f=n(1311),v=n(1497),O=n(2909),m=n(1436),j=Object(r.d)("RestoreItem",s.a.restoreItems)((function(e,t){var n=v.a.tableViews.get(t),r=n.tableQuery.folderId,i=Object(f.C)(e,t),a=Object(d.a)(i);return Object(b.a)(a,r,"Restore"),Object(l.a)(i).then((function(e){return Object(m.a)(e)})).catch((function(e){return Object(O.b)(n),Promise.reject(e)}))}));function p(e,t,n){switch(v.a.tableViews.get(t).tableQuery.listViewType){case 0:Object(u.a)(e,t);break;case 1:j(e,t)}}var h=n(5377),k=Object(i.action)("DELETE_ITEMS_BASED_ON_NODE_OR_THREAD_IDS",(function(e,t,n){return{nodeIds:e,tableViewId:t,actionSource:n}})),g=Object(i.action)("SCHEDULE_ROWS",(function(e,t,n,r){return{rowKeys:e,tableViewId:t,actionSource:n,scheduleReturnTime:r}})),y=n(8213),I=n(12),S=n(1323),w=n(11887);function C(e,t){"Flagged"===e?S.s.importAndExecute(t?Object(I.b)(w.a):Object(I.b)(w.c)):"NotFlagged"===e&&S.s.importAndExecute(t?Object(I.b)(w.b):Object(I.b)(w.d))}var _=n(1955);function T(e,t,n,r){var i;switch(e.FlagStatus){case"Flagged":i="Flag";break;case"NotFlagged":i="FlagCleared";break;case"Complete":i="FlagComplete"}Object(_.d)(i,t)}var N=n(2256),F=n(285),A=Object(F.select)({tableViewConversationRelations:function(){return f.X.tableViewConversationRelations},tableViews:function(){return f.X.tableViews}})((function(e,t,n,r,i){e.forEach((function(e){i.tableViews.forEach((function(i){i.serverFolderId==t&&Object(f.E)([e],i).forEach((function(e){var t=Object(f.K)(e,i.id);t&&t.itemIds.forEach((function(e){n.indexOf(e)>-1&&r(t,e)}))}))}))}))})),x=Object(F.select)({tableViews:function(){return f.X.tableViews}})(Object(F.action)("ApplyConversationFlagInListViewStore")((function(e,t,n,r){if(!t||!t.FlagStatus)throw new Error("Invalid flag type.");var i=r.tableViews.get(n),a=Object(f.y)(t,e,i),o=Object(f.C)(e,i.id);A(o,i.serverFolderId,a,(function(e,n){e.flagStatus=t.FlagStatus}))}))),E=n(1493),R=n(4568),M=n(2453),D=n(2454),V=n(547),P=n(723),B=n(1382),L=n(6158);function U(e,t,n){var r=e.map((function(e){return function(e,t,n){var r=Object(D.a)({Action:"Flag",ConversationId:Object(P.a)({Id:e.conversationId}),Flag:t,ConversationLastSyncTime:Object(R.a)(e.conversationLastSyncTimeStamp)});if(n){var i=Object(B.a)({BaseFolderId:Object(V.a)({Id:n})});r.ContextFolderId=i}return r}(e,t,n)}));return Object(M.a)({ConversationActions:r})}var W=n(3334),K=n(1866),J=n(2010),H=n(1986),Q=n(319);function G(e,t,n){var r=function(e,t){var n=Object(W.a)("Flag",t),r=[];return e.forEach((function(e){return r.push(Object(K.a)({Updates:[n],ItemId:Object(P.a)({Id:e})}))})),Object(J.a)({ItemChanges:r,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly"})}(e,t);return Object(H.a)({Header:Object(Q.b)(),Body:r},n).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var q=n(1652),z=n(440),X=Object(r.d)("setConversationsFlagState",s.a.setConversationsFlagState)((function(e,t,n,r,i){q.b();var a=v.a.tableViews.get(n);T(r,t);var o=Object(f.C)(e,n);return x(e,r,n),Object(N.a)(o,r,n),Object(f.e)(a)?function(e,t,n){var r=Object(z.a)(Object(E.b)(e));return G(Object(f.y)(t,n,e),t,r).then((function(e){return Object(m.a)(e)})).catch((function(e){return Promise.reject(e)}))}(a,r,e):function(e,t,n){var r=Object(f.k)(e),i=function(e,t,n){var r=U(e,t,n);return Object(L.a)(r)}(n.map((function(t){return Object(f.h)(t,e.id)})),t,r);return Object(O.c)(i,n,r,e,!1)}(a,r,e)}));var Z=n(0),Y=n(1319),$=n(2199),ee=n(2206),te=Object(i.action)("FLAG_ITEMS_STORE_UPDATE",(function(e,t,n){return{itemIds:e,flagTypeToSet:t,parentFolderId:n}}));Object(i.mutator)(te,(function(e){var t,n,r,i;e.itemIds.forEach((function(t){var n=Y.a.items.get(t);n&&(n.Flag={FlagStatus:e.flagTypeToSet.FlagStatus})}));var a=Object(ee.a)(e.parentFolderId,!0);try{for(var o=Object(Z.__values)(a),c=o.next();!c.done;c=o.next()){var u=c.value;if(Object(f.P)(u))try{for(var s=(r=void 0,Object(Z.__values)(e.itemIds)),d=s.next();!d.done;d=s.next()){ne(d.value,u,e.flagTypeToSet.FlagStatus)}}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}));function ne(e,t,n){var r,i,a=Object(S.v)(e),o=Object(f.E)([a.ConversationId.Id],t);try{for(var c=Object(Z.__values)(o),u=c.next();!u.done;u=c.next()){var s=u.value;Object($.a)(s,t.id).flagStatus=n}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}var re=Object(r.d)("setItemsFlagState",s.a.setItemsFlagState)((function(e,t,n,r,i){var a=Object(f.J)().tableViews.get(r);return a&&Object(f.E)(e,a),q.b(),T(n,t),te(e,n,a&&a.tableQuery.folderId),G(e,n,Object(z.a)(Object(E.b)(a)))}));function ie(e,t,n,r,i){var a=e.filter((function(e){return!!Object(S.v)(e)}));a.length>0&&(re(a,t,n,r,i),C(n.FlagStatus,!1))}var ae=n(2058);function oe(e,t,n,r,i){var a=v.a.tableViews.get(t),o=Object(ae.a)(e,a);switch(a.tableQuery.listViewType){case 0:!function(e,t,n,r,i,a,o){var c=[];c=o?e:a(e,n,r),c.length>0&&(X(c,t,n,r,i),C(r.FlagStatus,!0))}(e,o,t,n,r,ce,i);break;case 1:!function(e,t,n,r,i,a,o){var c=[];if((c=o?e:a(e,n,r)).length>0){var u=Object(f.C)(c,n);re(u,t,r,n,i),C(r.FlagStatus,!1)}}(e,o,t,n,r,ce,i)}}function ce(e,t,n){var r=Object(f.J)().tableViews.get(t);return e.filter((function(e){return f.b.getFlagStatus(e,r)!=n.FlagStatus}))}var ue=n(96);var se=Object(F.action)("toggleRowsFlagState")((function(e,t,n){oe(e,t,function(e,t){for(var n,r=0;r<e.length;r++){switch(f.b.getFlagStatus(e[r],t)){case"Flagged":n=Object(ue.s)()?Object(y.b)(y.a.clear):Object(y.b)(y.a.complete);break;case"Complete":case"NotFlagged":default:n=Object(y.b)(y.a.noDate)}}return n}(e,f.X.tableViews.get(t)),n)})),de=Object(i.action)("SET_ITEMS_FLAG_STATE_BASED_ON_NODE_IDS",(function(e,t,n,r){return{nodeIds:e,tableViewId:t,flagStatusToSet:n,actionSource:r}})),le=n(1325),be=n(6878),fe=n(269),ve=n(1312),Oe=n(2050),me=n(3837),je=n(1659),pe=n(1570),he=Object(F.select)({sourceFolder:function(e,t,n){return ve.d.folderTable.get(n.tableQuery.folderId)},destinationFolder:function(e,t,n){return ve.d.folderTable.get(t)}})((function(e,t,n,r,i,a){var o=this,c=function(e,t){return e&&e.treeType===le.k||t&&t.treeType===le.k?1:0}(a.sourceFolder,a.destinationFolder),u=n.tableQuery.folderId;if(Object(be.a)(u,t))return(s=Object(fe.r)())&&s.endWithError("UserError",new Error("Action not supported for shadow mailbox")),Promise.resolve();q.b();var s,d,l=e.filter((function(e){return n.rowKeys.indexOf(e)>=0&&t!=f.b.getParentFolderId(e,n)})),b=[];if(1==n.tableQuery.type&&l.forEach((function(e){var t=f.b.getInstrumentationContext(e,n);t&&b.push(t)})),Object(_.d)("Move",b),0==l.length)return(s=Object(fe.r)())&&s.endWithError("UserError",new Error("no conversations to move")),Promise.resolve();switch(c){case 1:if(!Object(Oe.h)(Object(je.g)(n),t))return Object(Oe.j)(t),Promise.resolve();switch(n.tableQuery.listViewType){case 0:Object(Z.__awaiter)(o,void 0,void 0,(function(){return Object(Z.__generator)(this,(function(e){switch(e.label){case 0:return[4,pe.z.import()];case 1:return e.sent()(l,t,n),[2]}}))}));break;case 1:Object(Z.__awaiter)(o,void 0,void 0,(function(){return Object(Z.__generator)(this,(function(e){switch(e.label){case 0:return[4,pe.A.import()];case 1:return e.sent()(l,n.id,t,u),[2]}}))}))}break;case 0:default:me.b.importAndExecute(t),d=r(l,t,n,i)}return d})),ke=n(8212),ge=n(3942),ye=n(1534),Ie=n(664),Se=n(30),we=n(1368),Ce=n(11888);function _e(e,t,n){if(Object(Se.a)().UserOptions.ShowNotificationBar){var r=Object(ve.j)(ve.d.folderTable.get(t)),i="archive"===Object(we.a)(t);if("deleteditems"===Object(we.a)(t))Object(ke.a)(e,n);else{var a;a=i?1===e?Object(I.b)(Ce.a):Object(I.c)(Object(I.b)(Ce.b),e):1===e?Object(I.c)(Object(I.b)(Ce.c),r):Object(I.c)(Object(I.b)(Ce.d),e,r);var o=Object(ye.h)();Ie.e.importAndExecute("moveOrArchiveNotification","MailModuleNotificationBarHost",a,{icon:i?"Archive":"FabricMoveToFolder",primaryActionText:n?Object(I.b)(ge.a):null,allowClear:!0,minWidth:o.minWidth,maxWidth:o.maxWidth,notificationCallback:function(e){e===Ie.a.PrimaryActionClicked&&q.e.importAndExecute("NotificationBar")}})}}}var Te=n(3008);function Ne(e,t){var n=e.filter((function(e){return!e.isRead})).length,r=e.length;Object(Te.a)(n,r,t,!0)}function Fe(e,t,n){var r=0,i=0;e.forEach((function(e){var n=Object(f.K)(e,t.id);r+=n.unreadCount,i+=n.itemIds.length})),Object(Te.a)(r,i,n,!0)}function Ae(e){var t=ve.d.folderTable.get(e);return Object(S.j)(e)||Object(S.p)(t)}var xe=n(6879),Ee=n(340),Re=n(1849),Me={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MoveConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"destinationFolderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"moveConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"destinationFolderId"},value:{kind:"Variable",name:{kind:"Name",value:"destinationFolderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"undoRequestId"},arguments:[],directives:[]}]}}]}}]},De={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UndoMoveConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"destinationFolderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"undoMoveConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}},{kind:"ObjectField",name:{kind:"Name",value:"destinationFolderId"},value:{kind:"Variable",name:{kind:"Name",value:"destinationFolderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},Ve=Object(r.d)("moveConversations",s.a.moveConversation)((function(e,t,n,r){return he(e,t,n,Pe,r)}));function Pe(e,t,n){var r=this,i="category"!==n.tableQuery.scenarioType?n.tableQuery.folderId:null,a=e.map((function(e){return Object(f.h)(e,n.id)})),o=Object(f.C)(e,n.id),c=Object(q.c)(i,Object(E.b)(n));Object(S.m)(t)&&Fe(e,n,t),Object(xe.a)(n.tableQuery,Ae(t))&&Object(Re.a)(o,n,"Move");var u=Be.invokeMoveConversationMutation(a,t,i);return c&&q.a((function(){return Object(Z.__awaiter)(r,void 0,void 0,(function(){var e;return Object(Z.__generator)(this,(function(n){switch(n.label){case 0:return[4,u];case 1:return(e=n.sent()).success?[4,Be.invokeUndoMoveConversationMutation(a,i,t,e.undoRequestId)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2,Promise.resolve()]}}))}))}),n.serverFolderId,u),_e(a.length,t,c),Object(fe.r)().markUserPerceivedTime(),Object(O.c)(u,e,i,n,!0,!0)}var Be={invokeMoveConversationMutation:function(e,t,n){var r;return Object(Z.__awaiter)(this,void 0,void 0,(function(){var i,a;return Object(Z.__generator)(this,(function(o){switch(o.label){case 0:return i=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(R.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(Ee.a)()];case 1:return[4,o.sent().mutate({variables:{conversations:i,folderId:n,destinationFolderId:t},mutation:Me})];case 2:return a=o.sent(),[2,null===(r=null==a?void 0:a.data)||void 0===r?void 0:r.moveConversation]}}))}))},invokeUndoMoveConversationMutation:function(e,t,n,r){var i;return Object(Z.__awaiter)(this,void 0,void 0,(function(){var a,o;return Object(Z.__generator)(this,(function(c){switch(c.label){case 0:return a=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(R.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(Ee.a)()];case 1:return[4,c.sent().mutate({variables:{conversations:a,folderId:n,destinationFolderId:t,undoRequestId:r},mutation:De})];case 2:return o=c.sent(),[2,null===(i=null==o?void 0:o.data)||void 0===i?void 0:i.undoMoveConversation]}}))}))}},Le=n(6154),Ue=n(5376),We=n(3896),Ke=n(4044),Je=n(1529);function He(e,t,n){var r=function(e,t){return Object(We.a)({ToFolderId:Object(Le.a)(t),ItemIds:Object(Ue.a)(e),ReturnNewItemIds:!0})}(e,t);return Object(Ke.a)({Header:Object(Q.b)(),Body:r},Object(z.a)(Object(Je.b)(t))).then((function(e){return e.Body}))}var Qe=n(8214),Ge=Object(r.d)("moveItemsFromItemIds",s.a.moveItems)((function(e,t,n,r){var i=this,a="category"!==n.tableQuery.scenarioType?n.tableQuery.folderId:null,o=Object(q.c)(a,Object(E.b)(n)),c=Object(fe.r)();if(Object(be.a)(a,t))return c.endWithError("UserError",new Error("Action not supported for shadow mailbox")),Promise.resolve();var u=Object(f.E)(e,n);q.b();var s=Object(d.a)(e);Object(Qe.a)(t)&&Ne(s,t),Object(xe.a)(n.tableQuery,Ae(t))&&Object(b.a)(s,a,"Move");var l=He(e,t);return o&&q.a((function(){return Object(Z.__awaiter)(i,void 0,void 0,(function(){var e,t,n,r,i,o,c,u;return Object(Z.__generator)(this,(function(s){switch(s.label){case 0:return[4,l];case 1:if((e=s.sent()).ResponseMessages){t=e.ResponseMessages.Items,n=[];try{for(r=Object(Z.__values)(t),i=r.next();!i.done;i=r.next())"Success"==(o=i.value).ResponseClass&&n.push(o.Items[0].ItemId.Id)}catch(e){c={error:e}}finally{try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(c)throw c.error}}if(n.length>0)return[2,He(n,a)]}return[2,Promise.resolve()]}}))}))}),n.serverFolderId),_e(e.length,t,o),c.markUserPerceivedTime(),Object(O.d)(l,u,a,n,!0)}));function qe(e,t,n,r){return he(e,t,n,ze,r)}function ze(e,t,n,r){var i=Object(f.C)(e,n.id);return Ge(i,t,n,r)}function Xe(e,t,n,r){var i=f.X.tableViews.get(n);return(0==i.tableQuery.listViewType?Ve:qe)(e,t,i,r)}var Ze=n(11889),Ye=n(5594);function $e(e,t,n){var r=Object(B.a)({BaseFolderId:Object(V.a)({Id:t})}),i=null==n?null:Object(B.a)({BaseFolderId:Object(V.a)({Id:n})}),a=e.map((function(e){return function(e,t,n){return Object(D.a)({Action:"Copy",ConversationId:Object(P.a)({Id:e.conversationId}),ContextFolderId:t,DestinationFolderId:n,ConversationLastSyncTime:Object(R.a)(e.conversationLastSyncTimeStamp)})}(e,i,r)}));return Object(M.a)({ConversationActions:a,ReturnMovedItemIds:!0})}function et(e,t,n){var r=$e(e,t,n);return Object(L.a)(r)}var tt=Object(r.d)("copyMailListRows",s.a.copyMailListRows)((function(e,t,n,r,i){switch(t.tableQuery.listViewType){case 0:var a=et(e.map((function(e){return Object(f.h)(e,t.id)})),n,r);return nt(e.length),Object(O.c)(a,e,r,t,!1);case 1:var o=Object(f.C)(e,t.id),c=Object(Ye.a)(o,Object(Le.a)(n),!1,Object(z.a)(Object(E.b)(t)));return nt(e.length),Object(O.d)(c,e,r,t,!1);default:return Promise.reject(new Error("ListViewType not support: "+t.tableQuery.listViewType))}}));function nt(e){var t=1===e?Object(I.b)(Ze.a):Object(I.c)(Object(I.b)(Ze.b),e),n=Object(ye.h)();Ie.e.importAndExecute("copyNotification","MailModuleNotificationBarHost",t,{icon:"Copy",minWidth:n.minWidth,maxWidth:n.maxWidth})}var rt=Object(i.action)("MOVE_ITEMS_BASED_ON_NODE_IDS",(function(e,t,n,r){return{nodeIds:e,destinationFolderId:t,tableViewId:n,actionSource:r}})),it=Object(F.select)({archiveFolderId:function(){return Object(Se.a)().UserOptions.ArchiveFolderId}})(Object(r.d)("archiveMailListRowsFromTable",s.a.archiveMailListRows)((function(e,t,n,r){return Object(Z.__awaiter)(this,void 0,void 0,(function(){return Object(Z.__generator)(this,(function(n){switch(n.label){case 0:return r.archiveFolderId?[4,Xe(e,r.archiveFolderId,t.id)]:[3,2];case 1:return n.sent(),[3,3];case 2:throw new Error("Archive folder id should always be set");case 3:return[2]}}))}))}))),at=n(2828),ot=n(1332),ct=n(3139);function ut(e,t,n){var r=function(e,t){var n,r,i=[];try{for(var a=Object(Z.__values)(e),o=a.next();!o.done;o=a.next()){var c=o.value,u=void 0;u=t?Object(W.a)("RenewTime",ct.e):Object(at.a)({Path:Object(ot.a)({FieldURI:"RenewTime"})});var s=Object(K.a)({Updates:[u],ItemId:Object(P.a)({Id:c})});i.push(s)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return Object(J.a)({ItemChanges:i,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly"})}(e,t),i=Object(Q.b)();return i.TimeZoneContext.TimeZoneDefinition.Id="UTC",Object(H.a)({Header:i,Body:r},n).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var st=n(2816);function dt(e,t){return e&&Object(f.x)(e)!=t}var lt=Object(r.d)("pinConversations",s.a.pinConversations)((function(e,t,n,r){q.b();var i=Object(f.g)(e,t.id,dt,n),a=function(e,t,n){for(var r={},i=0;i<e.length;i++){var a=Object(f.K)(e[i],t);if(n){var o=a.itemIds[0];r[o]||(r[o]=!0)}else a.itemIds.forEach((function(e){r[e]||(r[e]=!0)}))}return Object.keys(r)}(i,t.id,n);if(0==a.length)return Promise.resolve();Object(st.a)(i,t.id,n);var o=Object(ae.a)(e,t);return Object(_.d)(n?"Pin":"Unpin",o),ut(a,n)})),bt=n(2817),ft=Object(r.d)("pinItems",s.a.pinItems)((function(e,t,n,r){q.b();var i=function(e,t,n){var r=[];return e.forEach((function(e){(f.b.getIsPinned(e,t)&&!n||!f.b.getIsPinned(e,t)&&n)&&r.push(e)})),r}(e,t,n),a=Object(f.C)(i,t.id);if(0==a.length)return Promise.resolve();if(Object(bt.a)(i,t.id,n),n){var o=Object(ae.a)(e,t);Object(_.d)("Pin",o)}return ut(a,n,Object(z.a)(Object(E.b)(t)))}));function vt(e,t,n){var r=f.X.tableViews.get(t),i=f.b.getIsPinned(e,r);switch(r.tableQuery.listViewType){case 0:lt([e],r,!i,n);break;case 1:ft([e],r,!i,n)}}function Ot(e,t,n,r){var i=f.X.tableViews.get(t);switch(i.tableQuery.listViewType){case 0:lt(e,i,n,r);break;case 1:ft(e,i,n,r)}}var mt=n(4976),jt=n(11890),pt=n(1328);function ht(e){return q.b(),Object(Se.a)().SegmentationSettings.ReportJunkEmailEnabled?Object(pt.b)(Object(I.b)(jt.a),Object(I.b)(jt.b),!1,{okText:Object(I.b)(mt.p),cancelText:Object(I.b)(mt.o),delayCallbackAfterAnimation:!0}).then((function(t){t===pt.a.ok&&e()})):(e(),Promise.resolve())}function kt(e,t){return e.filter((function(e){return t.rowKeys.indexOf(e)>=0}))}var gt=n(29);function yt(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(Z.__assign)({__type:"ReportMessageToSafetyLibraryRequest:#Exchange"},n)),Object(gt.a)("ReportMessageToSafetyLibrary",e,t)}function It(e,t,n){var r={ItemIds:Object(Ue.a)(e),ReportAction:t};return n&&(r.ActionData=n),yt(r).then((function(e){return e})).catch((function(e){return Promise.reject(e)}))}var St=Object(r.d)("markItemsAsPhishing",s.a.markItemsAsPhishing)((function(e,t,n,r){if(Object(Se.a)().SegmentationSettings.ReportJunkEmailEnabled)try{It(e,3)}catch(e){}return r(),Promise.resolve()})),wt=n(3957);function Ct(e,t,n){ht((function(){!function(e,t,n){var r=kt(e,t);if(0==r.length)return;var i=Object(ae.a)(e,t),a=Object(f.C)(r,t.id),o=Object(wt.a)(r,t.id);St(o,t,n,(function(){Object(Re.a)(a,t,"MarkAsPhishing")})),Object(_.d)("MarkAsPhishing",i,{conversationIds:a})}(e,t,n)}))}function _t(e,t,n){ht((function(){!function(e,t,n){var r=kt(e,t);if(0==r.length)return;var i=Object(ae.a)(e,t),a=Object(f.C)(r,t.id);St(a,t,n,(function(){var e=Object(d.a)(a);Object(b.a)(e,t.tableQuery.folderId,"MarkAsPhishing")})),Object(_.d)("MarkAsPhishing",i,{itemIds:a})}(e,t,n)}))}function Tt(e,t,n){switch(t.tableQuery.listViewType){case 0:Ct(e,t,n);break;case 1:_t(e,t,n)}}function Nt(e,t,n){var r=S.u.items.get(e);return ht((function(){St([e],t,n,(function(){var t=Object(d.a)([e]);Object(b.a)(t,r.ParentFolderId.Id,"MarkAsPhishing")}))}))}var Ft={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SetInferenceClassificationOnConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"inferenceClassification"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"InferenceClassification"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setInferenceClassificationOnConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"inferenceClassification"},value:{kind:"Variable",name:{kind:"Name",value:"inferenceClassification"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},At=Object(r.d)("moveConversationToFocusedOrOtherAction",s.a.moveConversationToFocusedOrOther)((function(e,t,n,r){var i=v.a.tableViews.get(t),a=0==n,o=Object(f.C)(e,t);q.b();var c=function(e,t,n){var r;return Object(Z.__awaiter)(this,void 0,void 0,(function(){var i,a;return Object(Z.__generator)(this,(function(o){switch(o.label){case 0:return i=e.map((function(e){return{id:e}})),[4,Object(Ee.a)()];case 1:return[4,o.sent().mutate({variables:{conversations:i,folderId:t,inferenceClassification:n},mutation:Ft})];case 2:return a=o.sent(),[2,null===(r=null==a?void 0:a.data)||void 0===r?void 0:r.setInferenceClassificationOnConversation]}}))}))}(o,i.tableQuery.folderId,a?"Focused":"Other");return Object(fe.r)().markUserPerceivedTime(),Object(Re.a)(o,i,"Move"),c}));var xt=n(2134);function Et(e,t){var n=function(e,t){var n,r,i=[];try{for(var a=Object(Z.__values)(e),o=a.next();!o.done;o=a.next()){var c=o.value,u=Object(W.a)("InferenceClassification",t),s=Object(K.a)({Updates:[u],ItemId:Object(P.a)({Id:c})});i.push(s)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return Object(J.a)(Object(Z.__assign)({ConflictResolution:"AlwaysOverwrite",ItemChanges:i,MessageDisposition:"SaveOnly"},Object(xt.a)()))}(e,t),r=Object(Q.b)();return r.TimeZoneContext.TimeZoneDefinition.Id="UTC",Object(H.a)({Header:r,Body:n}).then((function(e){return e.Body.ResponseMessages.Items[0]})).catch((function(e){return Promise.reject(e)}))}var Rt=Object(r.d)("moveItemsToFocusedOrOther",s.a.moveItemToFocusedOrOther)((function(e,t,n,r){var i=v.a.tableViews.get(t),a=0==n,o=Object(f.C)(e,t);q.b();var c=Object(d.a)(o),u=Et(o,a?"Focused":"Other");return Object(b.a)(c,i.tableQuery.folderId,"Move"),Object(fe.r)().markUserPerceivedTime(),u.then((function(e){return Object(m.a)(e)}))}));function Mt(e,t,n,r){return Object(Z.__awaiter)(this,void 0,void 0,(function(){var i;return Object(Z.__generator)(this,(function(a){switch(a.label){case 0:switch(i=v.a.tableViews.get(t),i.tableQuery.listViewType){case 0:return[3,1];case 1:return[3,3]}return[3,5];case 1:return[4,At(e,t,n,r)];case 2:return a.sent(),[3,5];case 3:return[4,Rt(e,t,n,r)];case 4:return a.sent(),[3,5];case 5:return[2]}}))}))}var Dt=n(11891),Vt=n(5637);function Pt(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(Z.__assign)({__type:"CreateOrUpdateFocusedOtherOverrideJsonRequest:#Exchange"},n)),Object(gt.a)("CreateOrUpdateFocusedOtherOverride",e,t)}function Bt(e,t){var n={SenderSmtpAddress:e,AlwaysClassifyAs:t};return Pt({Header:Object(Q.b)(),Body:n}).then((function(e){return e.Body})).catch((function(e){return Promise.reject(e)}))}var Lt=n(5231),Ut=n(5232),Wt=Object(r.d)("alwaysMoveRowToFocusedOrOtherInternal",s.a.alwaysMoveRowToFocusedOrOther)((function(e,t,n,r){return Object(Z.__awaiter)(this,void 0,void 0,(function(){var r,i,a,o=this;return Object(Z.__generator)(this,(function(c){switch(c.label){case 0:if(null==(r=f.b.getLastSenderSMTP(e[0],t)))return[2];switch(n){case 0:a="Focused",i=Object(I.b)(Ut.a);break;case 1:a="Other",i=Object(I.b)(Lt.a);break;case-1:throw new Error("FocusedViewFilter.None is not supported for this action")}return[4,Object(pt.b)(null,Object(I.c)(Object(I.b)(Dt.a),r,i)).then((function(i){return Object(Z.__awaiter)(o,void 0,void 0,(function(){return Object(Z.__generator)(this,(function(o){switch(o.label){case 0:return i!==pt.a.ok?[3,2]:t.rowKeys.indexOf(e[0])>-1?[4,Kt(e[0],r,a,t,n)]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}}))}))}))];case 1:return c.sent(),[2]}}))}))}));function Kt(e,t,n,r,i){return Object(Z.__awaiter)(this,void 0,void 0,(function(){return Object(Z.__generator)(this,(function(a){switch(a.label){case 0:return[4,Mt([e],r.id,i)];case 1:return a.sent(),[4,Bt(t,n).then((function(e){return Object(m.a)(e)}))];case 2:return a.sent(),[4,(o={Id:r.serverFolderId},c=[{EmailAddress:t}],u=Object(W.a)("InferenceClassification",n),s={SourceFolderId:o,EmailAddresses:c,ActionType:3,ItemPropertyToUpdate:u},Object(Vt.a)({Header:Object(Q.b)(),Body:s}).then((function(e){return e.Body.ResponseMessages.Items[0]})).catch((function(e){return Promise.reject(e)}))).then((function(e){return Object(m.a)(e)}))];case 3:return a.sent(),[2]}var o,c,u,s}))}))}var Jt=n(11892),Ht=n(8215),Qt=n(506),Gt=n(1444),qt=n(622),zt=new RegExp("List-Unsubscribe:[ ]+<mailto:"),Xt=Object(r.d)("unsubscribeWithoutConfirmDialog",s.a.unsubscribe)((function(e,t,n,r){var i={itemId:e.ItemId.Id,itemConversationId:e.ConversationId,isRead:e.IsRead,mailboxInfo:e.MailboxInfo};return Object(b.a)([i],e.ParentFolderId.Id,"Unsubscribe"),It([e.ItemId.Id],5,n?[1]:void 0).then((function(e){if(!e.ReportSucccess.every(Boolean)){var t=new Error("Failed to report message to safety library!");return t.fetchErrorType="ServerFailure",Promise.reject(t)}return Promise.resolve()})).catch((function(e){return Promise.reject(e)}))})),Zt=Object(F.action)("showUnsubscribeDialog")((function(e,t,n,r){var i=this;return Object(pt.b)(Object(I.b)(Jt.b),Object(I.c)(Object(I.b)(Jt.a),e.From.Mailbox.Name),!1,{okText:Object(I.b)(Ht.a),cancelText:Object(I.b)(Qt.a)}).then((function(a){return Object(Z.__awaiter)(i,void 0,void 0,(function(){return Object(Z.__generator)(this,(function(i){return a===pt.a.ok?[2,Xt(e,t,n,r)]:[2]}))}))}))})),Yt=Object(F.select)({message:function(e,t){return Y.a.items.get(e)},originalTableView:function(e,t){return f.X.tableViews.get(t)},reportToExternalSender:function(){return Object(Se.a)().SafetyUserOptions.ReportToExternalSender}})(Object(F.action)("unsubscribeEmail")((function(e,t,n,r){var i=r.message,a=r.originalTableView,o=r.reportToExternalSender,c=i.MessageSafety&&(2==i.MessageSafety.MessageSafetyLevel||1==i.MessageSafety.MessageSafetyLevel);if(!o||!c)return Zt(i,a,!1,n);var u=Object(qt.a)({BaseShape:"IdOnly"});return Object(Gt.a)(i.ItemId.Id,u,"MessageDetails").then((function(e){if("Success"==e[0].ResponseClass){var t=e[0],r=t.Items[0].ExtendedProperty&&t.Items[0].ExtendedProperty[0].Value;return Zt(i,a,zt.test(r),n)}throw new Error(e[0].MessageText)}))}))),$t=Object(i.action)("unsubscribeEmailV2",(function(e,t,n,r){return{message:e,cacheEntry:t,actionSource:n,itemViewState:r}})),en=n(6159);var tn=n(11893);function nn(e){return Object(Z.__assign)({__type:"CreateSweepRuleForSenderRequest:#Exchange"},e)}function rn(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(Z.__assign)({__type:"CreateSweepRuleForSenderJsonRequest:#Exchange"},n)),Object(gt.a)("CreateSweepRuleForSender",e,t)}function an(e){return e.map((function(e){return Object(I.c)(Object(I.b)(tn.a),e.Name)}))}function on(e,t,n,r,i){var a=nn({EmailAddresses:e,ActionType:0,RuleName:null,RuleNames:an(e),SourceFolderId:{Id:n},DestinationFolderId:{Id:t},CountType:r,KeepNCount:i});return rn({Header:Object(Q.b)(),Body:a}).then((function(e){return e.Body}))}var cn=n(6573),un=n(1651),sn={};sn[cn.a.All]={keepNType:1,keepNCount:0},sn[cn.a.AllCurrentAndFuture]={keepNType:1,keepNCount:0},sn[cn.a.AllButOne]={keepNType:1,keepNCount:1},sn[cn.a.AllOlderThan]={keepNType:0,keepNCount:10};var dn=Object(F.action)("sweepConversations")((function(e,t,n,r){return Object(Z.__awaiter)(this,void 0,void 0,(function(){var i,a,o,c,u,s,d;return Object(Z.__generator)(this,(function(l){return i=function(e){return sn[e]}(n),a=i.keepNType,o=i.keepNCount,c=t.tableQuery.folderId,u=e.map((function(e){return e.EmailAddress})).join(", "),s=u.length>70?u.slice(0,70)+"...":u,d={Scenario:"Sweep",senderSMTPs:s,destinationFolderId:r},un.i.importAndExecute(t.tableQuery.folderId,"Sweep",d),function(e,t,n,r,i,a){var o=Object(en.a)({ActionType:0,DestinationFolderId:{Id:t},EmailAddresses:e,SourceFolderId:{Id:n},CountType:r,KeepNCount:i,BulkActionRequest:!0,BulkActionCustomData:a&&JSON.stringify(a)});Object(Vt.a)({Header:Object(Q.b)(),Body:o}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}(e,r,c,a,o,d),n==cn.a.All?[2]:(Object(cn.e)(1),[2,on(e,r,c,a,o).then((function(e){"Success"==e.ResponseMessages.Items[0].ResponseClass&&Object(cn.e)(2)})).catch((function(){Object(cn.e)(3)}))])}))}))})),ln=n(9813),bn=n(2355),fn=n(6155),vn=n(59);var On=n(320),mn=n(1322);var jn=n(6880),pn=n(4744);function hn(e,t,n,r){switch(e){case"Unread":return t?r?ln.j:ln.u:r?ln.i:ln.t;case"Flagged":return t?r?ln.h:ln.s:r?ln.g:ln.r;case"ToOrCcMe":return t?r?ln.f:ln.q:r?ln.e:ln.p;case"All":default:return function(e,t,n){return e?t?n?ln.d:ln.o:n?ln.b:ln.m:t?n?ln.c:ln.n:n?ln.a:ln.l}(t,n,r)}}function kn(e,t,n){switch(e){case"Unread":return t?mt.j:mt.i;case"Flagged":return t?mt.c:mt.b;case"ToOrCcMe":return t?mt.h:mt.g;case"All":default:return function(e,t){return e?t?mt.f:mt.d:t?mt.e:mt.a}(t,n)}}var gn=n(3004),yn=Object(F.action)("emptyFolderAction")((function(e,t,n,r,i,a,o,c){var u,s,d,l=this,b=e.FolderId.Id,v=!1;if(function(e){return Object(Z.__awaiter)(this,void 0,void 0,(function(){return Object(Z.__generator)(this,(function(t){switch(t.label){case 0:return[4,gn.c.import()];case 1:return[2,t.sent()(e)]}}))}))}(b).then((function(e){v=e})),v)return null;q.b();var O,m=Object(pn.a)(0,c&&f.X.tableViews.get(c),Object(ve.j)(e)),j=a?a.length:0,p=e,h=!0,k=e.TotalCount-j;if(c){var g=f.X.tableViews.get(c);p=ve.d.folderTable.get(g.tableQuery.folderId),h=1===g.tableQuery.listViewType,Object(f.S)(g,n)&&(k=g.totalRowsInView-j)}var y=function(e){if(!e)throw new Error("MailFolder should not be null at getEmptyFolderHelperProperties");var t={};return Object(S.m)(e.FolderId.Id)?(t.shouldSupportBulkActions=!1,t.treeType="archiveFolderTree",t.deletedItemsFolderId=Object(mn.a)(le.a)):(t.shouldSupportBulkActions=!0,t.treeType="primaryFolderTree",t.deletedItemsFolderId=Object(mn.a)(le.g)),t.isFolderDeletedItemsFolder=Object(S.j)(e.FolderId.Id),t.isFolderDumpsterFolder=Object(S.k)(e.FolderId.Id),t}(p),w=y.isFolderDeletedItemsFolder,C=y.isFolderDumpsterFolder,_=y.deletedItemsFolderId,T=y.shouldSupportBulkActions;return C?(O=Object(I.b)(hn(n,h,j>0,!1)),d=!1,s="HardDelete"):w||"junkemail"==e.DistinguishedFolderId?(O=Object(I.b)(hn(n,h,j>0,!1)),d=!Object(On.a)(),o=d?null:o,s="SoftDelete"):Object(S.p)(e)?(O=Object(I.b)(hn(n,h,j>0,!0)),d=!1,s="SoftDelete"):(r?(O=Object(I.b)(hn(n,h,j>0,!1)),s="SoftDelete"):(O=Object(I.b)(kn(n,h,j>0)),s="MoveToDeletedItems"),d=!1),u=Object(I.c)(O,m),Object(pt.b)(function(e,t,n){var r,i="ContextFolder"===e||1===t;return n<0?(Object(vn.d)("totalCount should not be negative."),i?Object(I.b)(mt.n):Object(I.b)(mt.l)):0==n?(vn.g.warn("getDeleteAllConfirmText should not be called."),""):1==n?Object(I.b)(bn.a):(r=n<fn.a?n:"10000+",i?Object(I.c)(Object(I.b)(mt.m),r):Object(I.c)(Object(I.b)(mt.k),r))}(i,Object(f.A)(b),k),u,!1,{delayCallbackAfterAnimation:!0,okText:Object(I.b)(ln.k)}).then((function(t){return Object(Z.__awaiter)(l,void 0,void 0,(function(){return Object(Z.__generator)(this,(function(n){return t===pt.a.ok&&(T&&un.i.importAndExecute(b,"EmptyFolder",null,k),Object(jn.a)(e,s,d,o,a,c,_,T)),[2]}))}))}))}));function In(e){return Object(c.a)(e.rowKeys,e.id,!1)}var Sn=n(9),wn=Object(F.action)("emptyTableView")(Object(F.select)({folderToBeEmptied:function(e){return ve.d.folderTable.get(e.tableQuery.folderId)}})((function(e,t,n,r,i){var a=i.folderToBeEmptied,o=e.selectAllModeTimeStamp,c=e.id,u=e.serverFolderId,s=e.totalRowsInView;if(Object(S.k)(a.FolderId.Id)||Object(S.j)(a.FolderId.Id)||"junkemail"===a.DistinguishedFolderId)yn(a,-1,Object(f.O)(e),t,n,r,o,c);else{var d=Object(Z.__assign)({},a);d.FolderId={Id:u},d.TotalCount=s;var l=o;if(Object(f.T)(a.FolderId.Id)){var b=f.X.inboxPausedDateTime;Object(Sn.Gb)(b,o)&&(l=b)}yn(d,Object(f.l)(e),Object(f.O)(e),t,n,r,l,c)}}))),Cn=Object(i.mutatorAction)("updateMessageLikers",(function(e,t,n,r,i){var a,o;if(n?e.LikeCount>1?(e.LikeCount--,e.Likers=e.Likers.filter((function(e){return e.EmailAddress!==r}))):(e.LikeCount=null,e.Likers=null):(e.LikeCount?e.LikeCount++:(e.LikeCount=1,e.Likers=[]),e.Likers.push({EmailAddress:r,Name:i,MailboxType:"Mailbox",RoutingType:"SMTP"})),t&&Object(f.P)(t)&&e.ConversationId){var c=Object(f.E)([e.ConversationId.Id],t);try{for(var u=Object(Z.__values)(c),s=u.next();!s.done;s=u.next()){var d=s.value;Object($.a)(d,t.id).globalLikeCount+=n?-1:1}}catch(e){a={error:e}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(a)throw a.error}}}}));function _n(e){return Object(Z.__assign)({__type:"LikeItemJsonRequest:#Exchange"},e)}function Tn(e,t){var n;return n={IsUnlike:t,ItemId:e},Object(Z.__assign)({__type:"LikeItemRequest:#Exchange"},n)}function Nn(e,t,n){var r,i,a=Tn(e,t);return(r=_n({Header:Object(Q.b)(),Body:a}),i=n,void 0===r||r.__type||(r=_n(r)),Object(gt.a)("LikeItem2",r,i)).then((function(e){return e.Body}))}var Fn=n(11894),An=Object(i.action)("likeItem",(function(e,t,n,i,a){return Object(r.c)({name:"LikeItem",actionSource:"ReadingPane"},{itemId:e,message:t,tableView:n,isLocalUpdateOnly:i,instrumentationContext:a})}));Object(i.orchestrator)(An,(function(e){var t=e.tableView,n=e.itemId,r=e.message,i=e.instrumentationContext,a=Object(Se.a)().SessionSettings.UserEmailAddress,o=!!r.Likers&&r.Likers.some((function(e){return e.EmailAddress===a}));Cn(r,t,o,a,Object(Se.a)().SessionSettings.UserDisplayName),e.isLocalUpdateOnly||Nn(n,o,n.mailboxInfo.requestOptions),o||Object(_.d)("Like",[i],{itemIds:[r.ItemId.Id],conversationIds:[r.ConversationId.Id]}),S.s.importAndExecute(o?Object(I.b)(Fn.b):Object(I.b)(Fn.a))}));var xn=An;function En(e,t){var n=function(e,t){var n=Object(K.a)({Updates:[Object(W.a)("OwnerReactionType",t)],ItemId:Object(P.a)({Id:e.Id,ChangeKey:e.ChangeKey})});return Object(J.a)({ItemChanges:[n],ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly"})}(e,t),r=Object(Q.b)();return r.TimeZoneContext.TimeZoneDefinition.Id="UTC",Object(H.a)({Header:r,Body:n}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var Rn=Object(i.action)("reactToItem",(function(e,t,n,i,a,o,c){return Object(r.c)({name:"ReactToItem",actionSource:"ReadingPane"},{message:e,itemId:t,conversationId:n,reactionType:i,instrumentationContext:a,actionAnnouncementString:o,ownerCurrentReactionType:c})})),Mn=Object(i.mutatorAction)("updateMessageReactors",(function(e,t,n,r,i){e.Reactions||(e.Reactions=[]),e.OwnerReactionType=i;var a=e.OwnerReactionType===t,o=!1;e.Reactions.forEach((function(i){i.ReactionType===e.OwnerReactionType&&(i.Count--,i.Reactors=i.Reactors.filter((function(e){return e.ReactorEmail.EmailAddress!==n})),0===i.Count&&(i.Count=null,i.Reactors=null)),i.ReactionType!==t||a||(o=!0,i.Count++,i.Reactors.push({ReactorEmail:{EmailAddress:n,Name:r,MailboxType:"Mailbox",RoutingType:"SMTP"}}))})),o||a||e.Reactions.push({Count:1,ReactionType:t,Reactors:[{ReactorEmail:{EmailAddress:n,Name:r,MailboxType:"Mailbox",RoutingType:"SMTP"}}]}),e.Reactions=e.Reactions.filter((function(e){return null!==e.Reactors})),e.OwnerReactionType=a?null:t}));Object(i.orchestrator)(Rn,(function(e){var t=e.itemId,n=e.message,r=e.reactionType,i=e.conversationId,a=e.instrumentationContext,o=e.actionAnnouncementString,c=e.ownerCurrentReactionType,u=Object(Se.a)().SessionSettings.UserEmailAddress,s=Object(Se.a)().SessionSettings.UserDisplayName;Mn(n,r,u,s,c),En(t,null!==n.OwnerReactionType?r:"0"),Object(_.d)("Reaction",[a],{itemIds:[t],conversationIds:[i]}),S.s.importAndExecute(o)}));var Dn=Rn,Vn=n(9814),Pn=n(11895),Bn=n(1245),Ln=n(11896);function Un(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(Z.__assign)({__type:"MarkAsJunkJsonRequest:#Exchange"},n)),Object(gt.a)("MarkAsJunk",e,t)}function Wn(e,t){var n,r={ItemIds:Object(Ue.a)(e),IsJunk:t,MoveItem:!0,SendCopy:!1,JunkMessageHeader:Object(I.b)(Ln.b),JunkMessageBody:Object(I.b)(Ln.a)};return n=r,Object(Z.__assign)({__type:"MarkAsJunkRequest:#Exchange"},n)}function Kn(e,t){var n=Wn(e,t);return Un({Header:Object(Q.b)(),Body:n}).then((function(e){return e.Body.ResponseMessages.Items}))}var Jn=n(11897);var Hn=n(1),Qn=n(367),Gn=Object(r.d)("markItemsJunkNotJunkBasedOnItemIds",s.a.markItemsJunkNotJunk)((function(e,t,n,r,i,a){var o,c=this,u=q.c(null===(o=null==r?void 0:r.tableQuery)||void 0===o?void 0:o.folderId,Object(E.b)(r));q.b();var s,d=Object(Se.a)().SegmentationSettings.ReportJunkEmailEnabled,l=Object(Se.a)().UserOptions.ReportJunkSelected,b=Object(Se.a)().UserOptions.CheckForReportJunkDialog,f=!1,v=Promise.resolve(),O=!1;try{Object(On.a)()||b&&l&&d&&t?(s=It(e,t?1:2),O=!0):!d||b&&t?s=Kn(e,t):v=Object(pt.b)(t?Object(I.b)(Pn.a):Object(I.b)(Pn.b),On.a?Object(I.b)(Pn.c):Object(I.b)(Pn.d),!1,{okText:Object(I.b)(mt.p),cancelText:Object(I.b)(mt.o),bodyElement:t?Hn.createElement(Bn.a,{label:Object(I.b)(Vn.a),onChange:function(){f=!f}}):null}).then((function(n){if(t){var r=n===pt.a.ok;Object(Qn.a)((function(e){e.UserOptions.ReportJunkSelected=r,e.UserOptions.CheckForReportJunkDialog=f}),[{key:"CheckForReportJunkDialog",valuetype:"Boolean",value:[String(f)]},{key:"ReportJunkSelected",valuetype:"Boolean",value:[String(r)]}])}n==pt.a.ok?(s=It(e,t?1:2),O=!0):s=Kn(e,t)}))}catch(e){}return u&&q.a((function(){return Object(Z.__awaiter)(c,void 0,void 0,(function(){var e,n;return Object(Z.__generator)(this,(function(i){switch(i.label){case 0:return[4,s];case 1:return e=i.sent(),n=O?qn(e):zn(e),[2,Xn(O,t,n,r)]}}))}))}),r.serverFolderId),n&&v.then((function(){return function(e,t,n){if(Object(Se.a)().UserOptions.ShowNotificationBar){var r;r=n?1===e?Object(I.b)(Jn.a):Object(I.c)(Object(I.b)(Jn.c),e):1===e?Object(I.b)(Jn.b):Object(I.c)(Object(I.b)(Jn.d),e);var i=Object(ye.h)();Ie.e.importAndExecute("markAsJunkNotification","MailModuleNotificationBarHost",r,{icon:"Blocked",primaryActionText:t?Object(I.b)(ge.a):null,allowClear:!0,minWidth:i.minWidth,maxWidth:i.maxWidth,notificationCallback:function(e){e===Ie.a.PrimaryActionClicked&&q.e.importAndExecute("NotificationBar")}})}}(e.length,u,t)})),a(),t&&Object(_.d)("MarkAsJunk",i,{itemIds:e}),v}));function qn(e){for(var t=e.MovedItemIds,n=e.ReportSucccess,r=[],i=0;i<Math.min(t.length,n.length);++i)n[i]&&r.push(t[i].Id);return r}function zn(e){var t,n,r=[];try{for(var i=Object(Z.__values)(e),a=i.next();!a.done;a=i.next()){var o=a.value;"Success"===o.ResponseClass&&r.push(o.MovedItemId.Id)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function Xn(e,t,n,r){return Object(Z.__awaiter)(this,void 0,void 0,(function(){var i,a,o,c;return Object(Z.__generator)(this,(function(u){switch(u.label){case 0:return n.length>0?(i=e?It(n,t?2:1):Kn(n,!t),a=Object(mn.a)("inbox"),t&&a!==r.tableQuery.folderId?[4,i]:[3,2]):[3,3];case 1:if(o=u.sent(),(c=e?qn(o):zn(o)).length>0)return[2,He(c,r.tableQuery.folderId)];u.label=2;case 2:return[2,i];case 3:return[2,Promise.resolve()]}}))}))}function Zn(e,t,n,r){switch(t.tableQuery.listViewType){case 0:!function(e,t,n,r){var i=Object(wt.a)(e,t.id),a=Object(ae.a)(e,t);Gn(i,n,r,t,a,(function(){var n=Object(f.C)(e,t.id);Object(Re.a)(n,t,"MarkAsJunk")}))}(e,t,n,r);break;case 1:!function(e,t,n,r){var i=Object(f.C)(e,t.id),a=Object(ae.a)(e,t);Gn(i,n,r,t,a,(function(){var e=Object(d.a)(i);Object(b.a)(e,t.tableQuery.folderId,"MarkAsJunk")}))}(e,t,n,r)}}var Yn=Object(i.action)("MARK_ITEMS_JUNK_NOT_JUNK_BASED_ON_NODE_IDS",(function(e,t,n,r){return{nodeIds:e,tableViewId:t,isJunkValueToSet:n,actionSource:r}})),$n=n(1530),er=Object(F.select)({item:function(e){return Y.a.items.get(e)}})((function(e,t,n,r,i){var a=i.item,o=Object($n.a)(a.ParentFolderId.Id,"junkemail");return Gn([e],!o,n,t,r,(function(){var t=Object(d.a)([e]);Object(b.a)(t,a.ParentFolderId.Id,"MarkAsJunk")}))})),tr=Object(i.action)("ON_KEYBOARD_MARK_AS_JUNK_NOT_JUNK",(function(e,t,n){return{tableView:e,selectedNodeIds:t,selectedRowKeys:n}})),nr=Object(i.action)("ON_KEYBOARD_TOGGLE_FLAG_STATE",(function(e,t,n){return{tableView:e,selectedNodeIds:t,selectedRowKeys:n}})),rr=Object(i.action)("ON_KEYBOARD_ARCHIVE",(function(e,t,n){return{tableView:e,selectedNodeIds:t,selectedRowKeys:n}})),ir=Object(i.action)("ON_KEYBOARD_DELETE",(function(e,t,n,r,i){return{tableView:e,selectedNodeIds:t,selectedRowKeys:n,isInVirtualSelectAllMode:r,isExplicitSoftDelete:i}})),ar=n(9307),or=n(11898);function cr(e){return dr(e,(function(e){return e.Name}),Object(I.b)(or.h),Object(I.b)(or.t),Object(I.b)(or.p),Object(I.b)(or.e),Object(I.b)(or.l))}function ur(e){var t=Object(On.a)();return dr(e,(function(e){return e.EmailAddress}),t?Object(I.b)(or.f):Object(I.b)(or.g),t?Object(I.b)(or.r):Object(I.b)(or.s),t?Object(I.b)(or.n):Object(I.b)(or.o),t?Object(I.b)(or.c):Object(I.b)(or.d),t?Object(I.b)(or.j):Object(I.b)(or.k))}function sr(e){return function(e,t,n,r,i,a){switch(e.length){case 0:throw new Error("formatDomains: no email addresses");case 1:return Object(I.c)(t,e[0]);case 2:return Object(I.c)(n,e[0],e[1]);case 3:return Object(I.c)(r,e[0],e[1]);case 4:case 5:case 6:return Object(I.c)(i,e[0],e[1],e.length-2);default:return Object(I.c)(a,e[0],e[1],e.length-2)}}(e,Object(I.b)(or.a),Object(I.b)(or.q),Object(I.b)(or.m),Object(I.b)(or.b),Object(I.b)(or.i))}function dr(e,t,n,r,i,a,o){switch(e.length){case 0:throw new Error("formatSenders: no email addresses");case 1:return Object(I.c)(n,t(e[0]));case 2:return Object(I.c)(r,t(e[0]),t(e[1]));case 3:return Object(I.c)(i,t(e[0]),t(e[1]));case 4:case 5:case 6:return Object(I.c)(a,t(e[0]),t(e[1]),e.length-2);default:return Object(I.c)(o,t(e[0]),t(e[1]),e.length-2)}}function lr(e){return e.map((function(e){return""}))}var br=Object(i.action)("ADD_DOMAINS_TO_BLOCKED_LIST",(function(e){return{domains:e}})),fr=n(2769),vr=n(11899),Or=n(83),mr=!1;function jr(e,t){return Object(Z.__awaiter)(this,void 0,void 0,(function(){var n,r,i,a,o,c;return Object(Z.__generator)(this,(function(u){switch(u.label){case 0:return e?[4,hr(e)]:[2];case 1:return u.sent()?[4,Object(pt.b)(Object(I.b)(vr.b),Object(I.b)(vr.a),!1,{hideCancelButton:!0})]:[3,3];case 2:return u.sent(),[2];case 3:return mr=!1,n=function(e){var t=e.map((function(e){return e.EmailAddress.split("@")[1]}));return t.filter((function(e,n){return t.indexOf(e)===n}))}(e),r=Object(Z.__read)(function(e,t){return[cr(e),ur(e),sr(t)]}(e,n),3),i=r[0],a=r[1],o=r[2],c=Hn.createElement(Bn.a,{key:"blockDomainCheckbox",defaultChecked:mr,label:o,onChange:pr}),[4,Object(pt.b)(i,a,!1,{bodyElement:Object(Or.i)("tri-blockDomain")?c:null})];case 4:if(u.sent()!==pt.a.ok)return[2];mr&&(br(n),Object(fe.p)("BlockDomain",[n.length]));try{d=nn({EmailAddresses:s=e,ActionType:2,RuleName:null,RuleNames:lr(s)}),rn({Header:Object(Q.b)(),Body:d}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}catch(e){}return t(),[2]}var s,d}))}))}function pr(){mr=!mr}function hr(e){return Object(Z.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,a,o;return Object(Z.__generator)(this,(function(c){switch(c.label){case 0:return Object(On.a)()?[2,Promise.resolve(!1)]:[4,Object(fr.b)(Object(Se.a)().SessionSettings.UserEmailAddress,e.map((function(e){return e.EmailAddress})))];case 1:if(t=c.sent()){n=t.ResponseMessages.map((function(e){return Object(fr.a)(e.MessageText)})).filter((function(e){return!!e}));try{for(r=Object(Z.__values)(n),i=r.next();!i.done;i=r.next())if(0===i.value.ExternalMemberCount)return[2,Promise.resolve(!0)]}catch(e){a={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(a)throw a.error}}}return[2,Promise.resolve(!1)]}}))}))}var kr=n(6881),gr=n(9809),yr=n(1854);function Ir(e,t,n){if(e&&0!=e.length){var r=Object(ae.a)(e,t);jr(Object(kr.a)(e,t),(function(){Sr(e,t,n,r)})),Object(yr.a)("Block",r,{rowKeys:e})}else vn.d("Block button should not be exposed when there is nothing selected in list view.")}var Sr=Object(r.d)("deleteRowsUponBlocking",s.a.blockSendersFromTable)((function(e,t,n,r){var i=e.filter((function(e){return t.rowKeys.indexOf(e)>=0}));switch(t.tableQuery.listViewType){case 0:var a=Object(gr.a)(i,t.id);Object(ar.b)(a,t.id,"MoveToDeletedItems",r);break;case 1:var o=Object(f.C)(e,t.id);Object(h.c)(o,"MoveToDeletedItems",t.tableQuery.folderId,null,r,null,Object(q.c)(t.tableQuery.folderId,Object(E.b)(t)))}}));function wr(e,t,n){e?(jr(Object(kr.b)([e]),(function(){Cr(e,t,n)})),Object(yr.a)("Block",t,{itemIds:[e]})):vn.d("blockLastSendersFromReadingPane should not be called on invalid items.")}var Cr=Object(r.d)("deleteItemUponBlock",{name:"TnS_BlockSenderFromReadingPane",actionSource:function(e,t,n){return n}})((function(e,t,n){return Object(h.a)([e],"MoveToDeletedItems",t)}));function _r(e,t,n,r){if(!e||0===e.length)throw new Error("Update category action should not be exposed.");if(r&&(t||n))throw new Error("When clearCategories is true, categoriesToAdd and categoriesToRemove both have to be null.");if(t&&n)throw new Error("Can only add or remove categories at one time.")}var Tr=n(3273),Nr=n(1737),Fr={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CategorizeConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoriesToAdd"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoriesToRemove"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clearAllCategories"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"processRightAway"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"categorizeConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"categoriesToAdd"},value:{kind:"Variable",name:{kind:"Name",value:"categoriesToAdd"}}},{kind:"ObjectField",name:{kind:"Name",value:"categoriesToRemove"},value:{kind:"Variable",name:{kind:"Name",value:"categoriesToRemove"}}},{kind:"ObjectField",name:{kind:"Name",value:"clearAllCategories"},value:{kind:"Variable",name:{kind:"Name",value:"clearAllCategories"}}},{kind:"ObjectField",name:{kind:"Name",value:"processRightAway"},value:{kind:"Variable",name:{kind:"Name",value:"processRightAway"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]};function Ar(e,t,n,r,i,a){return Object(Tr.a)(e,t.id,n,r,i),function(e,t){Nr.a.add(e,t,0)}(e,t),function(e,t,n,r,i,a){var o=Object(f.k)(t,!0),c=e.map((function(e){return Object(f.h)(e,t.id)})),u=xr.invokeCategorizeConversationMutation(c,o,n,r,i);return Object(O.c)(u,e,t.serverFolderId,t,!1,!0)}(e,t,n,r,i)}var xr={invokeCategorizeConversationMutation:function(e,t,n,r,i){var a;return Object(Z.__awaiter)(this,void 0,void 0,(function(){var o,c;return Object(Z.__generator)(this,(function(u){switch(u.label){case 0:return o=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(R.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(Ee.a)()];case 1:return[4,u.sent().mutate({variables:{conversations:o,categoriesToAdd:n,categoriesToRemove:r,clearAllCategories:i,processRightAway:Object(Or.i)("tri-processConversationCategoriesRightAway"),folderId:t},mutation:Fr})];case 2:return c=u.sent(),[2,null===(a=null==c?void 0:c.data)||void 0===a?void 0:a.categorizeConversation]}}))}))}},Er=n(3274),Rr={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CategorizeItem"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"items"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CategorizeItemSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"categorizeItem"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"items"},value:{kind:"Variable",name:{kind:"Name",value:"items"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]};function Mr(e,t,n,r,i){var a=Object(f.C)(e,t.id);return Object(Er.a)(a,n,r,i),Nr.a.add(e,t,0),function(e,t,n){return Object(Z.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(Z.__generator)(this,(function(a){switch(a.label){case 0:r=Object(E.b)(t),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Dr.invokeCategorizeItemMutation(n,r)];case 2:return a.sent(),Object(O.a)(e,t.serverFolderId,!0),[3,4];case 3:return i=a.sent(),Object(O.a)(e,t.serverFolderId,!0),Object(O.b)(t),[2,Promise.reject(i)];case 4:return[2]}}))}))}(e,t,function(e){var t=[];return e.forEach((function(e){var n=Object(S.v)(e);t.push({id:n.ItemId.Id,categories:n.Categories})})),t}(a))}var Dr={invokeCategorizeItemMutation:function(e,t){var n;return Object(Z.__awaiter)(this,void 0,void 0,(function(){var r;return Object(Z.__generator)(this,(function(i){switch(i.label){case 0:return[4,Object(Ee.a)()];case 1:return[4,i.sent().mutate({variables:{items:e,mailboxInfo:t},mutation:Rr})];case 2:return r=i.sent(),[2,null===(n=null==r?void 0:r.data)||void 0===n?void 0:n.categorizeItem]}}))}))}},Vr=n(668),Pr=Object(r.d)("addCategories",s.a.addCategories)((function(e,t,n,r,i){var a=Ur(e,t,n,null,!1,r,i);Vr.A.importAndExecute(n);var o=Object(ae.a)(e,t);return Object(_.d)("Categorize",o),a})),Br=Object(r.d)("clearCategories",s.a.clearCategories)((function(e,t,n){return Ur(e,t,null,null,!0,n)})),Lr=Object(r.d)("removeCategoriesFromTable",s.a.removeCategories)((function(e,t,n,r){return Ur(e,t,null,n,!1,r)}));function Ur(e,t,n,r,i,a,o){return Object(f.P)(t)?function(e,t,n,r,i,a,o){return _r(e,n,r,i),q.b(),o?o.then((function(o){return Ar(e,t,n,r,i,a)})):Ar(e,t,n,r,i,a)}(e,t,n,r,i,a,o):function(e,t,n,r,i,a,o){return _r(e,n,r,i),q.b(),o?o.then((function(a){return Mr(e,t,n,r,i)})):Mr(e,t,n,r,i)}(e,t,n,r,i,0,o)}var Wr=n(1365),Kr=n(1724),Jr=Object(F.action)("translateFromTable")((function(e,t,n){return Object(Z.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(Z.__generator)(this,(function(i){switch(i.label){case 0:if(n=f.b.getRowClientItemId(e[0],t),!e||0==e.length)return vn.d("Translate button should not show when empty list"),[2];switch(t.tableQuery.listViewType){case 0:return[3,1];case 1:return[3,6]}return[3,8];case 1:return[4,Kr.j.import()];case 2:return[4,i.sent()(n)];case 3:return(null==(r=i.sent())?void 0:r.Id)?[4,Wr.z.import()]:[3,5];case 4:i.sent()(Object(Wr.p)(r.Id)),i.label=5;case 5:return[3,8];case 6:return[4,Wr.z.import()];case 7:return i.sent()(Object(Wr.p)(n.Id)),[3,8];case 8:return[2]}}))}))})),Hr=Object(i.action)("toggleIgnoreConversations",(function(e,t,n,r){return{rowKeysToIgnore:e,tableViewId:t,shouldIgnore:n,actionSource:r}})),Qr=Object(i.action)("INTERNAL_TOGGLE_IGNORE_CONVERSATION",(function(e,t,n,i){return Object(r.c)({name:"TnS_Ignore",customData:[i,n],options:{isCore:!0}},{rowKeysToIgnore:e,tableViewId:t,shouldIgnore:n,actionSource:i})})),Gr=Object(i.action)("MOVE_SHARED_FOLDER_ITEMS",(function(e,t,n,r,i){return{rowKeys:e,originalTableViewId:t,destinationFolderId:n,parentFolderId:r,actionSource:i}})),qr=Object(i.action)("MOVE_SHARED_FOLDER_CONVERSATIONS",(function(e,t,n){return{rowKeys:e,destinationFolderId:t,originalTableView:n}})),zr=Object(i.action)("ON_REMOVE_MEETING",(function(e,t){return{tableViewId:e,conversationId:t}})),Xr=n(4773),Zr=Object(i.action)("removeSpotlight",(function(e,t,n,r){return{rowKey:e,tableViewId:t,actionSource:n,itemOrConversationId:r}})),Yr=n(11900),$r=n(1590),ei=n(6160),ti=n(8217);var ni=90,ri=98;function ii(){var e;(e=Object(ei.a)({Header:Object(Q.b)()}),Object(ti.a)(e)).then((function(e){var t,n;if(e.AccountInfo.Statistics&&e.AccountInfo.Mailbox){var r=e.AccountInfo.Statistics.TotalItemSize.Value,i=Object(ue.h)(),a=r/(n=!(null===(t=null==i?void 0:i.SessionSettings)||void 0===t?void 0:t.IsBposUser)&&e.AccountInfo.Mailbox.UseDatabaseQuotaDefaults?e.AccountInfo.Statistics.DatabaseProhibitSendQuota:e.AccountInfo.Mailbox.ProhibitSendQuota).Value*100;if(!(a<ni||n.IsUnlimited)){Object(fe.p)("TnS_MailboxQuotaWarning",[Math.round(a)]);var o=Object(I.c)(Object(I.b)(Yr.b),a.toFixed(2));o+=a>=ri?Object(I.b)(Yr.a):Object(I.b)(Yr.c),Ie.e.importAndExecute("mailboxQuotaWarningNotification","MailModuleNotificationBarHost",o,{primaryActionText:Object(I.b)(Yr.d),allowAutoDismiss:!1,shouldShowDismissIcon:!0,minWidth:0,notificationCallback:function(e){e===Ie.a.PrimaryActionClicked&&(Object(fe.p)("MailboxCleanup_NavigateTo",["OldMailboxQuotaWarning"]),$r.f.importAndExecute("general","storage"))}})}}}))}var ai=n(11901),oi=n(1937),ci=n(2985),ui=n(1644);Object(i.orchestrator)($t,(function(e){Object(pt.b)(Object(I.b)(ai.b),Object(I.c)(Object(I.b)(ai.a),e.message.From.Mailbox.Name),!1,{okText:Object(I.b)(oi.a),cancelText:Object(I.b)(Qt.a)}).then((function(t){return Object(Z.__awaiter)(void 0,void 0,void 0,(function(){return Object(Z.__generator)(this,(function(n){var r,i;return t===pt.a.ok&&(r=e.cacheEntry,i=e.itemViewState,Object(ci.e)("ReadingPaneInfoBar",r.smtpInfo.smtpAddress,r.smtpInfo.smtpIdentifier,r.unsubscribeSilentUris,r.unsubscribeHttpUris[0],(function(){Object(ui.a)(i,"unsubscribeInfoBar")}))),[2]}))}))}))}));var si=n(11902),di=n(4235);function li(){return Object(di.a)().then((function(e){if(e.WasSuccessful)return e.Options;throw new Error("getMailboxJunkEmailConfigurationOperation "+e.ErrorCode+" "+e.ErrorMessage)}))}var bi=n(6619);function fi(e){return Object(bi.a)({Header:Object(Q.b)(),Options:e})}function vi(e,t,n){var r=null==t?null:Object(B.a)({BaseFolderId:Object(V.a)({Id:t})}),i=e.map((function(e){return function(e,t,n){return Object(D.a)({Action:"AlwaysDelete",ConversationId:Object(P.a)({Id:e}),ContextFolderId:t,EnableAlwaysDelete:n,ProcessRightAway:Object(Or.i)("tri-processIgnoreRightAway")})}(e,r,n)}));return Object(M.a)({ConversationActions:i,ReturnMovedItemIds:!0})}Object(i.orchestrator)(a,(function(e){return Object(Z.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(Z.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(pt.b)(Object(I.c)(Object(I.b)(si.b),e.mailbox.EmailAddress),Object(I.c)(Object(I.b)(si.a),e.mailbox.EmailAddress))];case 1:return n.sent()!==pt.a.ok?[3,3]:[4,li()];case 2:t=n.sent(),o(e.mailbox,t),fi(t),n.label=3;case 3:return[2]}}))}))}));var Oi=function(){function e(e,t,n,r){var i=this;this.checkboxToggled=function(){i.isChecked=!i.isChecked},this.title=e,this.subtext=t,this.isChecked=!1,this.onConfirm=n,this.onDismiss=r,this.dialogOptions={okText:Object(I.b)(oi.a),cancelText:Object(I.b)(Qt.a),bodyElement:Hn.createElement(Bn.a,{label:Object(I.b)(Vn.a),onChange:this.checkboxToggled})}}return e.prototype.show=function(){var e=this;return Object(pt.b)(this.title,this.subtext,!1,this.dialogOptions).then((function(t){return t===pt.a.ok?e.onConfirm(e.isChecked):e.onDismiss()}))},e}(),mi=n(11903);Object(i.orchestrator)(Hr,(function(e){var t=e.shouldIgnore,n=e.rowKeysToIgnore,r=t?128:256;if((r&Object(Se.a)().UserOptions.NewEnabledPonts)==r){var i=void 0;i=t?1==n.length?Object(I.b)(mi.b):Object(I.c)(Object(I.b)(mi.c),n.length):1==n.length?Object(I.b)(mi.e):Object(I.c)(Object(I.b)(mi.f),n.length);var a=t?Object(I.b)(mi.a):Object(I.b)(mi.d);new Oi(i,a,(function(n){n&&function(e){var t=Object(Se.a)().UserOptions.NewEnabledPonts&~e;Object(Qn.a)((function(e){e.UserOptions.NewEnabledPonts=t}),[{key:"NewEnabledPonts",valuetype:"Integer32",value:[""+t]}])}(r),Qr(e.rowKeysToIgnore,e.tableViewId,t,e.actionSource)}),(function(){})).show()}else Qr(e.rowKeysToIgnore,e.tableViewId,t,e.actionSource)}));Object(i.orchestrator)(Qr,(function(e){var t,n,r=e.shouldIgnore,i=e.tableViewId,a=e.rowKeysToIgnore,o=[],c=f.X.tableViews.get(i);try{for(var u=Object(Z.__values)(a),s=u.next();!s.done;s=u.next()){var l=s.value;o.push(f.b.getConversationId(l,c))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}if(r){var v=Object(ae.a)(a,c);Object(_.d)("Ignore",v,{rowKeys:a})}if(Object(f.P)(c))Object(Re.a)(o,c,"Ignore");else{var m=Object(f.C)(a,i),j=Object(d.a)(m);Object(b.a)(j,c.tableQuery.folderId,"Ignore")}var p=function(e,t,n){var r=vi(e,t,n);return Object(L.a)(r)}(o,c.tableQuery.folderId,r);return Object(O.c)(p,a,c.tableQuery.folderId,i,!1)}));var ji=n(1510),pi=n(6161),hi=n(2478);Object(i.orchestrator)(k,(function(e){var t=f.X.tableViews.get(e.tableViewId),n=Object(Z.__spread)(t.selectedRowKeys.keys()),r=Object(pi.a)(e.nodeIds,Object(hi.a)(n[0]));f.X.expandedConversationViewState.selectedNodeIds.indexOf(e.nodeIds[0])>-1&&Object(ji.m)(f.X.expandedConversationViewState.expandedRowKey,t),Object(h.a)(r,t.tableQuery.folderId&&Object($n.a)(t.tableQuery.folderId,"deleteditems")||function(e){var t,n;try{for(var r=Object(Z.__values)(e),i=r.next();!i.done;i=r.next()){var a=i.value,o=S.u.items.get(a);if((null==o?void 0:o.ParentFolderId)&&"deleteditems"==Object(we.a)(o.ParentFolderId.Id))return!0}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!1}(r)?"SoftDelete":"MoveToDeletedItems",null,e.actionSource,Object(E.b)(t))}));Object(i.orchestrator)(rt,(function(e){var t=f.X.tableViews.get(e.tableViewId),n=Object(Z.__spread)(t.selectedRowKeys.keys()),r=Object(pi.a)(e.nodeIds,Object(hi.a)(n[0]));Object(ji.m)(f.X.expandedConversationViewState.expandedRowKey,t),Ge(r,e.destinationFolderId,t,e.actionSource)})),Object(i.orchestrator)(Yn,(function(e){var t=f.X.tableViews.get(e.tableViewId),n=Object(Z.__spread)(t.selectedRowKeys.keys()),r=Object(pi.a)(e.nodeIds,Object(hi.a)(n[0]));Object(ji.m)(f.X.expandedConversationViewState.expandedRowKey,t),Gn(r,e.isJunkValueToSet,e.actionSource,t,null,(function(){var e=Object(d.a)(r);Object(b.a)(e,t.tableQuery.folderId,"MarkAsJunk")}))})),Object(i.orchestrator)(tr,(function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.selectedRowKeys;if(n.length>0)Yn(n,t.id,!0,"Keyboard");else{if(0===r.length)return;Zn(r,t,!0,"Keyboard")}}));var ki=n(2964);Object(i.orchestrator)(nr,(function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.selectedRowKeys;if(Object(Oe.b)(11))if(n.length>0){var i=function(e,t){var n,r;try{for(var i=Object(Z.__values)(e),a=i.next();!a.done;a=i.next()){var o=a.value;if("Flagged"!==Object(ki.a)(o,t).Flag.FlagStatus)return"Flagged"}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return Object(ue.s)()?"NotFlagged":"Complete"}(n,Object(hi.a)(r[0]));de(n,t.id,i,"Keyboard")}else{if(0===r.length)return;se(r,t.id,"Keyboard")}}));var gi=n(1538),yi=(Object(i.orchestrator)(rr,(function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.selectedRowKeys;if(n.length>0)rt(n,Object(mn.a)("archive"),t.id,"Keyboard"),gi.b.importAndExecute();else{if(0===r.length)return;it(r,t,"Keyboard")}})),Object(i.orchestrator)(ir,(function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.selectedRowKeys,i=e.isInVirtualSelectAllMode,a=e.isExplicitSoftDelete;if(Object(Oe.b)(9)){if(i)wn(t,a,"Keyboard",t.virtualSelectAllExclusionList);else{if(n.length>0)return k(n,t.id,"Keyboard"),void gi.b.importAndExecute();r.length>0&&Object(c.a)(r,t.id,a,"Keyboard")}0==t.rowKeys.length&&gi.b.importAndExecute()}})),Object(i.orchestrator)(de,(function(e){var t=f.X.tableViews.get(e.tableViewId),n=Object(Z.__spread)(t.selectedRowKeys.keys());ie(Object(pi.a)(e.nodeIds,Object(hi.a)(n[0])),null,{FlagStatus:e.flagStatusToSet},e.tableViewId,e.actionSource)})),n(3196)),Ii=n(2794),Si=(Object(i.orchestrator)(Gr,(function(e){return Object(Z.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,i,a,o,c,u,l,v,O,m,j,p;return Object(Z.__generator)(this,(function(h){switch(h.label){case 0:t=e.rowKeys,n=e.originalTableViewId,r=e.destinationFolderId,i=e.parentFolderId,a=e.actionSource,o=Object(f.C)(t,n),c=Object(d.a)(o),u=Object(f.G)(),Object(fe.p)(s.a.moveItems.name(t,r,u,a),s.a.moveItems.customData(t,r,u,a)),Ne(c,r),Object(b.a)(c,i,"Move"),q.b(),l=o.map((function(e){return{Id:e}})),h.label=1;case 1:return h.trys.push([1,6,,7]),[4,Object(Ye.a)(o,Object(Le.a)(r),!0)];case 2:return v=h.sent(),(O=(null===(p=v.ResponseMessages)||void 0===p?void 0:p.Items)?v.ResponseMessages.Items[0]:null)&&"Success"==O.ResponseClass?[4,Object(yi.a)(l,"HardDelete",null)]:[3,4];case 3:return m=h.sent(),Si(u,t),"Success"!==m[0].ResponseClass?(Object(Ii.a)(u),Object(Oe.j)(r)):_e(o.length,r,!1),[3,5];case 4:Si(u,t),Object(Ii.a)(u),Object(Oe.j)(r),h.label=5;case 5:return[3,7];case 6:return j=h.sent(),vn.d("Shared Folder move item action failed : "+JSON.stringify(j)),[3,7];case 7:return[2]}}))}))})),function(e,t){var n=e.tableQuery.folderId;Nr.a.removeRowsFromTombstone(t,n)}),wi=(Object(i.orchestrator)(qr,(function(e){return Object(Z.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,i,a,o,c,u,s;return Object(Z.__generator)(this,(function(d){switch(d.label){case 0:t=e.rowKeys,n=e.originalTableView,r=e.destinationFolderId,i=t.map((function(e){return Object(f.h)(e,n.id)})),a=Object(f.C)(t,n.id),Fe(t,n,r),Object(Re.a)(a,n,"Move"),d.label=1;case 1:return d.trys.push([1,6,,7]),[4,et(i,r,n.tableQuery.folderId)];case 2:return(o=d.sent())&&"Success"==o.ResponseClass?(c=Object(E.b)(n),[4,ar.c.invokeDeleteConversationMutation(i,Object(f.k)(n),"HardDelete",c)]):[3,4];case 3:return u=d.sent(),Si(n,t),u.success?_e(i.length,r,!1):(Object(Ii.a)(n),Object(Oe.j)(r)),[3,5];case 4:Si(n,t),Object(Ii.a)(n),Object(Oe.j)(r),d.label=5;case 5:return[3,7];case 6:return s=d.sent(),vn.d("Shared Folder move conversation action failed : "+JSON.stringify(s)),[3,7];case 7:return[2]}}))}))})),n(6614)),Ci=n(2482);var _i=n(8218);Object(i.orchestrator)(jn.a,(function(e){var t=[];if(e.rowKeysToExclude.length>0){var n=f.X.tableViews.get(e.tableViewId);switch(n.tableQuery.listViewType){case 0:t=Object(wt.a)(e.rowKeysToExclude,e.tableViewId);break;case 1:t=function(e,t){var n={};return e.forEach((function(e){var r=f.b.getRowClientItemId(e,t).Id;n[r]||(n[r]=!0)})),Object.keys(n)}(e.rowKeysToExclude,n)}}var r=f.X.tableViews.get(e.tableViewId),i=Object(wi.a)(e.folder.FolderId.Id,e.disposalType,e.deleteSubFolders,e.clientLastSyncTime,t,e.shouldSupportBulkActions).then((function(){r&&Object(_i.a)(r)})).catch((function(e){return r&&Object(_i.a)(r),Promise.reject(e)}));return Object(Ci.a)(e.folder,e.clientLastSyncTime,e.deletedItemsFolderId,e.rowKeysToExclude),i}));var Ti=n(11904);function Ni(e,t){if(Object(ue.h)().UserOptions.ShowNotificationBar){var n=t?Object(I.b)(Ti.a):Object(I.b)(Ti.b),r=Object(ye.h)();Ie.e.importAndExecute("scheduleNotification","MailModuleNotificationBarHost",n,{icon:"Clock",primaryActionText:e?Object(I.b)(ge.a):null,minWidth:r.minWidth,maxWidth:r.maxWidth,notificationCallback:function(e){e===Ie.a.PrimaryActionClicked&&q.e.importAndExecute("NotificationBar")}})}}var Fi={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ScheduleConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scheduleReturnTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"scheduleConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"scheduleReturnTime"},value:{kind:"Variable",name:{kind:"Name",value:"scheduleReturnTime"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"undoRequestId"},arguments:[],directives:[]}]}}]}}]},Ai={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UndoScheduleConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"undoScheduleConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},xi=Object(r.d)("ScheduleConversation",s.a.scheduleItems)((function(e,t,n,r){var i=this,a=t.id,o=Object(f.g)(e,a,(function(e){return!!e}));if(0==o.length)return Promise.resolve();var c=Object(f.C)(o,a),u=o.map((function(e){return Object(f.h)(e,a)})),s=t.tableQuery.folderId,d=Object(mn.a)("scheduled"),l=s===d;q.b(),Ni(!l,r),l||Object(Re.a)(c,t,"Snooze");var b=function(e,t,n){var r;return Object(Z.__awaiter)(this,void 0,void 0,(function(){var i,a;return Object(Z.__generator)(this,(function(o){switch(o.label){case 0:return i=e.map((function(e){return{id:e.conversationId}})),[4,Object(Ee.a)()];case 1:return[4,o.sent().mutate({variables:{conversations:i,folderId:t,scheduleReturnTime:n?Object(Sn.tb)(n):null},mutation:Fi})];case 2:return a=o.sent(),[2,null===(r=null==a?void 0:a.data)||void 0===r?void 0:r.scheduleConversation]}}))}))}(u,s,r);return l||q.a((function(){return Object(Z.__awaiter)(i,void 0,void 0,(function(){var e;return Object(Z.__generator)(this,(function(t){switch(t.label){case 0:return[4,b];case 1:return(e=t.sent()).success?[4,Ei(u,d,e.undoRequestId)]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2,Promise.resolve()]}}))}))}),t.serverFolderId,b),Object(O.c)(b,o,t.serverFolderId,t,!1,!0)}));function Ei(e,t,n){var r;return Object(Z.__awaiter)(this,void 0,void 0,(function(){var i,a;return Object(Z.__generator)(this,(function(o){switch(o.label){case 0:return i=e.map((function(e){return{id:e.conversationId}})),[4,Object(Ee.a)()];case 1:return[4,o.sent().mutate({variables:{conversations:i,folderId:t,undoRequestId:n},mutation:Ai})];case 2:return a=o.sent(),[2,null===(r=null==a?void 0:a.data)||void 0===r?void 0:r.undoScheduleConversation]}}))}))}var Ri=n(9811),Mi=n(9812),Di=n(6156);function Vi(e,t){var n=function(e,t){return Object(Ri.a)({MessageAction:Object(Mi.a)({Action:t?"Schedule":"Unschedule",ScheduleReturnTime:t?Object(Sn.tb)(t):null}),Ids:e.map((function(e){return Object(P.a)({Id:e})}))})}(e,t);return Object(Di.a)({Header:Object(Q.b)(),Body:n}).then((function(e){return e.Body.ResponseMessages.Items}))}var Pi=Object(r.d)("scheduleItems",s.a.scheduleItems)((function(e,t,n,r){return Object(Z.__awaiter)(this,void 0,void 0,(function(){var n,i,a,o,c,u=this;return Object(Z.__generator)(this,(function(s){return 0===(n=Object(f.C)(e,t.id)).length?[2,Promise.resolve()]:(i=t.tableQuery.folderId,a="scheduled"===Object(we.a)(i),q.b(),Ni(!a,r),a||(o=Object(d.a)(n),Object(b.a)(o,i,"Snooze")),c=Vi(n,r),a||q.a((function(){return Object(Z.__awaiter)(u,void 0,void 0,(function(){var e,t,n,r,i,a,o;return Object(Z.__generator)(this,(function(u){switch(u.label){case 0:return e=[],[4,c];case 1:t=u.sent();try{for(n=Object(Z.__values)(t),r=n.next();!r.done;r=n.next())"Success"===(i=r.value).ResponseClass&&e.push(i.Item.ItemId.Id)}catch(e){a={error:e}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(a)throw a.error}}return e.length>0?[4,Vi(e)]:[3,3];case 2:u.sent(),u.label=3;case 3:return[2,Promise.resolve()]}}))}))}),t.serverFolderId),[2,c.then((function(e){return Object(m.a)(e)})).catch((function(e){return Promise.reject(e)}))])}))}))}));Object(i.orchestrator)(g,(function(e){var t=e.rowKeys,n=e.actionSource,r=e.scheduleReturnTime,i=e.tableViewId,a=Object(f.J)().tableViews.get(i);switch(Object(_.d)("Snooze",null,{rowKeys:t}),a.tableQuery.listViewType){case 0:return void xi(t,a,n,r);case 1:return void Pi(t,a,n,r);default:throw new Error("scheduleRows: Invalid listView type")}})),Object(i.mutator)(o,(function(e){e.junkEmailConfiguration.TrustedSendersAndDomains.push(e.mailbox.EmailAddress)}));var Bi=n(4937),Li=n(4938);Object(i.orchestrator)(ci.d,(function(e){"ReadingPaneInfoBar"===e.unsubscribeSourceType&&(e.responseType===ci.a.Success?e.completedCallback&&e.completedCallback():Object(pt.b)(Object(I.b)(Li.a),Object(I.b)(Bi.a),!1,{hideCancelButton:!0}))})),Object(i.orchestrator)(zr,(function(e){var t=e.tableViewId,n=e.conversationId,r=f.X.tableViews.get(t);if(Object(f.P)(r)){var i=Object(f.E)([n],r);if(0===i.length)return;Nr.a.add(i,r,4)}}));Object(i.orchestrator)(br,(function(e){return Object(Z.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(Z.__generator)(this,(function(n){switch(n.label){case 0:return[4,li()];case 1:return t=n.sent(),e.domains.forEach((function(e){-1===t.BlockedSendersAndDomains.indexOf(e)&&t.BlockedSendersAndDomains.push(e)})),fi(t),[2]}}))}))})),n.d(t,"addMailboxToSafeSenders",(function(){return a})),n.d(t,"deleteMailListRows",(function(){return c.a})),n.d(t,"restoreMailListRows",(function(){return p})),n.d(t,"deleteItems",(function(){return h.a})),n.d(t,"deleteItemsBasedOnNodeOrThreadIds",(function(){return k})),n.d(t,"scheduleRows",(function(){return g})),n.d(t,"toggleRowsFlagState",(function(){return se})),n.d(t,"setMailListRowsFlagState",(function(){return oe})),n.d(t,"setItemsFlagStateFromItemIds",(function(){return ie})),n.d(t,"setItemsFlagStateBasedOnNodeIds",(function(){return de})),n.d(t,"moveMailListRows",(function(){return Xe})),n.d(t,"copyMailListRows",(function(){return tt})),n.d(t,"moveItemsFromItemIds",(function(){return Ge})),n.d(t,"moveItemsBasedOnNodeIds",(function(){return rt})),n.d(t,"archiveMailListRowsFromTable",(function(){return it})),n.d(t,"toggleRowPinnedState",(function(){return vt})),n.d(t,"markRowsPinnedUnpinned",(function(){return Ot})),n.d(t,"markRowsAsPhishingFromTable",(function(){return Tt})),n.d(t,"markItemAsPhishingFromReadingPane",(function(){return Nt})),n.d(t,"restoreConversations",(function(){return u.a})),n.d(t,"moveMailListRowsToFocusedOrOther",(function(){return Mt})),n.d(t,"alwaysMoveRowToFocusedOrOther",(function(){return Wt})),n.d(t,"unsubscribeEmail",(function(){return Yt})),n.d(t,"unsubscribeEmailV2",(function(){return $t})),n.d(t,"sweepConversations",(function(){return dn})),n.d(t,"emptyFolder",(function(){return yn})),n.d(t,"emptySearchTableView",(function(){return In})),n.d(t,"emptyTableView",(function(){return wn})),n.d(t,"likeItem",(function(){return xn})),n.d(t,"reactToItem",(function(){return Dn})),n.d(t,"markRowsJunkNotJunkFromTable",(function(){return Zn})),n.d(t,"markItemsJunkNotJunkBasedOnNodeIds",(function(){return Yn})),n.d(t,"markItemJunkNotJunkFromReadingPane",(function(){return er})),n.d(t,"onKeyboardMarkAsJunkNotJunk",(function(){return tr})),n.d(t,"onKeyboardToggleFlagState",(function(){return nr})),n.d(t,"onKeyboardArchive",(function(){return rr})),n.d(t,"onKeyboardDelete",(function(){return ir})),n.d(t,"blockLastSendersFromTable",(function(){return Ir})),n.d(t,"blockLastSenderFromReadingPane",(function(){return wr})),n.d(t,"addCategoriesFromTable",(function(){return Pr})),n.d(t,"removeCategoriesFromTable",(function(){return Lr})),n.d(t,"clearCategoriesFromTable",(function(){return Br})),n.d(t,"translateFromTable",(function(){return Jr})),n.d(t,"toggleIgnoreConversations",(function(){return Hr})),n.d(t,"moveSharedFolderItems",(function(){return Gr})),n.d(t,"moveSharedFolderConversations",(function(){return qr})),n.d(t,"onRemoveMeeting",(function(){return zr})),n.d(t,"dismissNudge",(function(){return Xr.a})),n.d(t,"removeSpotlight",(function(){return Zr})),n.d(t,"showNotificationOnMailboxQuotaWarning",(function(){return ii}))},4773:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("DISMISS_NUDGE",(function(e,t,n,r){return{rowKey:e,tableViewId:t,actionSource:n,itemOrConversationId:r}}))},4937:function(e){e.exports=JSON.parse('{"a":"wVa"}')},4938:function(e){e.exports=JSON.parse('{"a":"xVa"}')},505:function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"n",(function(){return l})),n.d(t,"l",(function(){return b})),n.d(t,"m",(function(){return f})),n.d(t,"a",(function(){return v})),n.d(t,"h",(function(){return O})),n.d(t,"b",(function(){return m})),n.d(t,"e",(function(){return j})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return h})),n.d(t,"o",(function(){return k}));var r=n(136),i=n(112),a=n(9);function o(e,t){return void 0===t&&(t=Object(a.Pb)()),s(Object(a.ac)(t,e),r.a.DaysInOneWeek)}function c(e,t){var n=u(e,t),r=Object(a.B)(e),i=Object(a.e)(Object(a.C)(r,t),1);return s(n,Math.abs(Object(a.s)(n,i)-1))}function u(e,t){var n=Object(a.Zb)(e);return Object(a.ac)(n,t)}function s(e,t){return{start:e,end:Object(a.e)(e,t-1)}}function d(e,t,n,r,c){switch(void 0===c&&(c=1),e){case i.b.Day:return s(Object(a.Wb)(t),c);case i.b.Month:var u=Object(a.Zb)(t),d=Object(a.B)(t);return s(u,Math.abs(Object(a.s)(u,d)-1));case i.b.Week:return o(n,t);case i.b.WorkWeek:return function(e,t,n){void 0===n&&(n=Object(a.Pb)());for(var r,i,c=o(e,n),u=0;u<=p(c);u++){var s=Object(a.e)(c.start,u);if(!r&&t.includes(Object(a.nb)(s))&&(r=s),s=Object(a.e)(c.end,-u),!i&&t.includes(Object(a.nb)(s))&&(i=s),r&&i)break}return{start:r,end:i}}(n,r,t)}}function l(e,t){var n=c(e,t);return Object(a.t)(n.end,n.start,t)}function b(e,t){var n;return s(n=t==i.b.WorkWeek?Object(a.k)(e.start,1):Object(a.e)(e.end,1),t==i.b.Month?Object(a.ob)(n):Object(a.s)(e.end,e.start)+1)}function f(e,t){var n,r;if(t==i.b.WorkWeek)n=Object(a.k)(e.start,-1),r=Object(a.k)(e.end,-1);else{r=Object(a.e)(e.start,-1);var o=t==i.b.Month?-Object(a.ob)(r):Object(a.s)(e.start,e.end)-1;n=Object(a.e)(e.start,o)}return{start:n,end:r}}function v(e,t){return e&&t&&0==Object(a.p)(e.start,t.start)&&0==Object(a.p)(e.end,t.end)}function O(e,t,n){if(!e||!t)throw new Error("Date ranges cannot be null in call to areDateRangesOverlapping");return n?Object(a.p)(e.start,t.start)<=0?Object(a.p)(e.end,t.start)>=0?0:1:Object(a.p)(t.end,e.start)>=0?0:-1:Object(a.p)(e.start,t.start)<0?Object(a.p)(e.end,t.start)>0?0:1:Object(a.p)(t.end,e.start)>0?0:-1}function m(e,t,n){return!(!e||!t)&&(n?Object(a.p)(e.start,t.start)<=0&&Object(a.p)(e.end,t.end)>=0:Object(a.p)(e.start,t.start)<0&&Object(a.p)(e.end,t.end)>0)}function j(e,t){return e&&t?{start:Object(a.p)(e.start,t.start)<0?e.start:t.start,end:Object(a.p)(e.end,t.end)>0?e.end:t.end}:null}function p(e){return Object(a.s)(e.end,e.start)}function h(e){return Math.floor(Object(a.v)(e.end,e.start)/24)+(Object(a.v)(e.end,e.start)%24>0?1:0)}function k(e,t){return Object(a.s)(e.start,t)<=0&&Object(a.s)(e.end,t)>=0}},506:function(e){e.exports=JSON.parse('{"a":"Naa"}')},534:function(e,t,n){"use strict";var r=n(505),i=n(9);function a(){var e=Object(i.Pb)(),t=Object(i.f)(Object(i.kc)(),12),n=Object(i.f)(Object(i.kc)(),18),r="Evening";return Object(i.y)(t,e)>0?r="Morning":Object(i.y)(n,e)>0&&(r="Afternoon"),r}function o(e,t,n){return Object(i.Mb)(e,t,n)}var c=n(136);function u(e,t){return function(e){var t=e%c.a.SecondsInOneMinute;return e-t+c.a.SecondsInOneMinute}(Object(i.y)(e,t))}var s=15*c.a.SecondsInOneMinute;function d(e,t){return u(e,t)<=s}var l=n(112),b=function(e,t,n){switch(n){case l.d.FirstFullWeek:return f(e,t,c.a.DaysInOneWeek);case l.d.FirstFourDayWeek:return f(e,t,4);default:return function(e,t){var n=v(e)-1,r=(Object(i.nb)(e)-n%c.a.DaysInOneWeek-t+2*c.a.DaysInOneWeek)%c.a.DaysInOneWeek;return Math.floor((n+r)/c.a.DaysInOneWeek+1)}(e,t)}};function f(e,t,n){var r=v(e)-1,a=Object(i.nb)(e)-r%c.a.DaysInOneWeek,o=v(Object(i.lc)(Object(i.Cb)(e)-1,l.e.December,31))-1,u=(t-a+2*c.a.DaysInOneWeek)%c.a.DaysInOneWeek;0!==u&&u>=n&&(u-=c.a.DaysInOneWeek);var s=r-u;return s<0&&(0!==(u=(t-(a-=o%c.a.DaysInOneWeek)+2*c.a.DaysInOneWeek)%c.a.DaysInOneWeek)&&u+1>=n&&(u-=c.a.DaysInOneWeek),s=o-u),Math.floor(s/c.a.DaysInOneWeek+1)}function v(e){for(var t=Object(i.xb)(e),n=Object(i.Cb)(e),r=0,a=0;a<t;a++)r+=O(a+1,n);return r+=Object(i.lb)(e)}function O(e,t){return Object(i.ob)(Object(i.lc)(t,e,0))}function m(e){for(var t=[],n=0;n<c.a.DaysInOneWeek;n++)e&1<<n&&t.push(n);return t}function j(e,t,n){for(var a=[],o=n.sort((function(e,t){var n=Object(i.p)(e.start,t.start);return 0!==n?n:Object(i.p)(e.end,t.end)})),c=Object(i.Wb)(e),u=0;Object(i.p)(c,t)<0&&u<o.length;){var s={start:c,end:Object(i.A)(c)},d=Object(r.h)(o[u],s,!1);d<=0?(0===d&&a.push(c),c=Object(i.e)(c,1)):u++}return a}n.d(t,"h",(function(){return r.g})),n.d(t,"g",(function(){return r.f})),n.d(t,"n",(function(){return r.k})),n.d(t,"d",(function(){return r.c})),n.d(t,"e",(function(){return r.d})),n.d(t,"s",(function(){return r.n})),n.d(t,"o",(function(){return r.l})),n.d(t,"p",(function(){return r.m})),n.d(t,"b",(function(){return r.a})),n.d(t,"j",(function(){return r.h})),n.d(t,"c",(function(){return r.b})),n.d(t,"f",(function(){return r.e})),n.d(t,"l",(function(){return r.j})),n.d(t,"k",(function(){return r.i})),n.d(t,"t",(function(){return r.o})),n.d(t,"w",(function(){return a})),n.d(t,"u",(function(){return o})),n.d(t,"v",(function(){return d})),n.d(t,"q",(function(){return u})),n.d(t,"r",(function(){return b})),n.d(t,"a",(function(){return c.a})),n.d(t,"i",(function(){return m})),n.d(t,"m",(function(){return j}))},5637:function(e,t,n){"use strict";var r=n(29),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"ApplyBulkItemActionJsonRequest:#Exchange"},n)),Object(r.a)("ApplyBulkItemAction",e,t)}n.d(t,"a",(function(){return a}))},6158:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(319),a=n(2562);function o(e,t,n){if(void 0===t&&(t=Object(i.b)()),!e||!e.ConversationActions||0===e.ConversationActions.length)throw new Error("ApplyConversationAction requestBody is invalid!");n=n||{};var o=Object(r.__assign)({},n),c=o.headers?new Headers(o.headers):new Headers;return c.set("X-OWA-ActionSource","ApplyConversationAction_"+e.ConversationActions[0].Action),o.headers=c,Object(a.a)({Header:t,Body:e},o).then((function(e){return e.Body.ResponseMessages.Items[0]})).catch((function(e){return Promise.reject(e)}))}},6159:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ApplyBulkItemActionRequest:#Exchange"},e)}},6160:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"GetAccountInformationRequest:#Exchange"},e)}},6573:function(e,t,n){"use strict";var r=n(3516),i=n(4251),a=n(285),o=Object(a.action)("setSweepOptionType")(Object(a.select)({sweepStore:function(){return r.a}})((function(e,t){t.sweepStore.sweepOptionType=e}))),c=n(12),u=n(59);var s=Object(a.action)("setSweepRequestStatus")(Object(a.select)({sweepStore:function(){return r.a}})((function(e,t){var n,r,i,a=t.sweepStore;a.isSweepDialogShown&&(n=a.sweepRequestStatus,i="Invalid state transition {0} to {1}",1==(r=e)&&0!=n&&u.d(Object(c.c)(i,n,r)),2!=r&&3!=r||1==n||u.d(Object(c.c)(i,n,r)),a.sweepRequestStatus=e)}))),d=Object(a.action)("showHideSweepDialog")(Object(a.select)({sweepStore:function(){return r.a}})((function(e,t){t.sweepStore.isSweepDialogShown=e,e||(t.sweepStore.sweepOptionType=i.a.All,t.sweepStore.sweepRequestStatus=0)}))),l=n(77);n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return v})),n.d(t,"g",(function(){return r.a})),n.d(t,"a",(function(){return i.a})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return d}));var b=new l.c((function(){return n.e(911).then(n.bind(null,16906))})),f=new l.b(b,(function(e){return e.onSweepMoveToFolderClicked})),v=new l.b(b,(function(e){return e.setSweepDestinationFolderId}))},6614:function(e,t,n){"use strict";var r=n(0),i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"EmptyFolder"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"disposalType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposalType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"deleteSubFolder"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clientLastSyncTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemIdsToExclude"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipt"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bulkActionInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EmptyFolderBulkActionInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"emptyFolder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"ObjectField",name:{kind:"Name",value:"disposalType"},value:{kind:"Variable",name:{kind:"Name",value:"disposalType"}}},{kind:"ObjectField",name:{kind:"Name",value:"deleteSubFolder"},value:{kind:"Variable",name:{kind:"Name",value:"deleteSubFolder"}}},{kind:"ObjectField",name:{kind:"Name",value:"clientLastSyncTime"},value:{kind:"Variable",name:{kind:"Name",value:"clientLastSyncTime"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemIdsToExclude"},value:{kind:"Variable",name:{kind:"Name",value:"itemIdsToExclude"}}},{kind:"ObjectField",name:{kind:"Name",value:"suppressReadReceipt"},value:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipt"}}},{kind:"ObjectField",name:{kind:"Name",value:"bulkActionInput"},value:{kind:"Variable",name:{kind:"Name",value:"bulkActionInput"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"FolderId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"},arguments:[],directives:[]}]}}]}}]}}]}}]},a=n(340),o=n(1651),c=n(9),u=n(83),s=n(1312),d=n(1325),l=n(30),b=n(4089),f=n(1368);function v(e,t,n,i,a,v,m){return Object(r.__awaiter)(this,void 0,void 0,(function(){var j,p,h,k,g;return Object(r.__generator)(this,(function(r){return null,j="AlwaysSend"!=Object(l.a)().UserOptions.ReadReceipt||Object(s.D)(e,d.k),p=Object(f.a)(e),h="none"==p?e:p,k=Object(b.a)(h,!1),g={id:e,disposalType:t,deleteSubFolder:n,clientLastSyncTime:i&&Object(c.tb)(i),itemIdsToExclude:a,suppressReadReceipt:j,bulkActionInput:{supportBulkActions:v,bulkActionBatchSize:Object(u.i)("tri-emptyFolderBulkActionBatchSize")?200:10,bulkActionCustomData:m&&JSON.stringify(m)},mailboxInfo:k},[2,O.invokeEmptyFolderMutation(g).then((function(){o.k.importAndExecute()}))]}))}))}n.d(t,"a",(function(){return v}));var O={invokeEmptyFolderMutation:function(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(a.a)()];case 1:return[4,r.sent().mutate({variables:e,mutation:i})];case 2:return n=r.sent(),[2,null===(t=null==n?void 0:n.data)||void 0===t?void 0:t.emptyFolder]}}))}))}}},6619:function(e,t,n){"use strict";var r=n(29),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"SetMailboxJunkEmailConfigurationRequest:#Exchange"},n)),Object(r.a)("SetMailboxJunkEmailConfiguration",e,t)}n.d(t,"a",(function(){return a}))},664:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return s}));var r=n(77),i=n(758);n.d(t,"a",(function(){return i.a}));var a=new r.c((function(){return Promise.all([n.e(0),n.e(2),n.e(3),n.e(21),n.e(23),n.e(88),n.e(652)]).then(n.bind(null,1254))})),o=Object(r.d)(a,(function(e){return e.NotificationBarHost})),c=new r.a(a,(function(e){return e.showNotification})),u=new r.a(a,(function(e){return e.dismissNotification})),s=new r.b(a,(function(e){return e.clearNotificationBar}))},6880:function(e,t,n){"use strict";var r=n(74),i=n(3),a=n(1368),o=Object(i.action)("emptyFolderWithoutConfirmation",(function(e,t,n,i,o,c,u,s){var d=e.TotalCount,l=Object(a.a)(e.FolderId.Id);return Object(r.c)({name:"TnS_EmptyFolderAction",customData:{folderTotalCount:d,disposalType:t,deleteSubFolders:n,folderName:l}},{folder:e,disposalType:t,deleteSubFolders:n,clientLastSyncTime:i,rowKeysToExclude:o,tableViewId:c,deletedItemsFolderId:u,shouldSupportBulkActions:s})}));t.a=o},6881:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return l}));var r=n(8216),i=n(12),a=n(1328),o=n(1311),c=n(1319),u=n(4569);function s(e){for(var t={},n=[],o=0;o<e.length;o++){var c=e[o].EmailAddress;if(c){if(Object(u.a)(c))return Object(a.b)(Object(i.c)(Object(i.b)(r.a),c),null,!1,{hideCancelButton:!0}),null;var s=c.toLowerCase();t[s]||(t[s]=!0,n.push(e[o]))}}return n.length>0?n:null}function d(e,t){var n=[];return e.forEach((function(e){var r=o.b.getLastSenderMailbox(e,t);r&&n.push(r)})),s(n)}function l(e){var t=[];return e.forEach((function(e){var n=c.a.items.get(e);n&&Object(o.V)(n)&&t.push(n.From.Mailbox)})),s(t)}},726:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},744:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(0),i=n(1),a=n(273),o=n(448),c=n(445),u=n(309),s=n(287),d=n(335),l=n(431),b=Object(a.a)(),f=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._checkBox=i.createRef(),a._renderContent=function(e,t,n){void 0===n&&(n={});var u=a.props,s=u.disabled,l=u.inputProps,b=u.name,f=u.ariaLabel,v=u.ariaLabelledBy,O=u.ariaDescribedBy,m=u.onRenderLabel,j=void 0===m?a._onRenderLabel:m,p=u.checkmarkIconProps,h=u.ariaPositionInSet,k=u.ariaSetSize,g=u.title,y=u.label;return i.createElement("div",{className:a._classNames.root,title:g},i.createElement(o.a,null),i.createElement("input",Object(r.__assign)({type:"checkbox"},l,{"data-ktp-execute-target":n["data-ktp-execute-target"],checked:e,disabled:s,className:a._classNames.input,ref:a._checkBox,name:b,id:a._id,title:g,onChange:a._onChange,onFocus:a._onFocus,onBlur:a._onBlur,"aria-disabled":s,"aria-label":f||y,"aria-labelledby":v,"aria-describedby":Object(c.a)(O,n["aria-describedby"]),"aria-posinset":h,"aria-setsize":k,"aria-checked":t?"mixed":e?"true":"false"})),i.createElement("label",{className:a._classNames.label,htmlFor:a._id},i.createElement("div",{className:a._classNames.checkbox,"data-ktp-target":n["data-ktp-target"]},i.createElement(d.a,Object(r.__assign)({iconName:"CheckMark"},p,{className:a._classNames.checkmark}))),j(a.props,a._onRenderLabel)))},a._onFocus=function(e){var t=a.props.inputProps;t&&t.onFocus&&t.onFocus(e)},a._onBlur=function(e){var t=a.props.inputProps;t&&t.onBlur&&t.onBlur(e)},a._onChange=function(e){var t=a.props.onChange,n=a.state,r=n.isChecked;n.isIndeterminate?(t&&t(e,r),void 0===a.props.indeterminate&&a.setState({isIndeterminate:!1})):(t&&t(e,!r),void 0===a.props.checked&&a.setState({isChecked:!r}))},a._onRenderLabel=function(e){var t=e.label,n=e.title;return t?i.createElement("span",{"aria-hidden":"true",className:a._classNames.text,title:n},t):null},Object(u.a)(a),a._id=a.props.id||Object(s.a)("checkbox-"),a.state={isChecked:!!(void 0!==t.checked?t.checked:t.defaultChecked),isIndeterminate:!!(void 0!==t.indeterminate?t.indeterminate:t.defaultIndeterminate)},a}return Object(r.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){var n={};return void 0!==e.indeterminate&&(n.isIndeterminate=!!e.indeterminate),void 0!==e.checked&&(n.isChecked=!!e.checked),Object.keys(n).length?n:null},t.prototype.render=function(){var e=this,t=this.props,n=t.className,r=t.disabled,a=t.boxSide,o=t.theme,c=t.styles,u=t.onRenderLabel,s=void 0===u?this._onRenderLabel:u,d=t.keytipProps,f=this.state,v=f.isChecked,O=f.isIndeterminate;return this._classNames=b(c,{theme:o,className:n,disabled:r,indeterminate:O,checked:v,reversed:"start"!==a,isUsingCustomLabelRender:s!==this._onRenderLabel}),d?i.createElement(l.a,{keytipProps:d,disabled:r},(function(t){return e._renderContent(v,O,t)})):this._renderContent(v,O)},Object.defineProperty(t.prototype,"indeterminate",{get:function(){return!!this.state.isIndeterminate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checked",{get:function(){return!!this.state.isChecked},enumerable:!0,configurable:!0}),t.prototype.focus=function(){this._checkBox.current&&this._checkBox.current.focus()},t.defaultProps={boxSide:"start"},t}(i.Component)},758:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.PrimaryActionClicked=0]="PrimaryActionClicked",e[e.SecondaryActionClicked=1]="SecondaryActionClicked",e[e.DismissClicked=2]="DismissClicked",e[e.AutoDismissed=3]="AutoDismissed",e[e.MouseLeaveAfterTimerCompleted=4]="MouseLeaveAfterTimerCompleted",e[e.NotificationBarUnmounted=5]="NotificationBarUnmounted"}(r||(r={}))},8213:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return u}));var r,i=n(270),a=n(9),o=n(534),c=n(30);function u(e){var t,n,u,s,d,l=Object(c.a)().UserOptions,b=l.WorkingHours.WorkDays,f=Object(a.Pb)();switch(e){case r.today:t=n=Object(a.tb)(f),d="Flagged";break;case r.tomorrow:t=n=Object(a.tb)(Object(a.e)(Object(a.Wb)(f),1)),d="Flagged";break;case r.thisWeek:s=function(e,t){var n=7-Object(a.nb)(t),r=2;0<n&&n<=2&&(r=n-1);var i=Object(a.e)(Object(a.Wb)(t),r),c=Object(o.i)(e);for(;t<i&&!c.includes(Object(a.nb)(i));)i=Object(a.e)(Object(a.Wb)(i),-1);var u=Object(a.e)(Object(a.Wb)(t),n-1);for(;i<u&&!c.includes(Object(a.nb)(u));)u=Object(a.e)(Object(a.Wb)(u),-1);return[Object(a.tb)(i),Object(a.tb)(u)]}(b,f),n=s[0],t=s[1],d="Flagged";break;case r.nextWeek:s=function(e,t,n){for(var r=Object(a.e)(n,7),i=Object(a.ac)(r,e),c=Object(o.i)(t),u=0;u<7&&!c.includes(Object(a.nb)(i));++u)i=Object(a.e)(Object(a.Wb)(i),1);var s=Object(a.C)(r,e);for(;i<s&&!c.includes(Object(a.nb)(s));)s=Object(a.e)(Object(a.Wb)(s),-1);return[Object(a.tb)(i),Object(a.tb)(s)]}(l.WeekStartDay,b,f),n=s[0],t=s[1],d="Flagged";break;case r.noDate:d="Flagged";break;case r.complete:u=Object(a.tb)(f),d="Complete";break;case r.clear:d="NotFlagged";break;default:Object(i.a)(e)}return{FlagStatus:d,StartDate:n,DueDate:t,CompleteDate:u}}!function(e){e[e.today=0]="today",e[e.tomorrow=1]="tomorrow",e[e.thisWeek=2]="thisWeek",e[e.nextWeek=3]="nextWeek",e[e.noDate=4]="noDate",e[e.complete=5]="complete",e[e.clear=6]="clear"}(r||(r={}))},8214:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1312),i=n(1325);function a(e){return Object(r.D)(e,i.c)||Object(r.D)(e,i.k)}},8215:function(e){e.exports=JSON.parse('{"a":"DFb"}')},8216:function(e){e.exports=JSON.parse('{"a":"oDb"}')},8217:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(29),i=n(6160);function a(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("GetAccountInformation",e,t)}},8218:function(e,t,n){"use strict";var r=n(285);t.a=Object(r.action)("clearTableViewLastEmptiedTime")((function(e){e.lastEmptiedTime=null}))},9813:function(e){e.exports=JSON.parse('{"u":"CEb","s":"DEb","q":"EEb","m":"FEb","o":"GEb","t":"HEb","r":"IEb","p":"JEb","l":"KEb","n":"LEb","j":"MEb","f":"NEb","d":"OEb","b":"PEb","h":"QEb","i":"REb","e":"SEb","a":"TEb","g":"UEb","c":"VEb","k":"WEb"}')},9814:function(e){e.exports=JSON.parse('{"a":"dFb"}')}}]);
//# sourceMappingURL=owa.MailBoot~TriageAction.js.map
self.scriptsLoaded['owa.MailBoot~TriageAction.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~TriageAction.js'] = (new Date()).getTime();