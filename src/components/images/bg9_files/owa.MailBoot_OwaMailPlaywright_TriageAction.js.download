self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~OwaMailPlaywright~TriageAction.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[264],{11882:function(e){e.exports=JSON.parse('{"a":"sEb","c":"tEb","b":"uEb","d":"vEb"}')},11883:function(e){e.exports=JSON.parse('{"b":"oEb","a":"pEb"}')},11884:function(e){e.exports=JSON.parse('{"a":"mEb","b":"nEb"}')},11885:function(e){e.exports=JSON.parse('{"b":"VDb","a":"WDb"}')},11886:function(e){e.exports=JSON.parse('{"b":"XEb","a":"YEb","c":"ZEb","d":"_Eb"}')},1854:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("USERMAIL_INTERACTION",(function(e,t,n){return{interactionType:e,instrumentationContexts:t,triageContext:n}}))},1955:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(77),i=n(1854);n.d(t,"d",(function(){return i.a}));var a=new r.c((function(){return n.e(447).then(n.bind(null,3811))})),o=new r.a(a,(function(e){return e.onKeyboardUpDown})),c=new r.a(a,(function(e){return e.onOpenEmail})),u=new r.a(a,(function(e){return e.onKeyboardToggleSelect}))},2452:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r=n(0),i=n(9),a=n(1368),o=n(59),c=n(1311);function u(e){var t=c.X.tableViews.get(e),n=null;t&&(n=0==t.tableQuery.type||2==t.tableQuery.type?Object(c.I)(t).sortColumn:null);return n}function s(e,t){var n,i,a=[];if(e)try{for(var o=Object(r.__values)(e),u=o.next();!u.done;u=o.next()){var s=u.value,l=c.b.getItemIds(s,t);l&&a.push.apply(a,Object(r.__spread)(l))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return a}function l(e,t){var n,i,a=[];if(e)try{for(var o=Object(r.__values)(e),u=o.next();!u.done;u=o.next()){var s=u.value;a.push(c.b.getConversationId(s,t))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return a}t.a={blockSendersFromTable:{name:"TnS_BlockSendersFromListView",customData:function(e,t,n,r){return[n,e.length,t.tableQuery.type]}},setConversationsFlagState:{name:function(e,t,n,r,i){var a;switch(r.FlagStatus){case"Flagged":a="TnS_FlagConversation";break;case"NotFlagged":a="TnS_UnflagConversation";break;case"Complete":a="TnS_CompleteFlagConversation";break;default:o.d("Cannot log invalid flag type")}return a},customData:function(e,t,n,r,i){var a=c.X.tableViews.get(n);return[Object(c.l)(a),Object(c.O)(a)]},cosmosOnlyData:function(e,t,n,i,a){return function(e,t){var n,i,a=[],o=[],u=c.X.tableViews.get(t);try{for(var s=Object(r.__values)(e),l=s.next();!l.done;l=s.next()){var d=l.value;a.push(c.b.getItemIds(d,u)[0]),o.push(c.b.getConversationId(d,u))}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return JSON.stringify({itemIds:a,conversationIds:o})}(e,n)},actionSource:function(e,t,n,r,i){return i},options:{isCore:!0}},setItemsFlagState:{name:function(e,t,n,r,i){var a;switch(n.FlagStatus){case"Flagged":a="TnS_FlagItem";break;case"NotFlagged":a="TnS_UnflagItem";break;case"Complete":a="TnS_CompleteFlagItem";break;default:o.d("Cannot log invalid flag type")}return a},customData:function(e,t,n,r,i){var a=c.X.tableViews.get(r);return[Object(c.l)(a),Object(c.O)(a)]},cosmosOnlyData:function(e,t,n,r,i){return JSON.stringify({itemIds:e})},actionSource:function(e,t,n,r,i){return i},options:{isCore:!0}},archiveMailListRows:{name:"TnS_Archive",customData:function(e,t,n){return[t.tableQuery.folderId?Object(a.a)(t.tableQuery.folderId):null,t.tableQuery.type,t.tableQuery.listViewType,e.length,Object(c.l)(t),Object(c.O)(t)]},cosmosOnlyData:function(e,t,n){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0},actionSource:function(e,t,n){return n}},markItemsJunkNotJunk:{name:function(e,t,n,r,i,a){var o="TnS_MarkAs";return o+=t?"Junk":"NotJunk"},customData:function(e,t,n,r,i,a){return[e.length,Object(c.l)(r),Object(c.O)(r)]},cosmosOnlyData:function(e,t,n,r,i,a){return JSON.stringify({itemIds:e})},actionSource:function(e,t,n,r,i,a){return n}},markItemsAsPhishing:{name:"TnS_MarkAsPhishing",customData:function(e,t,n,r){return[e.length,Object(c.l)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:e})},actionSource:function(e,t,n,r){return n}},moveConversation:{name:function(e,t,n,r){var i="TnS_MoveConversation";return i+=r?"":"Background"},customData:function(e,t,n,r){return[n.tableQuery.type,n.tableQuery.folderId?Object(a.a)(n.tableQuery.folderId):null,Object(a.a)(t),e.length,Object(c.l)(n),Object(c.O)(n)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,n),conversationIds:l(e,n)})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},moveItems:{name:function(e,t,n,r){var i="TnS_MoveItem";return i+=r?"":"Background"},customData:function(e,t,n,r){return[n.tableQuery.type,n.tableQuery.folderId?Object(a.a)(n.tableQuery.folderId):null,Object(a.a)(t),e.length,Object(c.l)(n),Object(c.O)(n)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:e})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},copyMailListRows:{name:"TnS_Copy",customData:function(e,t,n,r,i){return[t.tableQuery.type,t.tableQuery.folderId?Object(a.a)(r):null,Object(a.a)(n),e.length,Object(c.l)(t)]},cosmosOnlyData:function(e,t,n,r,i){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},actionSource:function(e,t,n,r,i){return i}},restoreConversation:{name:"TnS_RestoreConversation"},restoreItems:{name:"TnS_RestoreItem"},unsubscribe:{name:"TnS_Unsubscribe",customData:function(e,t,n,r){return[r,n,Object(c.l)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemId:e.ItemId.Id})}},pinConversations:{name:function(e,t,n,r){var i="TnS_";return i+=n?"PinConversation":"UnpinConversation"},customData:function(e,t,n,r){return[e.length,Object(c.l)(t),Object(c.O)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},actionSource:function(e,t,n,r){return r},options:{isCore:!0}},pinItems:{name:function(e,t,n,r){var i="TnS_";return i+=n?"PinItem":"UnpinItem"},customData:function(e,t,n,r){return[e.length,Object(c.l)(t),Object(c.O)(t)]},cosmosOnlyData:function(e,t,n,r){var i=s(e,t);return JSON.stringify({itemIds:i})},actionSource:function(e,t,n,r){return r},options:{isCore:!0}},moveConversationToFocusedOrOther:{name:function(e,t,n,r){return 0===n?"TnS_MoveConversationToFocused":"TnS_MoveConversationToOther"},customData:function(e,t,n,r){return[e.length,Object(c.l)(c.X.tableViews.get(t))]},cosmosOnlyData:function(e,t,n,r){var i=c.X.tableViews.get(t);return JSON.stringify({itemIds:s(e,i),conversationIds:l(e,i)})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},moveItemToFocusedOrOther:{name:function(e,t,n,r){return 0===n?"TnS_MoveItemToFocused":"TnS_MoveItemToOther"},customData:function(e,t,n,r){return[e.length,Object(c.l)(c.X.tableViews.get(t))]},cosmosOnlyData:function(e,t,n,r){var i=c.X.tableViews.get(t);return JSON.stringify({itemIds:s(e,i)})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},alwaysMoveRowToFocusedOrOther:{name:function(e,t,n,r){return 0===n?"TnS_AlwaysMoveToFocused":"TnS_AlwaysMoveToOther"},customData:function(e,t,n,r){return[e.length,Object(c.l)(t),t.tableQuery.listViewType]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},addCategories:{name:"TnS_AddCategory",customData:function(e,t,n,r){return[r,e.length,t.tableQuery.listViewType,Object(c.l)(t),Object(c.O)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0}},removeCategories:{name:"TnS_RemoveCategory",customData:function(e,t,n,r){return[r,e.length,t.tableQuery.listViewType,Object(c.l)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0}},clearCategories:{name:"TnS_ClearCategory",customData:function(e,t,n){return[n,e.length,t.tableQuery.listViewType,Object(c.l)(t)]},cosmosOnlyData:function(e,t,n){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0}},scheduleItems:{name:"TnS_ScheduleItem",customData:function(e,t,n,r){return[e.length,t.tableQuery.listViewType,Object(c.l)(t),r?Object(i.tb)(r):null]},options:{isCore:!0},actionSource:function(e,t,n){return n}}}},2877:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"DeleteItemJsonRequest:#Exchange"},e)}},2909:function(e,t,n){"use strict";var r=n(1737);function i(e,t,n){n&&r.a.removeRowsFromTombstone(e,t)}var a=n(3010);function o(e){e&&Object(a.a)(e)}var c=n(1436),u=n(269);function s(e,t,n,r,a,s){var l=Object(u.r)();return e.then((function(e){return l&&l.addCheckpoint("PAPCARM"),i(t,n,a),s?void 0:Object(c.a)(e)})).catch((function(e){return i(t,n,a),o(r),Promise.reject(e)}))}var l=n(0);function d(e,t,n,r,a){return e.then((function(e){if(i(t,n,a),e.ResponseMessages){var c=function(e,t){var n,r;try{for(var i=Object(l.__values)(e),a=i.next();!a.done;a=i.next()){var c=a.value;if(c&&"Success"!=c.ResponseClass){o(t);var u=new Error("ResponseCode="+c.ResponseCode+", Stacktrace="+c.StackTrace);return u.fetchErrorType="ServerFailure",u}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return null}(e.ResponseMessages.Items,r);return c?Promise.reject(c):Promise.resolve()}return Promise.reject(new Error("processUpdateItemActionResponseMessage empty response"))})).catch((function(e){return i(t,n,a),o(r),Promise.reject(e)}))}n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}))},2959:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"DeleteItemRequest:#Exchange"},e)}},2960:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(29),i=n(2877);function a(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("DeleteItem",e,t)}},3196:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2959),i=n(723),a=n(2960),o=n(319);function c(e,t){return Object(r.a)({ItemIds:e.map((function(e){return t=e,Object(i.a)({Id:t.Id,ChangeKey:t.ChangeKey});var t})),DeleteType:t,SuppressReadReceipts:!0,ReturnMovedItemIds:!0,SendMeetingCancellations:"SendToNone",AffectedTaskOccurrences:"AllOccurrences"})}function u(e,t,n){var r=c(e,t);return Object(a.a)({Header:Object(o.b)(),Body:r},n).then((function(e){return e.Body.ResponseMessages.Items}))}},3515:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1311),i=n(1323);function a(e){return e.map((function(e){var t,n=i.u.items.get(e);return t=!Object(r.V)(n)||n.IsRead,{itemId:e,itemConversationId:n.ConversationId,isRead:t,mailboxInfo:n.MailboxInfo}}))}},3942:function(e){e.exports=JSON.parse('{"a":"tRa"}')},4568:function(e,t,n){"use strict";function r(e){return e?new Date(e).toISOString():null}n.d(t,"a",(function(){return r}))},4976:function(e){e.exports=JSON.parse('{"f":"XDb","d":"YDb","j":"ZDb","c":"_Db","h":"$Db","e":"aEb","a":"bEb","i":"cEb","b":"dEb","g":"eEb","k":"fEb","p":"gEb","o":"hEb","m":"iEb","l":"kEb","n":"lEb"}')},5376:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(723);function i(e){return e.map((function(e){return Object(r.a)({Id:e})}))}},5377:function(e,t,n){"use strict";n.d(t,"c",(function(){return J})),n.d(t,"a",(function(){return Q})),n.d(t,"b",(function(){return P}));var r=n(0),i=n(11886),a=n(4976),o=n(2355),c=n(12),u=n(1652),s=n(1484),l=n(5594),d=n(3515),b=n(2452),f=n(3196),v=n(1712),m=n(9808),O=n(1322),j=n(6154),p=n(6878),y=n(1497),I=n(9810),g=n(8212),k=n(1323),S=n(1328),h=n(1493),T=n(1311),C=n(1319),_=(n(1538),n(269)),D=n(1955),N=n(1312),w=n(1325),x=n(6879),V=n(2909),R=n(1436),F=n(74),M=n(3),E=n(440);function A(e){var t=s.a.primaryComposeId&&s.a.viewStates.get(s.a.primaryComposeId).itemId;return t&&e.indexOf(t.Id)>=0}var J=Object(M.action)("deleteItemsWithoutConfirmDialog",(function(e,t,n,r,i,a,o){return Object(F.c)({name:"TnS_DeleteItem",options:{timeout:7e4},customData:[e.length,t],cosmosOnlyData:JSON.stringify({itemIds:e}),actionSource:r},{itemIds:e,disposalType:t,parentFolderId:n,actionSource:r,instrumentationContexts:i,requestInitOptions:a,allowUndoAction:o})}));function Q(e,t,n,r,a,o){var s=Object(C.b)().items.get(e[0]).ParentFolderId.Id;if(Object(p.a)(s,null))return Promise.resolve();var d=Object(N.D)(s,w.k),b=Object(E.a)(a)||null,f=a&&"GroupMailbox"==a.type,v=Object(k.j)(s),m="SoftDelete"==t&&v||f||Object(N.H)(s);return Object(S.b)(f?Object(c.b)(i.b):"",f?Object(c.b)(i.a):Object(c.b)(i.c),!m,{delayCallbackAfterAnimation:!0}).then((function(i){var o=Object(u.c)(s,a)&&"MoveToDeletedItems"===t;if(i==S.a.ok){if(d){var c=Object(O.a)(w.g);return Object(l.a)(e,Object(j.a)(c),!0).then((function(){return J(e,"HardDelete",s,r,n,b,o)}))}return J(e,t,s,r,n,b,o)}return Promise.resolve()}))}function P(e,t,n,r,s){var l=y.a.tableViews.get(t),d={deleteNumberOfRowsTitle:Object(c.b)(a.m),deleteOneRowTitle:Object(c.b)(o.a),confirmDeleteRows:Object(c.b)(i.d)},f=y.a.tableViews.get(t);return Object(_.p)("TnS_DeleteItemsFromTable",[s,e.length,Object(b.b)(t),Object(T.u)(f)]),Object(m.a)(e,t,n,(function(e,n){var i=Object(T.C)(e,t);return J(i,n,l.tableQuery.folderId,s,r,Object(E.a)(Object(h.b)(l)),Object(u.c)(l.tableQuery.folderId,Object(h.b)(l))&&"MoveToDeletedItems"==n)}),A,d,s)}Object(M.orchestrator)(J,(function(e){var t=e.itemIds,n=e.disposalType,i=e.parentFolderId,a=e.actionSource,o=e.instrumentationContexts,c=e.requestInitOptions,s=e.allowUndoAction,l=Object(T.G)(),b=null,m=[];if(l&&(m=Object(T.E)(t,l),b=l.serverFolderId,Object(x.a)(l.tableQuery,!0))){var O=Object(d.a)(t);Object(v.a)(O,i,"Delete")}u.b();var j=t.map((function(e){return{Id:e}}));(c=c||{}).timeoutMS=6e4;var p=Object(f.a)(j,n,c);u.a((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,i,a,o,c,u;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return[4,p];case 1:if(e=l.sent(),s){t=[];try{for(n=Object(r.__values)(e),i=n.next();!i.done;i=n.next())a=i.value,"Success"==(o=a).ResponseClass&&t.push(o.MovedItemId.Id)}catch(e){c={error:e}}finally{try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(c)throw c.error}}if(t.length>0)return[2,Object(I.a)(t)]}return[2,Promise.resolve()]}}))}))}),b),a&&Object(g.a)(t.length,s),Object(D.d)("Delete",o,{itemIds:t});var y=Object(_.r)();return y.markUserPerceivedTime(),p.then((function(e){return y.addCheckpoint("di_then"),Object(V.a)(m,i,!!l),Object(R.a)(e)})).catch((function(e){return y.addCheckpoint("di_catch"),"ErrorItemNotFound"==e.responseCode&&(e.fetchErrorType="Expected"),Object(V.a)(m,i,!!l),Object(V.b)(l),Promise.reject(e)}))}))},5594:function(e,t,n){"use strict";var r=n(5376),i=n(0);var a=n(29);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"CopyItemJsonRequest:#Exchange"},n)),Object(a.a)("CopyItem",e,t)}var c=n(319);function u(e,t,n,a){var u=function(e,t,n){return a={ToFolderId:t,ItemIds:Object(r.a)(e),ReturnNewItemIds:!0,RemoteExecute:n},Object(i.__assign)({__type:"CopyItemRequest:#Exchange"},a);var a}(e,t,n);return o({Header:Object(c.b)(),Body:u},a).then((function(e){return e.Body}))}n.d(t,"a",(function(){return u}))},6153:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(9307),i=n(5377),a=n(1497),o=n(2058);function c(e,t,n,c){var u=a.a.tableViews.get(t),s=Object(o.a)(e,u);switch(u.tableQuery.listViewType){case 0:Object(r.a)(e,t,n,s,c);break;case 1:Object(i.b)(e,t,n,s,c)}}},6154:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(547),i=n(1382);function a(e){return e?Object(i.a)({BaseFolderId:Object(r.a)({Id:e})}):null}},6155:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r=1e4,i=25},6156:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(29),i=n(6157);function a(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("ApplyMessageAction",e,t)}},6157:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ApplyMessageActionJsonRequest:#Exchange"},e)}},6878:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11882),i=n(12),a=n(1328),o=n(1312),c=n(30);function u(e,t){if(!Object(c.a)().SessionSettings.IsShadowMailbox)return!1;var n,u=o.d.folderTable.get(e),s=o.d.folderTable.get(t),l=u.sourceWellKnownFolderType;if(87==l)n=Object(i.b)(r.a);else if(88==l)n=Object(i.b)(r.c);else if(null!=s){var d=s.sourceWellKnownFolderType;87==d?n=Object(i.b)(r.b):88==d&&(n=Object(i.b)(r.d))}return null!=n&&(Object(a.b)("",n,!1,{hideCancelButton:!0}),!0)}},6879:function(e,t,n){"use strict";function r(e,t){switch(0==e.type?e.scenarioType:""){case"persona":case"privatedistributionlist":return!1;case"category":return t;default:return!0}}n.d(t,"a",(function(){return r}))},7330:function(e,t,n){"use strict";var r=n(0),i=n(2452),a=n(74),o=n(1849),c=n(1311),u=n(1497),s=n(5237),l=n(2909),d=n(340),b=n(4568),f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UndoDeleteConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"undoDeleteConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]};n.d(t,"b",(function(){return v}));t.a=Object(a.d)("RestoreConversation",i.a.restoreConversation)((function(e,t){var n=Object(u.b)().tableViews.get(t),r=Object(s.a)(e,t,(function(e){return!!e})),i=Object(c.C)(r,t),a=r.map((function(e){return Object(c.h)(e,t)}));Object(o.a)(i,n,"Restore");var d=n.tableQuery.folderId,b=v.invokeUndoDeleteMutation(a,d);return Object(l.c)(b,r,n.serverFolderId,n,!1,!0)}));var v={invokeUndoDeleteMutation:function(e,t,n){var i;return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(b.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(d.a)()];case 1:return[4,r.sent().mutate({variables:{conversations:a,folderId:t,undoRequestId:n},mutation:f})];case 2:return o=r.sent(),[2,null===(i=null==o?void 0:o.data)||void 0===i?void 0:i.undoDeleteConversation]}}))}))}}},8212:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(12),i=n(3942),a=n(1534),o=n(1652),c=n(664),u=n(30),s=n(11884);function l(e,t){if(Object(u.a)().UserOptions.ShowNotificationBar){var n=1===e?Object(r.b)(s.a):Object(r.c)(Object(r.b)(s.b),e),l=Object(a.h)();c.e.importAndExecute("deleteNotification","MailModuleNotificationBarHost",n,{icon:"Delete",primaryActionText:t?Object(r.b)(i.a):null,allowClear:!0,minWidth:l.minWidth,maxWidth:l.maxWidth,notificationCallback:function(e){e===c.a.PrimaryActionClicked&&o.e.importAndExecute("NotificationBar")}})}}},9307:function(e,t,n){"use strict";var r=n(0),i=n(2452),a=n(9808),o=n(9809),c=n(6879),u=n(8212),s=n(7330),l=n(4976),d=n(269),b=n(74),f=n(340),v=n(1425),m=n(12),O=n(2355),j=n(1955),p=n(1849),y=n(1484),I=n(1497),g=n(1493),k=n(2909),S=n(4568),h=n(1652),T=n(1322),C=n(3),_=n(1311),D=n(11885),N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"disposalType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposalType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"disposalType"},value:{kind:"Variable",name:{kind:"Name",value:"disposalType"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"undoRequestId"},arguments:[],directives:[]}]}}]}}]};n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return x})),n.d(t,"c",(function(){return R}));var w=Object(C.action)("deleteConversationsWithoutConfirmDialog",(function(e,t,n,r,a){var o=I.a.tableViews.get(t);return Object(b.c)({name:"TnS_DeleteConversation",options:{timeout:7e4},customData:[a,e.length,n,Object(i.b)(t),Object(_.l)(o),Object(_.O)(o),Object(_.u)(o)],cosmosOnlyData:JSON.stringify({conversationIds:e.map((function(e){return e.conversationId}))}),actionSource:a},{conversationActionContexts:e,originalTableViewId:t,disposalType:n,instrumentationContexts:r})}));Object(C.orchestrator)(w,(function(e){var t=e.conversationActionContexts,n=e.originalTableViewId,i=e.disposalType,a=e.instrumentationContexts,o=t.map((function(e){return e.conversationId})),l=Object(I.b)().tableViews.get(n);Object(c.a)(l.tableQuery,!0)&&Object(p.a)(o,l,"Delete"),h.b();var b=Object(T.a)("deleteditems"),f=Object(_.E)(o,l),v=Object(g.b)(l),m=Object(_.k)(l,!0),O=Object(h.c)(l.tableQuery.folderId,v)&&"MoveToDeletedItems"===i,y=R.invokeDeleteConversationMutation(t,m,i,v,{timeoutMS:6e4});return O&&h.a((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,y];case 1:return(e=n.sent()).success?[2,s.b.invokeUndoDeleteMutation(t,b,e.undoRequestId)]:[2,Promise.resolve()]}}))}))}),l.serverFolderId,y),Object(u.a)(t.length,O),Object(j.d)("Delete",a,{conversationIds:o}),Object(d.r)().markUserPerceivedTime(),Object(k.c)(y,f,l.serverFolderId,l,!0,!0)}));function x(e,t,n,r,i){var c=I.a.tableViews.get(t),u=Object(v.e)(c.tableQuery),s={deleteNumberOfRowsTitle:Object(m.b)(l.k),deleteOneRowTitle:Object(m.b)(O.a),confirmDeleteRows:u?Object(m.b)(D.b):Object(m.b)(D.a)};return Object(a.a)(e,t,n,(function(e,n){var a=Object(o.a)(e,t);w(a,t,n,r,i)}),V,s,i)}function V(e){var t=y.a.primaryComposeId&&y.a.viewStates.get(y.a.primaryComposeId).conversationId;return t&&e.indexOf(t)>=0}var R={invokeDeleteConversationMutation:function(e,t,n,i,a){var o;return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(S.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(f.a)()];case 1:return[4,r.sent().mutate({variables:{conversations:c,disposalType:n,folderId:t,mailboxInfo:i},context:{requestOptions:a},mutation:N})];case 2:return u=r.sent(),[2,null===(o=null==u?void 0:u.data)||void 0===o?void 0:o.deleteConversation]}}))}))}}},9808:function(e,t,n){"use strict";var r=n(0),i=n(6878),a=n(5594),o=n(4976),c=n(1328),u=n(1425),s=n(12),l=n(6648),d=n(1495),b=n(1484),f=n(2784),v=n(4744),m=n(1497),O=n(1659),j=n(1323),p=n(6154),y=n(6155),I=n(1322),g=n(285),k=n(11883),S=n(1311),h=n(1312),T=n(1325);function C(e,t,n,i,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=Object(S.C)(e,t.id),a(o)?[4,d.f.importAndExecute(b.a.viewStates.get(b.a.primaryComposeId))]:[3,2];case 1:r.sent(),r.label=2;case 2:return a(o)||(c=e.filter((function(e){return t.rowKeys.indexOf(e)>=0}))).length>0&&i(c,n),[2]}}))}))}t.a=Object(g.select)({originalTableView:function(e,t){return m.a.tableViews.get(t)},folderTable:function(){return h.d.folderTable},searchStore:function(){return Object(O.i)()}})((function(e,t,n,r,o,d,b,v){var m,O,g=v.originalTableView,k=g.tableQuery,w=k.folderId;if(Object(i.a)(w,null))return null;var x=Object(u.e)(k),V=1==k.type,R=V&&0===g.selectedRowKeys.size&&"Hover"!==b,F=Object(h.H)(w),M=Object(S.Q)(k)||Object(f.c)(k);if(x)m=!1;else if(V){var E=v.searchStore.staticSearchScope;m=("PrimaryMailbox"==E.kind||"ArchiveMailbox"==E.kind)&&Object(j.j)(E.folderId),O=Object(s.b)(l.a)}else if(!M&&!F){var A=v.folderTable.get(w);m=Object(j.j)(w)||Object(j.p)(A),O=Object(h.j)(A)}var J=n||m||x||F,Q=e.length,P=Q>=y.b,U=Object(S.u)(g),q=_(Q,d),B=D(d,M,R,J,g,O),H=N(J,P,M,R,U);return Object(c.b)(q,B,H,{delayCallbackAfterAnimation:!0}).then((function(t){if(t===c.a.ok){var n=e.filter((function(e){return g.rowKeys.indexOf(e)>=0}));if(Object(h.D)(w,T.k)){var i=Object(I.a)(T.g),u=Object(S.C)(e,g.id);return Object(a.a)(u,Object(p.a)(i),!0).then((function(){n.length>0&&C(n,g,"HardDelete",r,o)}))}var s=M?"HardDelete":J?"SoftDelete":"MoveToDeletedItems";if(n.length>0)return C(n,g,s,r,o)}return Promise.resolve()}))}));var _=function(e,t){return e>1?Object(s.c)(t.deleteNumberOfRowsTitle,e):t.deleteOneRowTitle},D=function(e,t,n,r,i,a){if(n)return r?Object(s.b)(k.b):Object(s.b)(k.a);var c=Object(S.P)(i)?o.e:o.f;return r||t?e.confirmDeleteRows:Object(s.c)(Object(s.b)(c),Object(v.a)(i.tableQuery.type,i,a))},N=function(e,t,n,r,i){return!(i||e||t||n||r)}},9809:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1311);function i(e,t){var n=[],i={};return e.forEach((function(e){var a=Object(r.h)(e,t);i[a.conversationId]||(i[a.conversationId]=!0,n.push(a))})),n}},9810:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(6156),i=n(319),a=n(9811),o=n(9812),c=n(723);function u(e){var t=function(e){return Object(a.a)({MessageAction:Object(o.a)({Action:"Restore"}),Ids:e.map((function(e){return Object(c.a)({Id:e})}))})}(e);return Object(r.a)({Header:Object(i.b)(),Body:t}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}},9811:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ApplyMessageActionRequest:#Exchange"},e)}},9812:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"MessageAction:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.MailBoot~OwaMailPlaywright~TriageAction.js.map
self.scriptsLoaded['owa.MailBoot~OwaMailPlaywright~TriageAction.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~OwaMailPlaywright~TriageAction.js'] = (new Date()).getTime();