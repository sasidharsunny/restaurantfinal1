self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FilterContextMenu.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[397],{10852:function(e,t,n){"use strict";n.r(t);var r=n(49),i=n(12193),o=n(8289),c=n(12),a=n(12194),u=n(6170);function l(e){switch(e){case 1:return Object(c.b)(a.a);case 3:return Object(c.b)(a.b);case 7:return Object(c.b)(a.d);case 5:return Object(c.b)(a.c);case 8:return Object(c.b)(u.a);default:throw new Error("Sort not implemented")}}var s=n(7419),d=n(5252),f=n(6171),b=n(270),m=n(59);function p(e){switch(e){case"All":return Object(c.b)(o.a);case"Unread":return Object(c.b)(d.a);case"Flagged":return Object(c.b)(s.a);case"ToOrCcMe":return Object(c.b)(o.e);case"HasAttachment":return Object(c.b)(f.a);case"Mentioned":return Object(c.b)(o.c);case"TaskActive":case"TaskOverdue":case"TaskCompleted":case"DeprecatedSuggestions":case"DeprecatedSuggestionsRespond":case"DeprecatedSuggestionsDelete":case"DeprecatedNoClutter":case"DeprecatedClutter":case"SystemCategory":case"UserCategory":case"Pinned":case"Focused":case"Locked":case"Hashtag":case"Liked":return m.d("Filter not implemented"),"";default:return Object(b.a)(e)}}var g=n(4425),h=n(1311),w=n(1),x=n(184),S=n(608),y=n(85),O=n(3756),v=n(1369),D=n(2634),j=n(1368),C=n(9872),I=Object(r.a)((function(e){var t=w.useMemo((function(){return h.X.tableViews.get(e.tableViewId)}),[e.tableViewId]),n=function(){var e=Object(h.I)(t),n=e.sortDirection==h.c.ASCENDING_SORT_DIR,r=e.sortColumn,o=h.c.getSupportedSortColumns(t.tableQuery.folderId),u=[],s=[];o.forEach((function(t){var n=r==t;s.push({key:t.toString(),name:l(t),data:{sortOrder:n?e.sortDirection:h.c.getDefaultSortDirectionForSortColumn(t),sortColumn:t},onClick:a,canCheck:!0,isChecked:n})})),u.push({key:"sortBySection",itemType:x.a.Section,sectionProps:{bottomDivider:!0,title:Object(c.b)(i.j),items:s}});var d=function(e){switch(e){case 1:return{ascendingString:Object(c.b)(i.g),descendingString:Object(c.b)(i.f)};case 3:case 8:return{ascendingString:Object(c.b)(i.a),descendingString:Object(c.b)(i.b)};case 7:return{ascendingString:Object(c.b)(i.h),descendingString:Object(c.b)(i.d)};case 5:return{ascendingString:Object(c.b)(i.e),descendingString:Object(c.b)(i.c)};default:throw new Error("Sort not implemented")}}(r),f=d.ascendingString,b=d.descendingString,m=[{key:"ascending",name:f,data:{sortOrder:"Ascending",sortColumn:r},onClick:a,canCheck:!0,isChecked:n},{key:"descending",name:b,data:{sortOrder:"Descending",sortColumn:r},onClick:a,canCheck:!0,isChecked:!n}];return u.push({key:"sortOrderSection",itemType:x.a.Section,sectionProps:{bottomDivider:!0,title:Object(c.b)(i.k),items:m}}),u},r=function(t){return{key:t.toString(),name:p(t),data:t,canCheck:!0,isChecked:e.currentViewFilter==t,onClick:u}},a=function(t,n){e.dismissContextMenu(),g.e.importAndExecute(n.data.sortColumn,n.data.sortOrder,e.tableViewId,e.filterMenuSource)},u=function(t,n){e.dismissContextMenu();var r=n.data;"Important"===r?g.c.importAndExecute(e.filterMenuSource):g.d.importAndExecute(r,e.filterMenuSource)},s=e.dismissContextMenu,d=e.contextMenuTargetElement,f=function(){var a=e.supportedViewFilters.filter((function(e){return!(Object(v.c)()&&("Mentioned"===e||"ToOrCcMe"===e))})).map((function(e){return r(e)}));if(Object(D.c)()&&t.tableQuery.folderId&&"inbox"==Object(j.a)(t.tableQuery.folderId)){var l=D.e.tryImportForRender(),s=(null==l?void 0:l())||0;a.push({key:"importantFilter",name:Object(c.b)(o.d),canCheck:!0,data:"Important",onClick:u,secondaryText:s>0?s.toString():null,itemProps:{styles:{secondaryText:C.secondaryText}}})}if(1!=t.tableQuery.type){a.push({key:"divider",name:"-",itemType:x.a.Divider});var d=h.X.tableViews.get(e.tableViewId).tableQuery.folderId;a.push({key:"sortBy",name:Object(c.b)(i.i),items:n()});var f=O.a.tryImportForRender();if(f){var b=f(d,e.dismissContextMenu,"filterMenu");b&&(a.push({key:"divider",name:"-",itemType:x.a.Divider}),a.push(b))}}return a}();return w.createElement(S.a,{shouldFocusOnMount:!0,target:d,directionalHint:y.DirectionalHint.bottomRightEdge,onDismiss:s,items:f})}));var k=n(0),E=n(335),N=n(1538),M=n(285),_=n(3),F=Object(_.createStore)("mailListFilterView",{filterContextMenuDisplayState:!1}),P=F(),Q=Object(M.action)("showFilterDropDownContextMenu")((function(){F().filterContextMenuDisplayState=!0})),V=Object(M.action)("hideFilterDropDownContextMenu")((function(){F().filterContextMenuDisplayState=!1})),T=n(3415);Object(_.mutator)(T.e,(function(e){F().filterContextMenuDisplayState=!0}));var A=n(1345),H=n(83),K=n(501),R=n(9872),L=Object(r.a)((function(e){var t,n=w.useRef(),r=h.X.tableViews.get(e.tableViewId),i=Object(h.O)(r),a=r.tableQuery,u="spotlight"===a.scenarioType,l="All"==i&&!u,s=function(t){t.stopPropagation();var n=P.filterContextMenuDisplayState;u?g.b.importAndExecute(e.filterMenuSource):l?n?Y():Q():g.d.importAndExecute("All",e.filterMenuSource)},d=K(e.containerClassName,e.isInboxWithPivots&&R.filterPivots,P.filterContextMenuDisplayState?R.filterAllOpened:R.filterAll),f={role:A.a.button},b=w.useMemo((function(){return l?Object(c.b)(o.b):u?Object(c.b)(o.d):p(i)}),[e.tableViewId]),m=Object(H.i)("mon-tri-filterButtonStyling"),x="Ascending"==(null===(t=null==a?void 0:a.sortBy)||void 0===t?void 0:t.sortDirection)?"SortUp":"SortDown",S=l?m?x:"ChevronDownMed":"Cancel";return w.createElement("div",Object(k.__assign)({ref:function(e){return n.current=e},className:d,onClick:s,onKeyDown:function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),s(e))}},Object(A.b)(f),{tabIndex:0}),w.createElement("div",{className:K(R.filterContents,m&&R.monarchFilterContents)},m&&w.createElement(E.a,{className:m?R.filterIcon:R.icon,iconName:"Filter"}),b,w.createElement(E.a,{className:m?R.sortOrderIcon:R.icon,iconName:S})),P.filterContextMenuDisplayState&&w.createElement(I,{currentViewFilter:i,supportedViewFilters:e.supportedViewFilters,dismissContextMenu:Y,contextMenuTargetElement:n.current,filterMenuSource:e.filterMenuSource,tableViewId:e.tableViewId}))}));function Y(){V(),N.b.importAndExecute()}n.d(t,"MailFilterContextMenu",(function(){return I})),n.d(t,"MailListFilterMenu",(function(){return L}))},12193:function(e){e.exports=JSON.parse('{"i":"SDc","j":"TDc","k":"UDc","a":"VDc","b":"WDc","g":"XDc","f":"YDc","d":"ZDc","h":"_Dc","c":"$Dc","e":"aEc"}')},12194:function(e){e.exports=JSON.parse('{"a":"cEc","b":"dEc","d":"eEc","c":"fEc"}')},12195:function(e,t,n){(t=e.exports=n(130)(!1)).push([e.i,'._2HxQ4wKES5wjvIgnjfLcQK,._3HGhEMHDY2i8us0auVPsuI{cursor:pointer;font-size:14px;font-weight:400;color:"[theme:themePrimary, default:#0078D4]";font-weight:600;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;height:32px}html[dir] ._2HxQ4wKES5wjvIgnjfLcQK,html[dir] ._3HGhEMHDY2i8us0auVPsuI{padding:0 8px;border-radius:2px;margin-top:5px}html[dir=ltr] ._2HxQ4wKES5wjvIgnjfLcQK,html[dir=ltr] ._3HGhEMHDY2i8us0auVPsuI{margin-left:auto;margin-right:-8px}html[dir=rtl] ._2HxQ4wKES5wjvIgnjfLcQK,html[dir=rtl] ._3HGhEMHDY2i8us0auVPsuI{margin-right:auto;margin-left:-8px}html[dir] ._2HxQ4wKES5wjvIgnjfLcQK:hover,html[dir] ._3HGhEMHDY2i8us0auVPsuI{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] .SNcGPM0gk8ayZzwzROpZX{margin-bottom:8px}html[dir] ._3lIR1LfENBYPLTyCDNhq5k{margin-top:6px}._2oQ9sQfC-vORW35CueNgmA{font-weight:400;font-size:10px;color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] ._2oQ9sQfC-vORW35CueNgmA{padding-left:4px}html[dir=rtl] ._2oQ9sQfC-vORW35CueNgmA{padding-right:4px}._2_SkjBhZSNqf9Kyzy4u3E7{font-size:14px}html[dir=ltr] ._2_SkjBhZSNqf9Kyzy4u3E7{padding-right:7px}html[dir=rtl] ._2_SkjBhZSNqf9Kyzy4u3E7{padding-left:7px}._2Bkh9v8E1TnE5lKtn0SYsl{font-size:16px}html[dir=ltr] ._2Bkh9v8E1TnE5lKtn0SYsl{padding-left:14px}html[dir=rtl] ._2Bkh9v8E1TnE5lKtn0SYsl{padding-right:14px}.QCFDYNlgEXFDrarlbtyNf{color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] .QCFDYNlgEXFDrarlbtyNf{margin-right:3px}html[dir=rtl] .QCFDYNlgEXFDrarlbtyNf{margin-left:3px}._20HunDtNJtjpwLyRVIvyIV{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}',""]),t.locals={filterAll:"_2HxQ4wKES5wjvIgnjfLcQK",filterAllOpened:"_3HGhEMHDY2i8us0auVPsuI",filterPivots:"SNcGPM0gk8ayZzwzROpZX",filterContents:"_3lIR1LfENBYPLTyCDNhq5k",icon:"_2oQ9sQfC-vORW35CueNgmA",filterIcon:"_2_SkjBhZSNqf9Kyzy4u3E7",sortOrderIcon:"_2Bkh9v8E1TnE5lKtn0SYsl",secondaryText:"QCFDYNlgEXFDrarlbtyNf",monarchFilterContents:"_20HunDtNJtjpwLyRVIvyIV"}},2063:function(e,t,n){"use strict";var r=n(3),i=Object(r.createStore)("spotlightStore",{spotlightItems:[],rollupDismissed:!1,logicalId:null});t.a=i},2303:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1408),i=n(83);function o(){return Object(i.i)("tri-spotlight2")&&!Object(r.a)(2048)}},2634:function(e,t,n){"use strict";var r=n(77),i=n(2063);function o(e){var t=e.itemId,n=e.conversationId,r=e.rowKey;return Object(i.a)().spotlightItems.some((function(e){return t&&e.itemId===t||n&&e.conversationId===n||r&&e.rowKey===r}))}function c(e){var t=Object(i.a)().spotlightItems.filter((function(t){return t.itemId===e}))[0];return null==t?void 0:t.rowKey}var a=n(2303);n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"a",(function(){return m})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return a.a}));var u=new r.c((function(){return Promise.all([n.e(1),n.e(45),n.e(49),n.e(59),n.e(65),n.e(79),n.e(733)]).then(n.bind(null,16658))})),l=new r.a(u,(function(e){return e.initializeSpotlight})),s=new r.b(u,(function(e){return e.getUnacknowledgedSpotlightCount})),d=new r.a(u,(function(e){return e.onSpotlightDismissedFromRP})),f=new r.a(u,(function(e){return e.loadImportantTable})),b=new r.a(u,(function(e){return e.logSpotlightItemClicked})),m=Object(r.d)(u,(function(e){return e.SpotlightIconTeachingMoment}))},2998:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.createStore)("whatsNewStore",{cards:null,disablePauseInboxTryIt:!1})},2999:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("OPEN_PAUSE_INBOX")},3254:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Read="Read",e.Unread="Unread"}(r||(r={}))},3415:function(e,t,n){"use strict";var r=n(77),i=n(2998),o=n(3254);function c(){var e=Object(i.a)();return e.cards?Object.keys(e.cards).filter((function(t){return e.cards[t].status===o.a.Unread})).length:0}var a=n(2999);n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return a.a}));var u=new r.c((function(){return Promise.all([n.e(0),n.e(19),n.e(27),n.e(28),n.e(51),n.e(172),n.e(776)]).then(n.bind(null,16616))})),l=Object(r.d)(u,(function(e){return e.WhatsNewFluentPane})),s=new r.a(u,(function(e){return e.initializeWhatsNewIfNecessary})),d=new r.a(u,(function(e){return e.openPremiumDashboard}))},3756:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(77),i=new r.c((function(){return n.e(861).then(n.bind(null,5634))})),o=new r.b(i,(function(e){return e.getPauseInboxContextMenuItem}))},4425:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return a})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return s}));var r=n(77),i=new r.c((function(){return Promise.all([n.e(40),n.e(59),n.e(65),n.e(71),n.e(79),n.e(135),n.e(171),n.e(250),n.e(618)]).then(n.bind(null,9204))})),o=new r.a(i,(function(e){return e.selectFilter})),c=new r.a(i,(function(e){return e.selectSort})),a=new r.a(i,(function(e){return e.togglePauseInbox})),u=new r.a(i,(function(e){return e.clearFilter})),l=new r.a(i,(function(e){return e.loadSpotlightFilter})),s=new r.a(i,(function(e){return e.clearSpotlightFilter}))},6170:function(e){e.exports=JSON.parse('{"a":"Aua"}')},6171:function(e){e.exports=JSON.parse('{"a":"cwb"}')},7419:function(e){e.exports=JSON.parse('{"a":"bEc"}')},8289:function(e){e.exports=JSON.parse('{"b":"NDc","a":"ODc","e":"PDc","c":"QDc","d":"RDc"}')},9872:function(e,t,n){var r=n(12195),i=n(131);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)}}]);
//# sourceMappingURL=owa.FilterContextMenu.js.map
self.scriptsLoaded['owa.FilterContextMenu.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FilterContextMenu.js'] = (new Date()).getTime();