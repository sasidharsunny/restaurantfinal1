self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentPreviewSxS~SxS.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[213],{1379:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1679);function i(e){return Object(r.a)().attachments.get(e.Id)}},1402:function(e,n,t){"use strict";t.d(n,"b",(function(){return s}));var r=t(0),i=t(20),a=t(83),o=t(1522),c=t(3),u={conversationReadingPaneViewState:null,loadedItemReadingPaneViewStates:new i.ObservableMap({}),loadedConversationReadingPaneViewStates:new i.ObservableMap({}),itemReadingPaneViewState:null,itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null,shouldShowMobileUpsellEmptyState:!1,primaryReadingPaneTabId:null,sxsId:null},s=Object(c.createStore)("readingpane",u),d=s();o.a.registerReference((function(){var e,n;return Object(a.i)("rp-persistedReadingPaneTabs")?Object(r.__spread)(d.loadedConversationReadingPaneViewStates.keys()):null===(n=null===(e=d.conversationReadingPaneViewState)||void 0===e?void 0:e.conversationId)||void 0===n?void 0:n.Id})),n.a=d},1456:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(1402),i=t(83),a=t(1932);function o(e){return Object(i.i)("rp-persistedReadingPaneTabs")?Object(r.b)().loadedConversationReadingPaneViewStates.get(e||(Object(r.b)().sxsId?Object(r.b)().sxsId:Object(a.a)())):Object(r.b)().conversationReadingPaneViewState}},1484:function(e,n,t){"use strict";var r=t(20),i=t(3),a={viewStates:new r.ObservableMap,primaryComposeId:null,newMessageCreationInProgress:!1},o=Object(i.createStore)("compose",a),c=o();t.d(n,"a",(function(){return c})),t.d(n,"b",(function(){return o}))},1527:function(e,n,t){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return i})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1694:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},1712:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("DELETE_ITEMS_STORE_UPDATE",(function(e,n,t){return{itemContexts:e,parentFolderId:n,actionType:t}}))},1718:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(3),i=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(e){return{id:e}}))},1719:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1724:function(e,n,t){"use strict";var r=t(77),i=t(2256),a=t(1849),o=t(1712),c=t(1816),u=t(1966),s=t(1967),d=t(2160),f=t(2205),l=t(2131),b=t(1402),v=t(83),O=t(1319);function w(e,n){return!!e&&(1!==n&&!!O.a.conversations.get(e))}function h(e,n){return 2!=n&&(Object(v.i)("rp-persistedReadingPaneTabs")?b.a.loadedItemReadingPaneViewStates.has(e):b.a.itemReadingPaneViewState&&b.a.itemReadingPaneViewState.itemId==e)}var g=t(1899),m=t(1900),I=t(1832),j=t(1456);t.d(n,"l",(function(){return S})),t.d(n,"p",(function(){return T})),t.d(n,"m",(function(){return R})),t.d(n,"q",(function(){return P})),t.d(n,"s",(function(){return A})),t.d(n,"n",(function(){return _})),t.d(n,"o",(function(){return E})),t.d(n,"i",(function(){return y})),t.d(n,"j",(function(){return x})),t.d(n,"k",(function(){return C})),t.d(n,"g",(function(){return k})),t.d(n,"r",(function(){return M})),t.d(n,"h",(function(){return D})),t.d(n,"d",(function(){return w})),t.d(n,"e",(function(){return h})),t.d(n,"f",(function(){return g.a})),t.d(n,"a",(function(){return m.a})),t.d(n,"t",(function(){return b.a})),t.d(n,"c",(function(){return I.a})),t.d(n,"b",(function(){return j.a}));var p=new r.c((function(){return Promise.all([t.e(1),t.e(6),t.e(8),t.e(14),t.e(16),t.e(18),t.e(21),t.e(19),t.e(26),t.e(34),t.e(43),t.e(61),t.e(74),t.e(119),t.e(174),t.e(179),t.e(181),t.e(260),t.e(270),t.e(256),t.e(693)]).then(t.bind(null,16618))})),S=new r.a(p,(function(e){return e.loadConversationReadingPane})),T=new r.a(p,(function(e){return e.moveReadingPaneToTab})),R=new r.a(p,(function(e){return e.loadConversationReadingPaneForSingleMailItemSelected})),P=new r.a(p,(function(e){return e.print})),A=new r.a(p,(function(e){return e.setItemIdToScrollTo})),_=new r.a(p,(function(e){return e.loadItemReadingPane})),E=new r.a(p,(function(e){return e.loadItemReadingPaneForSingleMailItemSelected})),y=new r.a(p,(function(e){return e.expandCollapseAllItemParts}));Object(r.f)(o.a,p,(function(e){return e.deleteItemsStoreUpdateOrchestrator})),Object(r.f)(u.a,p,(function(e){return e.markConversationsAsReadStoreUpdateOrchestrator})),Object(r.f)(s.a,p,(function(e){return e.markItemsAsReadStoreUpdateOrchestrator})),Object(r.f)(c.a,p,(function(e){return e.markAllAsReadOrchestrator})),Object(r.f)(i.a,p,(function(e){return e.applyConversationFlagStateStoreUpdateOrchestrator})),Object(r.f)(a.a,p,(function(e){return e.deleteConversationStoreUpdateOrchestrator})),Object(r.f)(l.a,p,(function(e){return e.conversationReadyToLoadOrchestrator})),Object(r.f)(l.b,p,(function(e){return e.updateAttachmentsOrchestrator})),Object(r.f)(l.c,p,(function(e){return e.updateItemMandatoryPropertiesOrchestrator})),Object(r.f)(d.a,p,(function(e){return e.updateInternetMessageIdOrchestrator})),Object(r.f)(f.a,p,(function(e){return e.initializeExtendedCardForItemReadingPaneOrchestrator}));new r.b(p,(function(e){return e.getLastestNonDraftItemId}));var x=new r.b(p,(function(e){return e.getLatestNonDraftItemIdFromConversation})),C=new r.b(p,(function(e){return e.isUnsupportedItem})),k=new r.a(p,(function(e){return e.clearReadingPaneStore})),M=new r.a(p,(function(e){return e.replyByMeeting})),D=new r.a(p,(function(e){return e.ensureSecondaryReadingPaneTabHandler}))},1744:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(295),i=t(388);function a(e){if("ArchiveMailbox"==e.type)return Object(r.a)();var n=e.userIdentity&&Object(i.r)(e.userIdentity),t="GroupMailbox"===e.type;return n&&!t?Object(r.b)(e.mailboxSmtpAddress)+e.userIdentity:"UserMailbox"===e.type?Object(r.a)():e.mailboxSmtpAddress}},1746:function(e,n,t){"use strict";var r=t(388),i=t(0),a={};function o(e){return a[e]}function c(e,n){var t=a[e];a[e]=Object(i.__assign)(Object(i.__assign)({},t),n)}var u=t(96),s=t(29);var d=t(269),f=t(59),l=t(670),b=t(1347),v=t(1346);function O(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,t;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return(n={}).headers=new Headers,[4,Object(b.a)(e)];case 1:return t=r.sent(),Object(v.b)(n.headers,t),[2,n]}}))}))}var w=Object(l.b)({timeBetweenRetryInMS:function(){return 3e4}});function h(e,n){n=n<1?1:n,setInterval((function(){!function(e){Object(i.__awaiter)(this,void 0,void 0,(function(){var n,t,a,u,l,b,v=this;return Object(i.__generator)(this,(function(h){switch(h.label){case 0:if(n=function(){return Object(i.__awaiter)(v,void 0,void 0,(function(){var n,t;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),n={},Object(r.r)(e.userIdentity)?[4,O(e.userIdentity)]:[3,2];case 1:n=i.sent(),i.label=2;case 2:return[2,(a=n,Object(s.a)("GetAttachmentDownloadToken",{},a))];case 3:throw t=i.sent(),f.g.warn("Unable to get the download token "+t),t.networkError=!0,t;case 4:return[2]}var a}))}))},null==(t=o(e.userIdentity))?void 0:t.isRefreshingDownloadToken)return[3,4];c(e.userIdentity,{isRefreshingDownloadToken:!0}),a=0,u=w((function(){return Object(i.__awaiter)(v,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return a++,[4,n()];case 1:return t=r.sent(),f.g.info("update new token"),c(e.userIdentity,{downloadToken:t,isRefreshingDownloadToken:!1}),[2]}}))}))})).retriableFunc,l=new d.b("AttachmentRefreshDownloadToken"),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,u()];case 2:return h.sent(),l.addCustomData([a]),l.end(),[3,4];case 3:return b=h.sent(),f.g.warn("Retry to refresh token failed: "+b),l.addCustomData([a]),l.endWithError("ServerError",b),c(e.userIdentity,{isRefreshingDownloadToken:!1}),[3,4];case 4:return[2]}}))}))}(e)}),6e4*n)}var g=t(270);function m(e){var n=Object(r.j)(null==e?void 0:e.userIdentity),t=o(null==e?void 0:e.userIdentity);if((null==t?void 0:t.downloadToken)&&(null==t?void 0:t.downloadUrlBase))return t;switch(n){case null:case"Outlook":!function(e){var n=Object(r.r)(e.userIdentity)?Object(u.i)(e.userIdentity):Object(u.h)(),t=null==n?void 0:n.ApplicationSettings;if(t){var i=t.DownloadUrlBase;c(e.userIdentity,{downloadUrlBase:i,downloadToken:t.FirstDownloadToken}),i&&h(e,t.DownloadTokenRefreshMinutes)}}(e);break;case"Google":case"ICloud":break;default:Object(g.a)(n)}var i=o(e.userIdentity);return i||(Object(d.p)("FilesUrlDataNotFound",{accountProviderType:n}),f.g.warn("Unable to get the url data")),i}function I(e){if(!e)return null;var n=m(e);return null==n?void 0:n.downloadToken}t.d(n,"b",(function(){return m})),t.d(n,"a",(function(){return I}))},1816:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("MARK_ALL_AS_READ_STORE_UPDATE",(function(e,n,t){return{tableView:e,markAsRead:n,rowIdsToExclude:t}}))},1832:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(1402),i=t(83),a=t(1932);function o(e){return Object(i.i)("rp-persistedReadingPaneTabs")?Object(r.b)().loadedItemReadingPaneViewStates.get(e||(Object(r.b)().sxsId?Object(r.b)().sxsId:Object(a.a)())):Object(r.b)().itemReadingPaneViewState}},1849:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("DELETE_CONVERSATION_STORE_UPDATE",(function(e,n,t){return{conversationIds:e,tableView:n,actionType:t}}))},1874:function(e,n,t){"use strict";t.d(n,"h",(function(){return s})),t.d(n,"i",(function(){return d})),t.d(n,"f",(function(){return f})),t.d(n,"k",(function(){return l})),t.d(n,"m",(function(){return b})),t.d(n,"e",(function(){return v})),t.d(n,"g",(function(){return O})),t.d(n,"j",(function(){return w})),t.d(n,"l",(function(){return h}));var r=t(77),i=t(1718);t.d(n,"n",(function(){return i.a}));var a=t(1694);t.d(n,"a",(function(){return a.a}));var o=t(1527);t.d(n,"d",(function(){return o.b})),t.d(n,"c",(function(){return o.a}));var c=t(1719);t.d(n,"b",(function(){return c.a}));var u=new r.c((function(){return Promise.all([t.e(1),t.e(33),t.e(70),t.e(724)]).then(t.bind(null,2900))})),s=new r.b(u,(function(e){return e.getSharingInformation})),d=new r.b(u,(function(e){return e.getSharingIssuesForSharingData})),f=new r.b(u,(function(e){return e.getInfoBarCreator})),l=new r.b(u,(function(e){return e.hasLargeDLRecipient})),b=new r.b(u,(function(e){return e.hasRecipientExpansionFailure})),v=new r.b(u,(function(e){return e.getGroupsAndSmallDLs})),O=new r.b(u,(function(e){return e.getInvididualRecipients})),w=new r.b(u,(function(e){return e.hasGetRecipientPermissionFailed})),h=new r.b(u,(function(e){return e.logSharingTipChangesForLinkRemoval}))},1899:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(83);function i(){return Object(r.i)("rp-linkedInViewProfile")||Object(r.i)("rp-linkedInViewProfileV1_1")}},1900:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var r="displaylinkedindataprebind"},1923:function(e,n,t){"use strict";var r=t(1928);t.d(n,"a",(function(){return r.a})),t.d(n,"b",(function(){return r.b}));var i=t(1746);t.d(n,"c",(function(){return i.a}));var a=t(1744);t.d(n,"d",(function(){return a.a}))},1928:function(e,n,t){"use strict";var r=t(270),i=t(12),a=t(43),o="/owa/",c="service.svc/s/GetFileAttachment?id={0}",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",d="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",f="service.svc/s/GetAttachmentThumbnail?id={0}",l="pdfprint.aspx?id={0}",b="pdfprint.aspx?id={0}&location={1}",v=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var O=t(320),w=t(57),h=t(2),g=t(27),m=t(1746),I=t(1744);function j(e,n,t,r,c){if(void 0===r&&(r=!1),void 0===c&&(c=null),!e||!e.Id||!e.mailboxInfo)return null;var u=Object(m.b)(e.mailboxInfo),s=null==u?void 0:u.downloadUrlBase,d=Object(I.a)(e.mailboxInfo);if(c=c||Object(i.c)(n,encodeURIComponent(e.Id)),!s||r&&"Firefox"===Object(w.a)().browser){var f=o+c+"&X-OWA-CANARY="+Object(a.a)();return Object(g.a)(f)}var l="{0}{1}/{2}";Object(O.a)()&&(l+="&isc=1");var b=Object(i.c)(l,s,d,c);return t&&(b+="&token="+(null==u?void 0:u.downloadToken),b+="&X-OWA-CANARY="+Object(a.a)()),Object(w.i)()||(b+="&owa="+window.location.hostname,b+="&scriptVer="+Object(h.n)()||!1),b}function p(e,n,t,c,s,f,l,O,w){var h;switch(void 0===s&&(s=0),void 0===f&&(f=0),void 0===l&&(l=!0),void 0===O&&(O=null),void 0===w&&(w=null),t){case 0:h=u;break;case 3:h=b;break;case 1:if(!function(e){if(!e)return!1;var n=null,t=e.lastIndexOf(".");return t>0&&(n=e.substr(t).toLowerCase()),!!n&&v.indexOf(n.toLowerCase())>=0}(O))return null;h=d;break;default:Object(r.a)(t)}var m=c?f:s;!m&&s&&(m=s);var I=Object(i.c)("{0}&permissionLevel={1}",Object(i.c)(h,encodeURIComponent(e.Id),encodeURIComponent(n)),m),p=j(e,h,!0,3===t,I);if(p)return p;var S=Object(i.c)("{0}{1}{2}",o,w,I);l&&(S=S+"&X-OWA-CANARY="+Object(a.a)());return Object(g.a)(S)}function S(e,n,t,a){var o;switch(void 0===t&&(t=!1),void 0===a&&(a=!0),n){case 0:o=c;break;case 1:o=s;break;case 2:o=f;break;case 3:o=l;break;default:return Object(r.a)(n)}if(!Object(i.f)(o)){var u=j(e,o,a,3===n);return Object(i.c)("{0}{1}{2}",u,t?"&isDownload=true":"","&animation=true")}return null}t.d(n,"b",(function(){return p})),t.d(n,"a",(function(){return S}))},1932:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(1451),i=t(2095);function a(){var e=Object(r.d)();switch(e.type){case r.a.SecondaryReadingPane:return e.data.id.Id;case r.a.Primary:default:return Object(i.a)()}}},1966:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("MARK_CONVERSATIONS_AS_READ_STORE_UPDATE",(function(e,n,t,r){return{conversationIds:e,tableViewId:n,isReadValue:t,isExplicit:r}}))},1967:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("MARK_ITEMS_AS_READ_STORE_UPDATE",(function(e,n,t,r){return{itemIds:e,isReadValue:n,isExplicit:t,tableViewId:r}}))},2095:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(1402),i=t(722);function a(){var e,n;return Object(i.v)()?null===(e=Object(r.b)().deeplinkId)||void 0===e?void 0:e.id:null===(n=Object(r.b)().primaryReadingPaneTabId)||void 0===n?void 0:n.Id}},2131:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return o}));var r=t(3),i=Object(r.action)("CONVERSATION_READY_TO_LOAD",(function(e,n){return{conversationId:e,nodeIdCollectionChange:n}})),a=Object(r.action)("UPDATE_ATTACHMENTS"),o=Object(r.action)("UPDATE_ITEM_MANDATORY_PROPERTIES",(function(e,n){return{conversationId:e,nodeIdCollectionWithItemMandatoryPropertiesChanged:n}}))},2148:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(0),i=t(1451),a=t(1361),o=t(1484),c=t(270);function u(e,n,t){var u,l;void 0===n&&(n=0);var b=function(e){switch(e){case 0:return s;case 1:return d;case 2:return f;default:return Object(c.a)(e)}}(n),v=Object(o.b)();try{for(var O=Object(r.__values)(Object(a.a)().tabs),w=O.next();!w.done;w=O.next()){var h=w.value;if(h.type==i.a.Compose&&0==h.state){var g=v.viewStates.get(h.data);if((null==g?void 0:g.isInlineCompose)&&b(g,e)&&(0==g.asyncSendState||t&&6==g.asyncSendState))return g}}}catch(e){u={error:e}}finally{try{w&&!w.done&&(l=O.return)&&l.call(O)}finally{if(u)throw u.error}}return null}function s(e,n){return e.conversationId===n}function d(e,n){return e.referenceItemId.Id===n}function f(e,n){return!1}},2160:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("updateInternetMessageId",(function(e,n,t){return{conversationId:e,itemId:n,internetMessageId:t}}))},2205:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("initializeExtendedCardForItemReadingPane",(function(e,n){return{itemReadingPaneViewState:e,loadedItem:n}}))},2247:function(e,n,t){"use strict";var r=t(270),i=t(1923),a=t(43),o=t(2518);function c(e,n,t,a,c){var u;void 0===c&&(c=!0);var s=n,d=s.Name,f=s.OriginalPermissionType,l=s.PermissionType,b=Object(o.a)(n),v="GroupMailbox"===(null===(u=null==e?void 0:e.mailboxInfo)||void 0===u?void 0:u.type)?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(t){case 0:case 3:return i.b(e,b,t,a,l,f,c,d,v);case 1:return n.AttachmentPreviewUrl?n.AttachmentPreviewUrl:i.b(e,b,1,a,l,f,c,d,v);case 2:return n.AttachmentThumbnailUrl;default:return Object(r.a)(t)}}function u(e,n,t,r){return void 0===t&&(t=!1),void 0===r&&(r=!0),i.a(e,n,t,r)}function s(e,n,t,r,o){void 0===o&&(o=!1);var s=t?c(e,n,1,r,!1):u(e,1,o,!1);if(t)return{url:s,init:{credentials:"include"}};var d=Object(i.c)(e.mailboxInfo),f=new Headers;return f.set("X-Token",d),f.set("X-OWA-CANARY",Object(a.a)()),{url:s,init:{headers:f}}}function d(e,n,t,r,i,a){return void 0===a&&(a=!1),r?c(e,n,t,i):u(e,t,a)}t.d(n,"a",(function(){return d})),t.d(n,"b",(function(){return u})),t.d(n,"c",(function(){return s}))},2256:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("APPLY_CONVERSATION_FLAG_STATE_STORE_UPDATE",(function(e,n,t){return{conversationIds:e,flagType:n,tableViewId:t}}))},440:function(e,n,t){"use strict";var r=t(0);function i(e,n){return e?Object(r.__assign)({mailboxInfo:e},n):null!=n?n:void 0}t.d(n,"a",(function(){return i}))},4981:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(5385),i=t(6167),a=t(3088),o=t(12);function c(e){switch(e){case 2:return Object(o.b)(i.d);case 3:return Object(o.b)(i.e);case 5:return Object(o.b)(i.c);case 6:return Object(o.b)(r.a);case 7:return Object(o.b)(i.g);case 4:return Object(o.b)(i.f);case 10:return Object(o.b)(i.a);case 11:return Object(o.b)(i.b);default:return Object(o.b)(a.a)}}},5385:function(e){e.exports=JSON.parse('{"a":"qtb"}')},5502:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SINGLE_EVENT_ICS=1]="SINGLE_EVENT_ICS",e[e.MULTIPLE_EVENT_ICS=2]="MULTIPLE_EVENT_ICS"}(r||(r={}))},6167:function(e){e.exports=JSON.parse('{"d":"rtb","e":"stb","c":"ttb","g":"utb","f":"vtb","a":"wtb","b":"xtb"}')},670:function(e,n,t){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var n=e.maximumAttempts,t=e.timeBetweenRetryInMS;return function(e){var r=0,i=!1,a=function(o,c){i?c(new Error("The function retry was cancelled")):(r++,e().then((function(e){return o(e)})).catch((function(e){n&&r>=n?c(e):setTimeout((function(){return a(o,c)}),t(r))})))};return{retriableFunc:function(){return new Promise((function(e,n){return a(e,n)}))},cancel:function(){return i=!0}}}}function i(e){return function(n){return Math.pow(2,n)*e}}t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return i}))},7104:function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return o}));var r=t(77),i=new r.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(4),t.e(14),t.e(21),t.e(28),t.e(33),t.e(34),t.e(41),t.e(43),t.e(62),t.e(63),t.e(61),t.e(67),t.e(175),t.e(215),t.e(232),t.e(213),t.e(275),t.e(738)]).then(t.bind(null,10959))})),a=new r.b(i,(function(e){return e.getSxSViewStateFromElement})),o=Object(r.d)(i,(function(e){return e.SxSLayerView}));Object(r.d)(i,(function(e){return e.SxSView}))},8930:function(e,n,t){"use strict";t.d(n,"c",(function(){return o})),t.d(n,"d",(function(){return c})),t.d(n,"b",(function(){return u}));var r=t(77),i=t(5502);t.d(n,"a",(function(){return i.a}));var a=new r.c((function(){return Promise.all([t.e(4),t.e(6),t.e(14),t.e(16),t.e(18),t.e(74),t.e(218),t.e(592)]).then(t.bind(null,16310))})),o=new r.b(a,(function(e){return e.addToCalendar})),c=(new r.b(a,(function(e){return e.getIcsCalendarItem})),new r.b(a,(function(e){return e.getIcsCalendarItemOrchestrator}))),u=Object(r.d)(a,(function(e){return e.IcsPreview}))},9308:function(e,n,t){"use strict";var r=t(29),i=t(0);function a(e,n){var t;return void 0===e||e.__type||(t=e,e=Object(i.__assign)({__type:"GetAttachmentTextPreviewRequest:#Exchange"},t)),Object(r.a)("GetAttachmentTextPreview",e,n)}t.d(n,"a",(function(){return a}))},9964:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(0),i=t(9308),a=t(59);function o(e,n,t,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u,s,d,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:c={error:null,errorMessage:"Something went wrong while the document preview was being created. Please try again later."},r.label=1;case 1:return r.trys.push([1,3,,4]),o&&(u="getAttachmentTextPreview"+o,(n=n||{}).headers=n.headers||new Headers,n.headers.set("X-OWA-ActionName",u)),[4,Object(i.a)({AttachmentId:e,ReadMode:t},n)];case 2:if((s=r.sent())&&0===s.Status)return[2,s.Content];switch(d=(null==s?void 0:s.Status)||1){case 2:c.errorMessage="The attachment has been moved or deleted.";break;case 3:c.errorMessage="Something went wrong while the document preview was being created. Please try again later.";break;case 1:default:c.errorMessage="Something went wrong while the document preview was being created. Please try again later."}return c.error=new Error("getAttachmentTextPreview failed with status: "+d),[3,4];case 3:return f=r.sent(),a.g.warn("getAttachmentTextPreview failed with error: "+f),c.error=f,[3,4];case 4:throw c}}))}))}}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentPreviewSxS~SxS.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentPreviewSxS~SxS.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentPreviewSxS~SxS.js'] = (new Date()).getTime();