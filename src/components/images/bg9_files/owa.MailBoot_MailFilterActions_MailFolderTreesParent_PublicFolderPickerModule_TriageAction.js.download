self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailFilterActions~MailFolderTreesParent~PublicFolderPickerModule~TriageAction.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[135],{1540:function(e,n,t){"use strict";t.d(n,"b",(function(){return a}));var r=t(3),i={bulkActionInformationMap:new(t(20).ObservableMap)},a=Object(r.createStore)("bulkActionStore",i),o=a();n.a=o},1580:function(e,n){e.exports=function(e){return e instanceof Date}},1607:function(e,n,t){var r=t(1580),i=36e5,a=6e4,o=2,u=/[T ]/,c=/:/,d=/^(\d{2})$/,s=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],b=/^-(\d{2})$/,O=/^-?(\d{3})$/,v=/^-?(\d{2})-?(\d{2})$/,I=/^-?W(\d{2})$/,m=/^-?W(\d{2})-?(\d{1})$/,p=/^(\d{2}([.,]\d*)?)$/,T=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,A=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,j=/([Z+-].*)$/,w=/^(Z)$/,R=/^([+-])(\d{2})$/,g=/^([+-])(\d{2}):?(\d{2})$/;function S(e,n,t){n=n||0,t=t||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*n+t+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,n){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var t=(n||{}).additionalDigits;t=null==t?o:Number(t);var E=function(e){var n,t={},r=e.split(u);c.test(r[0])?(t.date=null,n=r[0]):(t.date=r[0],n=r[1]);if(n){var i=j.exec(n);i?(t.time=n.replace(i[1],""),t.timezone=i[1]):t.time=n}return t}(e),_=function(e,n){var t,r=s[n],i=f[n];if(t=l.exec(e)||i.exec(e)){var a=t[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(t=d.exec(e)||r.exec(e)){var o=t[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(E.date,t),D=_.year,h=function(e,n){if(null===n)return null;var t,r,i,a;if(0===e.length)return(r=new Date(0)).setUTCFullYear(n),r;if(t=b.exec(e))return r=new Date(0),i=parseInt(t[1],10)-1,r.setUTCFullYear(n,i),r;if(t=O.exec(e)){r=new Date(0);var o=parseInt(t[1],10);return r.setUTCFullYear(n,0,o),r}if(t=v.exec(e)){r=new Date(0),i=parseInt(t[1],10)-1;var u=parseInt(t[2],10);return r.setUTCFullYear(n,i,u),r}if(t=I.exec(e))return a=parseInt(t[1],10)-1,S(n,a);if(t=m.exec(e)){a=parseInt(t[1],10)-1;var c=parseInt(t[2],10)-1;return S(n,a,c)}return null}(_.restDateString,D);if(h){var k,C=h.getTime(),y=0;return E.time&&(y=function(e){var n,t,r;if(n=p.exec(e))return(t=parseFloat(n[1].replace(",",".")))%24*i;if(n=T.exec(e))return t=parseInt(n[1],10),r=parseFloat(n[2].replace(",",".")),t%24*i+r*a;if(n=A.exec(e)){t=parseInt(n[1],10),r=parseInt(n[2],10);var o=parseFloat(n[3].replace(",","."));return t%24*i+r*a+1e3*o}return null}(E.time)),E.timezone?k=function(e){var n,t;if(n=w.exec(e))return 0;if(n=R.exec(e))return t=60*parseInt(n[2],10),"+"===n[1]?-t:t;if(n=g.exec(e))return t=60*parseInt(n[2],10)+parseInt(n[3],10),"+"===n[1]?-t:t;return 0}(E.timezone):(k=new Date(C+y).getTimezoneOffset(),k=new Date(C+y+k*a).getTimezoneOffset()),new Date(C+y+k*a)}return new Date(e)}},1651:function(e,n,t){"use strict";var r=t(77),i=t(1540),a=t(2410),o=t(59);function u(e){var n=i.a.bulkActionInformationMap.get(e);return!!n&&(!(n.customData&&!function(e){var n;try{n=JSON.parse(e)}catch(e){return o.d("Failed to parse bulkActionInfo.customData"),!1}return null!==n&&null!==n.Scenario}(n.customData))&&!Object(a.a)(n,e))}function c(e,n){var t=i.a.bulkActionInformationMap.get(e);return u(e)&&t.state==n}function d(e){return(c(e,s.b.Uninitialized)||c(e,s.b.Running))&&u(e)}var s=t(1763);t.d(n,"a",(function(){return f})),t.d(n,"j",(function(){return b})),t.d(n,"i",(function(){return O})),t.d(n,"k",(function(){return v})),t.d(n,"f",(function(){return I})),t.d(n,"h",(function(){return m})),t.d(n,"g",(function(){return p})),t.d(n,"c",(function(){return c})),t.d(n,"e",(function(){return u})),t.d(n,"d",(function(){return d})),t.d(n,"b",(function(){return s.b})),t.d(n,"l",(function(){return i.a}));var l=new r.c((function(){return Promise.all([t.e(0),t.e(2),t.e(3),t.e(28),t.e(41),t.e(49),t.e(59),t.e(65),t.e(71),t.e(224),t.e(483)]).then(t.bind(null,10835))})),f=Object(r.d)(l,(function(e){return e.BulkActionSpinner})),b=new r.a(l,(function(e){return e.subscribeToBulkActionNotification})),O=new r.a(l,(function(e){return e.onBulkActionSubmitted})),v=new r.a(l,(function(e){return e.findBulkActionItemAction})),I=new r.a(l,(function(e){return e.onBulkActionCancel})),m=new r.a(l,(function(e){return e.onBulkActionHierarchyNotification})),p=new r.a(l,(function(e){return e.onBulkActionDismiss}))},1652:function(e,n,t){"use strict";var r=t(77),i=t(1721),a=t(1311),o=t(1323),u=t(1322),c=t(1312),d=t(1325);function s(e,n){return e&&!Object(a.w)()&&n&&"UserMailbox"===n.type&&!Object(o.m)(e)&&e!=Object(u.a)("recoverableitemsdeletions")&&!Object(c.D)(e,d.k)}t.d(n,"e",(function(){return f})),t.d(n,"a",(function(){return i.a})),t.d(n,"b",(function(){return i.b})),t.d(n,"d",(function(){return i.c})),t.d(n,"c",(function(){return s}));var l=new r.c((function(){return t.e(932).then(t.bind(null,16432))})),f=new r.a(l,(function(e){return e.undo}))},1712:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("DELETE_ITEMS_STORE_UPDATE",(function(e,n,t){return{itemContexts:e,parentFolderId:n,actionType:t}}))},1721:function(e,n,t){"use strict";var r,i,a=t(0),o=t(3),u=Object(o.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null})(),c=t(1737),d=t(285),s=t(74),l=t(340),f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DismissUndo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dismissUndo"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]};t.d(n,"a",(function(){return b})),t.d(n,"b",(function(){return O})),t.d(n,"c",(function(){return I})),t.d(n,"d",(function(){return m}));var b=Object(d.action)("addActionToUndoStack")(Object(d.select)({store:function(){return u}})((function(e,n,t,a){null!==e&&(r=e,a.store.hasUndoableAction=!0,a.store.undoableActionFolderId=n,i=t)}))),O=Object(d.action)("clearLastUndoableAction")(Object(d.select)({store:function(){return u}})((function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,t,o;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return i?[4,i]:[3,4];case 1:return(n=a.sent()).success&&(t=n.undoRequestId)?(o={undoRequestId:t},[4,v.invokeDismissUndoMutation(o)]):[3,3];case 2:a.sent(),a.label=3;case 3:i=null,a.label=4;case 4:return r=null,e.store.hasUndoableAction=!1,e.store.undoableActionFolderId=null,[2]}}))}))}))),v={invokeDismissUndoMutation:function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(l.a)()];case 1:return[4,n.sent().mutate({variables:e,mutation:f})];case 2:return n.sent(),[2]}}))}))}},I=Object(d.select)({store:function(){return u}})((function(e){return e.store.hasUndoableAction})),m=Object(s.d)("undo",{name:"TnS_Undo",customData:function(e){return[e]}})((function(e){u.undoableActionFolderId?c.a.clearMapForFolder(u.undoableActionFolderId):c.a.removeAll();null!==r&&(r(),O())}))},1724:function(e,n,t){"use strict";var r=t(77),i=t(2256),a=t(1849),o=t(1712),u=t(1816),c=t(1966),d=t(1967),s=t(2160),l=t(2205),f=t(2131),b=t(1402),O=t(83),v=t(1319);function I(e,n){return!!e&&(1!==n&&!!v.a.conversations.get(e))}function m(e,n){return 2!=n&&(Object(O.i)("rp-persistedReadingPaneTabs")?b.a.loadedItemReadingPaneViewStates.has(e):b.a.itemReadingPaneViewState&&b.a.itemReadingPaneViewState.itemId==e)}var p=t(1899),T=t(1900),A=t(1832),j=t(1456);t.d(n,"l",(function(){return R})),t.d(n,"p",(function(){return g})),t.d(n,"m",(function(){return S})),t.d(n,"q",(function(){return E})),t.d(n,"s",(function(){return _})),t.d(n,"n",(function(){return D})),t.d(n,"o",(function(){return h})),t.d(n,"i",(function(){return k})),t.d(n,"j",(function(){return C})),t.d(n,"k",(function(){return y})),t.d(n,"g",(function(){return F})),t.d(n,"r",(function(){return P})),t.d(n,"h",(function(){return U})),t.d(n,"d",(function(){return I})),t.d(n,"e",(function(){return m})),t.d(n,"f",(function(){return p.a})),t.d(n,"a",(function(){return T.a})),t.d(n,"t",(function(){return b.a})),t.d(n,"c",(function(){return A.a})),t.d(n,"b",(function(){return j.a}));var w=new r.c((function(){return Promise.all([t.e(1),t.e(6),t.e(8),t.e(14),t.e(16),t.e(18),t.e(21),t.e(19),t.e(26),t.e(34),t.e(43),t.e(61),t.e(74),t.e(119),t.e(174),t.e(179),t.e(181),t.e(260),t.e(270),t.e(256),t.e(693)]).then(t.bind(null,16618))})),R=new r.a(w,(function(e){return e.loadConversationReadingPane})),g=new r.a(w,(function(e){return e.moveReadingPaneToTab})),S=new r.a(w,(function(e){return e.loadConversationReadingPaneForSingleMailItemSelected})),E=new r.a(w,(function(e){return e.print})),_=new r.a(w,(function(e){return e.setItemIdToScrollTo})),D=new r.a(w,(function(e){return e.loadItemReadingPane})),h=new r.a(w,(function(e){return e.loadItemReadingPaneForSingleMailItemSelected})),k=new r.a(w,(function(e){return e.expandCollapseAllItemParts}));Object(r.f)(o.a,w,(function(e){return e.deleteItemsStoreUpdateOrchestrator})),Object(r.f)(c.a,w,(function(e){return e.markConversationsAsReadStoreUpdateOrchestrator})),Object(r.f)(d.a,w,(function(e){return e.markItemsAsReadStoreUpdateOrchestrator})),Object(r.f)(u.a,w,(function(e){return e.markAllAsReadOrchestrator})),Object(r.f)(i.a,w,(function(e){return e.applyConversationFlagStateStoreUpdateOrchestrator})),Object(r.f)(a.a,w,(function(e){return e.deleteConversationStoreUpdateOrchestrator})),Object(r.f)(f.a,w,(function(e){return e.conversationReadyToLoadOrchestrator})),Object(r.f)(f.b,w,(function(e){return e.updateAttachmentsOrchestrator})),Object(r.f)(f.c,w,(function(e){return e.updateItemMandatoryPropertiesOrchestrator})),Object(r.f)(s.a,w,(function(e){return e.updateInternetMessageIdOrchestrator})),Object(r.f)(l.a,w,(function(e){return e.initializeExtendedCardForItemReadingPaneOrchestrator}));new r.b(w,(function(e){return e.getLastestNonDraftItemId}));var C=new r.b(w,(function(e){return e.getLatestNonDraftItemIdFromConversation})),y=new r.b(w,(function(e){return e.isUnsupportedItem})),F=new r.a(w,(function(e){return e.clearReadingPaneStore})),P=new r.a(w,(function(e){return e.replyByMeeting})),U=new r.a(w,(function(e){return e.ensureSecondaryReadingPaneTabHandler}))},1763:function(e,n,t){"use strict";var r,i;t.d(n,"a",(function(){return i})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Cancelled=2]="Cancelled",e[e.Complete=3]="Complete",e[e.Failed=4]="Failed",e[e.Timeout=5]="Timeout",e[e.Cancelling=6]="Cancelling"}(r||(r={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Cancelled=2]="Cancelled",e[e.Complete=3]="Complete",e[e.Failed=4]="Failed",e[e.Timeout=5]="Timeout"}(i||(i={})),n.b=r},1816:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("MARK_ALL_AS_READ_STORE_UPDATE",(function(e,n,t){return{tableView:e,markAsRead:n,rowIdsToExclude:t}}))},1832:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(1402),i=t(83),a=t(1932);function o(e){return Object(i.i)("rp-persistedReadingPaneTabs")?Object(r.b)().loadedItemReadingPaneViewStates.get(e||(Object(r.b)().sxsId?Object(r.b)().sxsId:Object(a.a)())):Object(r.b)().itemReadingPaneViewState}},1849:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("DELETE_CONVERSATION_STORE_UPDATE",(function(e,n,t){return{conversationIds:e,tableView:n,actionType:t}}))},1899:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(83);function i(){return Object(r.i)("rp-linkedInViewProfile")||Object(r.i)("rp-linkedInViewProfileV1_1")}},1900:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var r="displaylinkedindataprebind"},1966:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("MARK_CONVERSATIONS_AS_READ_STORE_UPDATE",(function(e,n,t,r){return{conversationIds:e,tableViewId:n,isReadValue:t,isExplicit:r}}))},1967:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("MARK_ITEMS_AS_READ_STORE_UPDATE",(function(e,n,t,r){return{itemIds:e,isReadValue:n,isExplicit:t,tableViewId:r}}))},2129:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("GET_FOLDER_DATA",(function(e){return{folderId:e}}))},2131:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return o}));var r=t(3),i=Object(r.action)("CONVERSATION_READY_TO_LOAD",(function(e,n){return{conversationId:e,nodeIdCollectionChange:n}})),a=Object(r.action)("UPDATE_ATTACHMENTS"),o=Object(r.action)("UPDATE_ITEM_MANDATORY_PROPERTIES",(function(e,n){return{conversationId:e,nodeIdCollectionWithItemMandatoryPropertiesChanged:n}}))},2160:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("updateInternetMessageId",(function(e,n,t){return{conversationId:e,itemId:n,internetMessageId:t}}))},2205:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("initializeExtendedCardForItemReadingPane",(function(e,n){return{itemReadingPaneViewState:e,loadedItem:n}}))},2206:function(e,n,t){"use strict";var r=t(1311),i=t(285);n.a=Object(i.select)({tableViews:function(){return r.X.tableViews}})((function(e,n,t){var r=t.tableViews,i=[];return r.forEach((function(t){if(t.tableQuery.folderId==e||n&&1==t.tableQuery.type)i.push(t);else if(n){var r=t.tableQuery.scenarioType;"category"!==r&&"persona"!==r&&"privatedistributionlist"!==r||i.push(t)}})),i}))},2256:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("APPLY_CONVERSATION_FLAG_STATE_STORE_UPDATE",(function(e,n,t){return{conversationIds:e,flagType:n,tableViewId:t}}))},2410:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(2510),i=t.n(r),a=t(1763),o=t(1540);function u(e,n){var t=new Date,r=new Date(e.sendTime),u=i()(t,r),c=isNaN(u),d=u>7.5,s=Object(o.b)().bulkActionInformationMap.get(n);return!(!c&&!d)||!!s&&[a.b.Cancelled,a.b.Failed,a.b.Complete].indexOf(s.state)>-1}},2480:function(e,n,t){var r=t(1607);e.exports=function(e,n){var t=r(e),i=r(n);return t.getTime()-i.getTime()}},2510:function(e,n,t){var r=t(2480),i=36e5;e.exports=function(e,n){var t=r(e,n)/i;return t>0?Math.floor(t):Math.ceil(t)}},2794:function(e,n,t){"use strict";var r=t(547),i=t(2129),a=t(2411),o=t(285),u=t(1892),c=t(1311),d=t(1493),s=t(1454),l=t(269),f=t(1518),b=Object(o.action)("onReloadTableSucceeded")((function(e,n,t){Object(f.h)(n,e,t,!0,!1,"MergeOnReload"),e.currentLoadedIndex=e.rowKeys.length})),O=Object(o.action)("onReloadTableFailed")((function(e){Object(l.p)("TnS_ReloadError",[e])})),v=t(2923);n.a=Object(o.action)("reloadMailListTableAction")((function(e){if(1!==e.tableQuery.type&&!Object(c.T)(e.tableQuery.folderId)){var n=Math.max(e.currentLoadedIndex,s.a);switch(e.tableQuery.listViewType){case 0:!function(e,n){var t,r=e.tableQuery,i=Object(c.j)(e,!0),a=null===(t=i)||void 0===t?void 0:t.Id;Object(u.d)(r.folderId,n,r.viewFilter,r.sortBy,Object(f.l)(r),r.focusedViewFilter,r.requestShapeName,Object(d.d)(r),void 0,r.categoryName,a).then((function(n){var t=[];n.edges&&(t=n.edges.map((function(e){return e.node}))),b(e,t,n.totalConversationRowsInView)})).catch((function(e){var n=Object(v.a)(e);O(n)}))}(e,n);break;case 1:!function(e,n){var t=e.tableQuery;Object(u.c)(Object(c.i)(t),0,n,t.viewFilter,Object(a.a)(t),t.focusedViewFilter,t.requestShapeName,t.shouldTryToUseSessionDataResponse,Object(d.e)(t),t.categoryName,e.serverFolderId&&e.serverFolderId!=t.folderId?Object(r.a)({Id:e.serverFolderId}):null).then((function(n){"Success"==n.ResponseClass?b(e,n.RootFolder.Items,n.RootFolder.TotalItemsInView):O(n.ResponseCode)})).catch((function(e){O()}))}(e,n)}0==e.tableQuery.type&&Object(i.a)(e.tableQuery.folderId),Object(l.p)("ReloadTable",[n],{sessionSampleRate:10})}}))},2816:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("MARK_CONVERSATIONS_PINNED_STORE_UPDATE",(function(e,n,t){return{rowKeys:e,tableViewId:n,shouldMarkAsPinned:t}}))},2817:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("MARK_ITEMS_PINNED_STORE_UPDATE",(function(e,n,t){return{rowKeys:e,tableViewId:n,shouldMarkAsPinned:t}}))},3010:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("RELOAD_TABLE_ON_TRIAGE_ACTION_FAIL",(function(e){return{tableView:e}}))},3273:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("CONVERSATION_CATEGORIES_STORE_UPDATE",(function(e,n,t,r,i){return{conversationRowKeys:e,tableViewId:n,categoriesToAdd:t,categoriesToRemove:r,clearCategories:i}}))},3274:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("ITEMS_CATEGORIES_STORE_UPDATE",(function(e,n,t,r){return{itemIds:e,categoriesToAdd:n,categoriesToRemove:t,clearCategories:r}}))}}]);
//# sourceMappingURL=owa.MailBoot~MailFilterActions~MailFolderTreesParent~PublicFolderPickerModule~TriageAction.js.map
self.scriptsLoaded['owa.MailBoot~MailFilterActions~MailFolderTreesParent~PublicFolderPickerModule~TriageAction.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailFilterActions~MailFolderTreesParent~PublicFolderPickerModule~TriageAction.js'] = (new Date()).getTime();