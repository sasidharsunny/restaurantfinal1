self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~OwaGroupSharedActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[664],{1346:function(t,e,n){"use strict";function r(t,e){Object.keys(e).forEach((function(n){return t.set(n,e[n])}))}function o(t){var e=null!=t?t:{headers:new Headers};return e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}))},1347:function(t,e,n){"use strict";var r=n(0),o=n(1405),i=n(388),u=n(662),a=n(269),c=n(9),s="X-AnchorMailbox",d="Authorization",f="X-OwaWebSessionType",b="X-OWA-ExplicitLogonUser";function l(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,l,p,g,v;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n={},l=Object(i.k)(t)){if(l.accountState==i.b.AccessRevoked)return[2,null];if(l.accountState==i.b.AccountDeprovisioned||l.accountState==i.b.AccountNotFound)return Object(i.c)(l.accountState,l.accountProviderType),[2,null]}return e?(n[s]=e,n[b]=e):l&&(n[s]=l.anchorMailbox),l?(p=l.token,!(g=Object(u.g)(l.tokenExpiry))&&p?[3,2]:(Object(a.p)("getAndUpdateAccessToken",{tokenExpiry:Object(c.y)(l.tokenExpiry,Object(c.Pb)()),isTokenExpired_1:g,isTokenInvalid_2:!p},{isCore:!0}),[4,o.a.importAndExecute(l.accountId,t)])):[3,3];case 1:(p=r.sent())||(p=""),r.label=2;case 2:v=void 0,"Outlook"==l.accountProviderType?(v='MSAuth1.0 usertoken="'+p+'", type="MSACT"',n[f]=1..toString()):"Google"!=l.accountProviderType&&"ICloud"!=l.accountProviderType||(v="Bearer "+p,n[f]=2..toString()),n[d]=v,r.label=3;case 3:return[2,n]}}))}))}var p=n(1346),g=n(59);function v(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(p.a)(),o=n,[4,O(t,e)];case 1:return o.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function O(t,e){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=e&&(null===(n=t.headers)||void 0===n?void 0:n.set)?new Headers(t.headers):new Headers,[4,l(t.mailboxInfo.userIdentity,j(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=r.sent(),Object(p.b)(o,i),[2,o]}}))}))}function j(t,e){var n="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return n&&null==e&&g.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return v})),n.d(e,"c",(function(){return j}))},1348:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3),o=Object(r.action)("triggerReInitializeAccount",(function(t){return{userIdentity:t}}))},1373:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(3),o=n(20),i=Object(r.createStore)("groupsStore",{groups:new o.ObservableMap})},1390:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(3),o=n(1458),i=Object(r.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:o.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},1395:function(t,e,n){"use strict";var r=n(3),o=n(20),i=(Object(r.createStore)("personaPhotoStore",{personaPhotoUrls:new o.ObservableMap})(),n(1549),n(1458),n(1373)),u=n(1390),a=n(1397);function c(t){var e=Object(i.a)().groups.get(t.toLowerCase());return!!e&&!e.groupDetailsError}var s=n(1504),d=n(1552),f=function(){return Object(d.a)().smtpAddress},b=n(1453),l=Object(r.mutatorAction)("updateGroupSiteAndDocumentUrl",(function(t,e,n,r){if(2==e){var o=Object(a.a)(t);Object(s.a)(o,"Site")[0].Url=n,Object(s.a)(o,"Files")[0].Url=r}})),p=n(1610);function g(t){return t=t.toLocaleLowerCase(),Object(b.a)().groupSiteStatus.has(t)?Object(b.a)().groupSiteStatus.get(t):0}var v=function(t){var e="string"==typeof t?Object(a.a)(t):t;return e?e.ExternalDirectoryObjectId:null},O=(n(1412),n(1602),n(1586),n(1611),n(1603),n(1901)),j=n(1902),S=n(1918),m=n(1889),h=n(1890),A=n(12);function y(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(A.b)(m.a);if(3===e)return Object(A.b)(h.a)}return""}function x(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(A.b)(S.b);if(3===e)return Object(A.b)(S.c)}return""}function w(t){var e=0;return t.members?e=t.members.totalCount:t.groupDetails&&(e=t.groupDetails.MemberCount),e?e>1?Object(A.c)(Object(A.b)(j.a),e.toString()):Object(A.c)(Object(A.b)(O.a),e.toString()):Object(A.b)(S.a)}n.d(e,"j",(function(){return i.a})),n.d(e,"l",(function(){return u.a})),n.d(e,"d",(function(){return a.a})),n.d(e,"m",(function(){return c})),n.d(e,"f",(function(){return s.a})),n.d(e,"g",(function(){return s.b})),n.d(e,"c",(function(){return f})),n.d(e,"i",(function(){return b.a})),n.d(e,"o",(function(){return l})),n.d(e,"n",(function(){return p.b})),n.d(e,"h",(function(){return g})),n.d(e,"e",(function(){return v})),n.d(e,"a",(function(){return y})),n.d(e,"b",(function(){return x})),n.d(e,"k",(function(){return w}))},1397:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1373);function o(t){var e=Object(r.a)().groups.get(t.toLowerCase());return e?e.groupDetails:null}},1405:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(77),o=n(1348);n.d(e,"b",(function(){return o.a}));var i=new r.c((function(){return n.e(1149).then(n.bind(null,1664))})),u=new r.a(i,(function(t){return t.getAndUpdateAccessToken}))},1412:function(t,e,n){"use strict";var r;!function(t){t[t.None=0]="None",t[t.Executing=1]="Executing",t[t.Succeed=2]="Succeed",t[t.FailureNotice=3]="FailureNotice",t[t.FailureRetry=4]="FailureRetry"}(r||(r={})),e.a=r},1418:function(t,e,n){"use strict";var r=n(0),o=n(1346);function i(t){return{"X-OWA-ExplicitLogonUser":t,"X-AnchorMailbox":t}}function u(t,e){e&&t&&Object(o.b)(e,i(t))}function a(t,e){var n,o=null!=e?e:{},i=(null===(n=o.headers)||void 0===n?void 0:n.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",u(t,i),Object(r.__assign)(Object(r.__assign)({},o),{headers:i})}var c=n(388),s=n(1347),d=n(121),f=n(360);function b(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e=Object(d.a)(),t?Object(c.r)(t.userIdentity)?[4,Object(s.a)(t.userIdentity,"GroupMailbox"==t.type||"TeamsMailbox"==t.type?t.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return n=r.sent(),f(e,n),[3,3];case 2:"GroupMailbox"!=t.type&&"TeamsMailbox"!=t.type||(o=i(t.mailboxSmtpAddress),f(e,o)),r.label=3;case 3:return[2,e]}}))}))}function l(){var t=Object(d.a)();return t.prefer='exchange.Behavior="CalendarInternal"',t}function p(t){void 0===t&&(t=null);var e={};return Object(c.r)(t)?(e=l(),Object(s.a)(t).then((function(t){return Object.keys(t).forEach((function(n){return e[n]=t[n]})),e}))):Promise.resolve(e)}var g=n(43);function v(t,e,n){var r=new Headers;return n&&r.set("X-OWA-CANARY",Object(g.a)()),e&&r.set("X-OWA-ActionName",e),t&&u(t,r),r}n.d(e,"a",(function(){return a})),n.d(e,"d",(function(){return b})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return l})),n.d(e,"f",(function(){return u})),n.d(e,"e",(function(){return v}))},1453:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(3),o=n(20),i=Object(r.createStore)("getGroupSiteStatusStore",{groupSiteStatus:new o.ObservableMap})},1458:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Private=0]="Private",t[t.Public=1]="Public"}(r||(r={}))},1469:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0);function o(t){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},t)}},1504:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var r=n(1397),o=function(t,e){var n="string"==typeof t?Object(r.a)(t):t;if(!n||!n.GroupResources)return null;var o=n.GroupResources.filter((function(t){return t.Name===e}));return!o||o.length<1?null:o},i=function(t,e){var n=o(t,e);return n&&0!=n.length?n[0].Url:null}},1549:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(83),o=n(1390),i=n(96);function u(){return(Object(r.i)("grp-shareable-crud")||Object(o.a)().isSensitivityLabelsEnabled)&&!Object(i.s)()}},1552:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3),o=Object(r.createStore)("currentGroupInformationStore",{smtpAddress:"",groupId:"",tenantId:""})},1586:function(t,e,n){"use strict";var r=n(3),o=n(1662),i=Object(r.mutatorAction)("setJoinButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=i},1602:function(t,e,n){"use strict";var r=n(3),o=n(1661),i=Object(r.mutatorAction)("setFollowButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=i},1603:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1412),o=n(1662);function i(t){t=t.toLowerCase();var e=o.a.groupActionState;return e.has(t)?e.get(t):r.a.None}},1610:function(t,e,n){"use strict";n.d(e,"b",(function(){return i}));var r=n(3),o=n(1453),i=Object(r.mutatorAction)("setGroupSiteStatus",(function(t,e){t=t.toLocaleLowerCase(),Object(o.a)().groupSiteStatus.has(t)&&e==Object(o.a)().groupSiteStatus.get(t)||Object(o.a)().groupSiteStatus.set(t,e)}));e.a=i},1611:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1412),o=n(1661);function i(t){t=t.toLowerCase();var e=o.a.groupActionState;return e.has(t)?e.get(t):r.a.None}},1661:function(t,e,n){"use strict";var r=n(3),o=n(20);e.a=Object(r.createStore)("followButtonStore",{groupActionState:new o.ObservableMap})()},1662:function(t,e,n){"use strict";var r=n(3),o=n(20);e.a=Object(r.createStore)("joinButtonStore",{groupActionState:new o.ObservableMap})()},1687:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0);function o(t){return Object(r.__assign)({__type:"BodyContentType:#Exchange"},t)}},1734:function(t,e,n){"use strict";var r,o,i,u,a,c,s,d,f,b,l,p,g,v,O;var j;n(12);function S(t,e){e,j=t}function m(){return j}n.d(e,"o",(function(){return r})),n.d(e,"n",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return a})),n.d(e,"g",(function(){return c})),n.d(e,"d",(function(){return s})),n.d(e,"f",(function(){return d})),n.d(e,"l",(function(){return f})),n.d(e,"m",(function(){return b})),n.d(e,"q",(function(){return l})),n.d(e,"r",(function(){return p})),n.d(e,"h",(function(){return g})),n.d(e,"j",(function(){return v})),n.d(e,"e",(function(){return O})),n.d(e,"p",(function(){})),n.d(e,"k",(function(){return S})),n.d(e,"i",(function(){return m}))},1889:function(t){t.exports=JSON.parse('{"a":"bba"}')},1890:function(t){t.exports=JSON.parse('{"a":"aba"}')},1901:function(t){t.exports=JSON.parse('{"a":"$aa"}')},1902:function(t){t.exports=JSON.parse('{"a":"fba"}')},1918:function(t){t.exports=JSON.parse('{"b":"cba","c":"dba","a":"eba"}')},1993:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0);function o(t){return Object(r.__assign)({__type:"UnifiedGroupIdentity:#Exchange"},t)}},2468:function(t,e,n){"use strict";function r(t,e,n){var r,o,i,u,a,c=t.groups.get(e.toLowerCase());if(c||(n.unreadMessageCount=null,n.groupDetailsError=n.groupDetailsError||!1),!n.groupDetailsError||c&&c.basicInformation||(n.basicInformation={SmtpAddress:e,DisplayName:e}),n.groupDetails){var s=n.groupDetails;c&&c.basicInformation&&!c.groupDetailsError||(n.basicInformation={SmtpAddress:s.SmtpAddress,DisplayName:s.DisplayName,AccessType:s.AccessType,LegacyDN:s.LegacyDN,MailboxGuid:s.MailboxGuid}),n.groupDetails.UserGroupRelationship={SubscriptionType:(null===(r=s.UserGroupRelationship)||void 0===r?void 0:r.SubscriptionType)||0,IsSubscribed:(null===(o=s.UserGroupRelationship)||void 0===o?void 0:o.IsSubscribed)||!1,ShouldIgnoreReply:(null===(i=s.UserGroupRelationship)||void 0===i?void 0:i.ShouldIgnoreReply)||!1,IsMember:(null===(u=s.UserGroupRelationship)||void 0===u?void 0:u.IsMember)||!1,IsOwner:(null===(a=s.UserGroupRelationship)||void 0===a?void 0:a.IsOwner)||!1}}return n}var o=n(285),i=n(1552),u=Object(o.action)("addOrUpdateGroup")((function(t,e,n,o,u){var a;e=e.toLowerCase();var c=void 0!==o&&""!==o;if(c&&(o=o.toLowerCase(),e=n.groupDetails.SmtpAddress),n=r(t,c?o:e,n),t.groups.has(e)||c&&t.groups.has(o)){var s=t.groups.has(e)?t.groups.get(e):t.groups.get(o);n.basicInformation&&(s.basicInformation=n.basicInformation),n.groupDetails&&((null===(a=s.groupDetails)||void 0===a?void 0:a.MailboxSettings)&&!n.groupDetails.MailboxSettings&&(n.groupDetails.MailboxSettings=s.groupDetails.MailboxSettings),s.groupDetails=n.groupDetails),n.members&&(s.members=n.members),null!=n.groupDetailsError&&(s.groupDetailsError=n.groupDetailsError),c&&e!==o&&(void 0!==u&&u(e,o),t.groups.set(e,s),t.groups.delete(o),Object(i.a)().smtpAddress=e)}else t.groups.set(e,n)}));e.a=u},3234:function(t,e,n){"use strict";var r=n(285),o=n(1734),i=n(1810),u=n(1395),a=n(2468),c=n(1610),s=n(1504);var d=function(t,e){var n=Object(s.b)(e,"Site");n?!function(t){return-1==t.indexOf("_layouts/groupstatus.aspx")}(n)?Object(c.a)(t,1):Object(c.a)(t,2):Object(c.a)(t,0)},f=n(3),b=Object(f.action)("beforeGetGroupDetailsStartAction",(function(t){return{groupSmtpAddress:t}}));Object(f.orchestrator)(b,(function(t){3==Object(u.h)(t.groupSmtpAddress)&&Object(u.n)(t.groupSmtpAddress,1)}));var l=b,p=n(1552),g=Object(f.mutatorAction)("updateCurrentGroupIdAndTenantIdAction",(function(t,e){Object(p.a)().groupId=t,Object(p.a)().tenantId=e})),v=function(t,e){Object(a.a)(Object(u.j)(),t,{basicInformation:null,groupDetails:null,members:null,groupDetailsError:!0}),Object(u.n)(t,0),e&&e()},O=Object(r.action)("getGroupDetailsAction")((function(t,e,n,r){l(t),(o.g||i.f)(t,e).then((function(e){return function(t,e,n,r){if(t&&t.Body&&Object(i.i)(t.Body)){var o=t.Body.GroupDetails;o?(Object(a.a)(Object(u.j)(),o.SmtpAddress,{basicInformation:null,groupDetails:o,members:null,groupDetailsError:!1}),g(o.ExternalDirectoryObjectId,o.ExternalDirectoryOrganizationId),d(e,o),n&&n()):v(e,r)}else v(e,r)}(e,t,n,r)})).catch((function(e){v(t,r)}))}));e.a=O},6945:function(t,e,n){"use strict";var r=n(401),o=n(1390);e.a=Object(r.mutatorAction)("updateUnifiedGroupSettings",(function(t){var e=Object(o.a)();Object.keys(t).forEach((function(n){e[n]=t[n]}))}))},7317:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n(6945),i=n(4991),u=n(3),a=Object(u.action)("loadUnifiedGroupsSettings");Object(u.orchestrator)(a,(function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(i.b)()];case 1:return(null==(t=e.sent())?void 0:t.unifiedGroupSettings)&&t.responseCode===i.a.Success&&Object(o.a)(t.unifiedGroupSettings),[2]}}))}))}));var c=a,s=n(3234);n.d(e,"loadUnifiedGroupsSettings",(function(){return c})),n.d(e,"getGroupDetailsAction",(function(){return s.a}))}}]);
//# sourceMappingURL=owa.MailBoot~OwaGroupSharedActions.js.map
self.scriptsLoaded['owa.MailBoot~OwaGroupSharedActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~OwaGroupSharedActions.js'] = (new Date()).getTime();