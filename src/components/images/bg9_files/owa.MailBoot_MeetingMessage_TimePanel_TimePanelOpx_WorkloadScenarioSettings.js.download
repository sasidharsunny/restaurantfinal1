self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MeetingMessage~TimePanel~TimePanelOpx~WorkloadScenarioSettings.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[136],{2049:function(e,n,t){"use strict";var i=t(3),r=t(0),a=t(96),c=Object(i.action)("WORKLOAD_SCENARIO_SETTINGS_LOADED",(function(e,n){return{settings:e,userIdentity:n}})),u=Object(i.action)("LOADING_WORKLOAD_SCENARIO_SETTINGS_FAILED",(function(e){return{userIdentity:e}}));var o="ows/beta/ScenarioSettings",s=["IsTimePanelDatePickerExpanded","TimePanelCalendarIds","IsTimePanelCalendarViewTaskListSelected","WasFocusTimeSuggestionDisabled"];function d(e){switch(e){case 1:return"Mail";case 2:return"Calendar";case 64:return"FilesHub";case 4:return"People";default:throw new Error("getWorkloadScenarioType: The workload type is not supported")}}var l=71;function f(e){return 0!=(e&l)}var w=t(1396);function b(e){if(s.some((function(n){return n===e})))return"Owa";var n=Object(w.b)();return f(n)?d(n):null}var v=t(1418),m=t(321);function O(e){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,a,c,u,s,l,O;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=["Owa"],f(i=Object(w.b)())&&(a=d(i),t.push(a)),c=function(e){var n=e.join(",");return o+"/?Scenarios="+n}(t),s=m.b,l=[c,void 0,void 0],[4,Object(v.b)(e)];case 1:return[4,s.apply(void 0,l.concat([r.sent(),!0,void 0,"GET_WORKLOAD_SCENARIO_SETTINGS"]))];case 2:return u=r.sent(),O={timePanelSelectedView:null,timePanelCalendarIds:[],timePanelSelectedCalendarView:null,isTimePanelOpen:!1,isTimePanelDatePickerExpanded:!1,isTimePanelCalendarViewTaskListSelected:!0,wasFocusTimeSuggestionDisabled:!1},null===(n=null==u?void 0:u.settings)||void 0===n||n.forEach((function(e){var n,t=b(e.settingName);(n=e).calendarIds&&"TimePanelCalendarIds"===n.settingName&&t===b("TimePanelCalendarIds")?O.timePanelCalendarIds=e.calendarIds:!function(e){return!!e.selectedView&&"TimePanelSelectedView"===e.settingName}(e)||t!==b("TimePanelSelectedView")?!function(e){return!!e.selectedView&&"SelectedCalendarListView"===e.settingName}(e)||t!==b("SelectedCalendarListView")?!function(e){return void 0!==e.isOpen&&"IsTimePanelOpen"===e.settingName}(e)||t!==b("IsTimePanelOpen")?!function(e){return void 0!==e.isExpanded&&"IsTimePanelDatePickerExpanded"===e.settingName}(e)||t!==b("IsTimePanelDatePickerExpanded")?!function(e){return void 0!==e.isSelected&&"IsTimePanelCalendarViewTaskListSelected"===e.settingName}(e)||t!==b("IsTimePanelCalendarViewTaskListSelected")?function(e){return void 0!==e.wasDisabled&&"WasFocusTimeSuggestionDisabled"===e.settingName}(e)&&t===b("WasFocusTimeSuggestionDisabled")&&(O.wasFocusTimeSuggestionDisabled=e.wasDisabled):O.isTimePanelCalendarViewTaskListSelected=e.isSelected:O.isTimePanelDatePickerExpanded=e.isExpanded:O.isTimePanelOpen=e.isOpen:O.timePanelSelectedCalendarView=e.selectedView:O.timePanelSelectedView=e.selectedView})),[2,O]}}))}))}var T=t(670),p=Object(T.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(T.a)(1e3)}),S={};function j(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return e=Object(a.e)().map(h),[4,Promise.all(e)];case 1:return n.sent(),[2]}}))}))}function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),S[e]?[2]:(S[e]=p((function(){return O(e)})),[4,S[e].retriableFunc()]);case 1:return n=t.sent(),c(n,e),[3,3];case 2:return t.sent(),u(e),[3,3];case 3:return[2]}}))}))}var P=t(777);Object(i.orchestrator)(P.e,(function(e){h(e.userIdentity)}));function _(e,n){return o+"/"+e+"/"+n}function g(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(n=b("TimePanelSelectedView"))?(t=_(n,"TimePanelSelectedView"),i={ViewType:e},[4,Object(m.c)(t,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}function I(e,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,a,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(t=b("TimePanelCalendarIds"))?(i=_(t,"TimePanelCalendarIds"),a={CalendarIds:e},c=m.c,u=[i,a,void 0,void 0],[4,Object(v.b)(n)]):[3,3];case 1:return[4,c.apply(void 0,u.concat([r.sent(),!0,void 0,"UpdateTimePanelCalendarIdsRequest"]))];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))}function k(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(n=b("IsTimePanelOpen"))?(t=_(n,"IsTimePanelOpen"),i={IsOpen:e},[4,Object(m.c)(t,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}function V(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(n=b("SelectedCalendarListView"))?(t=_(n,"SelectedCalendarListView"),i={ViewType:e},[4,Object(m.c)(t,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}function C(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(n=b("IsTimePanelDatePickerExpanded"))?(t=_(n,"IsTimePanelDatePickerExpanded"),i={isExpanded:e},[4,Object(m.c)(t,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}function E(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(n=b("IsTimePanelCalendarViewTaskListSelected"))?(t=_(n,"IsTimePanelCalendarViewTaskListSelected"),i={isSelected:e},[4,Object(m.c)(t,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}function A(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(n=b("WasFocusTimeSuggestionDisabled"))?(t=_(n,"WasFocusTimeSuggestionDisabled"),i={wasDisabled:e},[4,Object(m.c)(t,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}t.d(n,"j",(function(){return c})),t.d(n,"b",(function(){return u})),t.d(n,"a",(function(){return j})),t.d(n,"h",(function(){return g})),t.d(n,"g",(function(){return I})),t.d(n,"f",(function(){return k})),t.d(n,"e",(function(){return V})),t.d(n,"d",(function(){return C})),t.d(n,"c",(function(){return E})),t.d(n,"i",(function(){return A}))},2500:function(e,n,t){"use strict";var i=t(5180),r=t(3),a=Object(r.createStore)("timePanelSettingStore",{panelViewStack:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return{stack:e||[]}}(Object(i.a)().initialPanelView)}),c={Conflicts:"Calendar",EventDetails:"Calendar",AttendeeTracking:"Calendar",Calendar:"Calendar",ComposeForm:"Calendar",Tasks:"Tasks",TaskDetails:"Tasks"};function u(e){return e?c[e]:null}var o=t(1523);function s(e){return!("Tasks"===u(e)&&!Object(o.c)())}var d=t(2049),l=t(295),f=Object(r.action)("pushTimePanelView",(function(e){return{newView:e}})),w=Object(r.action)("updateTopTimePanelView",(function(e){return{updatedView:e}})),b=Object(r.action)("popTimePanelView");function v(e){s(e)&&function(e,n){if(0===n.length)return null;n[n.length-1]=e}(e,a().panelViewStack.stack)}Object(r.mutator)(f,(function(e){var n,t=e.newView;s(t)&&(n=t,a().panelViewStack.stack.push(n))})),Object(r.mutator)(w,(function(e){return v(e.updatedView)})),Object(r.mutator)(b,(function(){var e=a().panelViewStack;e.stack.pop()})),Object(r.mutator)(d.j,(function(e){var n=e.settings,t=e.userIdentity;Object(l.d)().userIdentity===t&&n.timePanelSelectedView&&v(n.timePanelSelectedView)}));var m=t(0),O=t(670),T=t(59),p=Object(O.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(O.a)(1e3)}),S=null;function j(){return u(h())}function h(){var e,n=a().panelViewStack;return 0===(e=n.stack).length?null:e[e.length-1]}function P(){return a().panelViewStack.stack.length}function _(){return-1!==a().panelViewStack.stack.indexOf("Conflicts")}function g(){return-1!==a().panelViewStack.stack.indexOf("AttendeeTracking")}function I(){var e=a().panelViewStack;return P()>=2?e.stack[P()-2]:null}Object(r.orchestrator)(w,(function(e){return Object(m.__awaiter)(void 0,void 0,void 0,(function(){var n,t;return Object(m.__generator)(this,(function(i){switch(i.label){case 0:if(n=e.updatedView,"Tasks"!==(r=n)&&"Calendar"!==r||!s(n))return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),S&&S.cancel(),[4,(S=p((function(){return Object(d.h)(n)}))).retriableFunc()];case 2:return i.sent(),[3,4];case 3:return t=i.sent(),T.g.warn("viewStackOrchestrator: updateTimePanelSelectedViewService with retry failed: "+t),[3,4];case 4:S=null,i.label=5;case 5:return[2]}var r}))}))})),t.d(n,"i",(function(){return f})),t.d(n,"j",(function(){return w})),t.d(n,"h",(function(){return b})),t.d(n,"b",(function(){return j})),t.d(n,"a",(function(){return h})),t.d(n,"e",(function(){return P})),t.d(n,"g",(function(){return _})),t.d(n,"f",(function(){return g})),t.d(n,"d",(function(){return I})),t.d(n,"c",(function(){return u}))},321:function(e,n,t){"use strict";t.d(n,"d",(function(){return a})),t.d(n,"c",(function(){return c})),t.d(n,"e",(function(){return u})),t.d(n,"b",(function(){return o})),t.d(n,"a",(function(){return s})),t.d(n,"f",(function(){return d}));var i=t(77),r=new i.c((function(){return Promise.all([t.e(1),t.e(23),t.e(860)]).then(t.bind(null,944))})),a=new i.a(r,(function(e){return e.makePostRequest})).importAndExecute,c=new i.a(r,(function(e){return e.makePatchRequest})).importAndExecute,u=new i.a(r,(function(e){return e.makePutRequest})).importAndExecute,o=new i.a(r,(function(e){return e.makeGetRequest})).importAndExecute,s=new i.a(r,(function(e){return e.makeDeleteRequest})).importAndExecute,d=new i.a(r,(function(e){return e.sendOwsPrimeRequest})).importAndExecute},5180:function(e,n,t){"use strict";var i=t(0),r={abovePanelHeight:t(5736).b,initialPanelView:"Calendar",areFREsDisabled:!1,isInlineComposeDisabled:!1};function a(e){r=Object(i.__assign)({},e)}function c(){return r}t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return c}))},5736:function(e,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return r}));var i=48,r=65},669:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"c",(function(){return a})),t.d(n,"d",(function(){return c})),t.d(n,"b",(function(){return u}));var i=t(3),r=Object(i.action)("initializeOwaAccountsStore"),a=Object(i.action)("owaConnectedAccountAdded",(function(e,n){return{userIdentity:e,accountProviderType:n}})),c=Object(i.action)("removeAccount",(function(e){return{userIdentity:e}})),u=Object(i.action)("owaAccountStoreInitializationFailed",(function(e,n,t,i){return{userIdentity:e,isRetry:n,accountProvider:t,error:i}}))},670:function(e,n,t){"use strict";function i(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var n=e.maximumAttempts,t=e.timeBetweenRetryInMS;return function(e){var i=0,r=!1,a=function(c,u){r?u(new Error("The function retry was cancelled")):(i++,e().then((function(e){return c(e)})).catch((function(e){n&&i>=n?u(e):setTimeout((function(){return a(c,u)}),t(i))})))};return{retriableFunc:function(){return new Promise((function(e,n){return a(e,n)}))},cancel:function(){return r=!0}}}}function r(e){return function(n){return Math.pow(2,n)*e}}t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return r}))},777:function(e,n,t){"use strict";t.d(n,"a",(function(){return c})),t.d(n,"b",(function(){return u})),t.d(n,"c",(function(){return o}));var i=t(669);t.d(n,"e",(function(){return i.c})),t.d(n,"d",(function(){return i.b}));var r=t(77),a=new r.c((function(){return t.e(795).then(t.bind(null,1262))})),c=new r.a(a,(function(e){return e.initializeOwaAccountsStore})),u=new r.a(a,(function(e){return e.initializeOwaConnectedAccount})),o=new r.a(a,(function(e){return e.removeOWAConnectedAccount}))}}]);
//# sourceMappingURL=owa.MailBoot~MeetingMessage~TimePanel~TimePanelOpx~WorkloadScenarioSettings.js.map
self.scriptsLoaded['owa.MailBoot~MeetingMessage~TimePanel~TimePanelOpx~WorkloadScenarioSettings.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MeetingMessage~TimePanel~TimePanelOpx~WorkloadScenarioSettings.js'] = (new Date()).getTime();