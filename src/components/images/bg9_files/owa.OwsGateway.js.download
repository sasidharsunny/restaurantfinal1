self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.OwsGateway.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[860],{116:function(t,n,e){"use strict";e.d(n,"b",(function(){return i})),e.d(n,"a",(function(){return c}));var r,u=e(0);function i(t){r=t}function c(){return Object(u.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(u.__generator)(this,(function(e){switch(e.label){case 0:return(n=r)?[4,r()]:[3,2];case 1:n=e.sent(),e.label=2;case 2:return(t=n)?[2,t.split(" ")[1]]:[2,void 0]}}))}))}},154:function(t,n,e){"use strict";e.d(n,"a",(function(){return u})),e.d(n,"b",(function(){return i}));var r=!1;function u(){return r}function i(t){r=t}},19:function(t,n,e){"use strict";function r(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.map(c).filter((function(t){return 0!==t.length})).join("/")}function u(t){return t?t.length>0&&"/"!==t[0]?"/"+t:t:"/"}function i(t){return t.length>0&&"/"!==t[t.length-1]?t+"/":t}function c(t){return t.replace(/^\/*/,"").replace(/\/*$/,"")}e.d(n,"a",(function(){return r})),e.d(n,"b",(function(){return u})),e.d(n,"c",(function(){return i}))},190:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r=e(24);function u(){var t=Object(r.a)(),n=t.origin;return n||(n=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")),n}},2154:function(t,n,e){"use strict";var r=e(0),u=e(83),i=e(337),c=e(4),o=e(722),a=e(2223),s=e(43),f=e(125),d=e(123),l=e(469),b=e(59),h=e(73),p=e(581),O="owsserver",j="owsapi";e.d(n,"f",(function(){return k})),e.d(n,"d",(function(){return w})),e.d(n,"c",(function(){return y})),e.d(n,"e",(function(){return T})),e.d(n,"b",(function(){return R})),e.d(n,"a",(function(){return P}));var v=2048,m=null;function k(t,n,e,i,c,a,s,f,d){return Object(r.__awaiter)(this,void 0,void 0,(function(){var b,h,p,O,j,v,m,k;return Object(r.__generator)(this,(function(w){switch(w.label){case 0:return b="object"==typeof e&&e.customHeaders||s,h=b?Object.keys(b).reduce((function(t,n){return t[n.toLowerCase()]=b[n],t}),{}):void 0,p="object"==typeof e?Object(r.__assign)(Object(r.__assign)({},e),{customHeaders:h}):{returnFullResponse:e,correlationId:c,requestObject:a,customHeaders:h,throwServiceError:f,includeCredentials:d},"authorization",p.customHeaders&&p.customHeaders.authorization?[3,3]:(j=Object(o.l)(),v=Object(r.__read)(Object(l.getAccessTokenforResourceAsLazy)(j),2),m=v[0],k=v[1],m?[3,2]:[4,k]);case 1:m=w.sent(),w.label=2;case 2:O=m,void 0===p.includeCredentials&&(p.includeCredentials=!Object(u.i)("auth-authzHeaderNoCookies")),w.label=3;case 3:return[2,g(t,n,O,p,i)]}}))}))}function g(t,n,e,l,k){return Object(r.__awaiter)(this,void 0,void 0,(function(){var g,w,y,T,R,P,C,S,_,q,I,A,E,x,D,H,L,U;return Object(r.__generator)(this,(function(r){return g=l.returnFullResponse,w=l.correlationId,y=l.requestObject,T=l.customHeaders,R=l.throwServiceError,P=l.sendPayloadAsBody,C=l.includeCredentials,(S=new Headers).append("X-OWA-CANARY",Object(s.a)()),S.append("X-MS-AppName","owa-react"+Object(o.q)()),_={n:Object(f.a)().toString()},w&&(S.append("client-request-id",w),_.cri=w),T&&Object.keys(T).forEach((function(t){S.append(t,T[t])})),(q=Object(h.b)())&&(S.append(h.a,q),_.cv=q),e&&("Authorization",Object(u.i)("fwk-devTools")&&(3==(I=e.split(".")).length&&0!==I[2].length||b.d("BearerTokenIncomplete "+I.length)),S.append("Authorization","Bearer  "+e)),"x-anchormailbox",T&&T["x-anchormailbox"]||(A=Object(a.a)())&&A.length>0&&S.append("X-AnchorMailbox",A),E={method:n,credentials:!1!==C?"same-origin":"omit"},y&&(S.append("Content-Type","application/json"),x=JSON.stringify(y),D=t.search(/ows\/|owa\//i)>=0,Object(u.i)("fwk-emptyPost")&&D&&"POST"==n&&!P&&(H=encodeURIComponent(x)).length<v?S.append("X-OWA-UrlPostData",H):E.body=x),E.headers=S,L=function(t,n){var e=function(t,n){var e=Object(o.w)(t,n),r=e.split("/");r.length>0&&("ows"==r[0]||"OutlookGateway"==r[0])&&(r[0]=Object(o.e)(r[0]),e=r.join("/"));return Object(o.a)(e)}(Object(u.i)("fwk-proxyOwsPrime")?"/OutlookGateway/":"/",t),r=Object(o.l)()+e;if(Object(u.i)("fwk-devTools")&&Object(c.d)(O)&&(Object(c.a)(j)==t||!Object(c.d)(j))&&(null==m&&(m=confirm("A query param '"+O+"' is set to redirect some of calls to '"+Object(c.a)(O)+"'.\n\nThose calls contain PII. If this is not intentional, click 'Cancel' below or remove the queryparam and reload the page.")),m)){var i=t.split("/");i.length>0&&"ows"==i.shift()&&(t=i.join("/")),r=Object(c.a)(O)+"/"+t}return Object(o.u)(r,n)}(t,_),U=Object(d.a)(L,E),Object(p.a)(E,l,U,k,L),[2,U.then((function(e){if(g)return e;if(Object(i.a)(e.status))return e.text().then((function(t){return t?JSON.parse(t):{}}));throw new Error(n+" request to "+t+" failed, http error:"+e.status)})).catch((function(t){if(b.g.warn(t),R)throw{stack:t.stack,message:t.message,correlationVector:q,correlationId:l.correlationId,networkError:!0};return[]}))]}))}))}function w(t,n,e,r,u,i,c,o,a,s){return k(t,"POST",{returnFullResponse:r,correlationId:e,requestObject:n,customHeaders:u,throwServiceError:i,sendPayloadAsBody:c,includeCredentials:o,datapoint:s},a)}function y(t,n,e,r,u,i,c,o){return k(t,"PATCH",{returnFullResponse:r,correlationId:e,requestObject:n,customHeaders:u,throwServiceError:i,includeCredentials:c},o)}function T(t,n,e,r,u,i,c,o){return k(t,"PUT",r,c,e,n,u,i,o)}function R(t,n,e,r,u,i,c){return k(t,"GET",e,c,n,void 0,r,u,i)}function P(t,n,e,r,u,i,c){return k(t,"DELETE",{returnFullResponse:r,correlationId:e,requestObject:n,customHeaders:u,throwServiceError:i,includeCredentials:c})}},2223:function(t,n,e){"use strict";e.d(n,"b",(function(){return c})),e.d(n,"a",(function(){return o}));var r=e(33),u=e(24),i=e(96);function c(){var t=Object(r.a)("targetServer"),n="DefaultAnchorMailbox"+(t?"_"+t.toLocaleLowerCase():"");return Object(r.a)(n)}function o(){var t,n,e=(t="",(n=Object(u.a)().pathname.split("/").filter((function(t){return t.length}))).length>=2&&n[1].match(/.+@.+/)&&(t=n[1]),t);if(0===e.length){var r=Object(i.h)();if(null==r?void 0:r.SessionSettings){var o=r.SessionSettings.ExternalDirectoryTenantGuid,a=r.SessionSettings.UserPuid;a&&o&&(e="PUID:"+a+"@"+o)}}return 0===e.length&&(e=c()),e}},27:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r=e(75);function u(t){return Object(r.a)(t,[r.c,r.b])}},297:function(t,n,e){"use strict";var r=e(34);n.a=function(t,n){return new Date(+t+n*r.g)}},337:function(t,n,e){"use strict";var r=e(726);e.d(n,"a",(function(){return r.a}))},34:function(t,n,e){"use strict";e.d(n,"i",(function(){return r})),e.d(n,"e",(function(){return u})),e.d(n,"f",(function(){return i})),e.d(n,"g",(function(){return c})),e.d(n,"h",(function(){return o})),e.d(n,"l",(function(){return a})),e.d(n,"a",(function(){return s})),e.d(n,"b",(function(){return f})),e.d(n,"j",(function(){return d})),e.d(n,"c",(function(){return l})),e.d(n,"k",(function(){return b})),e.d(n,"d",(function(){return h}));var r=6048e5,u=864e5,i=36e5,c=6e4,o=1e3,a=12,s=30,f=365,d=-864e13,l=864e13,b=Date.UTC(1601,0,1),h=Date.UTC(4501,0,1)},349:function(t,n,e){"use strict";var r=e(34);n.a=function(t,n){return new Date(+t+n*r.h)}},362:function(t,n,e){"use strict";e.d(n,"a",(function(){return i})),e.d(n,"b",(function(){return c}));var r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function u(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function i(){return u()+u()+"-"+u()+"-"+u()+"-"+u()+"-"+u()+u()+u()}function c(t){return r.test(t)}},429:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r=e(75);function u(t){return Object(r.a)(t,[r.c])}},444:function(t,n,e){"use strict";var r=function(){function t(t,n,e){this.maxParallelTasks=t,this.taskCallback=n,this.taskDelay=e,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout((function(){t.tryRunTask()}),this.taskDelay)},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.tryRunTask=function(){var t=this;if(this.canRunMoreTasks()){var n=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(n).then((function(){t.onTaskComplete()})).catch((function(){t.onTaskComplete()})),this.scheduleTask()}},t}();e.d(n,"a",(function(){return r}))},474:function(t,n){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},51:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r=e(24);function u(){var t,n=null===(t=Object(r.a)())||void 0===t?void 0:t.pathname;if(n){var e=n.split("/").filter((function(t){return!!t}));return e[0]?e[0].toLowerCase():null}return null}},624:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r=["hostApp","isanonymous","cspoff","frameName","opxInstanceId"];function u(t){t&&Object.keys(t).forEach((function(n){r.includes(n)&&delete t[n]}))}},722:function(t,n,e){"use strict";var r=e(429),u=e(27),i=e(75);function c(t){return Object(i.a)(t,[i.b])}var o=e(19),a=e(51);function s(t){return Object(o.b)(Object(o.c)(Object(o.a)(Object(a.a)()||"",t)))}var f,d,l,b=e(752),h=e(751),p=e(134);function O(){return f||(f=Object(u.a)("/calendar")+"/"),f}function j(){return d||(d=Object(u.a)("/mail")+"/"),d}function v(){return l||(l=Object(u.a)("/files")+"/"),l}var m,k,g,w=e(754);function y(t){return m&&k===t||(k=t,m=t?Object(u.a)("/people/group/owner")+"/":Object(u.a)("/people/group/member")+"/"),m}function T(){return g||(g=Object(u.a)("/people/group/deleted")+"/"),g}function R(t){return window.location.origin+O()+"showPeek/item/"+encodeURIComponent(t)}var P=e(313),C=e(759),S=e(4),_=e(624),q=Object(C.a)().split("/").slice(1).join("/")+"deeplink/";function I(t,n,e,r){e&&((r=r||{}).minus="");var u="";if(r){var i=Object(S.b)();Object(_.a)(i),Object.keys(r).filter((function(t){return t})).forEach((function(t){return i[t]=r[t]})),u="?"+Object(S.h)(i)}var c={pathname:"/"+t+"/"+q+n,search:u};return P.format(c)}var A,E,x=e(154),D=e(30),H="https://to-do.microsoft.com";function L(t){var n,e,r=Object(D.a)(),u=r.UserOptions,i=null===(n=r.SessionSettings)||void 0===n?void 0:n.UserPrincipalName,c=H,o={};return(null===(e=null==u?void 0:u.ReactOptinSettings)||void 0===e?void 0:e.TasksRedirectUrl)&&(c=u.ReactOptinSettings.TasksRedirectUrl,i&&(o.auth_upn=i)),t&&(o.utm_source=t),Object.keys(o).length>0?Object(p.a)(c,o):c}function U(){return A||(A=Object(u.a)("/spaces")+"/"),A}function z(){return E||(E=Object(u.a)("/eventify")+"/"),E}var N=e(190);e.d(n,"i",(function(){return r.a})),e.d(n,"s",(function(){return u.a})),e.d(n,"e",(function(){return c})),e.d(n,"k",(function(){return s})),e.d(n,"r",(function(){return b.a})),e.d(n,"w",(function(){return o.a})),e.d(n,"a",(function(){return o.b})),e.d(n,"n",(function(){return h.a})),e.d(n,"u",(function(){return p.a})),e.d(n,"c",(function(){return O})),e.d(n,"j",(function(){return j})),e.d(n,"f",(function(){return v})),e.d(n,"o",(function(){return w.a})),e.d(n,"h",(function(){return y})),e.d(n,"g",(function(){return T})),e.d(n,"b",(function(){return R})),e.d(n,"p",(function(){return I})),e.d(n,"v",(function(){return x.a})),e.d(n,"t",(function(){return L})),e.d(n,"m",(function(){return U})),e.d(n,"d",(function(){return z})),e.d(n,"l",(function(){return N.a})),e.d(n,"q",(function(){return a.a}))},726:function(t,n,e){"use strict";function r(t){return t>=200&&t<300}e.d(n,"a",(function(){return r}))},75:function(t,n,e){"use strict";e.d(n,"c",(function(){return c})),e.d(n,"b",(function(){return o})),e.d(n,"a",(function(){return a}));var r=e(19),u=e(24),i=e(51),c=function(t){return!isNaN(parseInt(t))},o=function(t){return!!t.match(/.+@.+/)};function a(t,n){var e,c=t,o=null===(e=Object(u.a)())||void 0===e?void 0:e.pathname;if(o){var a=o.split("/"+Object(i.a)()+"/")[1];if(a){var s=a.split("/")[0];s&&n.filter((function(t){return t(s)})).length>0&&(c=Object(r.a)(c,s))}}return Object(r.b)(c)}},751:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(24),u=e(27),i=e(190);function c(t){var n=Object(r.a)(),e=Object(i.a)()+Object(u.a)("/owa")+"/",c=n.search&&n.search.length>0;e+=c?n.search:"?";for(var o=Object.keys(t),a=c,s=0;s<o.length;s++)a?e+="&":a=!0,e+=o[s]+"="+t[o[s]];return e}},752:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(4),u=e(624);function i(){var t=Object(r.b)();Object(u.a)(t);var n=Object(r.h)(t);return n.length>0?"?"+n:""}},754:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r,u=e(27);function i(){return r||(r=Object(u.a)("/people")+"/"),r}},759:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(51),u=e(27);function i(t){return(Object(u.a)("/"+(t||Object(r.a)()))+"/").replace(/^\//,"")}},944:function(t,n,e){"use strict";e.r(n);var r=e(2154);function u(t,n,e,u){return Object(r.f)(e,n,u,t)}e.d(n,"makeOwsPrimeRequest",(function(){return r.f})),e.d(n,"makePostRequest",(function(){return r.d})),e.d(n,"makePatchRequest",(function(){return r.c})),e.d(n,"makePutRequest",(function(){return r.e})),e.d(n,"makeGetRequest",(function(){return r.b})),e.d(n,"makeDeleteRequest",(function(){return r.a})),e.d(n,"sendOwsPrimeRequest",(function(){return u}))}}]);
//# sourceMappingURL=owa.OwsGateway.js.map
self.scriptsLoaded['owa.OwsGateway.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.OwsGateway.js'] = (new Date()).getTime();