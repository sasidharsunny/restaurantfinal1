self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SubstrateSuggestions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[735],{1346:function(t,n,e){"use strict";function r(t,n){Object.keys(n).forEach((function(e){return t.set(e,n[e])}))}function c(t){var n=null!=t?t:{headers:new Headers};return n.datapoint=n.datapoint||{},n.datapoint.mailbox="Default",n}e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return c}))},1347:function(t,n,e){"use strict";var r=e(0),c=e(1405),o=e(388),u=e(662),i=e(269),a=e(9),s="X-AnchorMailbox",d="Authorization",b="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";function l(t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,l,O,j,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(e={},l=Object(o.k)(t)){if(l.accountState==o.b.AccessRevoked)return[2,null];if(l.accountState==o.b.AccountDeprovisioned||l.accountState==o.b.AccountNotFound)return Object(o.c)(l.accountState,l.accountProviderType),[2,null]}return n?(e[s]=n,e[f]=n):l&&(e[s]=l.anchorMailbox),l?(O=l.token,!(j=Object(u.g)(l.tokenExpiry))&&O?[3,2]:(Object(i.p)("getAndUpdateAccessToken",{tokenExpiry:Object(a.y)(l.tokenExpiry,Object(a.Pb)()),isTokenExpired_1:j,isTokenInvalid_2:!O},{isCore:!0}),[4,c.a.importAndExecute(l.accountId,t)])):[3,3];case 1:(O=r.sent())||(O=""),r.label=2;case 2:p=void 0,"Outlook"==l.accountProviderType?(p='MSAuth1.0 usertoken="'+O+'", type="MSACT"',e[b]=1..toString()):"Google"!=l.accountProviderType&&"ICloud"!=l.accountProviderType||(p="Bearer "+O,e[b]=2..toString()),e[d]=p,r.label=3;case 3:return[2,e]}}))}))}var O=e(1346),j=e(59);function p(t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e=Object(O.a)(),c=e,[4,v(t,n)];case 1:return c.headers=r.sent(),e.authNeededOnUnAuthorized=!1,e.datapoint=e.datapoint||{},e.datapoint.mailbox="Connected",[2,e]}}))}))}function v(t,n){var e;return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c=n&&(null===(e=t.headers)||void 0===e?void 0:e.set)?new Headers(t.headers):new Headers,[4,l(t.mailboxInfo.userIdentity,h(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null)];case 1:return o=r.sent(),Object(O.b)(c,o),[2,c]}}))}))}function h(t,n){var e="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return e&&null==n&&j.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),e}e.d(n,"a",(function(){return l})),e.d(n,"b",(function(){return p})),e.d(n,"c",(function(){return h}))},1348:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(3),c=Object(r.action)("triggerReInitializeAccount",(function(t){return{userIdentity:t}}))},1405:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r=e(77),c=e(1348);e.d(n,"b",(function(){return c.a}));var o=new r.c((function(){return e.e(1149).then(e.bind(null,1664))})),u=new r.a(o,(function(t){return t.getAndUpdateAccessToken}))},17019:function(t,n,e){"use strict";e.r(n);var r=e(2871),c=e(285),o=e(295),u=Object(c.action)("execute3SPrimeCall")((function(){Object(r.b)(Object(o.d)().userIdentity,null,!1)}));e.d(n,"execute3SPrimeCall",(function(){return u}))},1755:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(83);function c(){return Object(r.i)("rp-peopleSuggestionsTrie")&&Object(r.i)("rp-peopleSuggestionsCacheFirst")||Object(r.i)("rp-cacheFirstPeopleTrieSize300")||Object(r.i)("rp-cacheFirstPeopleTrieSize500")||Object(r.i)("rp-cacheFirstPeopleTrieSize700")||Object(r.i)("rp-peopleTrieOnTimeoutLow")||Object(r.i)("rp-peopleTrieOnTimeoutMed")||Object(r.i)("rp-peopleTrieOnTimeoutHigh")}},2757:function(t,n,e){"use strict";e.d(n,"a",(function(){return a}));var r=e(1755),c=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"],o=c.concat(["FeatureData","GivenName","Surname","Alias"]),u=c.concat(["FeatureData"]),i=c.concat(["Phones","OfficeLocation","Department"]);function a(t){return 2===t?i:Object(r.a)()?0==t?o:u:c}},2871:function(t,n,e){"use strict";e.d(n,"a",(function(){return g})),e.d(n,"b",(function(){return I})),e.d(n,"c",(function(){return x}));var r=e(0),c=e(388),o=e(1347),u=e(83),i=e(362),a=e(337),s=e(321),d=e(320),b=e(2757),f=e(59),l=e(1755),O="/search/api/v1/init?",j="/search/api/v1/suggestions?",p="owa.react.compose",v=["PandaServingCompose","PandaServingComposeZeroQuery"],h="AppendFreshContactsToTopN",S="ContextAwareServing",y="20",A="5",T="MixtModel0308WithZeroQNoRotate",m="CSRCounterFactual",g="owa.projectMoca.peopleCard";function I(t,n,e,c,o,u,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,b,l,O,v;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return d=a||p,null!=n?[3,1]:[2,w(d)];case 1:return[4,_(n,e,u,d)];case 2:return b=r.sent(),l=function(t,n,e){return{AppName:"OWA",Scenario:{Name:e},Cvid:n||Object(i.a)(),EntityRequests:[t]}}(b,null==o?void 0:o.conversationId,d),O=s.d,v=[j+x(d,n),l,c,!1],[4,P(t,null==o?void 0:o.clientSessionId)];case 3:return[2,O.apply(void 0,v.concat([r.sent(),!0,!0,!1])).then((function(t){return t})).catch((function(t){return f.g.info(t),null}))]}}))}))}function w(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,e;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=s.b,e=[O+x(t),void 0,!0],[4,P(null)];case 1:return[2,n.apply(void 0,e.concat([r.sent(),!0,!1])).then((function(t){return Object(a.a)(t.status)?t.json():null})).catch((function(t){return t.networkError=!0,f.d(t),null}))]}}))}))}function _(t,n,e,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){return o={Query:{QueryString:t},EntityType:"People",Provenances:k(n),Size:n?y:A},e&&e.length>0&&(o.Context=function(t){var n={};t&&(n.RecipientsTo=t.toString());return n}(e)),o.Fields=c===g?Object(b.a)(2):Object(b.a)(1),[2,o]}))}))}function k(t){var n=["Mailbox"];return t&&!Object(d.a)()&&n.push("Directory"),n}function x(t,n){var e={scenario:t},c=[],o=Object(l.a)();return(o||Object(u.i)("rp-cacheFirstPeopleTrieSize500cf"))&&(c.push.apply(c,Object(r.__spread)(v)),o&&Object(u.i)("rp-EnableFreshContactsForZeroQuery")&&c.push(h),c.push(T),c.push(m)),Object(u.i)("rp-contextualZeroQuery")&&""==n&&c.push(S),c.length>0&&(e.setflight=c.join(",")),Object.keys(e).map((function(t){return t+"="+e[t]})).join("&")}function P(t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(r){return e={},n&&(e["client-session-id"]=n),t&&Object(c.r)(t)?[2,Object(o.a)(t).then((function(t){return Object.keys(t).forEach((function(n){return e[n]=t[n]})),e}))]:[2,e]}))}))}},337:function(t,n,e){"use strict";var r=e(726);e.d(n,"a",(function(){return r.a}))},388:function(t,n,e){"use strict";var r,c=e(3);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var o,u=e(74),i=Object(c.action)("addAccount",(function(t){return{userIdentity:t.userIdentity,account:t}})),a=Object(c.action)("removeAccount",(function(t){return{userIdentity:t}})),s=Object(c.action)("updateAccount",(function(t,n,e){return{userIdentity:t,accountToken:n,accountTokenExpiresIn:e}})),d=Object(c.action)("updateOWAConnectedAccountStatus",(function(t,n){return{userIdentity:t,accountState:n}})),b=Object(c.action)("accountIsInErrorState",(function(t,n){return Object(u.c)({name:"accountIsInErrorState",options:{isCore:!0},customData:{accountState_1:r[t],accountProvider_2:n}},{accountState:t})})),f=Object(c.action)("retryAccountUpdateToken",(function(t,n,e,c,o){return Object(u.c)({name:"retryAccountUpdateToken",customData:{currentAccountState_1:r[e],localAccountState_2:r[c],previousAccountState_3:r[o]}},{accountId:t,userIdentity:n,currentAccountState:e})})),l=Object(c.action)("connectedAccountsListRequested",(function(t){return Object(u.c)({name:"connectedAccountsGetResponse",options:{isCore:!0},customData:{isSuccess_1:t}},{isSuccess:t})})),O=Object(c.action)("setAccountsStoreState",(function(t){return{state:t}})),j=e(0),p=e(20);!function(t){t[t.None=0]="None",t[t.AccountsLoadSuccessful=1]="AccountsLoadSuccessful",t[t.AccountsLoadError=2]="AccountsLoadError"}(o||(o={}));var v=Object(c.createStore)("OWAAccountsStore",{accountsMap:new p.ObservableMap({}),accountsLoadedState:o.None}),h=e(270),S=e(96);function y(t){return t!=Object(S.b)()&&void 0!==T(t)}function A(){return Object(j.__spread)(v().accountsMap.values())}function T(t){return v().accountsMap.get(t)}function m(){var t;return(null===(t=A())||void 0===t?void 0:t.length)>0?A()[0]:null}function g(){return A().filter((function(t){return t.accountState!=r.Valid}))}function I(t){return A().filter((function(n){return t.includes(n.accountState)}))}function w(t){return A().filter((function(n){return n.accountProviderType==t}))}function _(t){return y(t)?T(t).accountProviderType:null}function k(t){return"Outlook"==t.accountProviderType?'MSAuth1.0 usertoken="'+t.token+'", type="MSACT"':"Google"==t.accountProviderType||"ICloud"==t.accountProviderType?"Bearer "+t.token:Object(h.a)(t.accountProviderType)}function x(t,n){return function(e){var r=T(e);return r?r[t]:n}}x("accountUniqueId","0");var P=x("accountState",r.Valid),C=function(){return A().some((function(t){return!F(t.userIdentity)}))},E=x("accountProviderType",null),M=function(t){return"Outlook"==E(t)},F=function(t){return P(t)==r.Valid},D=function(){return A().length>0};function L(){return v().accountsLoadedState}var N=e(9),z=e(269);Object(c.mutator)(i,(function(t){var n=t.account;Object(z.p)("owaAccountAdded",{accountStatus_1:r[n.accountState]}),v().accountsMap.set(n.userIdentity,n)})),Object(c.mutator)(a,(function(t){var n=t.userIdentity;v().accountsMap.delete(n)})),Object(c.mutator)(s,(function(t){var n=t.userIdentity,e=t.accountToken,r=t.accountTokenExpiresIn,c=v().accountsMap.get(n);c.token=e,c.tokenExpiry=Object(N.j)(Object(N.Pb)(),parseInt(r))})),Object(c.mutator)(d,(function(t){var n=t.userIdentity,e=t.accountState,c=v().accountsMap.get(n);c.accountState==r.Valid&&e!=r.Valid&&Object(z.p)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[e]}),c.accountState=e})),Object(c.mutator)(l,(function(t){var n=t.isSuccess?o.AccountsLoadSuccessful:o.AccountsLoadError;v().accountsLoadedState=n})),Object(c.mutator)(O,(function(t){v().accountsLoadedState=t.state})),e.d(n,"d",(function(){return i})),e.d(n,"u",(function(){return a})),e.d(n,"y",(function(){return s})),e.d(n,"x",(function(){return d})),e.d(n,"c",(function(){return b})),e.d(n,"v",(function(){return f})),e.d(n,"e",(function(){return l})),e.d(n,"w",(function(){return O})),e.d(n,"n",(function(){return A})),e.d(n,"k",(function(){return T})),e.d(n,"i",(function(){return m})),e.d(n,"f",(function(){return g})),e.d(n,"g",(function(){return I})),e.d(n,"o",(function(){return w})),e.d(n,"j",(function(){return _})),e.d(n,"m",(function(){return k})),e.d(n,"l",(function(){return P})),e.d(n,"q",(function(){return C})),e.d(n,"t",(function(){return M})),e.d(n,"s",(function(){return F})),e.d(n,"p",(function(){return D})),e.d(n,"h",(function(){return L})),e.d(n,"r",(function(){return y})),e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return o}))},662:function(t,n,e){"use strict";var r=e(3),c=Object(r.action)("initializeOwaObservableDateTime"),o=Object(r.action)("observableNowChanged"),u=Object(r.action)("observableTodayChanged"),i=e(9),a=e(20),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),d=Object(a.computed)((function(){return Object(i.lc)(s().now)})),b=function(){return d.get()},f=Object(a.computed)((function(){return Object(i.lc)(s().today)})),l=function(){return f.get()},O=function(t){return Object(i.Gb)(t,b())},j=function(t){return Object(i.Eb)(t,b())},p=function(t){return h(t,i.Gb)},v=function(t){return h(t,i.Hb)},h=function(t,n){return n(Object(i.Wb)(Object(i.lc)(t)),l())};function S(t){if(!t)return"";var n=Object(i.lc)(t);return function(t,n){var e=Object(i.Wb)(t);if(Object(i.Ib)(e,n))return i.Z;var r=function(t){return Object(i.Mb)(e,Object(i.e)(n,-t),n)};if(r(3))return i.hb;if(r(30))return i.gb;return i.X}(n,l())(n)}function y(t){if(!t)return"";var n=Object(i.lc)(t);return function(t,n){var e=Object(i.Wb)(t);if(Object(i.Ib)(e,n))return i.S;return i.T}(n,l())(n)}function A(t){return t?function(t,n){var e=Object(i.Wb)(t);return Object(i.Ib)(e,n)?Object(i.Z)(t):T(e,n,2)?Object(i.kb)(t):T(e,n,7)?Object(i.H)(Object(i.ab)(t),Object(i.Z)(t)):Object(i.H)(Object(i.J)(t),Object(i.Z)(t))}(Object(i.lc)(t),l()):""}function T(t,n,e){return Object(i.Mb)(t,Object(i.e)(n,-e),n)}var m=Object(r.action)("updateTimes"),g=Object(r.action)("setNow"),I=Object(r.action)("setToday",(function(t){return{today:t}}));Object(r.mutator)(g,(function(){s().now=Object(i.jc)()})),Object(r.mutator)(I,(function(t){var n=t.today;s().today=n}));var w=e(34),_=e(128);Object(r.orchestrator)(c,(function(){m();var t=Object(i.Pb)(),n=Object(i.Yb)(Object(i.h)(t,1)),e=Object(i.w)(n,t);setTimeout((function(){return setInterval(m,w.g)}),e)})),Object(r.orchestrator)(_.l,(function(){m()})),Object(r.orchestrator)(m,(function(){g();var t=Object(i.zb)(Object(i.kc)()),n=s().today!=t;n&&I(t),o(),n&&u()})),e.d(n,"d",(function(){return c})),e.d(n,"j",(function(){return o})),e.d(n,"l",(function(){return u})),e.d(n,"i",(function(){return b})),e.d(n,"k",(function(){return l})),e.d(n,"g",(function(){return O})),e.d(n,"e",(function(){return j})),e.d(n,"f",(function(){return p})),e.d(n,"h",(function(){return v})),e.d(n,"a",(function(){return S})),e.d(n,"b",(function(){return y})),e.d(n,"c",(function(){return A}))},726:function(t,n,e){"use strict";function r(t){return t>=200&&t<300}e.d(n,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.MailBoot~SubstrateSuggestions.js.map
self.scriptsLoaded['owa.MailBoot~SubstrateSuggestions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SubstrateSuggestions.js'] = (new Date()).getTime();