self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentPreviewSxS~AttachmentPreviewSxSInitialize~Attachments~ConversationAttachment~File~5439b604.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[63],{2882:function(t,e,n){"use strict";var r=n(3958),o=n(4571),a=n(4572),i=n(285);e.a=Object(i.action)("setOngoingActionAndActionMessage")((function(t,e,n){Object(r.a)(t,e),t.actionMessage=n,Object(a.a)(t)?Object(o.a)(t,!0):Object(o.a)(t,!1)}))},3420:function(t,e,n){"use strict";var r=n(4690),o=n(12),a=n(4252),i=n(2882);var c=n(2165),u=n(1780),s=n(2185),d=n(1503),l=n(1681),p=n(285);n.d(e,"b",(function(){return f}));var v=null;function f(){return v||(v=Object.keys(c.a).reduce((function(t,e){var n=c.a[e];return Number.isInteger(n)&&t.push(n),t}),[])),v}e.a=Object(p.action)("initializeAttachmentFullViewState")((function(t,e,n,p,v){var b;p&&0!==p.length||(b=e.model,p=Object(d.d)(b)?function(t){return 2===Object(l.a)(t)?[c.a.Preview,c.a.Download]:[c.a.Download]}(b):f());var O=Object(s.b)(e.model,!0),I=Object(s.e)(),m=Object(u.a)(e),j=Object(r.a)(I,O,e.attachmentClass,e.model,m?e.model.ProviderType:null,e.model.AttachmentOriginalUrl,e.info.allowDownload,p,t.isReadOnly,n,v);t.strategy=j,function(t,e,n){n&&!Object(o.f)(e.model.AttachmentOriginalUrl)&&(Object(a.a)(t,2),Object(i.a)(t,0,2))}(t,e,t.strategy.isSaveToCloudSupported)}))},3958:function(t,e,n){"use strict";var r=n(285);e.a=Object(r.action)("setOngoingAction")((function(t,e){t.ongoingAction=e}))},3960:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1363);function o(t){var e="";return(null==t?void 0:t.model)&&(e=Object(r.c)(t.model.Name||"")||t.model.ContentType||""),e}},4252:function(t,e,n){"use strict";var r=n(285);e.a=Object(r.action)("addCompletedAction")((function(t,e){t.completedActions.push(e)}))},4253:function(t,e,n){"use strict";n.d(e,"b",(function(){return s}));var r=n(0),o=n(270),a=n(3639),i=n(320);var c=Object(a.a)((function(t){switch(t){case 0:return e={supportViewInProvider:!1,supportConvertCloudyToClassic:!1},Object(r.__assign)(Object(r.__assign)({},e),{supportViewInProvider:!0,supportConvertCloudyToClassic:!0});case 1:return function(){var t={supportViewInProvider:!1,supportConvertCloudyToClassic:!1};return Object(r.__assign)(Object(r.__assign)({},t),{supportConvertCloudyToClassic:Object(i.a)()})}();case 3:case 2:case 6:case 5:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};case 7:case 8:case 9:case 4:case 10:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};default:return Object(o.a)(t)}var e})),u=c.getDataProviderInfo,s=c.getDefaultDataProviderInfo;e.a=u},4571:function(t,e,n){"use strict";var r=n(285);e.a=Object(r.action)("setShouldShowImageOverlay")((function(t,e){t.shouldShowImageOverlay=e}))},4572:function(t,e,n){"use strict";function r(t){return 0!==t.actionMessage}n.d(e,"a",(function(){return r}))},4574:function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n(0),o=n(472),a=n(766),i=n(723),c=n(622),u=n(767),s=n(319),d=n(59),l="0xe0b",p=Object(o.a)({PropertyTag:l,PropertyType:"Binary"});function v(t){var e;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,a,i,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=null,o=Object(c.a)({BaseShape:"IdOnly",AdditionalProperties:[p]}),[4,f([t],o)];case 1:return a=r.sent(),"Success"===(null===(e=null==a?void 0:a[0])||void 0===e?void 0:e.ResponseClass)&&(i=a[0],u=i.Items[0],n=function(t,e){var n;if(t){var r=t.ExtendedProperty;if(r)for(var o=r.length,a=0;a<o;a++){var i=r[a];if((null===(n=i.ExtendedFieldURI)||void 0===n?void 0:n.PropertyTag)===e)return i}}return null}(u,l)),n?[2,n.Value]:(d.g.info("[getImmutableEntryId] extendedProperty could not be retrieved"),[2,null])}}))}))}function f(t,e){var n=Object(s.b)(),r=t.map((function(t){return Object(i.a)({Id:t})}));return Object(u.a)({Header:n,Body:Object(a.a)({ItemShape:e,ItemIds:r})}).then((function(t){var e,n;return null===(n=null===(e=null==t?void 0:t.Body)||void 0===e?void 0:e.ResponseMessages)||void 0===n?void 0:n.Items})).catch((function(t){return d.g.warn("GetItem:"+t.message),null}))}},4690:function(t,e,n){"use strict";var r=n(0),o=n(12),a=n(2185),i=n(2165),c=n(270),u=n(1733);function s(t){switch(t){case i.a.Download:return u.a.Download;case i.a.OpenInNewTab:return u.a.OpenInNewTab;case i.a.Preview:return u.a.Preview;case i.a.ImportCalendarEventAttachment:case i.a.ChangePermissions:case i.a.CopyLink:case i.a.SaveToCloud:case i.a.ViewInProvider:case i.a.ConvertClassicToCloudy:case i.a.ConvertCloudyToClassic:case i.a.MoveAttachmentToInline:case i.a.RefreshLink:case i.a.IgnoreExpiration:return null;default:return Object(c.a)(t)}}function d(t){switch(t){case u.a.Download:return i.a.Download;case u.a.OpenInNewTab:return i.a.OpenInNewTab;case u.a.Preview:return i.a.Preview;case u.a.NoAction:return null;default:return Object(c.a)(t)}}var l=n(4253);var p=n(320),v=n(1938),f=n(1553),b=n(3155);function O(t,e,n,o,i,c,p,O,m,j,C){var h=Object(u.d)(e,n,o,j);!function(t,e){var n=Object(v.d)();0===n?t.supportedOpenActions=t.supportedOpenActions.filter((function(t){return t!==u.a.Download})):1===n&&(t.supportedOpenActions=t.supportedOpenActions.filter((function(t){return t!==u.a.Download&&t!==u.a.Preview})));var r=function(t,e,n){void 0===n&&(n=!1);var r=t.filter((function(t){return-1!==e.indexOf(t)}));return n&&(r=r.filter((function(t,e,n){return n.indexOf(t)===e}))),r}(t.supportedOpenActions.map(d).filter((function(t){return!!t})),e);t.supportedOpenActions=r.map(s)}(h,O);var g,w=Object(f.a)(o),_=j&&Object(b.a)(o),S=Object(a.d)(o,w||_,m,C),y=w,T=I(w,_,c),A=function(t,e,n){return t.convertClassicToCloudyEnabled&&!e&&!n}(t,w||_,m),P=function(t,e,n,r,o){if(t.convertCloudyToClassicEnabled&&e&&!n&&r){var a=Object(l.a)(o);return(null==a?void 0:a.supportConvertCloudyToClassic)||!1}return!1}(t,w,m,p,i),E=function(t,e,n,r){return 2===t&&!e&&!n&&!r}(n,w,_,m);switch(n){case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:case 13:g=function(t,e,n,o,a,i,c,u){return Object(r.__assign)(Object(r.__assign)({},t),{isSaveToCloudSupported:e,isOpeningByLinkSupported:n,isOpeningInProviderSupported:o,isViewingInProviderSupported:a,isConvertClassicToCloudySupported:i,isConvertCloudyToClassicSupported:c,isMoveAttachmentToInlineSupported:u,showActionsMenu:!0,supportedMenuActions:[]})}(h,S,w||_,y,T,A,P,E);break;case 1:g=function(t){return Object(r.__assign)(Object(r.__assign)({},t),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!1,isOpeningInProviderSupported:!1,isViewingInProviderSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]})}(h);break;default:g=w?function(t,e,n,o){return Object(r.__assign)(Object(r.__assign)({},t),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!0,isOpeningInProviderSupported:e,isViewingInProviderSupported:n,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:o,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(h,y,T,P):function(t,e,n,o){return Object(r.__assign)(Object(r.__assign)({},t),{isSaveToCloudSupported:e,isViewingInProviderSupported:n,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:o,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(h,S,T,A)}return g.supportedMenuActions=O,g}function I(t,e,n){if(t||e)return!1;var r=Object(p.a)(),a=Object(l.b)(r);return!Object(o.f)(n)&&(r||(null==a?void 0:a.supportViewInProvider))}n.d(e,"a",(function(){return O})),n.d(e,"b",(function(){return I}))},4706:function(t,e,n){"use strict";var r=n(0),o=n(269),a=n(9819),i=n(1379),c=n(3960),u=n(5153),s=n(4574),d=n(285),l=n(9820),p=n(4252),v=n(4690),f=n(2882),b=Object(d.action)("updateIsViewingInProviderSupported")((function(t,e){t.strategy.isViewingInProviderSupported=e}));n.d(e,"d",(function(){return O})),n.d(e,"c",(function(){return j})),n.d(e,"b",(function(){return C}));e.a=Object(d.action)("saveToCloud")((function(t,e,n,o,a,i){var c=Object(r.__read)(I(t,e,n,o,!1,a,i),2),s=c[0],d=c[1];Object(u.b)(t.attachmentId,null,i,s,d)}));function O(t,e,n,o,a,i,c){var s=Object(r.__read)(I(t,e,n,o,!0,i,c),2),d=s[0],l=s[1];Object(u.c)(t.attachmentId,d,l,a,c)}function I(t,e,n,r,a,i,c){var u=new o.a("AttachmentSaveToCloud");l.a.run(2,t.attachmentId,c),j(t,a);return[function(o){var a=0===o.ResultCode;return C(t,a,a?o.Item.Location:null,c),e(a),m(u,t.attachmentId,o.ResultCode,"ServerError",o.Exception,n,r,i),!0},function(o,a,c,s){C(t,!1,null,s),e(!1),m(u,t.attachmentId,a,c,o,n,r,i)}]}function m(t,e,n,r,a,u,d,l){var p=Object(i.a)(e);t.addCustomData({entryPoint:u,result:n});var v=Object(c.a)(p);t.addCosmosOnlyData(JSON.stringify({size:p.model.Size,fileType:v})),0===n?t.end():t.endWithError(r,new Error(a)),Object(s.a)(null==d?void 0:d.Id).then((function(t){o.m.importAndExecute("SavedAttachment",{itemId:t,customProperties:{FileId:e.Id,FileType:v,Destination:"Cloud",Sender:l}})}))}function j(t,e){void 0===e&&(e=!1);var n=e?18:1;Object(f.a)(t,2,n)}function C(t,e,n,r){if(e){Object(p.a)(t,2),Object(a.a)(t.attachmentId,n),l.a.run(3,t.attachmentId,r);var o=Object(v.b)(!1,!1,n);b(t,o)}else l.a.run(4,t.attachmentId,r);Object(f.a)(t,0,e?3:4)}},5153:function(t,e,n){"use strict";var r=n(0),o=n(1503),a=n(269),i={},c=5e3,u=12;function s(t,e,n,s,l){var p=new a.a("SaveToCloudProgressManager"),v=setInterval((function(){!function(t,e,n,a,i,c,u){Object(r.__awaiter)(this,void 0,void 0,(function(){var s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(s=u[t])?(s.counter++,s.counter>c?(d(t,u),s.datapoint.addCustomData({operationId:t,counter:s.counter}),s.datapoint.endWithError("Timeout"),i&&i(),[2]):[4,o.f.import()]):[2];case 1:return r.sent()(e,n,t,0,(function(t){a&&a(t.NotificationPayloads)})),[2]}}))}))}(n,t,e,s,l,u,i)}),c);i[n]={timer:v,counter:0,datapoint:p}}function d(t,e){void 0===e&&(e=null),e||(e=i);var n=e[t];if(n){clearInterval(n.timer);var r=n.datapoint;r.addCustomData({operationId:t,counter:n.counter}),r.end(),delete e[t]}}var l=n(3),p=Object(l.action)("cancelSaveAttachmentsToCloud",(function(t){return{operationId:t}}));Object(l.orchestrator)(p,(function(t){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return d(t.operationId),[2]}))}))}));var v=Object(l.action)("saveAttachmentsToCloud",(function(t,e,n,r,o,a,i,c,u,s){return{attachmentId:t,itemId:e,sxsId:n,notificationHandler:r,serviceCallFailureCallback:o,operationCreatedCallback:a,folderId:i,attachmentIds:c,showProgressBar:u,subscriptionId:s}}));function f(t){return Object(r.__assign)({__type:"SaveAttachmentsToCloudRequest:#Exchange"},t)}var b=n(29);var O=n(440);function I(t,e,n,r,o,a,i){var c,u,s=function(t,e,n,r,o,a,i){return f({ewsAttachmentId:t,itemId:e,subscriptionId:n,groupSmtpAddress:o,channelId:r,folderItemId:a,attachmentIds:i})}(t,e,n,r,"GroupMailbox"===(null==o?void 0:o.type)?o.mailboxSmtpAddress:null,a,i);return c={requestObject:s},u=Object(O.a)(o),void 0===c.requestObject||c.requestObject.__type||(c.requestObject=f(c.requestObject)),Object(b.a)("SaveAttachmentsToCloud",c,u)}var m=n(5195),j=n(1467);Object(l.orchestrator)(v,(function(t){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,n,o,a,i,c,u,l,p;return Object(r.__generator)(this,(function(v){switch(v.label){case 0:return e=!1!==t.showProgressBar,!(n=t.attachmentId||t.itemId)&&t.attachmentIds.length>0&&(n=t.attachmentIds[0]),o=function(r){if(!r||"Reload"===r.EventType)return!1;if(23===r.ResultCode)return!1;var o=t.notificationHandler(r);return e&&o&&(d(n.Id),e=!1),o},a=t.subscriptionId,[4,Object(m.a)(o,a)];case 1:return i=r.__read.apply(void 0,[v.sent(),4]),c=i[0],u=i[1],l=i[2],p=i[3],function(t,e,n,o,a,i,c,u,s,d){Object(r.__awaiter)(this,void 0,void 0,(function(){var l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,I(t?t.Id:null,e?e.Id:null,n,i,C(e,t,d),s,d?d.map((function(t){return t.Id})):null)];case 1:return[2,r.sent()];case 2:return l=r.sent(),u(l,1,"ServerError",c),j.g.importAndExecute(o,a),[2,null];case 3:return[2]}}))}))}(t.attachmentId,t.itemId,c,u,l,p,t.sxsId,t.serviceCallFailureCallback,t.folderId,t.attachmentIds),e&&s(t.attachmentId,t.itemId,n.Id,(function(t){t.forEach((function(t){o(t)}))}),(function(){t.serviceCallFailureCallback("Progress manager timeout. OperationId = "+n,3,"Timeout",t.sxsId)})),t.operationCreatedCallback&&t.operationCreatedCallback(n.Id,u,l),[2]}}))}))}));function C(t,e,n){return t?t.mailboxInfo:e?e.mailboxInfo:n[0].mailboxInfo}function h(t,e,n,o,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=function(n){if(!n||"Reload"===n.EventType)return!1;if(23===n.ResultCode)return!1;var r=e(n);return r&&d(t.Id),r},[4,Object(m.a)(i,o)];case 1:return r.sent(),s(t,null,t.Id,(function(t){t.forEach((function(t){i(t)}))}),(function(){n("Progress manager timeout. OperationId = "+t.Id,3,"Timeout",a)})),[2]}}))}))}n.d(e,"a",(function(){return p})),n.d(e,"b",(function(){return v})),n.d(e,"c",(function(){return h}))},5195:function(t,e,n){"use strict";var r=n(0),o=n(362),a=n(1467);function i(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=e||Object(o.a)(),i={subscriptionId:n,requiresExplicitSubscribe:!1,subscriptionParameters:null,noSubscriptionFailureReload:!0},c=function(e){t(e)&&a.g.importAndExecute(i,c)},[4,a.f.import()];case 1:return r.sent()(i,c),[4,a.b.import()];case 2:return u=r.sent()(),[2,[n,i,c,u]]}}))}))}n.d(e,"a",(function(){return i}))},9819:function(t,e,n){"use strict";var r=n(1379),o=n(285);e.a=Object(o.action)("setAttachmentOriginalUrl")((function(t,e){Object(r.a)(t).model.AttachmentOriginalUrl=e}))},9820:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=null,o={register:function(t){r=t},run:function(t,e,n){r&&r(t,e,n)}}}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentPreviewSxS~AttachmentPreviewSxSInitialize~Attachments~ConversationAttachment~File~5439b604.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentPreviewSxS~AttachmentPreviewSxSInitialize~Attachments~ConversationAttachment~File~5439b604.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentPreviewSxS~AttachmentPreviewSxSInitialize~Attachments~ConversationAttachment~File~5439b604.js'] = (new Date()).getTime();