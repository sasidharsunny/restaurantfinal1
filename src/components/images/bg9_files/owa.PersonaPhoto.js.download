self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.PersonaPhoto.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[866],{1391:function(e,r,t){"use strict";var n,a,o;t.d(r,"c",(function(){return n})),t.d(r,"b",(function(){return a})),t.d(r,"a",(function(){return o})),function(e){e[e.tiny=0]="tiny",e[e.extraExtraSmall=1]="extraExtraSmall",e[e.extraSmall=2]="extraSmall",e[e.small=3]="small",e[e.regular=4]="regular",e[e.large=5]="large",e[e.extraLarge=6]="extraLarge",e[e.size8=17]="size8",e[e.size10=9]="size10",e[e.size16=8]="size16",e[e.size24=10]="size24",e[e.size28=7]="size28",e[e.size32=11]="size32",e[e.size40=12]="size40",e[e.size48=13]="size48",e[e.size56=16]="size56",e[e.size72=14]="size72",e[e.size100=15]="size100",e[e.size120=18]="size120"}(n||(n={})),function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy"}(a||(a={})),function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed",e[e.transparent=15]="transparent",e[e.violet=16]="violet",e[e.lightRed=17]="lightRed",e[e.gold=18]="gold",e[e.burgundy=19]="burgundy",e[e.warmGray=20]="warmGray",e[e.coolGray=21]="coolGray",e[e.gray=22]="gray",e[e.cyan=23]="cyan",e[e.rust=24]="rust"}(o||(o={}))},16433:function(e,r,t){"use strict";t.r(r);var n=t(2993);t.d(r,"downloadPersonaPhoto",(function(){return n.a}))},190:function(e,r,t){"use strict";t.d(r,"a",(function(){return a}));var n=t(24);function a(){var e=Object(n.a)(),r=e.origin;return r||(r=e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")),r}},2431:function(e,r,t){"use strict";t.d(r,"a",(function(){return b})),t.d(r,"b",(function(){return p}));var n=t(2835),a=t(1376),o=t(1391),i=t(270),s=t(5),c="email",u="personId",l="UA",d="size",f="/service.svc/s/GetPersonaPhoto";function b(e,r,t,o){if(Object(a.a)()&&e)return Object(n.a)(e,t);var i=Object(s.a)().baseUrl,b="";return e&&(b=h(b,c,e&&e.toLowerCase())),r&&(b=h(b,u,r)),b=h(b,l,"0"),b=h(b,d,o?"HR96x96":"HR64x64"),""+i+f+"?"+b}function p(e,r,t){return Object(a.a)()?Object(n.a)(e,r):"https://cid-"+e+".users.storage.live.com/users/0x"+e+"/myprofile/expressionprofile/profilephoto:"+function(e){switch(e){case o.c.tiny:case o.c.extraExtraSmall:case o.c.extraSmall:case o.c.small:case o.c.regular:case o.c.large:case o.c.size10:case o.c.size8:case o.c.size16:case o.c.size24:case o.c.size28:case o.c.size32:return"UserTileStatic,UserTileSmall";case o.c.extraLarge:case o.c.size40:case o.c.size48:case o.c.size56:case o.c.size72:case o.c.size100:case o.c.size120:return"UserTileMedium,UserTileStatic,UserTileSmall";default:return Object(i.a)(e)}}(t)+"/MeControlMediumUserTile?ck=1&ex=24&fofoff=1"}function h(e,r,t){t&&(t=encodeURIComponent(t));var n=r+"="+t;return e&&(n=e+"&"+n),n}},2835:function(e,r,t){"use strict";t.d(r,"a",(function(){return o}));var n=t(12),a="/profile/v1.0/{0}/{1}/image/$value";function o(e,r){var t=e.indexOf("@")>-1,o="GroupMailbox"==r?"groups":"users";return Object(n.c)(a,o,t?e:"cid:"+e)}},2993:function(e,r,t){"use strict";var n=t(0),a=t(285),o=Object(a.action)("setIsPendingFetch")((function(e,r){e.personaBlob.isPendingFetch=r})),i=t(3),s=t(1317),c=Object(i.mutatorAction)("addBrandToDynamicBrandSet",(function(e,r){r?s.a.dynamicBrandSets.verifiedBrands.set(e,!0):s.a.dynamicBrandSets.unverifiedBrands.set(e,!0)})),u=t(2835),l=t(2431),d=t(1376),f=t(269),b=t(12),p=t(469),h=t(59),g=t(123),m=t(124),v=t(83);t.d(r,"a",(function(){return U}));var O="GetProfileImageTime",y="GetPersonaTime",j="GetProfileImageNoPhoto",z="GetPersonaResponseNoPhoto",x="https://outlook.office.com/M365.Access",w="image_verified_flag",R="outlook.brands.verified_status",A={};function U(e,r,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var a,i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(a=e.personaBlob,!r&&(a.isPendingFetch||a.hasFetchFailed||a.blobUrl&&A[a.blobUrl]||Object(b.f)(e.emailAddress)&&Object(b.f)(e.personaId)||(null==t?void 0:t())))return[2];o(e,!0),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,Object(d.a)()?P(e,r):C(e,r)];case 2:return n.sent(),[3,5];case 3:throw i=n.sent(),h.g.warn("Error in getPersonaPhoto "+i),i;case 4:return o(e,!1),[7];case 5:return[2]}}))}))}function C(e,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,a,o,i,s,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return t=S(),a=new Headers,r&&a.append("Cache-Control","no-cache"),(o=Object(m.a)({isUserActivity:!1,returnFullResponseOnSuccess:!0,headers:a,method:"GET"})).credentials="same-origin",o.headers.has("X-OWA-CANARY")&&o.headers.delete("X-OWA-CANARY"),o.headers.has("X-Req-Source")&&o.headers.delete("X-Req-Source"),[4,Object(g.a)(Object(l.a)(e.emailAddress,e.personaId),o)];case 1:return i=n.sent(),s=k,c=[e],[4,i.blob()];case 2:return s.apply(void 0,c.concat([n.sent()])),t.end(),[2]}}))}))}function P(e,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,a,o,i,s,l;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(p.getDelegationTokenForOwa)(x)];case 1:return(t=n.sent())?(a=Object(u.a)(e.emailAddress,e.mailboxType),o={"Content-Type":"image/gif",Authorization:"Bearer "+t,"X-AnchorMailbox":e.emailAddress,image_verified_flag:"","X-RoutingParameter-ResolutionDepth":"Shallow"},r&&(o["Cache-Control"]="no-cache"),i=S(),[4,fetch(a,{method:"GET",mode:"cors",headers:o})]):[2];case 2:return s=n.sent(),Object(d.a)()&&Object(v.i)("rp-brandCards")&&function(e,r){var t=r.headers.get(w);if(null!=t){var n=t.toLowerCase(),a=-1!==n.indexOf(R),o=-1!==n.indexOf(R+" = true");a&&c(e.emailAddress,o)}}(e,s),[4,s.blob()];case 3:return l=n.sent(),k(e,l),i.end(),[2]}}))}))}function S(){var e=Object(d.a)()?O:y;return new f.b(e)}var k=Object(a.action)("processGetPhotoResponse")((function(e,r){o(e,!1);var t,n=0==r.type.toLowerCase().indexOf("image"),a=0==r.type.toLowerCase().indexOf("text/xml"),i=r.size<100;if((n||a)&&!i)return e.personaBlob.blobUrl=URL.createObjectURL(r),A[e.personaBlob.blobUrl]=!0,void(e.personaBlob.hasFetchFailed=!1);t=Object(d.a)()?j:z,Object(f.q)(t),e.personaBlob.hasFetchFailed=!0}))},317:function(e,r,t){"use strict";r.decode=r.parse=t(521),r.encode=r.stringify=t(522)},362:function(e,r,t){"use strict";t.d(r,"a",(function(){return o})),t.d(r,"b",(function(){return i}));var n=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function o(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}function i(e){return n.test(e)}},429:function(e,r,t){"use strict";t.d(r,"a",(function(){return a}));var n=t(75);function a(e){return Object(n.a)(e,[n.c])}},521:function(e,r,t){"use strict";function n(e,r){return Object.prototype.hasOwnProperty.call(e,r)}e.exports=function(e,r,t,o){r=r||"&",t=t||"=";var i={};if("string"!=typeof e||0===e.length)return i;var s=/\+/g;e=e.split(r);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var u=e.length;c>0&&u>c&&(u=c);for(var l=0;l<u;++l){var d,f,b,p,h=e[l].replace(s,"%20"),g=h.indexOf(t);g>=0?(d=h.substr(0,g),f=h.substr(g+1)):(d=h,f=""),b=decodeURIComponent(d),p=decodeURIComponent(f),n(i,b)?a(i[b])?i[b].push(p):i[b]=[i[b],p]:i[b]=p}return i};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},522:function(e,r,t){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,r,t,s){return r=r||"&",t=t||"=",null===e&&(e=void 0),"object"==typeof e?o(i(e),(function(i){var s=encodeURIComponent(n(i))+t;return a(e[i])?o(e[i],(function(e){return s+encodeURIComponent(n(e))})).join(r):s+encodeURIComponent(n(e[i]))})).join(r):s?encodeURIComponent(n(s))+t+encodeURIComponent(n(e)):""};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,r){if(e.map)return e.map(r);for(var t=[],n=0;n<e.length;n++)t.push(r(e[n],n));return t}var i=Object.keys||function(e){var r=[];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.push(t);return r}}}]);
//# sourceMappingURL=owa.PersonaPhoto.js.map
self.scriptsLoaded['owa.PersonaPhoto.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.PersonaPhoto.js'] = (new Date()).getTime();