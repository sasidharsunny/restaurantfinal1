self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.54.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[54],{1643:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(30),i=n(83),a=n(2754);function c(){var e=Object(r.a)(),t=null==e?void 0:e.SessionSettings,n=null==t?void 0:t.IsExplicitLogon,c=null==t?void 0:t.IsSubstrateSearchServiceAvailable;return!(a.a.fallbackToFindPeople||!Object(i.i)("rp-3SPeopleSuggestions")||n||!c)}},1755:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(83);function i(){return Object(r.i)("rp-peopleSuggestionsTrie")&&Object(r.i)("rp-peopleSuggestionsCacheFirst")||Object(r.i)("rp-cacheFirstPeopleTrieSize300")||Object(r.i)("rp-cacheFirstPeopleTrieSize500")||Object(r.i)("rp-cacheFirstPeopleTrieSize700")||Object(r.i)("rp-peopleTrieOnTimeoutLow")||Object(r.i)("rp-peopleTrieOnTimeoutMed")||Object(r.i)("rp-peopleTrieOnTimeoutHigh")}},1812:function(e,t,n){"use strict";var r=n(12),i=n(285),a=n(2469),c=n(2442),o=n(319),s=n(59);function u(e){var t=Object(c.a)({EntityFeedbackEntries:e});return Object(a.a)({Header:Object(o.b)(),Body:t}).then((function(e){!function(e){if(null==e?void 0:e.Body){var t=e.Body;s.g.info(Object(r.c)("addEntityFeedback Error count: {0}",t.ErrorCount)),s.g.info(Object(r.c)("addEntityFeedback error details: {0}",t.ErrorDetails))}}(e)}))}t.a=Object(i.action)("attemptToSubmitAddEntityFeedback")((function(e,t,n){e&&t&&(e.entityFeedbackEntries.push(t),(n||e.entityFeedbackEntries.length>=e.maxActionBatchSize)&&(u(e.entityFeedbackEntries),s.g.info(Object(r.c)("{0} Submitted {1} entities.",e.entityScenarioName,e.entityFeedbackEntries.length)),e.entityFeedbackEntries=[]))}))},1837:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(77),i=new r.c((function(){return n.e(697).then(n.bind(null,4022))})),a=new r.b(i,(function(e){return e.searchSuggestionsForSinglePersona})),c=new r.b(i,(function(e){return e.searchSuggestions}))},1927:function(e,t,n){"use strict";var r=n(0),i=n(1837),a=n(2324),c=n(2638),o=n(2295),s=n(2115),u=n(2532),l=n(2488),d=n(9),b=n(362),p=n(1410),f=n(2639),O=n(285),j=Object(O.action)("autoSearchDirectory")((function(e,t,n,O,j){return Object(r.__awaiter)(this,void 0,void 0,(function(){var v,h,m,S;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return v=Object(d.Pb)(),h=Object(b.a)(),Object(o.b)(e,v,h,!0),[4,i.a.import().then((function(n){return n(e.userIdentity,t,!0,h,e.findPeopleFeedbackManager,null,j)}))];case 1:return m=r.sent(),Object(s.a)(e,!1),e.queryString.trim()==t&&(20,Object(u.a)(e,t),Object(c.a)(e.findResultSet,m,O,20,!0),S=Object(l.a)(m),Object(o.d)(e,!0,S,m),Object(f.a)(e.findResultSet,e,v,S),e.directorySearchType=p.a.Auto,0==e.findResultSet.length&&(e.findResultSet=[]),Object(a.a)(e,p.b.SearchDirectory,0,n)),[2]}}))}))})),v=n(2603),h=n(3066),m=n(2867),S=n(3067),g=n(1643),y=n(3173),R=n(1703),E=n(1755),I=Object(O.action)("backfillCache")((function(e,t,n,a,s,u){return Object(r.__awaiter)(this,void 0,void 0,(function(){var O,I,T,A,P,w,_,F;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:O=Object(b.a)(),Object(v.a)(O),I=Object(d.Pb)(),Object(o.b)(e,I,O,!1),T="",r.label=1;case 1:return r.trys.push([1,8,9,10]),[4,i.a.import().then((function(n){return n(e.userIdentity,t,!1,O,null,null,u)}))];case 2:return A=r.sent(),T=Object(l.a)(A),P=function(e){if(Object(g.a)()){var t=[];return Object(m.a)(t,e,!1),t}return e.ResultSet}(A),a&&Object(h.a)(P),w=e.queryString==t,function(e){var t;var n;return Object(g.a)()?!(null===(t=null==(n=e)?void 0:n.Groups)||void 0===t?void 0:t.length):"Success"!=(n=e).ResponseClass||0==n.ResultSet.length}(A)&&w?[4,j(e,t,n,s,u)]:[3,4];case 3:return r.sent(),Object(y.a)(e,p.a.Auto),[3,7];case 4:return w?(_="",Object(E.a)()&&s?[4,R.a.import().then((function(n){return n(t,e.findResultSet,A)}))]:[3,6]):[3,7];case 5:_=r.sent(),r.label=6;case 6:Object(o.d)(e,!1,T,A,_),Object(c.a)(e.findResultSet,A,s,5),Object(f.a)(P,e,I,T),r.label=7;case 7:return[3,10];case 8:throw F=r.sent(),Object(S.a)(e,I,T),F;case 9:return Object(v.b)(O),[7];case 10:return[2]}}))}))}));var T=n(3068),A=n(3111),P=n(269),w=Object(O.action)("setFindResultSet")((function(e,t){e.findResultSet=t}));var _=n(4051),F=Object(O.action)("processCacheResult")((function(e,t,n,i,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(u){return n&&(o=new Map,e.findResultSet.forEach((function(e){o[e.EmailAddress.EmailAddress]=e})),t=function(e,t){return t.filter((function(t){return null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]}))}(o,t),(t=Object(r.__spread)(e.findResultSet,t)).splice(5)),Object(s.a)(e,!1),(n||t.length>0)&&w(e,t),Object(_.a)(e,c),Object(a.a)(e,p.b.Cache,t.length,i),[2]}))}))})),C=n(1671);function k(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(E.a)()?[4,Object(C.d)(e,5,t)]:[3,2];case 1:return i=r.sent(),[3,3];case 2:i=Object(C.a)(e,5,t),r.label=3;case 3:return 0==(n=i).length?[2,[]]:(a=n.map((function(e){var t=e;return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId,PersonaTypeString:e.PersonaTypeString,FeatureData:e.FeatureData,Id:t.Id}})),[2,Promise.resolve(a)])}}))}))}var D=n(3071),x=function(e,t,n,i,a){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var c,s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c=Object(d.Pb)(),[4,k(e,Object(D.a)(t))];case 1:return s=r.sent(),Object(u.a)(n,e),l=Object(b.a)(),Object(o.a)(n,c,s,l),F(n,s,i,a,c),[2,s]}}))}))},N=Object(O.action)("findPeopleCacheFirst")((function(e,t,n,i,c,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,l,d,b,f,O;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return u=p.b.Cache,l=new P.a(T.a.SearchCacheFirst.name),e.directorySearchType=p.a.None,Object(s.a)(e,!0),[4,x(t,n,e,i,c)];case 1:d=r.sent(),b=d.length,f=i||b>0,r.label=2;case 2:return r.trys.push([2,6,,7]),f&&A.a.pendingFindPeopleRequests<3?(I(e,t,c,!Object(E.a)(),f,o),u=p.b.MixedCacheLive,[3,5]):[3,3];case 3:return f?[3,5]:[4,I(e,t,c,!Object(E.a)(),f,o)];case 4:r.sent(),u=p.b.FindPeople,r.label=5;case 5:return[3,7];case 6:return O=r.sent(),f||w(e,[]),l.endWithError("ServerError",O),[3,7];case 7:return e.findResultSet.length>0?(Object(a.a)(e,u,b,c),[3,10]):[3,8];case 8:return[4,j(e,t,c,null,o)];case 9:r.sent(),u=p.b.SearchDirectory,r.label=10;case 10:return Object(s.a)(e,!1),l.addCustomData([u,t==e.queryString]),l.end(),[2]}}))}))})),q=5;var L=n(3924),M=n(83),W=n(2947),G=n(96),Q=n(3925),z=n(3926),J=n(3488),U=Object(O.action)("searchCacheFallback")((function(e,t,n,i,a,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e.queryString.trim()!=t.trim()?[3,2]:(s=Object(d.Pb)(),[4,k(t,Object(D.a)(n))]);case 1:l=r.sent(),Object(o.a)(e,s,l,Object(b.a)(),!0),Object(u.a)(e,t),e.directorySearchType=p.a.None,l.length>0?F(e,l,i,a,s):c&&(c.isCacheEmpty=!0),r.label=2;case 2:return[2]}}))}))}));t.a=Object(O.action)("findReadWriteRecipient")(Object(O.select)({store:function(){return A.a}})((function(e,t,n,O,h,m,y,R,E){return Object(r.__awaiter)(this,void 0,void 0,(function(){var I,A,w,_,F,C,k,D,x,V,B,H,K,$,X,Y,Z,ee;return Object(r.__generator)(this,(function(te){switch(te.label){case 0:return n||Object(o.c)(e),I=Object(L.a)(e,h),A=!1,m&&m.length>0&&(w=function(e,t){var n=[];if(t){var r=0;for(e=e.toLowerCase();n.length<q&&r<t.length;){var i=t[r].persona.EmailAddress;(i.EmailAddress&&0==i.EmailAddress.toLowerCase().indexOf(e)||i.Name&&0==i.Name.toLowerCase().indexOf(e))&&n.push({EmailAddress:i}),r++}}return n}(t,m))&&w.length>0&&(e.findResultSet=w,A=!0),!y&&!Object(J.a)()||n||Object(W.a)()?[3,2]:[4,N(e,t,I,A,O,R)];case 1:return te.sent(),[2];case 2:return _=!1,E.store.pendingFindPeopleRequests<Q.a?(ee=new P.a(T.a.SearchPeopleIndex.name),Object(s.a)(e,!0),F=e.currentRenderedQueryString,C=e.directorySearchType,Object(M.i)("rp-optimizeAutoSearchDirectory")&&""!=F&&!n&&C==p.a.Auto&&F.length<t.length&&0==t.indexOf(e.currentRenderedQueryString)?[4,j(e,t,O,null,R)]:[3,4]):[3,15];case 3:return te.sent(),_=!0,ee.addCustomData([!1,!0,!0,!1,!0,Object(g.a)()]),ee.end(),[3,14];case 4:k={isTimedOut:!1,isCacheEmpty:!1},D=n||Object(W.a)()?null:setTimeout(function(e,t,n,i,a,c){return function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c.isTimedOut=!0,[4,U(e,n,t,i,a,c)];case 1:return r.sent(),[2]}}))}))}}(e,I,t,A,O,k),Object(z.a)()),x=Object(d.Pb)(),V="",B=Object(b.a)(),te.label=5;case 5:return te.trys.push([5,12,,14]),Object(v.a)(B),H=[],I.forEach((function(e){H.push(e.persona.EmailAddress.EmailAddress)})),Object(o.b)(e,x,B,n),[4,i.a.import().then((function(r){return r(e.userIdentity,t,n,B,e.findPeopleFeedbackManager,H,R)}))];case 6:return K=te.sent(),Object(v.b)(B),clearTimeout(D),$=e.queryString==t,k.isTimedOut&&!k.isCacheEmpty||!$?[3,11]:(V=Object(l.a)(K),Object(o.d)(e,n,V,K),Object(u.a)(e,t),e.directorySearchType=n?p.a.Manual:p.a.None,X=n?Q.b:Q.c,Object(c.a)(e.findResultSet,K,A,X,n),Object(f.a)(e.findResultSet,e,x,V),e.findResultSet.length>0?(Object(s.a)(e,!1),Y=n?p.b.SearchDirectory:p.b.FindPeople,Object(a.a)(e,Y,0,O),[3,11]):[3,7]);case 7:return[4,U(e,t,I,A,O)];case 8:return te.sent(),0!==e.findResultSet.length?[3,11]:Object(G.s)()?(e.directorySearchType=p.a.Auto,e.findResultSet=[],[3,11]):[3,9];case 9:return _=!0,[4,j(e,t,O,null,R)];case 10:te.sent(),te.label=11;case 11:return ee.addCustomData([k.isTimedOut,$,n,k.isCacheEmpty,_,Object(g.a)()]),ee.end(),[3,14];case 12:return Z=te.sent(),Object(v.b)(B),ee.endWithError("ServerError",Z),Object(S.a)(e,x,V),[4,U(e,t,I,A,O)];case 13:return te.sent(),[3,14];case 14:return[3,17];case 15:return ee=new P.a("FindPeopleThresholdHit"),[4,U(e,t,I,A,O)];case 16:te.sent(),ee.end(),te.label=17;case 17:return Object(s.a)(e,!1),[2]}}))}))})))},1936:function(e,t,n){"use strict";var r=n(0),i=n(295),a=n(1550),c=n(1837),o=n(2948),s=n(3),u=Object(s.action)("addRecipientsToRecipientWell",(function(e,t){return{newRecipients:e,recipientWell:t}}));t.a=u,Object(s.mutator)(u,(function(e){var t,n=e.recipientWell;(t=n.recipients).splice.apply(t,Object(r.__spread)([n.recipients.length,0],e.newRecipients)),n.isDirty=!0})),Object(s.orchestrator)(u,(function(e){var t=e.newRecipients,n=e.recipientWell;t.forEach((function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,s,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e.isPendingResolution?(t=Object(a.a)(e.persona.EmailAddress),(s=n.userIdentity)||(s=Object(i.d)().userIdentity),[4,c.b.import().then((function(e){return e(s,t)}))]):[2];case 1:return u=r.sent(),Object(o.a)(e,u,t),[2]}}))}))}))}))},1940:function(e,t,n){"use strict";var r=n(12),i=n(285),a=Object(i.action)("increaseEntrySequenceNumber")((function(e){e&&e.entrySequenceNumber++})),c=n(97),o=n(59),s=n(9);function u(e,t,n,i,u,l,d,b){if(void 0===b&&(b=Object(s.Pb)()),!e)return o.g.warn("Attempting to create entity feedback entry with invalid feedbackManager"),null;if(Object(c.b)(e.clientSessionId))return o.g.warn(Object(r.c)("{0} - Attempting to create entity feedback entry with empty client session id",e.entityScenarioName)),null;var p={ClientEventTimeUtc:Object(s.tb)(b),ClientEventTimeLocal:Object(s.qb)(b),ClientSessionId:e.clientSessionId,ClientVersion:e.clientVersion,ClientId:e.clientId,EntityType:e.entityType,EntrySequenceNumber:e.entrySequenceNumber,TransactionId:t,EventType:n,TargetEntityList:i,EntityAddSource:u,JsonPropertyBag:l,ScenarioName:d||e.entityScenarioName};return a(e),p}n.d(t,"a",(function(){return u}))},2078:function(e,t,n){"use strict";var r=n(285);t.a=Object(r.action)("setCommonWellItemSelectedState")((function(e,t){e.isSelected=t}))},2115:function(e,t,n){"use strict";var r=n(285);t.a=Object(r.action)("setIsSearching")((function(e,t){e.isSearching!=t&&(e.isSearching=t)}))},2227:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(3),i=Object(r.createStore)("substratepeoplesuggestions",{sessionMaskedRecipients:[]}),a=i();t.a=a},2295:function(e,t,n){"use strict";var r=n(1643);n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return d}));var i="Cache",a="Mailbox",c="Directory",o=" Fallback";function s(e){e.peopleFeedbackState={live:null,cache:null,directory:null}}function u(e,t,n,i){if(Object(r.a)()&&e.peopleFeedbackState){var o={CorrelationId:"",QueryString:"",SuggestionSource:"",RawResponse:""};o.TimeStamp=t,o.QueryString=e.queryString,o.SuggestionSource=i?c:a,o.RawResponse="pending",n&&(o.CorrelationId=n),i?e.peopleFeedbackState.directory=o:e.peopleFeedbackState.live=o}}function l(e,t,n,i,a){if(Object(r.a)()&&e.peopleFeedbackState){var c=i?JSON.stringify(i):"no response";(null==e?void 0:e.peopleFeedbackState)&&(t&&e.peopleFeedbackState.directory?(e.peopleFeedbackState.directory.RawResponse=c,e.peopleFeedbackState.directory.TraceId=n):!t&&e.peopleFeedbackState.live&&(a&&(c+=a),e.peopleFeedbackState.live.RawResponse=c,e.peopleFeedbackState.live.TraceId=n))}}function d(e,t,n,a,c){if(Object(r.a)()&&e.peopleFeedbackState){var s={CorrelationId:"",QueryString:"",SuggestionSource:"",RawResponse:""};s.QueryString=e.queryString,s.TimeStamp=t,s.SuggestionSource=c?i+o:i,s.RawResponse=n?JSON.stringify(n):"no response",a&&(s.CorrelationId=a),e.peopleFeedbackState.cache=s}}},2324:function(e,t,n){"use strict";var r=n(285),i=n(1936),a=n(2446),c=n(1460);t.a=Object(r.action)("postProcessSuggestionsResult")((function(e,t,n,r){1==e.findResultSet.length&&r&&Object(a.a)(e)?Object(i.a)(e.findResultSet.map(c.b),e):(e.findResultType=t,e.numberOfCacheResults=n)}))},2442:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"AddEntityFeedbackRequest:#Exchange"},e)}},2446:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients&&void 0!==e.findResultSet}n.d(t,"a",(function(){return r}))},2469:function(e,t,n){"use strict";var r=n(29),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"AddEntityFeedbackJsonRequest:#Exchange"},n)),Object(r.a)("AddEntityFeedback",e,t)}n.d(t,"a",(function(){return a}))},2488:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1643);function i(e){var t,n="";e&&(Object(r.a)()?(t=e).Groups&&t.Instrumentation&&(n=t.Instrumentation.TraceId):"Success"==(t=e).ResponseClass&&t.ResultSet&&(n=t.TransactionId));return n}},2532:function(e,t,n){"use strict";var r=n(285);t.a=Object(r.action)("updateCurrentRenderedQueryString")((function(e,t){e.currentRenderedQueryString=t}))},2533:function(e,t,n){"use strict";var r=n(285);t.a=Object(r.action)("setForceResolveState")((function(e,t){e.inForceResolve=t}))},2534:function(e,t,n){"use strict";var r=n(285);t.a=Object(r.action)("updateIsEditing")((function(e,t){e.isEditing=t}))},2602:function(e,t,n){"use strict";function r(e){var t=[];return e&&e.forEach((function(e,n){t[n]=e.Id||e.EmailAddress.EmailAddress||e.EmailAddress.Name})),t}n.d(t,"a",(function(){return r}))},2603:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(3),i=Object(r.action)("addPendingRequest",(function(e){return{correlationId:e}})),a=Object(r.action)("removePendingRequest",(function(e){return{correlationId:e}}))},2638:function(e,t,n){"use strict";var r=n(2867),i=n(0),a=n(1643);function c(e,t){t&&(Object(a.a)()?function(e,t){var n,r;try{for(var a=Object(i.__values)(t.Groups),c=a.next();!c.done;c=a.next()){var o=c.value;if("People"===o.Type){var s=o.Suggestions.filter((function(t){return null==e[t.EmailAddresses?t.EmailAddresses[0]:""]}));o.Suggestions=s;break}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}(e,t):function(e,t){var n=t.ResultSet.filter((function(t){return null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]}));t.ResultSet=n}(e,t))}var o=n(4050),s=n(285);t.a=Object(s.action)("processResponseResults")((function(e,t,n,i,s){if(n){var u=new Map;e.forEach((function(e){u[e.EmailAddress.EmailAddress]=e})),c(u,t)}Object(a.a)()?Object(r.a)(e,t,n,i,s):Object(o.a)(e,t,n,i)}))},2639:function(e,t,n){"use strict";var r=n(12),i=n(1812),a=n(1940),c=n(9),o=n(97),s=n(59),u=n(285),l=Object(u.action)("transactionCompleted")((function(e,t,n,u,l,d,b,p){if(void 0===p&&(p=null),null==e?void 0:e.hasSessionStarted){var f={TransactionRequestTime:Object(c.qb)(l),TransactionRequestDuration:Object(c.w)(Object(c.Pb)(),l),QueryString:Object(r.f)(t)?"":t,QueryStringLength:Object(o.b)(t)?0:t.length,PersonaTypeList:b,ImpressionId:u,Cvid:e.conversationId};p&&Object.keys(p).forEach((function(e){f[e]=p[e]})),d&&(f.Context=d);var O=JSON.stringify(f),j=JSON.stringify(n),v=Object(a.a)(e,u,"TransactionCompleted",j,0,O);Object(i.a)(e,v,!1),s.g.info(Object(r.c)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})),d=n(2602),b=n(3172);function p(e,t,n,r){var i,a,c=e.map((function(e){return b.a[e.PersonaTypeString]}));l(t.findPeopleFeedbackManager,t.queryString,Object(d.a)(e),r,n,{Action:"Type Down"},c,{CacheCorrelationId:null===(a=null===(i=t.peopleFeedbackState)||void 0===i?void 0:i.cache)||void 0===a?void 0:a.CorrelationId})}n.d(t,"a",(function(){return p}))},2754:function(e,t,n){"use strict";var r=n(3),i=Object(r.createStore)("recipientcommon",{fallbackToFindPeople:!1})();t.a=i},2755:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2227);function i(e){return!!Object(r.b)().sessionMaskedRecipients[e]}},2756:function(e,t,n){"use strict";var r=n(3),i=Object(r.action)("onRecipientsChanged",(function(e,t){return{recipientWellRecipients:e,recipientData:t}}));t.a=i},2867:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(2868),a=20;function c(e,t,n,c,o){var s,u,l;if(!t||!t.Groups){var d=new Error("Response groups should not be null");throw d.networkError=!0,d}var b=[];c=c||a,c=n?c-e.length:c;var p=null===(l=t.Instrumentation)||void 0===l?void 0:l.TraceId;try{for(var f=Object(r.__values)(t.Groups),O=f.next();!O.done;O=f.next()){var j=O.value;if("People"===j.Type){j.Suggestions.forEach((function(e){if(b.length<c){var t=Object(i.a)(e,p,o);t&&b.push(t)}}));break}}}catch(e){s={error:e}}finally{try{O&&!O.done&&(u=f.return)&&u.call(f)}finally{if(s)throw s.error}}n?e.push.apply(e,Object(r.__spread)(b)):e.splice.apply(e,Object(r.__spread)([0,e.length],b))}},2868:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),i=n(2755),a=function(e){return e?{Id:e,__type:"ItemId:#Exchange"}:void 0};function c(e,t,n){var c=e.EmailAddresses,d=e.DisplayName,b=e.Text,p=e.PDLItemId,f=e.ADObjectId,O=e.PersonaId,j=e.FeatureData,v=e.Id,h=e.ReferenceId,m=e.ImAddress,S=e.JobTitle,g=e.PeopleType,y=e.PeopleSubtype,R=e.GivenName,E=e.Surname,I=e.Alias,T=e.Phones,A=e.Department,P=e.OfficeLocation,w=c?c[0]:void 0;if(!n&&w&&Object(i.a)(w))return null;var _={EmailAddress:w,Name:Object(r.f)(d)?b:d,MailboxType:u(y),RoutingType:o(y),ItemId:a(p)};return{DisplayName:d,ADObjectId:f,FeatureData:j,Id:v,ImAddress:m,EmailAddress:_,EmailAddresses:[_],PersonaTypeString:s(y),PersonaId:a(O),Title:S,ReferenceId:h,PeopleType:g,PeopleSubtype:y,GivenName:R,Surname:E,TransactionId:t,Alias:I,PhoneNumber:l(T),Department:A,Location:P}}function o(e){return"PersonalDistributionList"==e?"MAPIPDL":"SMTP"}function s(e){switch(e){case"PublicDistributionList":case"PersonalDistributionList":return"DistributionList";case"UnifiedGroup":return"ModernGroup";case"OrganizationUser":case"PersonalContact":case"ImplicitContact":case"OrganizationContact":return"Person";case"LinkedIn":return"LinkedIn";case"ImplicitGroup":return"ImplicitGroup";default:return"Unknown"}}function u(e){switch(e){case"PublicDistributionList":return"PublicDL";case"PersonalDistributionList":return"PrivateDL";case"UnifiedGroup":return"GroupMailbox";case"ImplicitGroup":return"RecommendedGroup";case"OrganizationUser":return"InternalMailbox";case"LinkedIn":return"LinkedIn";case"PersonalContact":case"OrganizationContact":case"ImplicitContact":case"Guest":case"Unknown":return"ExternalMailbox";default:return e}}function l(e){return(null==e?void 0:e.length)?{Number:e[0].Number,Type:e[0].Type}:{Number:""}}},2869:function(e,t,n){"use strict";var r=n(0),i=n(3696),a=n(2533),c=n(2534),o=n(285),s=n(269);t.a=Object(o.action)("resolveAllUnresolvedRecipients")((function(e,t,n){var o;return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,l,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(a.a)(e,!0),e.queryString=e.queryString.trim(),e.recipients&&e.queryString?(null==n||n(),[4,Object(i.a)(e,!1,!0,!0)]):[3,2];case 1:return r.sent(),[3,3];case 2:for(u=-1,l=0;l<t.length;l++)if((null===(o=t[l].persona)||void 0===o?void 0:o.EmailAddress)&&!t[l].persona.EmailAddress.EmailAddress&&"PrivateDL"!=(d=t[l].persona).EmailAddress.MailboxType&&Object(s.p)("EmptyEmailAddress",[d.EmailAddress.MailboxType,d.EmailAddress.RoutingType]),!t[l].isValid){u=l;break}-1!=u?Object(c.a)(t[u],!0):Object(a.a)(e,!1),r.label=3;case 3:return[2]}}))}))}))},2946:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}));var r=n(77),i=new r.c((function(){return Promise.all([n.e(1),n.e(2),n.e(3),n.e(4),n.e(7),n.e(692)]).then(n.bind(null,6546))})),a=new r.a(i,(function(e){return e.removePendingRequestCorrelationId})),c=new r.a(i,(function(e){return e.addPendingRequestCorrelationId})),o=new r.b(i,(function(e){return e.openFeedbackDialog}))},2947:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1588);function i(){return null===r.a.recipientCache||0==r.a.recipientCache.length}},2948:function(e,t,n){"use strict";var r=n(1550),i=n(1695),a=n(3),c=Object(a.action)("resolvePendingPersonaOnRecipient",(function(e,t,n){return{recipient:e,nextPersona:t,searchedString:n}}));Object(a.mutator)(c,(function(e){var t=e.recipient,n=e.nextPersona,a=e.searchedString;Object(r.a)(t.persona.EmailAddress)===a&&(t.isPendingResolution=!1,n&&(t.persona=n,t.isValid=!0,t.displayText=Object(i.a)(n.EmailAddress)))})),t.a=c},2949:function(e,t,n){"use strict";function r(e){var t,n;return e?(null===(t=e.EmailAddress)||void 0===t?void 0:t.EmailAddress)||(null===(n=e.PersonaId)||void 0===n?void 0:n.Id):null}n.d(t,"a",(function(){return r}))},3066:function(e,t,n){"use strict";var r=n(0),i=n(1588),a=n(285),c=n(2949);t.a=Object(a.action)("addToCache")((function(e){e&&0!=e.length&&null!==i.a.recipientCache&&e.forEach((function(e){if("LinkedIn"!=e.PersonaTypeString){var t=Object(c.a)(e);if(t&&!i.a.allKeys[t]){var n=Object(r.__assign)(Object(r.__assign)({},e),{sessionAdd:!0});i.a.recipientCache.push(n),i.a.allKeys[t]=!0}}}))}))},3067:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3694);function i(e,t,n){Object(r.a)(e.findPeopleFeedbackManager,e.queryString,n,t,{Action:"Type Down"})}},3068:function(e,t,n){"use strict";t.a={SearchPeopleIndex:{name:"SearchPeopleIndex"},AddRecipientFromFindControl:{name:"AddRecipientFromFindControl",customData:function(e,t){return{index:(e>23?23:e).toString(),source:t.toString()}}},SearchCacheFirst:{name:"SearchCacheFirst"}}},3069:function(e,t,n){"use strict";var r=n(3),i=Object(r.action)("removePersonaFromWell",(function(e,t,n){return void 0===n&&(n=!1),{targetRecipientWell:e,personaToRemove:t,shouldRemoveAllOccurrences:n}}));t.a=i},3070:function(e,t,n){"use strict";var r=n(0),i=n(3),a=Object(i.action)("removeRecipientFromRecipientWell",(function(e,t,n,r){return{recipientIndex:e,recipientWellRecipients:t,onRecipientDeletedCallback:n,deletedRecipient:t.recipients[e],newRecipients:r}}));Object(i.mutator)(a,(function(e){var t;e.recipientWellRecipients.isDirty=!0,(t=e.recipientWellRecipients.recipients).splice.apply(t,Object(r.__spread)([e.recipientIndex,1],e.newRecipients||[]))})),Object(i.orchestrator)(a,(function(e){e.onRecipientDeletedCallback([e.deletedRecipient],e.recipientIndex,e.recipientWellRecipients)})),t.a=a},3071:function(e,t,n){"use strict";function r(e){var t=[];return e&&(t=e.map((function(e){return e.persona}))),t}n.d(t,"a",(function(){return r}))},3111:function(e,t,n){"use strict";var r=n(3),i=n(3069),a=n(3487),c=n(3174),o=(Object(r.orchestrator)(i.a,(function(e){var t=e.targetRecipientWell,n=e.personaToRemove,r=e.shouldRemoveAllOccurrences,i=t.recipients.filter((function(e){return Object(a.a)(e.persona,n)}));if(i&&i.length>0){for(var o=r?i.length-1:0,s=[],u=0;u<=o;u++)i[u]&&!i[u].blockWellItemRemoval&&s.push(i[u]);s.length>0&&Object(c.a)(t,s)}})),n(3695)),s=(Object(r.orchestrator)(o.a,(function(e){var t=e.recipientWells;t&&0!==t.length&&e.emailAddresses.forEach((function(e){var n={EmailAddress:e};t.filter((function(e){return!!e})).forEach((function(e){return Object(i.a)(e,n,!0)}))}))})),n(1936)),u=n(3066),l=n(2756),d=n(2869),b=n(2446);Object(r.orchestrator)(s.a,(function(e){e.newRecipients.forEach((function(e){e.isValid&&Object(u.a)([e.persona])}))})),Object(r.orchestrator)(s.a,(function(e){var t=e.recipientWell;t&&Object(b.a)(t)&&t.inForceResolve&&Object(d.a)(t,t.recipients)})),Object(r.orchestrator)(s.a,(function(e){var t=e.recipientWell,n=e.newRecipients;Object(l.a)(t,n.map((function(e){return{isValid:e.isValid,newPersona:e.persona,newEmailAddress:e.persona.EmailAddress.EmailAddress}})))}));var p=n(2603),f=n(2946),O=n(6);Object(r.orchestrator)(p.a,(function(e){v.pendingFindPeopleRequests++,Object(O.i)()&&f.a.importAndExecute(e.correlationId)})),Object(r.orchestrator)(p.b,(function(e){v.pendingFindPeopleRequests--,Object(O.i)()&&f.c.importAndExecute(e.correlationId)}));var j=Object(r.createStore)("readwriterecipientwell",{pendingFindPeopleRequests:0})(),v=t.a=j},3172:function(e,t,n){"use strict";t.a={Unknown:0,Person:1,DistributionList:2,ModernGroup:5,ImplicitGroup:10,ExplicitGroup:11,LinkedIn:12}},3173:function(e,t,n){"use strict";var r=n(285);t.a=Object(r.action)("setDirectorySearchType")((function(e,t){e.directorySearchType=t}))},3174:function(e,t,n){"use strict";var r=n(0),i=n(2756),a=n(3070),c=n(2078),o=n(285);function s(e,t,n){e[0].isSelected&&n.recipients.length>0&&Object(c.a)(n.recipients[Math.max(0,t-1)],!0)}t.a=Object(o.action)("removeReadWriteRecipients")((function(e,t,n){var c,o;void 0===n&&(n=!0);var u=!1;try{for(var l=Object(r.__values)(t),d=l.next();!d.done;d=l.next()){var b=d.value,p=-1;if((p="number"==typeof b?b:e.recipients.map((function(e){return e.persona.EmailAddress})).indexOf(b.persona.EmailAddress))>=0){if(e.recipients[p].blockWellItemRemoval)return;Object(a.a)(p,e,s),u=!0}}}catch(e){c={error:e}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(c)throw c.error}}n&&u&&Object(i.a)(e)}))},3487:function(e,t,n){"use strict";function r(e,t){return null!=e&&null!=t&&(e==t||e.EmailAddress&&t.EmailAddress&&null!=e.EmailAddress.EmailAddress&&null!=t.EmailAddress.EmailAddress&&e.EmailAddress.EmailAddress.toLowerCase()==t.EmailAddress.EmailAddress.toLowerCase()||e.ADObjectId&&t.ADObjectId&&e.ADObjectId==t.ADObjectId||e.PersonaId&&t.PersonaId&&e.PersonaId==t.PersonaId)}n.d(t,"a",(function(){return r}))},3488:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(83);function i(){return Object(r.i)("rp-peopleSuggestionsCacheFirst")||Object(r.i)("rp-cacheFirstPeopleTrieSize300")||Object(r.i)("rp-cacheFirstPeopleTrieSize500")||Object(r.i)("rp-cacheFirstPeopleTrieSize700")}},3694:function(e,t,n){"use strict";var r=n(12),i=n(1812),a=n(1940),c=n(9),o=n(97),s=n(59),u=n(285);t.a=Object(u.action)("transactionFailed")((function(e,t,n,u,l,d){if(void 0===d&&(d=null),null==e?void 0:e.hasSessionStarted){var b={TransactionRequestTime:Object(c.qb)(u),TransactionRequestDuration:Object(c.w)(Object(c.Pb)(),u),QueryString:Object(r.f)(t)?"":t,QueryStringLength:Object(o.b)(t)?0:t.length,ImpressionId:n};d&&Object.keys(d).forEach((function(e){b[e]=d[e]})),l&&(b.Context=l);var p=JSON.stringify(b),f=Object(a.a)(e,n,"TransactionFailed",null,0,p);Object(i.a)(e,f,!1),s.g.info(Object(r.c)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}))},3695:function(e,t,n){"use strict";var r=n(3),i=Object(r.action)("removeRecipientsFromRecipientWells",(function(e,t){return{emailAddresses:e,recipientWells:t}}));t.a=i},3696:function(e,t,n){"use strict";var r=n(0),i=n(1936),a=n(1927),c=n(3173),o=n(2115),s=n(1410),u=n(285),l=n(1774);t.a=Object(u.action)("resolveQueryStringToRecipient")((function(e,t,n,u){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(c.a)(e,n?s.a.Manual:s.a.None),(d=e.queryString.trim())?t||e.inForceResolve?(e.queryString="",Object(o.a)(e,!1),Object(i.a)([Object(l.a)(d)],e),[3,3]):[3,1]:[3,4];case 1:return Object(o.a)(e,!0),[4,Object(a.a)(e,e.queryString,n,u)];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:Object(o.a)(e,!1),r.label=5;case 5:return[2]}}))}))}))},3924:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2446);function i(e,t){return Object(r.a)(e)?e.recipients:t||[]}},3925:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a}));var r=3,i=5,a=20},3926:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(83),i=100,a=250,c=500,o=1e3;function s(){return Object(r.i)("rp-peopleTrieOnTimeoutLow")?i:Object(r.i)("rp-peopleTrieOnTimeoutMed")?a:Object(r.i)("rp-peopleTrieOnTimeoutHigh")?c:o}},4050:function(e,t,n){"use strict";var r=n(0),i=n(285),a=(t.a=Object(i.action)("processFindPeopleResult")((function(e,t,n,i){if("Success"!=t.ResponseClass||!t.ResultSet)throw new Error("Response resultSet should not be null");i=i||20,i=n?i-e.length:i,i=t.ResultSet.length>i?i:t.ResultSet.length;for(var c=t.TransactionId,o=[],s=0;s<i;s++){var u=t.ResultSet[s];u.EmailAddress?o.push({EmailAddress:(l=u.EmailAddress,l.RoutingType&&"EX"===l.RoutingType.toUpperCase()?Object(r.__assign)(Object(r.__assign)({},l),{EmailAddress:l.OriginalDisplayName}):l),PersonaId:u.PersonaId,ADObjectId:u.ADObjectId,PersonaTypeString:u.PersonaTypeString,DisplayName:u.DisplayName,TransactionId:c}):"ImplicitGroup"==u.PersonaTypeString&&o.push({EmailAddress:a(u),PersonaId:u.PersonaId,ADObjectId:u.ADObjectId,Members:u.Members,PersonaTypeString:u.PersonaTypeString,DisplayName:u.DisplayName,TransactionId:c})}var l;n?e.push.apply(e,Object(r.__spread)(o)):e.splice.apply(e,Object(r.__spread)([0,e.length],o))})),function(e){return{EmailAddress:e.FeedbackId,OriginalDisplayName:e.FeedbackId,Name:e.DisplayName,MailboxType:"GroupMailbox",RoutingType:"SMTP"}})},4051:function(e,t,n){"use strict";var r=n(2602),i=n(12),a=n(1812),c=n(1940),o=n(9),s=n(97),u=n(59),l=n(285),d=n(362),b=Object(l.action)("localCacheTransactionCompleted")((function(e,t,n,r,l,b,p){if(void 0===p&&(p=Object(o.Pb)()),null==e?void 0:e.hasSessionStarted){var f={TransactionRequestTime:Object(o.qb)(p),TransactionRequestDuration:Object(o.w)(Object(o.Pb)(),p),QueryString:Object(i.f)(t)?"":t,QueryStringLength:Object(s.b)(t)?0:t.length,FeatureData:null!=r?r:void 0,personaTypeList:l,ImpressionId:Object(d.a)(),Cvid:e.conversationId,CacheCorrelationId:b},O=JSON.stringify(f),j=JSON.stringify(n),v=Object(c.a)(e,"","LocalCacheTransactionCompleted",j,0,O);Object(a.a)(e,v,!1),u.g.info(Object(i.c)("{0} LocalCacheTransactionCompleted. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})),p=n(3172),f=n(1755);function O(e,t){var n,i;if(e.findResultSet&&e.findResultSet.length>0){var a=[];e.findResultSet.forEach((function(e){a.push(p.a[e.PersonaTypeString])})),b(e.findPeopleFeedbackManager,e.queryString,Object(r.a)(e.findResultSet),Object(f.a)()?e.findResultSet.map((function(e){return e.FeatureData?e.FeatureData:""})):null,a,null===(i=null===(n=e.peopleFeedbackState)||void 0===n?void 0:n.cache)||void 0===i?void 0:i.CorrelationId,t)}}n.d(t,"a",(function(){return O}))}}]);
//# sourceMappingURL=owa.54.js.map
self.scriptsLoaded['owa.54.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.54.js'] = (new Date()).getTime();