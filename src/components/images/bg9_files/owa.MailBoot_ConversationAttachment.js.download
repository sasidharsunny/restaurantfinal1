self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ConversationAttachment.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[515],{1379:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1679);function o(e){return Object(r.a)().attachments.get(e.Id)}},1467:function(e,t,n){"use strict";var r=n(77),o={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return o}));var a=new r.c((function(){return Promise.all([n.e(1),n.e(23),n.e(651)]).then(n.bind(null,16661))})),i=new r.a(a,(function(e){return e.subscribe})),c=new r.a(a,(function(e){return e.unsubscribe})),s=new r.b(a,(function(e){return e.getChannelId})),l=(new r.b(a,(function(e){return e.getChannelReady})),new r.a(a,(function(e){return e.setup}))),u=new r.a(a,(function(e){return e.initializeNotificationManager})),d=new r.b(a,(function(e){return e.getNotificationEmitter}))},1469:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},e)}},14971:function(e,t,n){var r=n(14972),o=n(131);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},14972:function(e,t,n){(t=e.exports=n(130)(!1)).push([e.i,'._1pPFwx5rYgxcgAElMzLbAd{display:block;width:261px}html[dir] ._1pPFwx5rYgxcgAElMzLbAd._3JHQes77teu7GToIsCc_xE,html[dir] ._1pPFwx5rYgxcgAElMzLbAd:focus,html[dir] ._1pPFwx5rYgxcgAElMzLbAd:hover{background:"[theme:neutralLighter, default:#f4f4f4]"}._1pPFwx5rYgxcgAElMzLbAd._3JHQes77teu7GToIsCc_xE ._302eciisr8EpJrDSwH_Sbx,._1pPFwx5rYgxcgAElMzLbAd:hover ._302eciisr8EpJrDSwH_Sbx{width:142px}._Y2ypFk_xp-nvQtuGu_-h{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;position:relative}._3wcJ_rB4jUxKLkaKrKj_GZ{display:block}html[dir] ._3wcJ_rB4jUxKLkaKrKj_GZ{margin:6px 8px}._2Pr_qifjTGwPB6L_eo24_B{font-size:24px;color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._2Pr_qifjTGwPB6L_eo24_B{background:transparent}._1Ra5rtzVEB6uogdqQiC2rx{display:block;white-space:nowrap;position:relative;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}html[dir] ._1Ra5rtzVEB6uogdqQiC2rx{padding:6px 4px}._3EsA8G8nIiVlrwi7EvfneN{font-size:14px}._3EsA8G8nIiVlrwi7EvfneN,._302eciisr8EpJrDSwH_Sbx{font-weight:400;max-width:194px}._302eciisr8EpJrDSwH_Sbx{font-size:11px}html[dir] ._302eciisr8EpJrDSwH_Sbx{padding-top:3px}._302eciisr8EpJrDSwH_Sbx .GeukVsgtTix5zrmhP2k1C{font-size:12px;font-weight:400;font-weight:600;position:relative;top:2px}html[dir=ltr] ._302eciisr8EpJrDSwH_Sbx .GeukVsgtTix5zrmhP2k1C{padding-right:4px}html[dir=rtl] ._302eciisr8EpJrDSwH_Sbx .GeukVsgtTix5zrmhP2k1C{padding-left:4px}._302eciisr8EpJrDSwH_Sbx ._1DD8d7Q5IxT7aE8KaVPUKa{color:#107c10}._302eciisr8EpJrDSwH_Sbx ._23Ys9CLV_lGJ3w0LIHTfLi{color:#e81123}._2Tuvy48k5aBpiLeRkrcceY{overflow:hidden;text-overflow:ellipsis}._2aO0rTKW0ac8YNFb8bLNnA{height:26px;width:52px;position:absolute;bottom:0;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}html[dir=ltr] ._2aO0rTKW0ac8YNFb8bLNnA{right:0}html[dir=rtl] ._2aO0rTKW0ac8YNFb8bLNnA{left:0}.CO4JS_CRPsg_js1AAXe-d{display:block;height:100%;width:26px;position:absolute;bottom:0}html[dir=ltr] .CO4JS_CRPsg_js1AAXe-d{right:0}html[dir=rtl] .CO4JS_CRPsg_js1AAXe-d{left:0}html[dir] .CO4JS_CRPsg_js1AAXe-d:focus,html[dir] .CO4JS_CRPsg_js1AAXe-d:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}.GeukVsgtTix5zrmhP2k1C{font-size:14px}html[dir] .GeukVsgtTix5zrmhP2k1C{margin:0}.KLhaPYQ6nYXemE5yXxev7{font-size:12px;font-weight:400;line-height:30px;cursor:pointer;width:261px;-webkit-box-sizing:border-box;box-sizing:border-box;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}html[dir=ltr] .KLhaPYQ6nYXemE5yXxev7{padding:0 20px 0 54px}html[dir=rtl] .KLhaPYQ6nYXemE5yXxev7{padding:0 54px 0 20px}html[dir] .KLhaPYQ6nYXemE5yXxev7:focus,html[dir] .KLhaPYQ6nYXemE5yXxev7:hover{background:"[theme:neutralLight, default:#eaeaea]"}html[dir] ._1pk_VDuef6gt4o_QRNLHAe{margin-top:-4px}._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator-itemName{display:none}._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator,._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-itemProgress,._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressBar,._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressTrack{height:4px}html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator,html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-itemProgress,html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressBar,html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressTrack{padding:0}._3n11Nj1NwjIZ39AgUcDMoH{position:fixed;pointer-events:"none";z-index:1000;top:0;font-size:12px;font-weight:400}html[dir] ._3n11Nj1NwjIZ39AgUcDMoH{border-width:1px;border-style:solid;padding:0 4px;background:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir=ltr] ._3n11Nj1NwjIZ39AgUcDMoH{left:0}html[dir=rtl] ._3n11Nj1NwjIZ39AgUcDMoH{right:0}',""]),t.locals={container:"_1pPFwx5rYgxcgAElMzLbAd",active:"_3JHQes77teu7GToIsCc_xE",secondLine:"_302eciisr8EpJrDSwH_Sbx",innerContainer:"_Y2ypFk_xp-nvQtuGu_-h",thumbnailDiv:"_3wcJ_rB4jUxKLkaKrKj_GZ",placeholder:"_2Pr_qifjTGwPB6L_eo24_B",infoDiv:"_1Ra5rtzVEB6uogdqQiC2rx",firstLine:"_3EsA8G8nIiVlrwi7EvfneN",icon:"GeukVsgtTix5zrmhP2k1C",success:"_1DD8d7Q5IxT7aE8KaVPUKa",failure:"_23Ys9CLV_lGJ3w0LIHTfLi",textOverFlow:"_2Tuvy48k5aBpiLeRkrcceY",actionsContainer:"_2aO0rTKW0ac8YNFb8bLNnA",menuButton:"CO4JS_CRPsg_js1AAXe-d",menuItem:"KLhaPYQ6nYXemE5yXxev7",progressIndicator:"_1pk_VDuef6gt4o_QRNLHAe",dragPreview:"_3n11Nj1NwjIZ39AgUcDMoH"}},14973:function(e,t,n){var r=n(14974),o=n(131);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},14974:function(e,t,n){(t=e.exports=n(130)(!1)).push([e.i,"._3h6BOcXe5rgJt2gWiPg7WW{overflow-y:auto;overflow-x:hidden}",""]),t.locals={container:"_3h6BOcXe5rgJt2gWiPg7WW"}},14975:function(e){e.exports=JSON.parse('{"a":"Zhc"}')},14976:function(e,t,n){var r=n(14977),o=n(131);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},14977:function(e,t,n){(t=e.exports=n(130)(!1)).push([e.i,'._2I3DVKJX90XpSU9E0jOrPI{color:"[theme:neutralDark, default:#212121]"}html[dir] ._2I3DVKJX90XpSU9E0jOrPI{border-radius:2px;border-color:transparent}html[dir] ._2I3DVKJX90XpSU9E0jOrPI:not(:hover){background-color:transparent}._2I3DVKJX90XpSU9E0jOrPI.ms-Button{min-width:50px}html[dir] ._2I3DVKJX90XpSU9E0jOrPI.ms-Button{padding:0}html[dir=ltr] .jflLAFNOz_OPbbqzYM9gl{margin-left:2px}html[dir=rtl] .jflLAFNOz_OPbbqzYM9gl{margin-right:2px}._1kEgpc1Wh6CbzQbd6iET2p{font-size:10px}html[dir] ._1kEgpc1Wh6CbzQbd6iET2p{margin:2px 6px 0 6px}._3JXvFMglzZ7tMbYPkjKuKC{font-size:14px;font-weight:400}html[dir] ._3JXvFMglzZ7tMbYPkjKuKC{margin:0}',""]),t.locals={button:"_2I3DVKJX90XpSU9E0jOrPI",icon:"jflLAFNOz_OPbbqzYM9gl",menuIcon:"_1kEgpc1Wh6CbzQbd6iET2p",label:"_3JXvFMglzZ7tMbYPkjKuKC"}},1527:function(e,t,n){"use strict";var r;function o(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1580:function(e,t){e.exports=function(e){return e instanceof Date}},1607:function(e,t,n){var r=n(1580),o=36e5,a=6e4,i=2,c=/[T ]/,s=/:/,l=/^(\d{2})$/,u=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],d=/^(\d{4})/,m=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],p=/^-(\d{2})$/,g=/^-?(\d{3})$/,h=/^-?(\d{2})-?(\d{2})$/,f=/^-?W(\d{2})$/,b=/^-?W(\d{2})-?(\d{1})$/,x=/^(\d{2}([.,]\d*)?)$/,w=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,v=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,C=/([Z+-].*)$/,_=/^(Z)$/,S=/^([+-])(\d{2})$/,k=/^([+-])(\d{2}):?(\d{2})$/;function I(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var o=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+o),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?i:Number(n);var y=function(e){var t,n={},r=e.split(c);s.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var o=C.exec(t);o?(n.time=t.replace(o[1],""),n.timezone=o[1]):n.time=t}return n}(e),E=function(e,t){var n,r=u[t],o=m[t];if(n=d.exec(e)||o.exec(e)){var a=n[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(n=l.exec(e)||r.exec(e)){var i=n[1];return{year:100*parseInt(i,10),restDateString:e.slice(i.length)}}return{year:null}}(y.date,n),P=E.year,B=function(e,t){if(null===t)return null;var n,r,o,a;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=p.exec(e))return r=new Date(0),o=parseInt(n[1],10)-1,r.setUTCFullYear(t,o),r;if(n=g.exec(e)){r=new Date(0);var i=parseInt(n[1],10);return r.setUTCFullYear(t,0,i),r}if(n=h.exec(e)){r=new Date(0),o=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,o,c),r}if(n=f.exec(e))return a=parseInt(n[1],10)-1,I(t,a);if(n=b.exec(e)){a=parseInt(n[1],10)-1;var s=parseInt(n[2],10)-1;return I(t,a,s)}return null}(E.restDateString,P);if(B){var A,D=B.getTime(),O=0;return y.time&&(O=function(e){var t,n,r;if(t=x.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*o;if(t=w.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*o+r*a;if(t=v.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var i=parseFloat(t[3].replace(",","."));return n%24*o+r*a+1e3*i}return null}(y.time)),y.timezone?A=function(e){var t,n;if(t=_.exec(e))return 0;if(t=S.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=k.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(y.timezone):(A=new Date(D+O).getTimezoneOffset(),A=new Date(D+O+A*a).getTimezoneOffset()),new Date(D+O+A*a)}return new Date(e)}},16855:function(e,t,n){"use strict";n.r(t);var r=n(49),o=n(460),a=n(680),i=n(85),c=n(269),s=n(5382),l=n(3),u=Object(l.mutatorAction)("setConversationAttachmentWellVisible",(function(e,t){e.isVisible=t})),d=n(12),m=n(10185),p=n(1),g=n(0),h=n(10188),f=Object(l.mutatorAction)("updateConversationAttachmentWellMaxHeight",(function(e){e.maxHeight=(window.innerHeight||document.body.clientHeight)-200})),b=n(10958),x=n(1665),w=n(14),v=n(666),C=n(335),_=n(2796),S=n(60),k=n(1733),I=n(5754),y=n(10187),E=n(10925),P=n(10292),B=n(1503),A=n(1379),D=n(2917),O=n(2934),j=n(1569),T=n(1349),N=n(1363),V=n(2006),H=n(7105),L=n(662),F=n(1416),W=n(59),z=n(14971),M=n(387).bind(z),R=Object(r.a)((function(e){var t=p.useRef(),n=p.useRef();p.useEffect((function(){if(n.current&&(n.current=!1,e.attachmentViewState.shouldShowContextMenu)){var r=t.current.parentElement.clientHeight,o=t.current.parentElement.scrollTop,a=t.current.offsetHeight,i=t.current.offsetTop;a+i>r+o?t.current.parentElement.scrollTop=a+i-r:i<o&&(t.current.parentElement.scrollTop=i)}}));var r=function(n){var r=Object(k.e)(e.attachmentViewState.strategy);if(r!==k.a.NoAction){var o=y.d.OnClick,a=o.name,i=o.customData;Object(c.p)(a,i(r)),Object(D.c)(e.attachmentViewState,F.c.ConversationAttachmentWell,e.instrumentationContext,e.parentItemId,!1,e.onBeforePreview,e.createImageGallery,t.current.parentElement,window)}},o=function(){var t;null===(t=e.onFocus)||void 0===t||t.call(e,e.attachmentViewState.attachmentId.Id)},a=Object(A.a)(e.attachmentViewState.attachmentId),i=!!a&&13===a.attachmentClass;return p.createElement("div",{"aria-label":a.model.Name,ref:t,onFocus:o,onKeyDown:function(e){e.keyCode!==S.a.enter&&e.keyCode!==S.a.space||r()},onMouseOver:o,className:M(z.container,{active:e.attachmentViewState.shouldShowContextMenu}),tabIndex:0,"data-is-focusable":!0,onClick:r,onContextMenu:function(t){t.preventDefault(),Object(s.a)(e.attachmentViewState,n.current=!0)}},p.createElement(j.b,{canDrag:function(){return!!Object(A.a)(e.attachmentViewState.attachmentId)},getDragData:function(){var t=Object(A.a)(e.attachmentViewState.attachmentId).model,n=Object(I.a)(t);return{itemType:T.a.Attachment,attachmentFile:n}},getDragPreview:function(){var t=document.createElement("div");return t.className=z.dragPreview,t.innerText=Object(A.a)(e.attachmentViewState.attachmentId).model.Name,t},xOffset:-12,yOffset:5},p.createElement("div",{className:z.innerContainer},function(t){var n=B.n.tryImportForRender();if(null==n?void 0:n(t.model)){var r=t.model.Name,o=Object(V.e)(r),a=null,i=Object(w.getIconClassName)("Photo2");return Object(N.h)(r)&&(a=o.small,i=o.small),p.createElement("div",{className:z.thumbnailDiv},p.createElement(O.d,{attachmentViewState:e.attachmentViewState,placeHolderCSSClass:M(i,z.placeholder),fileIconCssClass:a,imageLoadErrorCSSClass:o.small,thumbnailWidth:32,thumbnailHeight:32}))}return p.createElement(O.c,{attachmentId:e.attachmentViewState.attachmentId})}(a),function(t){var n=1!==t.type&&0===e.attachmentViewState.actionMessage?{text:Object(L.a)(e.itemReceivedTime),title:null,shouldDisplaySuccessIcon:!1,shouldDisplayFailureIcon:!1}:Object(E.a)(e.attachmentViewState,t,!1);return p.createElement("div",{className:z.infoDiv},p.createElement("div",{className:M(z.firstLine,z.textOverFlow),title:t.model.Name},t.model.Name),p.createElement("div",{className:M(z.secondLine,z.textOverFlow),title:n.title},n.shouldDisplaySuccessIcon?p.createElement(C.a,{iconName:"Accept",className:M(z.icon,z.success)}):null,n.shouldDisplayFailureIcon?p.createElement(C.a,{iconName:"Cancel",className:M(z.icon,z.failure)}):null,n.text))}(a),e.attachmentViewState.strategy.showActionsMenu&&e.attachmentViewState.shouldShowActionsContainer&&p.createElement("div",{className:z.actionsContainer},p.createElement(y.a,{attachmentViewState:e.attachmentViewState,isForImageView:!1,previewState:F.a.None,shouldNotHandleOnBlur:!0,action:i?y.c.addToCalendar:y.c.download,parentItemId:e.parentItemId}),p.createElement(v.a,{"data-is-focusable":!1,className:z.menuButton,onClick:function(t){t.stopPropagation(),Object(s.a)(e.attachmentViewState,n.current=!e.attachmentViewState.shouldShowContextMenu)},title:Object(d.b)(H.a),ariaLabel:Object(d.b)(H.a),onKeyDown:Y,iconProps:{iconName:e.attachmentViewState.shouldShowContextMenu?"ChevronUp":"ChevronDown",styles:{root:z.icon}}})))),Object(P.a)(e.attachmentViewState)?p.createElement("div",{className:z.progressIndicator},p.createElement(_.a,{percentComplete:e.attachmentViewState.actionCompletePercent})):null,e.attachmentViewState.shouldShowContextMenu?function(n){var r=y.e.tryImportForRender(),o=r?r(e.attachmentViewState,n,{viewState:e.attachmentViewState,previewPaneSelectionSource:F.c.ConversationAttachmentWell,parentItemId:e.parentItemId,isDraft:!1,isEdit:!1,onBeforePreview:e.onBeforePreview,createImageGallery:e.createImageGallery,instrumentationContext:e.instrumentationContext,targetWindow:window},e.parentItemId,null,t.current.parentElement,null):[];return p.createElement(p.Fragment,null,o.map((function(t){return p.createElement(J,{key:t.key,attachmentViewState:e.attachmentViewState,menuItem:t})})))}(a):null)})),J=Object(r.a)((function(e){var t=p.useCallback((function(t){t.stopPropagation(),e.menuItem.onClick(t,e.menuItem),Object(s.a)(e.attachmentViewState,!1)}),[e.menuItem,e.attachmentViewState]),n=p.useCallback((function(t){t.keyCode!==S.a.enter&&t.keyCode!==S.a.space||(t.stopPropagation(),e.menuItem.onClick(),Object(s.a)(e.attachmentViewState,!1))}),[e.menuItem,e.attachmentViewState]);return p.createElement("div",{tabIndex:0,"data-is-focusable":!0,className:z.menuItem,onClick:t,onKeyDown:n},e.menuItem.name)}));function Y(e){e.keyCode!==S.a.enter&&e.keyCode!==S.a.space||(W.g.info("AttachmentMenuButton.keyDown enter|space"),e.stopPropagation())}var K=n(14973),X=n(387).bind(K),G=Object(r.a)((function(e){var t=this;p.useEffect((function(){return r(),x.a.importAndExecute(r),function(){x.c.importAndExecute(r)}}),[]);var n=function(t){e.viewState.docViewAttachments.forEach((function(e){Object(h.a)(e,e.attachmentId.Id===t),e.shouldShowContextMenu&&e.attachmentId.Id!==t&&Object(s.a)(e,!1)}))},r=function(){f(e.viewState)},o=function(){return Object(g.__awaiter)(t,void 0,void 0,(function(){return Object(g.__generator)(this,(function(t){return[2,Object(b.a)(e.viewState,!0)]}))}))},a=!1,i=null,c=null,l=function(){var t=null==i?void 0:i.nextElementSibling;null==t||t.focus(),n(e.viewState.docViewAttachments[0].attachmentId.Id)};return p.createElement("div",{className:X("disableTextSelection","customScrollBar",K.container),style:{maxHeight:e.viewState.maxHeight+"px"}},p.createElement("div",{ref:function(e){return i=e},tabIndex:0,onFocus:function(){if(a){var t=null==c?void 0:c.previousElementSibling;null==t||t.focus(),n(e.viewState.docViewAttachments[e.viewState.docViewAttachments.length-1].attachmentId.Id)}else a=!0,l()}}),e.viewState.docViewAttachments.map((function(t){return p.createElement(R,{key:"convoWell_"+t.attachmentId.Id,attachmentViewState:t,parentItemId:e.viewState.parentItemIdMap[t.attachmentId.Id],itemReceivedTime:e.viewState.itemReceivedTimeMap[t.attachmentId.Id],instrumentationContext:e.instrumentationContext,onBeforePreview:e.onBeforePreview,onFocus:n,createImageGallery:o})})),p.createElement("div",{ref:function(e){return c=e},tabIndex:0,onFocus:l}))})),Q=n(14975),U=n(14976),$=Object(r.a)((function(e){p.useEffect((function(){!n.current&&e.viewState.docViewAttachments.length>0&&(n.current=!0,Object(c.p)("ConversationAttachmentWellButtonShown"))}));var t=p.useRef(),n=p.useRef(!1),r=function(){u(e.viewState,!1),e.viewState.docViewAttachments.forEach((function(e){Object(s.a)(e,!1)}))},l=e.viewState.docViewAttachments.length;if(0===l)return null;var g,h=l+(e.canLoadMore?"+":"");return p.createElement("div",{className:e.className||""},p.createElement("div",{ref:function(e){return t.current=e}},p.createElement(o.a,{onClick:function(){e.viewState.isVisible?r():(u(e.viewState,!0),Object(c.p)("ConversationAttachmentWellButtonClicked",null,{cosmosOnlyData:JSON.stringify({numberOfAttachments:e.viewState.docViewAttachments.length})}))},text:h,className:U.button,iconProps:{iconName:"Attach",styles:{root:U.icon}},menuIconProps:{iconName:"ChevronDown",styles:{root:U.menuIcon}},ariaLabel:(g=e.viewState.docViewAttachments.length,g>1?Object(d.c)(Object(d.b)(m.a),g):Object(d.c)(Object(d.b)(Q.a),g)),styles:{label:U.label}})),e.viewState.isVisible?p.createElement(a.a,{setInitialFocus:!0,isBeakVisible:!1,target:t.current,onDismiss:r,directionalHint:i.DirectionalHint.bottomRightEdge},p.createElement(G,{viewState:e.viewState,instrumentationContext:e.instrumentationContext,onBeforePreview:r})):null)}));n.d(t,"ConversationAttachmentWellButton",(function(){return $}))},1694:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},1718:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(e){return{id:e}}))},1719:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1874:function(e,t,n){"use strict";n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"k",(function(){return m})),n.d(t,"m",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"g",(function(){return h})),n.d(t,"j",(function(){return f})),n.d(t,"l",(function(){return b}));var r=n(77),o=n(1718);n.d(t,"n",(function(){return o.a}));var a=n(1694);n.d(t,"a",(function(){return a.a}));var i=n(1527);n.d(t,"d",(function(){return i.b})),n.d(t,"c",(function(){return i.a}));var c=n(1719);n.d(t,"b",(function(){return c.a}));var s=new r.c((function(){return Promise.all([n.e(1),n.e(33),n.e(70),n.e(724)]).then(n.bind(null,2900))})),l=new r.b(s,(function(e){return e.getSharingInformation})),u=new r.b(s,(function(e){return e.getSharingIssuesForSharingData})),d=new r.b(s,(function(e){return e.getInfoBarCreator})),m=new r.b(s,(function(e){return e.hasLargeDLRecipient})),p=new r.b(s,(function(e){return e.hasRecipientExpansionFailure})),g=new r.b(s,(function(e){return e.getGroupsAndSmallDLs})),h=new r.b(s,(function(e){return e.getInvididualRecipients})),f=new r.b(s,(function(e){return e.hasGetRecipientPermissionFailed})),b=new r.b(s,(function(e){return e.logSharingTipChangesForLinkRemoval}))},3204:function(e,t,n){"use strict";function r(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}n.d(t,"a",(function(){return r}))},396:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n(0),o=n(14),a=n(342),i=function(){return{position:"absolute",width:1,right:31,top:8,bottom:8}};function c(e){var t,n,a,c,s,l=e.semanticColors,u=e.palette,d=l.buttonBackground,m=l.buttonBackgroundPressed,p=l.buttonBackgroundHovered,g=l.buttonText,h=l.buttonTextHovered,f=l.buttonTextChecked,b=l.buttonTextCheckedHovered;return{root:{backgroundColor:d,color:g},rootHovered:{backgroundColor:p,color:h,selectors:(t={},t[o.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},t)},rootPressed:{backgroundColor:m,color:f},rootExpanded:{backgroundColor:m,color:f},rootChecked:{backgroundColor:m,color:f},rootCheckedHovered:{backgroundColor:m,color:b},rootDisabled:{selectors:(n={},n[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},n)},splitButtonContainer:{selectors:(a={},a[o.HighContrastSelector]={border:"none"},a)},splitButtonMenuButton:{color:u.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:u.neutralLight,selectors:(c={},c[o.HighContrastSelector]={color:"Highlight"},c)}}},splitButtonMenuButtonDisabled:{backgroundColor:l.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:l.buttonBackgroundDisabled}}},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},i()),{backgroundColor:u.neutralTertiaryAlt,selectors:(s={},s[o.HighContrastSelector]={backgroundColor:"WindowText"},s)}),splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:u.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:u.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:u.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:u.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:l.buttonText},splitButtonMenuIconDisabled:{color:l.buttonTextDisabled}}}function s(e){var t,n,c,s,l,u,d,m,p,g=e.palette,h=e.semanticColors;return{root:{backgroundColor:h.primaryButtonBackground,border:"1px solid "+h.primaryButtonBackground,color:h.primaryButtonText,selectors:(t={},t[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},t["."+a.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:g.white}}},t)},rootHovered:{backgroundColor:h.primaryButtonBackgroundHovered,border:"1px solid "+h.primaryButtonBackgroundHovered,color:h.primaryButtonTextHovered,selectors:(n={},n[o.HighContrastSelector]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},n)},rootPressed:{backgroundColor:h.primaryButtonBackgroundPressed,border:"1px solid "+h.primaryButtonBackgroundPressed,color:h.primaryButtonTextPressed,selectors:(c={},c[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},c)},rootExpanded:{backgroundColor:h.primaryButtonBackgroundPressed,color:h.primaryButtonTextPressed},rootChecked:{backgroundColor:h.primaryButtonBackgroundPressed,color:h.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:h.primaryButtonBackgroundPressed,color:h.primaryButtonTextPressed},rootDisabled:{selectors:(s={},s[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},s)},splitButtonContainer:{selectors:(l={},l[o.HighContrastSelector]={border:"none"},l)},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},i()),{backgroundColor:g.white,selectors:(u={},u[o.HighContrastSelector]={backgroundColor:"Window"},u)}),splitButtonMenuButton:{backgroundColor:h.primaryButtonBackground,color:h.primaryButtonText,selectors:(d={},d[o.HighContrastSelector]={backgroundColor:"WindowText"},d[":hover"]={backgroundColor:h.primaryButtonBackgroundHovered,selectors:(m={},m[o.HighContrastSelector]={color:"Highlight"},m)},d)},splitButtonMenuButtonDisabled:{backgroundColor:h.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:h.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:h.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:h.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:h.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:h.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:h.primaryButtonText},splitButtonMenuIconDisabled:{color:g.neutralTertiary,selectors:(p={},p[o.HighContrastSelector]={color:"GrayText"},p)}}}},4275:function(e){e.exports=JSON.parse('{"a":"Cqb"}')},460:function(e,t,n){"use strict";var r=n(0),o=n(1),a=n(391),i=n(458),c=n(457),s=n(14),l=n(230),u=n(392),d=n(425),m=n(396),p=Object(l.c)((function(e,t,n){var r=Object(u.a)(e),o=Object(d.a)(e),a={root:{minWidth:"80px",height:"32px"},label:{fontWeight:s.FontWeights.semibold}};return Object(s.concatStyleSets)(r,a,n?Object(m.a)(e):Object(m.b)(e),o,t)}));n.d(t,"a",(function(){return g}));var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.primary,n=void 0!==t&&t,c=e.styles,s=e.theme;return o.createElement(a.a,Object(r.__assign)({},this.props,{variantClassName:n?"ms-Button--primary":"ms-Button--default",styles:p(s,c,n),onRenderDescription:i.b}))},t=Object(r.__decorate)([Object(c.a)("DefaultButton",["theme","styles"],!0)],t)}(o.Component)},5754:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1333),o=n(1471),a=n(1553);function i(e){var t=e.AttachmentId.Id||"";if(Object(a.a)(e)){var n=e;return{fileType:r.a.Cloud,name:n.Name,size:n.Size,providerId:"",providerType:4,location:n.AttachLongPathName,providerEndpointUrl:"",isFolder:!1,thumbnailUrl:n.AttachmentThumbnailUrl,previewUrl:n.AttachmentPreviewUrl,fileId:t,fileParentId:"",type:n.__type}}return{attachmentItemId:t,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:o.c}}},6438:function(e){e.exports=JSON.parse('{"a":"Wpb"}')},7089:function(e){e.exports=JSON.parse('{"a":"_pb"}')},780:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"FindItemJsonRequest:#Exchange"},e)}},794:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(29),o=n(780);function a(e,t){return void 0===e||e.__type||(e=Object(o.a)(e)),Object(r.a)("FindItem",e,t)}},795:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"FindItemRequest:#Exchange"},e)}},8931:function(e){e.exports=JSON.parse('{"a":"cqb"}')},8932:function(e){e.exports=JSON.parse('{"a":"Bqb"}')},947:function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}}}]);
//# sourceMappingURL=owa.MailBoot~ConversationAttachment.js.map
self.scriptsLoaded['owa.MailBoot~ConversationAttachment.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ConversationAttachment.js'] = (new Date()).getTime();