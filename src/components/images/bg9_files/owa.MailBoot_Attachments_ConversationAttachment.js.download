self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Attachments~ConversationAttachment.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[214],{10185:function(e){e.exports=JSON.parse('{"a":"arb"}')},10186:function(e){e.exports=JSON.parse('{"a":"Aqb"}')},10187:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return s}));var a=n(77),r=n(8897);n.d(t,"d",(function(){return r.a}));var o=n(4318);n.d(t,"c",(function(){return o.a}));var i=n(9240);n.d(t,"a",(function(){return i.a}));var c=new a.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(14),n.e(23),n.e(30),n.e(28),n.e(33),n.e(40),n.e(41),n.e(43),n.e(45),n.e(62),n.e(63),n.e(67),n.e(91),n.e(103),n.e(216),n.e(215),n.e(214),n.e(217),n.e(472)]).then(n.bind(null,16306))})),d=Object(a.d)(c,(function(e){return e.AttachmentView})),s=new a.b(c,(function(e){return e.getContextMenus}))},10188:function(e,t,n){"use strict";var a=n(285);t.a=Object(a.action)("setShouldShowActionsContainer")((function(e,t){e.shouldShowActionsContainer=t}))},10189:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1503),r=n(1379);function o(e){var t=Object(r.a)(e.attachmentId);return!!t&&(!!Object(a.d)(t.model)||t.download.url&&t.info&&t.info.allowDownload)}},10190:function(e,t,n){"use strict";t.a={SurfaceAction:"Surface action",ContextMenu:"Context menu"}},10191:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return p}));var a=n(7089),r=n(12),o=n(269),i=n(1811),c=n(9815),d=n(2882),s=n(10190),l=n(1379),u=n(3960),b=n(3044);function m(e,t){var n=Object(l.a)(e.attachmentId),a=Object(u.a)(n);Object(o.p)("AddToCalendar",[t],{cosmosOnlyData:JSON.stringify({size:n.model.Size,fileType:a})}),n.model.Size>10485760||!e.attachmentId||!e.attachmentId.Id?Object(d.a)(e,0,15):(Object(i.B)(Object(i.j)(n.model.Size),.1,(function(t){Object(i.x)(e,t)}),e.attachmentId),Object(c.a)(e,0))}function p(e){var t=Object(l.a)(e.attachmentId);return Object(b.a)(i.a.ImportCalendarEventAttachment,e)&&t&&13===t.attachmentClass?{name:Object(r.b)(a.a),key:"AddToCalendar",onClick:function(){m(e,s.a.ContextMenu)}}:null}},10292:function(e,t,n){"use strict";function a(e){return e.actionCompletePercent>0&&e.actionCompletePercent<=1}n.d(t,"a",(function(){return a}))},10925:function(e,t,n){"use strict";var a=n(8931),r=n(4275),o=n(8932),i=n(10186),c=n(14969),d=n(2567),s=n(12),l=n(270),u=n(83),b=n(1363),m=n(59),p=n(14970),f=n(7092);function v(e){return Object(u.i)("woven-saveToCloud2-viewInOneDrive")?Object(s.b)(p.f):Object(u.i)("woven-saveToCloud2-editInOneDrive")?Object(s.b)(p.b):Object(u.i)("woven-saveToCloud2-editInApp")||Object(f.a)()?function(e){var t=Object(b.b)(e)||"",n=Object(b.f)(t);if(null===n)return m.d("invalid office app for save to cloud experiment string"),Object(s.b)(p.b);switch(n){case b.a.Word:return Object(s.b)(p.d);case b.a.Excel:return Object(s.b)(p.a);case b.a.PowerPoint:return Object(s.b)(p.c);default:return Object(l.a)(n)}}(e):Object(u.i)("woven-saveToCloud2-editOnline")?Object(s.b)(p.e):Object(u.i)("woven-saveToCloud2-openFolder")?Object(s.b)(p.f):Object(s.b)(p.e)}var h=n(9);function g(e){var t,n;return(null===(n=null===(t=null==e?void 0:e.info)||void 0===t?void 0:t.sharingInfo)||void 0===n?void 0:n.expirationDate)&&Object(h.Gb)(e.info.sharingInfo.expirationDate,Object(h.Pb)())}var O=n(1733),j=n(320),w=n(7353);function y(e,t,n,a){return void 0===a&&(a=""),t?Object(s.b)(c.h):n?v(a):Object(s.c)(Object(s.b)(c.i),e?Object(s.b)(i.a):Object(s.b)(d.a))}function D(e,t,n,b){var m;void 0===b&&(b="");var p,f=Object(j.a)(),v="GroupMailbox"==(null===(m=t.id.mailboxInfo)||void 0===m?void 0:m.type);if(0===e.actionMessage)return function(e,t){var n=Object(w.c)(e,t);return{text:n.text,title:n.title,shouldDisplaySuccessIcon:!1,shouldDisplayFailureIcon:!1,useExpiredAttachmentStyling:Object(u.i)("doc-attachment-referenceAttachmentExpiration")&&g(t)}}(e,t);var h=!1,D=!1;switch(e.actionMessage){case 1:p=function(e,t){if(t)return Object(s.b)(c.k);var n=Object(O.f)();return e?Object(s.c)(Object(s.b)(c.l),Object(s.b)(i.a)):Object(s.c)(Object(s.b)(c.m),n)}(f,v);break;case 5:p=Object(s.b)(c.b);break;case 2:p=y(f,v,n,b);break;case 3:p=y(f,v,n,b),h=!0;break;case 4:case 9:p=function(e,t){return t?Object(s.b)(c.f):Object(s.c)(Object(s.b)(c.g),e?Object(s.b)(i.a):Object(s.b)(d.a))}(f,v),D=!0;break;case 7:p=Object(s.b)(c.n);break;case 6:p=Object(s.b)(c.d);break;case 8:p=function(e,t){if(t)return Object(s.b)(c.o);var n=Object(O.f)();return e?Object(s.c)(Object(s.b)(c.p),n,Object(s.b)(i.a)):Object(s.c)(Object(s.b)(c.q),n)}(f,v);break;case 10:p=Object(s.b)(c.c);break;case 11:p=Object(s.b)(c.a);break;case 12:p=Object(s.b)(c.e),D=!0;break;case 16:p=Object(s.b)(c.c);break;case 14:p=Object(s.b)(o.a),h=!0;break;case 15:p=Object(s.b)(r.a),D=!0;break;case 13:p=Object(s.b)(a.a);break;case 17:p=Object(s.b)(c.n);break;case 18:p=Object(s.b)(c.j);break;default:Object(l.a)(e.actionMessage)}return{text:p,title:p,shouldDisplaySuccessIcon:h,shouldDisplayFailureIcon:D,useExpiredAttachmentStyling:!1}}n.d(t,"a",(function(){return D}))},10958:function(e,t,n){"use strict";var a=n(0),r=n(1503),o=n(59);function i(e,t){return void 0===t&&(t=!1),Object(a.__awaiter)(this,void 0,void 0,(function(){var n,i,c,d,s,l,u,b,m,p,f;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return n=[],[4,r.h.import()];case 1:return i=a.sent(),[4,r.k.import()];case 2:return c=a.sent(),t?[4,r.n.import()]:[3,4];case 3:return s=a.sent(),[3,5];case 4:s=null,a.label=5;case 5:d=s,l=t?e.docViewAttachments:e.imageViewAttachments,u=0,a.label=6;case 6:if(!(u<l.length))return[3,12];if(b=l[u],m=i(b.attachmentId),t&&!d(m.model))return[3,11];a.label=7;case 7:return a.trys.push([7,9,,10]),[4,c(b.attachmentId,e.isReadOnly)];case 8:return a.sent(),[3,10];case 9:return p=a.sent(),o.g.warn("Unable to refresh thumbnail image for "+b.attachmentId+". Got error "+p),[3,10];case 10:f={downloadUrl:m.download.url,id:b.attachmentId,previewUrl:m.previewImage.url,thumbnailUrl:m.thumbnailImage.url},n.push(f),a.label=11;case 11:return u++,[3,6];case 12:return[2,n]}}))}))}n.d(t,"a",(function(){return i}))},13167:function(e){e.exports=JSON.parse('{"a":"Xkb"}')},13168:function(e){e.exports=JSON.parse('{"a":"Wkb"}')},1345:function(e,t,n){"use strict";var a={alert:"alert",alertdialog:"alertdialog",application:"application",article:"article",banner:"banner",button:"button",cell:"cell",checkbox:"checkbox",columnheader:"columnheader",combobox:"combobox",complementary:"complementary",contentinfo:"contentinfo",definition:"definition",dialog:"dialog",directory:"directory",document:"document",feed:"feed",figure:"figure",form:"form",grid:"grid",gridcell:"gridcell",group:"group",heading:"heading",img:"img",link:"link",list:"list",listbox:"listbox",listitem:"listitem",log:"log",main:"main",marquee:"marquee",math:"math",menu:"menu",menubar:"menubar",menuitem:"menuitem",menuitemcheckbox:"menuitemcheckbox",menuitemradio:"menuitemradio",navigation:"navigation",note:"note",option:"option",presentation:"presentation",progressbar:"progressbar",radio:"radio",radiogroup:"radiogroup",region:"region",row:"row",rowgroup:"rowgroup",rowheader:"rowheader",scrollbar:"scrollbar",search:"search",searchbox:"searchbox",separator:"separator",slider:"slider",spinbutton:"spinbutton",status:"status",switch:"switch",tab:"tab",table:"table",tablist:"tablist",tabpanel:"tabpanel",term:"term",textbox:"textbox",timer:"timer",toolbar:"toolbar",tooltip:"tooltip",tree:"tree",treegrid:"treegrid",treeitem:"treeitem"},r=0;function o(e){return void 0===e&&(e="id"),""+e+r++}function i(e){return Array.isArray(e)?e.join(" "):e}function c(e){if(!e)return null;for(var t={},n=Object.keys(e),a=0;a<n.length;a++){switch(n[a]){case"role":t.role=e.role;break;case"id":t.id=e.id;break;case"activeDescendant":t["aria-activedescendant"]=e.activeDescendant;break;case"atomic":t["aria-atomic"]=e.atomic;break;case"autocomplete":t["aria-autocomplete"]=e.autocomplete;break;case"busy":t["aria-busy"]=e.busy;break;case"checked":t["aria-checked"]=e.checked;break;case"controls":t["aria-controls"]=i(e.controls);break;case"describedBy":t["aria-describedby"]=i(e.describedBy);break;case"disabled":t["aria-disabled"]=e.disabled;break;case"dropEffect":t["aria-dropeffect"]=i(e.dropEffect);break;case"expanded":t["aria-expanded"]=e.expanded;break;case"flowTo":t["aria-flowto"]=i(e.flowTo);break;case"grabbed":t["aria-grabbed"]=e.grabbed;break;case"hasPopup":t["aria-haspopup"]=e.hasPopup;break;case"hidden":t["aria-hidden"]=e.hidden;break;case"invalid":t["aria-invalid"]=e.invalid;break;case"label":t["aria-label"]=e.label;break;case"labelledBy":t["aria-labelledby"]=i(e.labelledBy);break;case"level":t["aria-level"]=e.level;break;case"live":t["aria-live"]=e.live;break;case"multiline":t["aria-multiline"]=e.multiline;break;case"multiselectable":t["aria-multiselectable"]=e.multiselectable;break;case"orientation":t["aria-orientation"]=e.orientation;break;case"owns":t["aria-owns"]=i(e.owns);break;case"positionInSet":t["aria-posinset"]=e.positionInSet;break;case"pressed":t["aria-pressed"]=e.pressed;break;case"readonly":t["aria-readonly"]=e.readonly;break;case"relevant":t["aria-relevant"]=i(e.relevant);break;case"required":t["aria-required"]=e.required;break;case"selected":t["aria-selected"]=e.selected;break;case"setSize":t["aria-setsize"]=e.setSize;break;case"sort":t["aria-sort"]=e.sort;break;case"valueMax":t["aria-valuemax"]=e.valueMax;break;case"valueMin":t["aria-valuemin"]=e.valueMin;break;case"valueNow":t["aria-valuenow"]=e.valueNow;break;case"valueText":t["aria-valuetext"]=e.valueText}}return t}n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c}))},1349:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={FavoriteNode:"favoritenode",InboxRule:"inboxrule",LocalFile:"Files",MailFolderNode:"mailfoldernode",MailListItemPart:"maillistitempart",MailListRow:"maillistrow",MultiMailListConversationRows:"multimaillistconversationrows",MultiMailListMessageRows:"multimaillistmessagerows",ReadWriteRecipient:"recipient",NoteFeedItem:"notefeeditem",Todo:"todo",Attachment:"attachment",CommandBarEditorButton:"commandbareditorbutton"}},14607:function(e){e.exports=JSON.parse('{"a":"Fqb","c":"Gqb","d":"Hqb","b":"Iqb","e":"Jqb"}')},14608:function(e,t,n){var a=n(14609),r=n(131);"string"==typeof a&&(a=[[e.i,a]]);for(var o=0;o<a.length;o++)r.loadStyles(a[o][1],!1);a.locals&&(e.exports=a.locals)},14609:function(e,t,n){(t=e.exports=n(130)(!1)).push([e.i,'._2KRgryadS8K-_TLdBoNKmd{font-size:14px;color:"[theme:neutralSecondary, default:#666666]";height:25px;width:26px}html[dir] ._2KRgryadS8K-_TLdBoNKmd{padding:4px;text-align:center}._2KRgryadS8K-_TLdBoNKmd:focus,._2KRgryadS8K-_TLdBoNKmd:hover,._1eq1P1PoHUzBriyfNWVd1T{color:"[theme:neutralSecondary, default:#666666]"}._1eq1P1PoHUzBriyfNWVd1T{display:block}.HDG8P1QaVRBOeSU0W5zmW{bottom:0;position:absolute;color:"[theme:white, default:#ffffff]"}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW{right:26px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW{left:26px}.HDG8P1QaVRBOeSU0W5zmW:focus,.HDG8P1QaVRBOeSU0W5zmW:hover{color:"[theme:white, default:#ffffff]"}html[dir] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir] .HDG8P1QaVRBOeSU0W5zmW:hover{background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW:hover{border-bottom-right-radius:2px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW:hover{border-bottom-left-radius:2px}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW._2RdXhaKvBvt2MX9AyW7pcR{right:52px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW._2RdXhaKvBvt2MX9AyW7pcR{left:52px}._2ebptdF8eCnt_2-FT7dzaH{font-size:14px}html[dir] ._2ebptdF8eCnt_2-FT7dzaH{margin:0}html[dir] .IPPU7NtLHAzlPwHTIXmXp:focus,html[dir] .IPPU7NtLHAzlPwHTIXmXp:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] .rPIl3tr-13EegQ4JcXUy_,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq,html[dir] ._17q1sDoo-1SD8o99_vx_Wl,html[dir] ._1H8nRWpPKM9iogJAm6ze6p,html[dir] ._3bO0ii_CywH_7ysZAUsxkB,html[dir] ._1E-xlZkNQ0oWd42XQohXqv{margin:0;background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] .rPIl3tr-13EegQ4JcXUy_:focus,html[dir] .rPIl3tr-13EegQ4JcXUy_:hover,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq:focus,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq:hover,html[dir] ._17q1sDoo-1SD8o99_vx_Wl:focus,html[dir] ._17q1sDoo-1SD8o99_vx_Wl:hover,html[dir] ._1H8nRWpPKM9iogJAm6ze6p:focus,html[dir] ._1H8nRWpPKM9iogJAm6ze6p:hover,html[dir] ._3bO0ii_CywH_7ysZAUsxkB:focus,html[dir] ._3bO0ii_CywH_7ysZAUsxkB:hover,html[dir] ._1E-xlZkNQ0oWd42XQohXqv:focus,html[dir] ._1E-xlZkNQ0oWd42XQohXqv:hover{background:"[theme:themeTertiary, default:#71AFE5]"}html[dir] .rPIl3tr-13EegQ4JcXUy_{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}',""]),t.locals={actionButton:"_2KRgryadS8K-_TLdBoNKmd",actionButtonForDocViewInCompose:"_1eq1P1PoHUzBriyfNWVd1T",actionButtonForImageView:"HDG8P1QaVRBOeSU0W5zmW",extraRightPadding:"_2RdXhaKvBvt2MX9AyW7pcR",icon:"_2ebptdF8eCnt_2-FT7dzaH",default:"IPPU7NtLHAzlPwHTIXmXp",edit:"rPIl3tr-13EegQ4JcXUy_",notSelectedAndSaving:"_3vsJWDG9Ae71RWCd-gnOXq",selected:"_17q1sDoo-1SD8o99_vx_Wl",selectedAndPending:"_1H8nRWpPKM9iogJAm6ze6p",selectedAndSaving:"_3bO0ii_CywH_7ysZAUsxkB",thematic:"_1E-xlZkNQ0oWd42XQohXqv"}},14969:function(e){e.exports=JSON.parse('{"k":"dqb","l":"eqb","m":"fqb","j":"gqb","h":"hqb","i":"iqb","f":"jqb","g":"kqb","o":"lqb","p":"mqb","q":"nqb","b":"oqb","n":"pqb","d":"qqb","c":"rqb","a":"sqb","e":"tqb"}')},14970:function(e){e.exports=JSON.parse('{"f":"uqb","b":"vqb","d":"wqb","a":"xqb","c":"yqb","e":"zqb"}')},1516:function(e,t,n){"use strict";var a,r;function o(e){a=e}function i(){return a}function c(e){r=e}function d(){return r}n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return d}))},1569:function(e,t,n){"use strict";var a=n(0),r=n(1),o=n(285),i=Object(o.action)("setDragState")((function(e,t){e.isBeingDragged=t})),c=n(1516),d=n(1601),s=n(70),l=n(59),u=n(1345);n.d(t,"a",(function(){return b}));var b=function(){function e(e){var t=this;this.props=e,this.initialPageX=0,this.initialPageY=0,this.dragHelperElement=null,this.isPotentialDrag=!1,this.isDragging=!1,this.onDragStart=function(e){e.dataTransfer.clearData(),t.isDragAllowed()?(e.stopPropagation(),t.setDragStateAndData(e),e.dataTransfer.effectAllowed="copyMove",t.onDragStartInternal(e.pageX,e.pageY),t.overrideDefaultDragPreviewImage(e.dataTransfer)):t.props.showDefaultNoDragImage&&(t.overrideDefaultNoDragImage(e.dataTransfer),e.dataTransfer.setData("text","nodrop"),e.dataTransfer.effectAllowed="none")},this.onDragEnd=function(e){if(t.isDragging){t.isDragging=!1;var n=t.props.onDragEnd,a=e?e.dataTransfer.dropEffect:null;(Object(s.e)()||Object(s.g)())&&(a=Object(c.b)()),n&&n(t.props.getDragData(),a)}t.resetDragStateAndData(),t.removeDragHelperElement()},this.onMouseDown=function(e){!d.a&&0==e.button&&t.isDragAllowed()&&(t.initialPageX=e.pageX,t.initialPageY=e.pageY,t.isPotentialDrag=!0,document.body.addEventListener("mousemove",t.onMouseMove),document.body.addEventListener("mouseup",t.onMouseUp)),t.props.onMouseDown&&t.props.onMouseDown(e)},this.refCallback=function(e){t.div=e,t.div&&t.div.addEventListener("mousedown",t.onMouseDown)},this.onMouseMove=function(e){var n=e.pageX,a=e.pageY;(Math.abs(t.initialPageX-n)>=d.b||Math.abs(t.initialPageY-a)>=d.b)&&(t.removeMouseMoveAndUpEventListeners(),t.isPotentialDrag&&(t.isPotentialDrag=!1,(Object(s.e)()||Object(s.g)())&&window.getSelection().removeAllRanges(),t.isDragAllowed()&&(t.dragHelperElement=t.getDragHelperElement(),document.body.appendChild(t.dragHelperElement))),t.dragHelperElement&&(t.dragHelperElement.addEventListener("dragstart",(function(e){t.onDragStartHelperElement(e)})),t.dragHelperElement.addEventListener("dragend",(function(e){t.onDragEnd(e)})),t.dragHelperElement.dragDrop(),setTimeout(t.onDragEnd,0)))},this.onMouseUp=function(e){t.removeMouseMoveAndUpEventListeners()},this.onDragStartHelperElement=function(e){var n=e;n.stopPropagation(),n.dataTransfer.effectAllowed="copyMove",t.setDragStateAndData(n),t.onDragStartInternal(n.pageX,n.pageY)},this.removeMouseMoveAndUpEventListeners=function(){document.body.removeEventListener("mousemove",t.onMouseMove),document.body.removeEventListener("mouseup",t.onMouseUp)},this.removeDragHelperElement=function(){if(document.body)document.body.contains(t.dragHelperElement)&&(document.body.removeChild(t.dragHelperElement),t.dragHelperElement=null);else{var e=t.dragHelperElement?t.dragHelperElement.innerHTML:"null";l.d("removeDragHelperElement: "+e)}}}return e.prototype.updateProps=function(e){this.props=e},e.prototype.onUnmount=function(){this.onDragEnd(null),d.a||this.removeMouseMoveAndUpEventListeners(),this.div.removeEventListener("mousedown",this.onMouseDown)},e.prototype.getDiv=function(){return this.div},e.prototype.onDragStartInternal=function(e,t){this.isDragging=!0;var n=this.props.onDragStart;n&&n(this.props.getDragData(),e,t)},e.prototype.setDragStateAndData=function(e){this.props.dragViewState&&i(this.props.dragViewState,!0);var t=this.props.getDragData();try{e.dataTransfer.setData(t.itemType,JSON.stringify(t))}catch(n){e.dataTransfer.setData("text",JSON.stringify(t))}Object(c.c)(t.itemType)},e.prototype.resetDragStateAndData=function(){this.props.dragViewState&&i(this.props.dragViewState,!1),Object(c.c)(null),Object(c.d)(null)},e.prototype.overrideDefaultDragPreviewImage=function(e){if(d.a){this.dragHelperElement=this.getDragHelperElement(),document.body.appendChild(this.dragHelperElement);var t=this.props.xOffset?this.props.xOffset:0,n=this.props.yOffset?this.props.yOffset:0;e.setDragImage(this.dragHelperElement,t,n)}},e.prototype.overrideDefaultNoDragImage=function(e){d.a&&(this.dragHelperElement=document.createElement("div"),this.dragHelperElement.style.display="none",document.body.appendChild(this.dragHelperElement),e.setDragImage(this.dragHelperElement,0,0))},e.prototype.getDragHelperElement=function(){var e=this.props.getDragPreview(this.props.getDragData());return e.style.top="0px",e.style.left="0px",e.style.zIndex="-1000",e.style.position="fixed",e},e.prototype.isDragAllowed=function(){return!this.props.canDrag||this.props.canDrag()},e}();t.b=r.forwardRef((function(e,t){r.useEffect((function(){return function(){n.current.onUnmount()}}),[]);var n=r.useRef(new b(e));return n.current.updateProps(e),r.useImperativeHandle(t,(function(){return{getDiv:function(){return n.current.getDiv()}}}),[]),d.a?r.createElement("div",Object(a.__assign)({draggable:!e.isDraggable||e.isDraggable()},Object(u.b)(e.ariaProps),{className:e.classNames,ref:n.current.refCallback,onDragStart:n.current.onDragStart,onDragEnd:n.current.onDragEnd}),e.children):r.createElement("div",Object(a.__assign)({className:e.classNames,ref:n.current.refCallback},Object(u.b)(e.ariaProps)),e.children)}))},1601:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));var a=5,r="undefined"!=typeof window&&window.hasOwnProperty("DataTransfer")&&DataTransfer.prototype.setDragImage},1780:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(1681);function r(e){return i(e.type)}function o(e){return i(Object(a.a)(e))}function i(e){return 1===e||3===e}},2075:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(0),r=n(1),o=n(273),i=Object(o.a)(),c=.01,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderProgress=function(e){var n=t.props,a=n.ariaValueText,o=n.barHeight,d=n.className,s=n.styles,l=n.theme,u="number"==typeof t.props.percentComplete?Math.min(100,Math.max(0,100*t.props.percentComplete)):void 0,b=i(s,{theme:l,className:d,barHeight:o,indeterminate:void 0===u}),m={width:void 0!==u?u+"%":void 0,transition:void 0!==u&&u<c?"none":void 0},p=void 0!==u?0:void 0,f=void 0!==u?100:void 0,v=void 0!==u?Math.floor(u):void 0;return r.createElement("div",{className:b.itemProgress},r.createElement("div",{className:b.progressTrack}),r.createElement("div",{className:b.progressBar,style:m,role:"progressbar","aria-valuemin":p,"aria-valuemax":f,"aria-valuenow":v,"aria-valuetext":a}))},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.barHeight,n=e.className,o=e.label,c=void 0===o?this.props.title:o,d=e.description,s=e.styles,l=e.theme,u=e.progressHidden,b=e.onRenderProgress,m=void 0===b?this._onRenderProgress:b,p="number"==typeof this.props.percentComplete?Math.min(100,Math.max(0,100*this.props.percentComplete)):void 0,f=i(s,{theme:l,className:n,barHeight:t,indeterminate:void 0===p});return r.createElement("div",{className:f.root},c?r.createElement("div",{className:f.itemName},c):null,u?null:m(Object(a.__assign)(Object(a.__assign)({},this.props),{percentComplete:p}),this._onRenderProgress),d?r.createElement("div",{className:f.itemDescription},d):null)},t.defaultProps={label:"",description:"",width:180},t}(r.Component)},2261:function(e,t,n){"use strict";function a(e,t){(t||window).open(e,"_blank")}n.d(t,"a",(function(){return a}))},2308:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2261),r=n(269),o=n(70);function i(e,t,n,i){var c;if(Object(r.p)("downloadFileFromUrl",{isBrowserIE:Object(o.g)(),urlLength:e.length}),t||Object(o.g)())Object(a.a)(e);else{var d=document.createElement("a");d.style.display="none",d.href=e,d.download=i||"",n||(n=(null===(c=document.activeElement)||void 0===c?void 0:c.parentElement)||document.body),n.appendChild(d),d.click(),n.removeChild(d)}}},2567:function(e){e.exports=JSON.parse('{"a":"QVa"}')},2796:function(e,t,n){"use strict";var a=n(450),r=n(2075),o=n(0),i=n(14),c=n(230),d=n(188),s={root:"ms-ProgressIndicator",itemName:"ms-ProgressIndicator-itemName",itemDescription:"ms-ProgressIndicator-itemDescription",itemProgress:"ms-ProgressIndicator-itemProgress",progressTrack:"ms-ProgressIndicator-progressTrack",progressBar:"ms-ProgressIndicator-progressBar"},l=Object(c.c)((function(){return Object(i.keyframes)({"0%":{left:"-30%"},"100%":{left:"100%"}})})),u=Object(c.c)((function(){return Object(i.keyframes)({"100%":{right:"-30%"},"0%":{right:"100%"}})}));n.d(t,"a",(function(){return b}));var b=Object(a.a)(r.a,(function(e){var t,n,a,r=Object(d.a)(e.theme),c=e.className,b=e.indeterminate,m=e.theme,p=e.barHeight,f=void 0===p?2:p,v=m.palette,h=m.semanticColors,g=m.fonts,O=Object(i.getGlobalClassNames)(s,m),j=v.neutralLight;return{root:[O.root,g.medium,c],itemName:[O.itemName,i.noWrap,{color:h.bodyText,paddingTop:4,lineHeight:20}],itemDescription:[O.itemDescription,{color:h.bodySubtext,fontSize:g.small.fontSize,lineHeight:18}],itemProgress:[O.itemProgress,{position:"relative",overflow:"hidden",height:f,padding:"8px 0"}],progressTrack:[O.progressTrack,{position:"absolute",width:"100%",height:f,backgroundColor:j,selectors:(t={},t[i.HighContrastSelector]={borderBottom:"1px solid WindowText"},t)}],progressBar:[{backgroundColor:v.themePrimary,height:f,position:"absolute",transition:"width .3s ease",width:0,selectors:Object(o.__assign)((n={},n[i.HighContrastSelector]={backgroundColor:"highlight"},n),Object(i.getEdgeChromiumNoHighContrastAdjustSelector)())},b?{position:"absolute",minWidth:"33%",background:"linear-gradient(to right, "+j+" 0%, "+v.themePrimary+" 50%, "+j+" 100%)",animation:(r?u():l())+" 3s infinite",selectors:(a={},a[i.HighContrastSelector]={background:"highlight"},a)}:{transition:"width .15s linear"},O.progressBar]}}),void 0,{scope:"ProgressIndicator"})},2917:function(e,t,n){"use strict";var a=n(77),r=n(1416),o=n(0),i=n(1503),c=n(1379),d=n(2308),s=n(1871);function l(e,t,n){return Object(o.__awaiter)(this,void 0,void 0,(function(){var a,r;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return(a=Object(c.a)(e))?Object(i.d)(a.model)?[4,s.e.import()]:[3,2]:[2];case 1:return o.sent()(a.model),[3,3];case 2:(r=a.download.url)&&Object(d.a)(r,t,n),o.label=3;case 3:return[2]}}))}))}n.d(t,"c",(function(){return b})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return r.c})),n.d(t,"b",(function(){return l}));var u=new a.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(14),n.e(23),n.e(30),n.e(28),n.e(33),n.e(40),n.e(41),n.e(43),n.e(45),n.e(62),n.e(63),n.e(67),n.e(91),n.e(103),n.e(216),n.e(215),n.e(214),n.e(217),n.e(472)]).then(n.bind(null,16959))})),b=new a.a(u,(function(e){return e.clickAttachment})).importAndExecute,m=new a.a(u,(function(e){return e.previewAttachment}))},2934:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(77),r=new a.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(14),n.e(23),n.e(30),n.e(28),n.e(33),n.e(40),n.e(41),n.e(43),n.e(45),n.e(62),n.e(63),n.e(67),n.e(91),n.e(103),n.e(216),n.e(215),n.e(214),n.e(217),n.e(472)]).then(n.bind(null,5156))})),o=Object(a.d)(r,(function(e){return e.AttachmentThumbnailView})),i=Object(a.d)(r,(function(e){return e.AttachmentIconView})),c=Object(a.d)(r,(function(e){return e.AttachmentDocInfoView})),d=Object(a.d)(r,(function(e){return e.AttachmentDocView}))},3044:function(e,t,n){"use strict";function a(e,t){return-1!==t.strategy.supportedMenuActions.indexOf(e)}n.d(t,"a",(function(){return a}))},4318:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.saveToCloud=0]="saveToCloud",e[e.download=1]="download",e[e.addToCalendar=2]="addToCalendar",e[e.editAndReply=3]="editAndReply",e[e.openNewTabAndSaveToCloud=4]="openNewTabAndSaveToCloud",e[e.openAndEdit=5]="openAndEdit"}(a||(a={}))},7088:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u}));var a=n(10188),r=n(4571),o=n(4572),i={},c=null;function d(e,t){i[e.attachmentId.Id]&&(clearTimeout(i[e.attachmentId.Id]),i[e.attachmentId.Id]=null),c=e.attachmentId.Id,Object(a.a)(e,!0),t&&!Object(o.a)(e)&&Object(r.a)(e,!0)}function s(e,t){i[e.attachmentId.Id]&&clearTimeout(i[e.attachmentId.Id]),i[e.attachmentId.Id]=setTimeout((function(){Object(a.a)(e,!1),t&&!Object(o.a)(e)&&Object(r.a)(e,!1),e.attachmentId.Id===c&&(c=null),i[e.attachmentId.Id]=null}),40)}function l(e,t){Object(a.a)(e,!0),t&&!Object(o.a)(e)&&Object(r.a)(e,!0)}function u(e,t){e.attachmentId.Id!==c&&(Object(a.a)(e,!1),t&&!Object(o.a)(e)&&Object(r.a)(e,!1))}},7090:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(1379),r=n(1363),o=n(3204);function i(e){var t=Object(a.a)(e),n=Object(r.c)(t.model.Name||"");return""!==Object(o.a)(n)&&"Visio"!==Object(o.a)(n)}},7091:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(270),r=n(1811),o=n(10189),i=n(83),c=n(320),d=n(4318),s=n(3044),l=n(7090),u=n(7092);function b(e,t){if(0!==t.ongoingAction||!t.strategy.showActionsMenu)return!0;switch(e){case d.a.addToCalendar:return!1;case d.a.download:return!Object(s.a)(r.a.Download,t)||!Object(o.a)(t);case d.a.saveToCloud:case d.a.openNewTabAndSaveToCloud:return!t.isReadOnly||!function(e,t){var n,a=Object(c.a)()&&"GroupMailbox"===(null===(n=e.attachmentId.mailboxInfo)||void 0===n?void 0:n.type),o=!1;o=t===d.a.openNewTabAndSaveToCloud?Object(u.a)()&&Object(l.a)(e.attachmentId):Object(i.i)("woven-saveToCloud2-viewInOneDrive")||Object(i.i)("woven-saveToCloud2-editInOneDrive")||Object(i.i)("woven-saveToCloud2-editInApp")||Object(i.i)("woven-saveToCloud2-editOnline")||Object(i.i)("woven-saveToCloud2-openFolder")||Object(i.i)("wvn-productizeSTCHoverActionOnly")||Object(i.i)("wvn-productizeSTCHoverAndCloud")||Object(i.i)("wvn-productizeSTCHoverAndCloudWithTeaching")||Object(i.i)("wvn-productizeSTCChicletAndPreview")||Object(u.a)();return o&&Object(s.a)(r.a.SaveToCloud,e)&&Object(r.t)(e)&&!a}(t,e);case d.a.editAndReply:return!t.isReadOnly||!Object(l.a)(t.attachmentId);case d.a.openAndEdit:return!t.isReadOnly||!(Object(i.i)("wvn-productizeSTCHoverAndCloud")||Object(i.i)("wvn-productizeSTCHoverAndCloudWithTeaching")||Object(i.i)("wvn-productizeSTCChicletAndPreview"))||2!==t.actionMessage&&3!==t.actionMessage;default:return Object(a.a)(e)}}},7092:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(555),r=n(83);function o(){return Object(r.i)("woven-newTabExperiment")&&Object(a.d)()}},7105:function(e){e.exports=JSON.parse('{"a":"bqb"}')},7353:function(e,t,n){"use strict";var a=n(313);function r(e,t){var n,r=e?null===(n=Object(a.parse)(e))||void 0===n?void 0:n.hostname:null;return null!=r?r:t}var o=n(9963),i=n(83),c=n(1363),d=n(13168),s=n(12);function l(e,t){return u(t,e.isCloudy)}function u(e,t){var n=e.model.Name;if(t){var a=e,r=void 0;(r=Object(i.i)("doc-unwrap-safelinks")?a.originalUrl:a.openUrl)||(r=e.model.AttachLongPathName),r&&(n=Object(s.c)(Object(s.b)(d.a),e.model.Name,r))}return n}function b(e,t){var n,a;if(e.isCloudy){var i=t.model;if(e.isReadOnly)return{text:r(t.openUrl,i.AttachLongPathName||null),title:null};var d=null===(a=null===(n=t.info)||void 0===n?void 0:n.sharingInfo)||void 0===a?void 0:a.expirationDate,s=Object(o.a)(i.PermissionType,i.ProviderType,d,e.isPlaceholderAttachment);return{text:s,title:s}}var l=t.model.Size>0?Object(c.i)(t.model.Size):null;return{text:l,title:l}}n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return b}))},8897:function(e,t,n){"use strict";t.a={OnClick:{name:"AttachmentOnClick",customData:function(e){return[e]}}}},8898:function(e,t,n){"use strict";var a=n(1323);t.a=function(e){var t,n,r=e&&Object(a.v)(e);return null===(n=null===(t=(null==r?void 0:r.From)||(null==r?void 0:r.Sender))||void 0===t?void 0:t.Mailbox)||void 0===n?void 0:n.EmailAddress}},9240:function(e,t,n){"use strict";var a=n(49),r=n(666),o=n(60),i=n(1416),c=n(59),d=n(1),s=n(4318),l=n(7088),u=n(270),b=n(12),m=n(7089),p=n(6438),f=n(14607),v=n(7090);var h=n(7091),g=n(0),O=n(269),j=n(1811),w=n(10190),y=n(10191),D=n(1503),S=n(1379),A=n(3960),I=n(2917),C=n(2308),k=n(362),x=n(4574),T=n(1871),P=n(759),E=n(24),_="/"+Object(g.__spread)(["mail"],Object(P.a)().split("/").slice(1)).join("/")+"deeplink/saveAndEdit/";var H=n(8898);function N(e,t,n,a){var r,o,d,l=Object(i.k)(a);switch(e){case s.a.addToCalendar:Object(y.a)(t,w.a.SurfaceAction);break;case s.a.download:!function(e,t){var n,a;Object(g.__awaiter)(this,void 0,void 0,(function(){var r,o,i,d,s,l,u,b;return Object(g.__generator)(this,(function(m){switch(m.label){case 0:return(r=Object(S.a)(e.attachmentId))?Object(D.d)(r.model)?[4,T.e.import()]:[3,2]:(c.d("AttachmentSurfaceActionButton.downloadAttachment attachmentModel is null"),[2]);case 1:return m.sent()(r.model),[3,3];case 2:Object(C.a)(r.download.url,e.isCloudy,document.body),m.label=3;case 3:return o=Object(A.a)(r),Object(O.p)("AttachmentDownload",{entryPoint:"SurfaceAction",isCloudy:e.isCloudy,isCompose:!e.isReadOnly},{cosmosOnlyData:JSON.stringify({size:r.model.Size,fileType:o,attachmentId:null===(n=r.model.AttachmentId)||void 0===n?void 0:n.Id})}),i=null==t?void 0:t.Id,s=(d=O.m).importAndExecute,l=["SavedAttachment"],b={},(u=i)?[4,Object(x.a)(i)]:[3,5];case 4:u=m.sent(),m.label=5;case 5:return s.apply(d,l.concat([(b.itemId=u,b.customProperties={FileId:null===(a=r.model.AttachmentId)||void 0===a?void 0:a.Id,FileType:o,Destination:"Local",Sender:Object(H.a)(i)},b)])),[2]}}))}))}(t,n);break;case s.a.saveToCloud:!function(e,t,n){var a,r=Object(S.a)(e.attachmentId);if(!r)return void c.d("AttachmentSurfaceActionButton.saveToCloud attachmentModel is null");Object(O.p)("AttachmentSaveToCloud",{entryPoint:"SurfaceAction"},{cosmosOnlyData:JSON.stringify({size:r.model.Size,fileType:Object(A.a)(r),attachmentId:null===(a=r.model.AttachmentId)||void 0===a?void 0:a.Id}),isCore:!0}),Object(j.B)(Object(j.p)(e.attachmentId),.1,(function(t){Object(j.x)(e,t)}),e.attachmentId),Object(j.u)(e,(function(t){Object(j.C)(e.attachmentId,t)}),"SurfaceAction",t,Object(H.a)(null==t?void 0:t.Id),n)}(t,n,l);break;case s.a.editAndReply:!function(e,t,n){Object(g.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(g.__generator)(this,(function(r){switch(r.label){case 0:return[4,I.d.import()];case 1:return n=r.sent(),Object(O.p)("WovenEditAndReplyFromSurface",{},{isCore:!0}),a={viewState:e,previewPaneSelectionSource:i.c.ReadingPane,parentItemId:t,isDraft:!1,isEdit:!0,onBeforePreview:function(){return null},createImageGallery:function(){return null},instrumentationContext:null,targetWindow:window},n(a),[2]}}))}))}(t,n);break;case s.a.openNewTabAndSaveToCloud:!function(e,t,n){Object(g.__awaiter)(this,void 0,void 0,(function(){var a,r;return Object(g.__generator)(this,(function(o){return a=Object(k.a)(),function(e,t,n){var a=""+_;a+=encodeURIComponent(null==n?void 0:n.Id)+"/"+encodeURIComponent(e)+"/"+encodeURIComponent(t)+"/"+Object(E.a)().search,window.open(a,"_blank")}(e.attachmentId.Id,a,t),r=new O.a("WovenNewTabSaveToCloud",{isCore:!0}),Object(j.B)(4*Object(j.p)(e.attachmentId),.1,(function(t){Object(j.x)(e,t)}),e.attachmentId),Object(j.D)(e,(function(t){Object(j.C)(e.attachmentId,t),t?r.end():r.endWithError("ServerError")}),"PencilExperiment",t,a,Object(H.a)(null==t?void 0:t.Id),n),[2]}))}))}(t,n,l);break;case s.a.openAndEdit:r=t,o=Object(S.a)(r.attachmentId).model.AttachmentOriginalUrl,d=-1===o.indexOf("?")?"?":"&",window.open(o+d+"web=1","_blank"),Object(O.p)("WovenOpenAndEditFromSurface",{},{isCore:!0});break;default:Object(u.a)(e)}}var R=n(1872),W=n(14608),M=n(387).bind(W);t.a=Object(a.a)((function(e){var t=d.useContext(R.a),n=e.action,a=e.attachmentViewState,g=e.customClassName,O=e.isForImageView,j=e.previewState;if(Object(h.a)(n,a))return null;var w=void 0,y=function(e){switch(e){case i.a.Edit:return W.edit;case i.a.NotSelectedAndSaving:return W.notSelectedAndSaving;case i.a.OtherSaving:return W.attachmentView;case i.a.Selected:return W.selected;case i.a.SelectedAndPending:return W.selectedAndPending;case i.a.SelectedAndSaving:return W.selectedAndSaving;default:return W.default}}(j);if(O){var D={extraRightPadding:B(n,a)};w=M([W.actionButton,W.actionButtonForImageView,g,D])}else w=a.isReadOnly?M([W.actionButton,y,g]):M([W.actionButton,y,W.actionButtonForDocViewInCompose,g]);var S=function(e,t){switch(e){case s.a.addToCalendar:return"AddEvent";case s.a.download:return"Download";case s.a.saveToCloud:return"CloudUpload";case s.a.openNewTabAndSaveToCloud:return"Edit";case s.a.editAndReply:return"PencilReply";case s.a.openAndEdit:return Object(v.a)(t)?"CloudEdit":"Cloud";default:return Object(u.a)(e)}}(n,a.attachmentId),A=function(e,t){switch(e){case s.a.addToCalendar:return Object(b.b)(m.a);case s.a.download:return Object(b.b)(p.a);case s.a.saveToCloud:return Object(b.b)(f.d);case s.a.openNewTabAndSaveToCloud:return Object(b.b)(f.c);case s.a.editAndReply:return Object(b.b)(f.a);case s.a.openAndEdit:return Object(v.a)(t)?Object(b.b)(f.b):Object(b.b)(f.e);default:return Object(u.a)(e)}}(n,a.attachmentId);return d.createElement(r.a,{onFocus:function(){return Object(l.b)(e.attachmentViewState,e.isForImageView)},onBlur:function(){e.shouldNotHandleOnBlur||Object(l.a)(e.attachmentViewState,e.isForImageView)},onKeyDown:function(n){n.keyCode!==o.a.enter&&n.keyCode!==o.a.space||(c.g.info("AttachmentSurfaceActionButton.keyDown enter|space"),n.stopPropagation(),N(e.action,e.attachmentViewState,e.parentItemId,t))},ariaLabel:A,title:A,onClick:function(n){c.g.info("AttachmentSurfaceActionButton.onclick"),n.stopPropagation(),N(e.action,e.attachmentViewState,e.parentItemId,t)},className:w,iconProps:{iconName:S,styles:{root:W.icon}}})}));function B(e,t){return(e===s.a.saveToCloud||e===s.a.editAndReply||e===s.a.openNewTabAndSaveToCloud||e===s.a.openAndEdit)&&!Object(h.a)(s.a.download,t)}},9963:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(13167),r=n(12),o=n(3832),i=n(83),c=n(9);function d(e,t,n,d){return void 0===n&&(n=null),void 0===d&&(d=!1),null==e||d?null:Object(i.i)("doc-attachment-referenceAttachmentExpiration")&&n&&Object(c.Gb)(n,Object(c.Pb)())?Object(r.c)(Object(r.b)(a.a),n):Object(o.d)(e,t)}}}]);
//# sourceMappingURL=owa.MailBoot~Attachments~ConversationAttachment.js.map
self.scriptsLoaded['owa.MailBoot~Attachments~ConversationAttachment.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Attachments~ConversationAttachment.js'] = (new Date()).getTime();