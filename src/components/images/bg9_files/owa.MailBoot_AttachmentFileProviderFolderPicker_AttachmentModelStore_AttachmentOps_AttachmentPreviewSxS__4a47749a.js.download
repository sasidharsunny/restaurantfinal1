self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentFileProviderFolderPicker~AttachmentModelStore~AttachmentOps~AttachmentPreviewSxS~~4a47749a.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[33],{10877:function(e,t,n){"use strict";function r(e,t,n,r,o,i){var a=!1;return{task:function(){return new Promise((function(s,c){for(var u=0,l=0,d=0,f=function(){var h,b,p,v,O;a&&s(1),u<n&&d<t.length&&((h=d,b=t[h],p=b.start,v=b.end,O=e.slice(p,v),r(O,i(h),o)).then((function(){return u-=1,(l+=1)===t.length&&s(0),void f()})).catch(c),d+=1,u+=1)},h=0;h<n;h++)f()}))},cancelTask:function(){return a=!0}}}var o=Object.freeze({sliceSize:14680064,numberOfSlicesToParallelize:2});function i(e,t,n){void 0===n&&(n=o),function(e){e.sliceSize=e.sliceSize||o.sliceSize,e.numberOfSlicesToParallelize=e.numberOfSlicesToParallelize||o.numberOfSlicesToParallelize}(n);var i=n.sliceSize,c=n.numberOfSlicesToParallelize,u=Math.ceil(e.size/i),l=function(e,t,n){for(var r=[],o=0,i=0;i<e;i++){var a=Math.min(o+t,n);r.push({start:o,end:a}),o=a}return r}(u,i,e.size),d=r(e,[l[0]],1,t,u,(function(){return 0})),f=l.length>2?r(e,l.slice(1,l.length-1),c,t,u,(function(e){return e+1})):s(),h=l.length>1?r(e,[l[l.length-1]],1,t,u,(function(){return l.length-1})):s();return{onCompletePromise:d.task().then(a(f.task)).then(a(h.task)),cancel:function(){d.cancelTask(),f.cancelTask(),h.cancelTask()}}}function a(e){return function(t){return 0===t?e():Promise.resolve(t)}}function s(){var e=!1;return{task:function(){return e?Promise.resolve(1):Promise.resolve(0)},cancelTask:function(){return e=!0}}}n.d(t,"a",(function(){return i}))},2086:function(e,t,n){"use strict";var r=n(3057),o=n(5307);function i(e){var t;try{t=btoa(e)}catch(n){t=btoa(unescape(encodeURIComponent(e)))}finally{return"u!"+t.replace(/=+$/,"").replace("/","_").replace("+","-")}}n.d(t,"d",(function(){return r.d})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"e",(function(){return r.e})),n.d(t,"c",(function(){return r.c})),n.d(t,"f",(function(){return o.a})),n.d(t,"g",(function(){return i}))},2438:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},2697:function(e,t,n){"use strict";var r=n(0),o="https://www.googleapis.com/drive/v3/files",i=n(2908);function a(e,t,n){return void 0===n&&(n={forceTokenRefresh:!1,requestInit:{}}),Object(r.__awaiter)(this,void 0,void 0,(function(){var o,a,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=n.forceTokenRefresh,a=n.requestInit||{},[4,Object(i.d)(t,o,e)];case 1:return s=r.sent(),a.headers||(a.headers=new Headers),a.headers.set("Authorization",s),[4,fetch(e,a)];case 2:return[2,r.sent()]}}))}))}function s(e,t){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a(o+"?"+e,5,{forceTokenRefresh:t})];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return i=r.sent(),[2,{errorResponse:null,result:JSON.parse(i)}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}function c(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a(o+"/"+e+"?fields=id,mimeType,name,size,modifiedTime,createdTime,thumbnailLink,webViewLink,webContentLink,fileExtension",5)];case 1:return(t=r.sent()).ok?[4,t.text()]:[3,3];case 2:return n=r.sent(),[2,{errorResponse:null,result:JSON.parse(n)}];case 3:return[2,{errorResponse:t,result:null}]}}))}))}var u=n(270),l=n(2086),d=n(313),f=Object.freeze({name:"name",size:"size",lastModifiedBy:"lastModifiedBy",lastModifiedDateTime:"lastModifiedDateTime",file:"file",folder:"folder",id:"id",webDavUrl:"webDavUrl",package:"package",shared:"shared"});function h(){return Object.keys(f).map((function(e){return f[e]})).join(",")}var b,p="_api/v2.0",v="/v1.0",O="root";function m(e){switch(e){case 1:return v;case 0:return p;default:return Object(u.a)(e)}}function _(e){return m(e)+"/drive"}function w(e){return m(e)+"/shares"}function j(e){return _(e)+"/items"}function g(e,t,n,o,i,a,s){return void 0===a&&(a=b.None),Object(r.__awaiter)(this,void 0,void 0,(function(){var c,p,v,m,_,w,g,k,y;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=i||O,c=function(e){switch(e){case 0:return f.name;case 1:return f.size;default:return f.lastModifiedDateTime}}(n),p=function(e){switch(e){case 0:return"asc";case 1:return"desc";default:return Object(u.a)(e)}}(o),v=function(e,t,n){switch(e){case 0:return"folder,"+t+" "+n;case 1:return t+" "+n;default:return Object(u.a)(e)}}(t,c,p),m="expand=thumbnails(select=medium)&orderby="+v+"&select="+h(),a!==b.None&&(m=m+"&filter="+function(e){switch(e){case b.None:return"";case b.Folder:return"("+f.folder+" ne null)";default:return Object(u.a)(e)}}(a)),s&&(m=m+"&$top="+s.maxEntries,s.skipToken&&(m=m+"&$skiptoken="+s.skipToken)),_=e+"/"+j(t)+"/"+i+"/children?"+m,w={Prefer:"HonorNonIndexedQueriesWarningMayFailRandomly"},[4,Object(l.f)(t,encodeURI(_),_,{method:l.b,mode:l.a,datapointNamePrefix:"getOneDriveItems"},w)];case 1:return g=r.sent(),k=JSON.parse(g),y=k["@odata.nextLink"]?function(e){var t=Object(d.parse)(e,!0);return t.query?t.query.$skiptoken:null}(decodeURI(k["@odata.nextLink"])):null,[2,{errorResponse:null,result:{items:k.value,skipToken:y}}]}}))}))}function k(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,s,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:o=o||O,i="expand=thumbnails(select=medium)&select="+h(),a=t+"/"+j(e)+"/"+o+"/children?"+i,s={name:n,folder:{}},(c=new Headers).append("Content-Type","application/json"),c.append("Accept","application/json"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(l.f)(e,encodeURI(a),a,{method:l.d,mode:l.a,body:JSON.stringify(s),datapointNamePrefix:"createNewFolder"},null)];case 2:return u=r.sent(),[2,{errorResponse:null,result:JSON.parse(u)}];case 3:return[2,{errorResponse:r.sent(),result:null}];case 4:return[2]}}))}))}!function(e){e[e.None=0]="None",e[e.Folder=1]="Folder"}(b||(b={}));var y=n(10877),S=n(5307),T=n(337);var R=Object.freeze({folderInfo:{type:0,identifier:O},sliceSize:10485760,conflictBehavior:"rename",onProgress:function(){}});function P(e,t,n){var o=this,i=function(){return Promise.resolve({errorResponse:null,result:null})};return{uploadPromise:Object(r.__awaiter)(o,void 0,void 0,(function(){var o,a,s,c,d,f,h,b,p,v,O,m,w,g,k;return Object(r.__generator)(this,(function(P){switch(P.label){case 0:switch(function(e){Object.keys(R).forEach((function(t){e[t]=e[t]||R[t]}))}(n),o=n.fileToUpload,a=o.fileName,s=o.fileBlob,c=n.folderInfo,d=c.type,f=c.identifier,h=n.conflictBehavior,b=n.sliceSize,p=n.onProgress,d){case 0:v=t+"/"+j(e)+"/"+f+":/"+encodeURI(a)+":/createUploadSession";break;case 1:v=t+"/"+_(e)+"/"+f+":/"+encodeURI(a)+":/createUploadSession";break;default:Object(u.a)(d)}return O={item:{"@name.conflictBehavior":h}},[4,Object(S.a)(e,v,v,{method:l.d,mode:l.a,body:JSON.stringify(O),datapointNamePrefix:"createUploadSession"},null)];case 1:return m=P.sent(),w=function(e,t,n,o){var i=this,a=e.uploadUrl,s=t.size,c=null,l=null,d=function(e,t,n,o,i,a){var s=this;return function(c,u){return Object(r.__awaiter)(s,void 0,void 0,(function(){var s,l,d,f,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s=function(e,t,n){var r=x(e,t,n),o=r.rangeStart,i=r.rangeEnd;return new Headers({"Content-Range":"bytes "+o+"-"+i+"/"+n,Accept:"application/json"})}(u,t,n),l=function(e){var r=x(e,t,n).rangeStart;return function(e){var t=e.loaded;o({loaded:r+t,total:n})}}(u),[4,(b=e,p=l,v={method:"PUT",body:c,headers:s},void 0===v&&(v={method:"POST"}),new Promise((function(e,t){var n=v.method,r=v.body,o=v.headers,i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&e({status:i.status,text:function(){return Promise.resolve(i.responseText)}})},i.ontimeout=function(){t(new Error("Request timed out"))},i.onerror=function(){t(new Error("Request failed"))},i.onabort=function(){t(new Error("Request aborted"))},p&&(i.upload.onprogress=p),i.open(n,b,!0),new Headers(o).forEach((function(e,t){i.setRequestHeader(t,e)})),r?i.send(r):i.send()})))];case 1:return 201!==(d=r.sent()).status&&200!==d.status?[3,3]:[4,d.text()];case 2:f=r.sent(),h=JSON.parse(f),i(h),r.label=3;case 3:if(!Object(T.a)(d.status))throw a(d),new Error("Unable to upload file");return[2]}var b,p,v}))}))}}(a,n,s,o,(function(e){c=e}),(function(e){l=e})),f=Object(y.a)(t,d,{sliceSize:n,numberOfSlicesToParallelize:1}),h=f.onCompletePromise,b=f.cancel,p=Object(r.__awaiter)(i,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:e=null,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,h];case 2:return e=t.sent(),[3,4];case 3:return t.sent(),[2,{errorResponse:l,result:null}];case 4:switch(e){case 0:return c?[2,{errorResponse:null,result:c}]:[2,{errorResponse:l,result:null}];case 1:throw new Error("Upload was cancelled");default:return[2,Object(u.a)(e)]}return[2]}}))}));return{uploadPromise:p,cancel:function(){return Object(r.__awaiter)(i,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:b(),e.label=1;case 1:return e.trys.push([1,,3,5]),[4,p];case 2:return e.sent(),[3,5];case 3:return[4,N(a)];case 4:return[2,e.sent()];case 5:return[2]}}))}))}}}(JSON.parse(m),s,b,p),g=w.uploadPromise,k=w.cancel,i=k,[4,g];case 2:return[2,P.sent()]}}))})),cancel:function(){return Object(r.__awaiter)(o,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,i()];case 1:return[2,e.sent()]}}))}))}}}function x(e,t,n){var r=e*t;return{rangeStart:r,rangeEnd:Math.min(r+t,n)-1}}function N(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,fetch(e,{method:"DELETE"})];case 1:return t=n.sent(),Object(T.a)(t.status)?[2,{errorResponse:null,result:null}]:[2,{errorResponse:t,result:null}]}}))}))}var E="https://api.dropboxapi.com/2/files";function A(e,t){switch(e){case 0:return t;case 1:return null;default:Object(u.a)(e)}return null}function D(e){return"file"===e[".tag"]}function z(e){return"folder"===e[".tag"]}function I(e){return"deleted"===e[".tag"]}function F(e){return"folder"===e.type}function U(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e.path=e.path||"",t=E+"/list_folder",n={method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(e)},[4,a(t,2,{requestInit:n})];case 1:return(o=r.sent()).ok?[4,o.text()]:[3,3];case 2:return i=r.sent(),[2,{errorResponse:null,result:JSON.parse(i).entries}];case 3:return[2,{errorResponse:o,result:null}]}}))}))}var C,J="https://api.box.com/2.0",B=2e3;function M(e,t){return void 0===t&&(t=B),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a(J+"/folders/"+(e=e||"0")+"/items?fields=id,size,name,type,path_collection,modified_at,modified_by&limit="+t+"&offset=0",3)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return o=r.sent(),[2,{errorResponse:null,result:JSON.parse(o).entries}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}!function(e){e.Uploaded="uploaded",e.Tagged="tagged"}(C||(C={}));var q=C,H="https://graph.facebook.com/v2.7",L=200;function V(e,t){return void 0===t&&(t=L),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a(H+"/me/photos/?fields=id,name,images,from,link,album,place,created_time&type="+e.toString()+"&limit="+t,6)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return o=r.sent(),[2,{errorResponse:null,result:JSON.parse(o).data}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}var W=n(794),G=n(795),$=n(547),X=n(1322),Q=n(1469),K=n(622),Y=n(319),Z=n(59);function ee(e,t){var n=function(e,t){return Object(G.a)({ParentFolderIds:[Object($.a)({Id:e})],ItemShape:Object(K.a)({BaseShape:"IdOnly"}),ShapeName:"MailListItem",Traversal:"Shallow",Paging:t,FocusedViewFilter:-1,ViewFilter:"All",SortOrder:null})}(e,t);return Object(W.a)({Header:Object(Y.b)(),Body:n})}function te(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(Q.a)({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100}),[4,ee(e=e||Object(X.a)("inbox"),n)];case 1:return o=r.sent(),(i=o.Body.ResponseMessages.Items[0])&&"Success"===i.ResponseClass&&i.RootFolder.Items?[2,{errorResponse:null,result:i.RootFolder.Items}]:(Z.g.warn("Find Item Response of get mail messages failed with "+i),[2,{errorResponse:{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},result:null}])}}))}))}n.d(t,"m",(function(){return s})),n.d(t,"l",(function(){return c})),n.d(t,"o",(function(){return g})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return k})),n.d(t,"v",(function(){return P})),n.d(t,"i",(function(){return _})),n.d(t,"q",(function(){return w})),n.d(t,"e",(function(){return"https://api.onedrive.com"})),n.d(t,"b",(function(){return"https://api.dropboxapi.com/2/sharing"})),n.d(t,"d",(function(){return o})),n.d(t,"p",(function(){return A})),n.d(t,"t",(function(){return D})),n.d(t,"u",(function(){return z})),n.d(t,"s",(function(){return I})),n.d(t,"j",(function(){return U})),n.d(t,"r",(function(){return F})),n.d(t,"h",(function(){return M})),n.d(t,"a",(function(){return J})),n.d(t,"c",(function(){return q})),n.d(t,"k",(function(){return V})),n.d(t,"n",(function(){return te}))},2908:function(e,t,n){"use strict";var r=n(0),o=n(4180),i=n.n(o),a=n(12),s=n(320),c=n(469),u=n(313),l=n(29);function d(e){return Object(r.__assign)({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}function f(e,t){return void 0===e||e.__type||(e=d(e)),Object(l.a)("GetAccessTokenforDataProvider",e,t)}function h(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=d({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1}),i=n?"getAccessTokenForDataProvider_"+n:"getAccessTokenForDataProvider",(a=new Headers).append("X-OWA-ActionName",i),[4,f(o,{headers:a,datapoint:{customData:{actionSource:n},headersCustomData:function(e){return{tokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){return{tokenStatus:e.TokenResultCode.toString()}}},returnFullResponseOnSuccess:!0})];case 1:return[4,(s=r.sent()).json()];case 2:return[2,{token:r.sent(),response:s}]}}))}))}var b="onedrive_implicit.access",p="Bearer ",v=n(83),O=function(e,t,n){return Object(r.__assign)({resultCode:t,isAdalException:n,_typeSpec:"TokenRetrievalError"},e)},m=function(e){return"TokenRetrievalError"===e._typeSpec},_=[],w={},j=1,g=30,k="",y="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function S(e){w[e]=null}function T(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,h(e,t,n)];case 1:return o=r.sent(),function(e,t,n){_=_.filter((function(e){return e!==t}));var r=n.token;if(0!==r.TokenResultCode||!r.AccessToken||""===r.AccessToken){var o="Access token request failed for token key "+e+" with response code "+r.TokenResultCode,i=n.response.headers.get("x-tokenresult"),a=null!=i&&i.indexOf(y)>0;throw O(new Error(o),r.TokenResultCode,a)}var s=w[e]||{};s[t]=r,w[e]=s}(e,t,o),[2,o.token]}}))}))}function R(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(r){return o=k,0===e&&n&&(i=Object(u.parse)(n),o=Object(a.c)("{0}//{1}/",i.protocol,i.hostname)),Object(v.i)("doc-attachment-testAuthFallback")?[2,""]:[2,x(e,o,t,null)]}))}))}function P(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return[2,x(0,e,t,n)]}))}))}function x(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n||!function(e,t){var n=w[e];if(!n)return!1;var r=n[t];if(!r||!r.AccessTokenExpiry)return!1;var o=new Date(r.AccessTokenExpiry),a=i()(new Date(Date.now()),j);return null!=o&&a<o}(e,t)?[3,1]:(a=w[e],s=a[t],i()(new Date(Date.now()),g)>new Date(s.AccessTokenExpiry)&&-1===_.indexOf(t)&&(_.push(t),T(e,t,o)),[2,s.AccessToken]);case 1:return[4,T(e,t,o)];case 2:return[2,(s=r.sent()).AccessToken]}}))}))}function N(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(s.a)()&&1===e?[4,Object(c.getDelegationTokenForOwa)(b)]:[3,2];case 1:return o=r.sent(),[3,4];case 2:return[4,R(e,t,n)];case 3:o=r.sent(),r.label=4;case 4:return[2,p+o]}}))}))}n.d(t,"d",(function(){return N})),n.d(t,"c",(function(){return R})),n.d(t,"e",(function(){return P})),n.d(t,"b",(function(){return S})),n.d(t,"f",(function(){return m})),n.d(t,"a",(function(){return p}))},2942:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(29),o=n(2438);function i(e,t){return void 0===e||e.__type||(e=Object(o.a)(e)),Object(r.a)("FetchDataProviderResource",e,t)}},3057:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return s}));var r="POST",o="cors",i="GET",a="PUT",s="PATCH"},3663:function(e,t,n){var r=n(1607);e.exports=function(e,t){var n=r(e).getTime(),o=Number(t);return new Date(n+o)}},4180:function(e,t,n){var r=n(3663),o=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*o)}},5307:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(0),o=n(269),i=n(2908),a=n(337),s=n(2438),c=n(2942),u=n(83),l=n(59),d=n(6746),f=n(3057);function h(e,t,n,a,s){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(i.d)(e,!1,n)];case 1:return c=r.sent(),[3,3];case 2:return r.sent(),[3,3];case 3:return Object(u.i)("doc-authContext")&&0===e&&(s?s["x-ms-cc"]="t":s={"x-ms-cc":"t"}),c&&c.split(i.a)[1]?(Object(o.p)("fetchServiceViaDataProvider",[e]),l.g.info("fetchServiceViaDataProvider"),[4,b(t,c,a,s)]):[3,5];case 4:return[2,r.sent()];case 5:Object(o.p)("fetchServiceFailedToGetToken",[e]),r.label=6;case 6:return 0!==e?[3,8]:(Object(o.p)("fetchServiceViaOWAServer"),l.g.info("fetchServiceViaOWAServer"),[4,p(e,t,a,s)]);case 7:return[2,r.sent()];case 8:throw new Error("Fetch service has failed to retrieve client token.")}}))}))}function b(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,c,l,f,h,b,p,v;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s=n.datapointNamePrefix+"DataProvider",c=new o.a(s),l={Authorization:t,"Content-Type":"application/json",Accept:"application/json"},i&&Object.keys(i).forEach((function(e){l[e]=i[e]})),[4,fetch(e,{method:n.method,mode:n.mode,headers:l,body:n.body})];case 1:return f=r.sent(),Object(a.a)(f.status)?(c.end(),[4,f.json()]):[3,3];case 2:return h=r.sent(),[2,JSON.stringify(h)];case 3:return b=new Error(s+" : Response status = "+f.status+", body = "+f.body),c.endWithError("ServerError",b),p={datapointName:s,responseStatus:f.status,responseBody:f.body,headers:f.headers},Object(u.i)("doc-authContext")?(v=f.headers.get("www-authenticate"),[4,d.a.import()]):[3,6];case 4:return[4,r.sent()(v)];case 5:r.sent(),r.label=6;case 6:throw JSON.stringify(p)}}))}))}function p(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,l,d,h,b,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return u=n.datapointNamePrefix+"OWA",l=new o.a(u),d=Object(s.a)({ProviderType:e,Url:t,Method:n.method,Body:n.body?n.body:JSON.stringify({}),Headers:JSON.stringify(i),IsJsonPost:n.method===f.d}),[4,Object(c.a)(d)];case 1:if(h=r.sent(),Object(a.a)(h.Status))return l.end(),[2,h.Body];throw b=new Error(u+" : Response status = "+h.Status+", ServerTraceLog = "+h.ServerTraceLog),l.endWithError("ServerError",b),p={datapointName:u,responseStatus:h.Status,responseServerTraceLog:h.ServerTraceLog},JSON.stringify(p)}}))}))}},6746:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(77),o=new r.c((function(){return n.e(312).then(n.bind(null,10893))})),i=new r.b(o,(function(e){return e.launchRemediateAuthDialogAndRefresh}));new r.b(o,(function(e){return e.remediateAuth}))}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentFileProviderFolderPicker~AttachmentModelStore~AttachmentOps~AttachmentPreviewSxS~~4a47749a.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentFileProviderFolderPicker~AttachmentModelStore~AttachmentOps~AttachmentPreviewSxS~~4a47749a.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentFileProviderFolderPicker~AttachmentModelStore~AttachmentOps~AttachmentPreviewSxS~~4a47749a.js'] = (new Date()).getTime();