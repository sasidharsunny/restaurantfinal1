self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1237.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1237],{10834:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1493),i=n(1892),a=n(1824),c=n(59),u=n(1518);function d(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(r.__generator)(this,(function(r){return 1===(n=t.tableQuery).listViewType?(i={Id:e,mailboxInfo:Object(o.d)(n)},[2,a.e.importAndExecute(i,"LoadNudgedItem")]):[2,s(e,t)]}))}))}function s(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(r.__generator)(this,(function(r){return n=t.tableQuery,a=Object(o.d)(n),[2,i.h.importAndExecute(e,n.folderId,n.sortBy,Object(u.l)(n),n.requestShapeName,a).then((function(e){return e})).catch((function(e){return c.g.warn("loadNudgedConversation throws an exception"+e.message),null}))]}))}))}var l=n(83),f=n(320),b=n(469),w="https://outlook.office.com/FocusedInboxB2",O="https://outlook.office.com/M365.Access";function I(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,g()];case 1:return(e=n.sent())?((t=new Headers).authorization="Bearer "+e,[2,t]):[2,null]}}))}))}function g(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return e=null,Object(f.a)()?[3,2]:[4,Object(b.getAccessTokenforResource)(w)];case 1:return e=t.sent(),[3,4];case 2:return Object(l.i)("tri-nudge-consumer")?[4,Object(b.getDelegationTokenForOwa)(O)]:[3,4];case 3:e=t.sent(),t.label=4;case 4:return[2,e]}}))}))}var m=n(321),v=n(337),j="FocusedInboxB2/api/v1/Nudges/GetNudges";function _(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,I()];case 1:return(t=r.sent())?[4,Object(m.b)(j,e,!0,t,!1,!1,"GetNudges")]:[3,9];case 2:if(o=r.sent(),!Object(v.a)(o.status))return[3,7];r.label=3;case 3:return r.trys.push([3,5,,6]),[4,o.json()];case 4:return[2,r.sent()];case 5:return r.sent(),n="Parse Error",[3,6];case 6:return[3,8];case 7:n=o.status,r.label=8;case 8:return[3,10];case 9:n="Token Failure",r.label=10;case 10:return[2,n]}}))}))}var y=n(1311),N=n(4),h=n(1322);function p(e){switch(e){case"Received":return 0;case"Sent":return 1;default:return c.g.warn("No nudge reason returned in GetNudge server response"),0}}var R=n(4420),E=n(1965),T=n(3144),S=n(8281),C=n(2184),K=n(2283);function L(e,t){var n=t.rowKeys.indexOf(e);if(-1!=n){var r=y.b.getLastDeliveryOrRenewTimeStamp(e,t);if(Object(K.a)(e,t.id,r)){var o=Object(T.a)(r,y.b.getLastDeliveryTimeStamp(e,t),t,n+1);-1==o?Object(E.a)([e],t,"NotNudgeAnymore"):(Object(S.a)([e],t),C.a.updateRowPosition(--o,e,t))}}}var A=n(269),V=n(77),D=n(362),P=n(2513),M=n(1319),x=n(9);function F(e,t,n){Object(A.p)("Nudge_RowRemove",{owa_1:t,owa_2:n,rKey:e},{isCore:!0})}var U=n(4431),G=n(1368);function k(e){var t,n=(null!==(t=e.IconIndex)&&void 0!==t?t:"").toString().toLowerCase();return n.indexOf("replied")>-1||n.indexOf("forwarded")>-1}function B(e,t,n){return y.b.getIsPinned(n,t)?"RowPinned":function(e,t,n){if(Object(y.P)(e)){var r=y.b.getLatestGlobalItemId(t,e),o=y.b.getDraftItemIds(t,e);return!(!t||-1!=o.indexOf(r)||r==n)}var i=Object(M.b)().items.get(n);return!(!i||!k(i))}(t,n,e)?"NotLatestItemInRow":null}var W,Q,z=!1,H={},X=36e5,Y=18e5,q=Object(V.e)(U.a,"getNudgesOnNudgeOptionChangeClone",(function(e){ee(!0,"SettingChange")})),J=Object(V.e)(P.a,"clone_onSelectFolderComplete",(function(e){var t=e.selectedFolderId,n=e.previousFolderId,r=e.isExitingSearch;t==n||r||ee(!1,"FolderSwitch")})),Z=Object(V.e)(K.i,"clone_getNudgesOnNudgeRemoved",(function(e){Object(l.i)("tri-nudgePolling")&&(Q=setTimeout((function(){return ee(!0,"NudgeRemoval")}),9e5))}));function $(e,t){"visible"===document.visibilityState&&ee(e,t)}function ee(e,t){if(!z&&Object(R.b)()){var n=Object(l.i)("tri-nudgePolling");!W&&n&&(W=!0,document.addEventListener("visibilitychange",(function(){return $(!1,"VisibilityChange")})));var o=Object(y.G)(),i=o.tableQuery.folderId;if(Object(R.a)(i)){if(n){if(!e&&Date.now()-H[i]<=Y)return;Q&&(clearTimeout(Q),Q=null),Q=setTimeout((function(){return $(!1,"Timer")}),X)}!function(e,t,n){Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,d,s,l,f,b,w,O,I,g,m,v,j,p,R,E,T;return Object(r.__generator)(this,(function(S){switch(S.label){case 0:return z=!0,o=Object(D.a)(),i=Date.now(),[4,_(o)];case 1:if(a=S.sent(),d=[],!(null==(s=a)?void 0:s.Nudges))return[3,6];l=Date.now()-i,f=s.Nudges,b=0,w=[],O=[],I="sentitems"==Object(G.a)(e),g=0,S.label=2;case 2:return g<f.length?(m=f[g],v=m.FolderId.Id,j=m.ItemId.Id,w.push(j),I&&v!=e?[3,4]:[4,te(m,t,o,!I)]):[3,5];case 3:(p=S.sent())&&(d.push(p),O.push(j)),b++,S.label=4;case 4:return g++,[3,2];case 5:return Object(A.p)("Nudge_GetNudge",{owa_1:f.length,owa_2:b,owa_3:d.length,owa_4:n,cId:o,itemId:w.join(","),latency:l,validItemId:O.join(",")}),[3,7];case 6:Object(A.p)("Nudge_GetNudgesFailed",{owa_1:a.toString()},{isCore:!0}),S.label=7;case 7:return R=Object(N.a)("testOldNudge"),0!=decodeURIComponent(R||"").trim().length&&(d.push({rowKey:"testNudgeRowKey",itemId:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId=",conversationId:"getTestNudgeRowDataForRowNotLoadedInTableViewConversationId=",tableViewId:t.id,reason:0,daysAgo:7}),E={ConversationId:{__type:"ItemId:#Exchange",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewConversationId="},ConversationTopic:"This is a test Nudge Email that is older than the loaded rows",UniqueSenders:["Sayali Shah"],LastDeliveryTime:"2019-10-01T15:30:58-07:00",HasAttachments:!1,MessageCount:1,GlobalMessageCount:1,UnreadCount:1,GlobalUnreadCount:1,Size:1234,ItemClasses:["IPM.Note"],Importance:null,ItemIds:[{__type:"ItemId:#Exchange",ChangeKey:"CQAAAA==",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId="}],GlobalItemIds:[{__type:"ItemId:#Exchange",ChangeKey:"CQAAAA==",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId="}],LastModifiedTime:"2019-10-29T15:30:59-07:00",InstanceKey:"testNudgeRowKey",Preview:"Test nudge email for row that is not loaded",HasIrm:!1,IsLocked:!1,FamilyId:{__type:"ItemId:#Exchange",Id:"AAQkAGZjM2NmMGY1LTkzMzgtNGNhMy04ODg5LWQwMjJjMDc0YjJlMAAQAH9+ZbR0rbRFncY81mWHT1E="},LastDeliveryOrRenewTime:"2019-10-01T15:30:58-07:00",HasAttachmentPreviews:!1,LastSender:{Mailbox:{Name:"Sayali Shah",EmailAddress:"sayalis@microsoft.com",RoutingType:"SMTP"}}},t.rowKeys.indexOf("testNudgeRowKey")<0&&(T=Object(u.f)(t,0),C.a.addRow(T,E,t))),d.push.apply(d,Object(r.__spread)(function(e){var t=Object(N.a)("testNudge");if(0==decodeURIComponent(t||"").trim().length)return[];var n=[];if(e.rowKeys.length>0){var r=e.tableQuery.folderId===Object(h.a)("sentitems")?1:0,o={rowKey:e.rowKeys[4],itemId:y.b.getItemIds(e.rowKeys[0],e)[0],conversationId:y.b.getConversationId(e.rowKeys[4],e),tableViewId:e.id,reason:r,daysAgo:1};if(n.push(o),e.rowKeys.length>3){var i={rowKey:e.rowKeys[6],itemId:y.b.getItemIds(e.rowKeys[3],e)[0],conversationId:y.b.getConversationId(e.rowKeys[6],e),tableViewId:e.id,reason:r,daysAgo:0};n.push(i)}if(e.rowKeys.length>10&&1===Math.floor(2*Math.random())){var a={rowKey:e.rowKeys[10],itemId:y.b.getItemIds(e.rowKeys[10],e)[0],conversationId:y.b.getConversationId(e.rowKeys[10],e),tableViewId:e.id,reason:r,daysAgo:3};n.push(a)}}return n}(t))),Object(K.f)().nudgedRows.forEach((function(e){var n=e.rowKey;e.tableViewId!=t.id||d.some((function(t){return t.rowKey===n&&t.tableViewId===e.tableViewId}))||(L(n,t),F(n,"NotReceivedAsNudgeAnyMore",e.reason)),e.tableViewId!=t.id&&d.push(e)})),Object(K.h)(d,t),c.g.info("Nudge: onSelectFolderCompleteOrchestrator new nudges length: "+d.length),z=!1,[2]}}))}))}(i,o,t),H[i]=Date.now()}}}function te(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,l,f,b,w,O,I,g,m,v,j,_,N,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),s=void 0,l=void 0,f=e.ItemId.Id,b=e.ConversationId.Id,w=e.NudgeReason.Reason,O=Object(y.P)(t),I=O?b:f,g=Object(y.E)([I],t),m=i?"Sent"==w:"Received"==w,0!==g.length?[3,2]:[4,d(I,t)];case 1:return v=r.sent(),function(e,t,n,r){var o,i;if(!e)return"RowNotFound";if(i=n?e.LastDeliveryOrRenewTime:e.ReceivedOrRenewTime,Object(y.v)(i))return"RowPinned";if(n){var a=e,c=a.GlobalItemIds[0].Id;return 0==(a.DraftItemIds||[]).filter((function(e){return e.Id==c})).length&&c!=t?"NotLatestItemInRow":null}return k(e)?"NotLatestItemInRow":(null===(o=e.ParentFolderId)||void 0===o?void 0:o.Id)!=r.tableQuery.folderId?"ItemFromOtherTable":null}(v,f,O,t)||(s=v.InstanceKey,t.rowKeys.indexOf(s)<0&&(j=Object(u.f)(t,0),C.a.addRow(j,v,t))),[3,3];case 2:B(f,t,g[0])||(s=g[0]),r.label=3;case 3:return s?(function(e,t){if(1===e.listViewType){var n=Object(M.b)().items.get(t);n&&n.NormalizedBody||a.e.importAndExecute({Id:t,mailboxInfo:Object(o.d)(e)},"LoadNudgedItem")}else Object(M.b)().conversations.get(t)||a.d.importAndExecute({Id:t,mailboxInfo:Object(o.d)(e)},"LoadNudgedConversation")}(t.tableQuery,I),_=e.MessageReceivedOrSentTimeUTC||y.b.getLastDeliveryTimeStamp(s,t),N=Object(x.s)(Object(x.lc)(),Object(x.lc)(_)),[2,{rowKey:s,itemId:f,conversationId:b,tableViewId:t.id,reason:p(e.NudgeReason.Reason),daysAgo:N}]):(function(e,t,n,r,o,i,a){var u=a?"inbox":"sentitems";Object(A.p)("Nudge_Discarded",{owa_1:e,owa_2:o,owa_3:i,itemId:t,cId:n,crId:r}),c.g.warn("Nudge Discarded - isConversationView: "+o+" itemId: "+t+" conversationId: "+n+" folderId: "+u+" isNudgeFromOtherTable: "+i)}(l,f,b,n,O,m,i),[2,null]);case 4:return h=r.sent(),c.g.warn("Nudge: processNudgeResponse throws an exception"+h.message),[2,null];case 5:return[2]}}))}))}var ne="FocusedInboxB2/api/v1/Nudges/UpdateNudge";function re(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,I()];case 1:return i=r.sent(),a={ItemId:{Id:e},NudgeAction:t},[4,Object(m.d)(ne,a,Object(D.a)(),!0,i,!1,!1,!1,"UpdateNudges")];case 2:c=r.sent();try{Object(v.a)(c.status)||(u=c.status)}catch(e){u="Parse Error"}return function(e,t,n,r,o){Object(A.p)("Nudge_Update",{owa_1:e,owa_2:t,owa_3:n,owa_4:!o,itemId:r},{isCore:!0}),o&&Object(A.p)("Nudge_UpdateFailed",{owa_1:o},{isCore:!0})}(t,n,o,e,u),[2]}}))}))}var oe=n(1712),ie=n(2816),ae=n(2817),ce=n(3627),ue=n(4773),de=n(5715),se=n(3271),le=n(3009),fe=Object(V.e)(de.b,"clone_onNudgeInfoBarClicked",(function(e){var t=e.response===de.a.MarkComplete?"MarkedComplete":"DismissedOnView";ye(e.rowKey,e.itemId,t,"ReadingPane")})),be=Object(V.e)(ue.a,"clone_onDismissNudgeClicked",(function(e){Object(K.f)().nudgedRows.filter((function(t){return t.rowKey===e.rowKey&&t.tableViewId===e.tableViewId})).forEach((function(t){ye(e.rowKey,t.itemId,"Dismissed",e.actionSource)}))})),we=Object(V.e)(ae.a,"clone_markItemsAsPinnedStoreUpdate",(function(e){_e(e.rowKeys,e.tableViewId,e.shouldMarkAsPinned)})),Oe=Object(V.e)(ie.a,"clone_markConversationsAsPinnedStoreUpdate",(function(e){_e(e.rowKeys,e.tableViewId,e.shouldMarkAsPinned)})),Ie=Object(V.e)(oe.a,"clone_deleteItemsStoreUpdate",(function(e){e.itemContexts.map((function(e){return e.itemId})).forEach((function(t){var n=Object(K.e)(t);n&&(Object(K.i)(n),F(n,e.actionType,he(n)))}))})),ge=Object(V.e)(E.a,"clone_removeRowsFromListViewStore",(function(e){Ne(e.rowKeys,e.tableView.id,e.actionType)})),me=Object(V.e)(ce.a,"clone_onSendMessageSucceeded",(function(e){var t=e.operation;if(1===t||2===t||3===t){e.referenceItemId||c.g.warn("Nudge: referenceItemId should not be null for r/R/f operations");var n,r=e.referenceItemId.Id,o=e.conversationId,i=Object(K.e)(r);i||(i=Object(K.d)(o)),i&&(L(i,Object(y.G)()),n=he(i),Object(K.i)(i)),Object(A.p)("Nudge_Reply",{owa_1:t,owa_2:n,refId:r,cId:o,rKey:i},{isCore:!0})}})),ve=Object(V.e)(le.a,"clone_removeNudgeUponRowUpdate",(function(e){var t=Object(K.f)().nudgedRows.filter((function(t){return t.rowKey===e.rowKey}));if(t.length>0){var n=B(t[0].itemId,e.tableView,e.rowKey);n&&(L(e.rowKey,e.tableView),Ne([e.rowKey],e.tableView.id,n))}})),je=Object(V.e)(U.a,"updateNudgesOnNudgeOptionChangeClone",(function(e){if(Object(se.a)(16)){var t=Object(K.f)().nudgedRows.map((function(e){return e.rowKey})),n=Object(y.G)();t.forEach((function(e){L(e,n),Ne([e],n.id,"NudgeDisabled")}))}}));function _e(e,t,n){var r=n?"Pinned":"Unpinned";e.forEach((function(e){Object(K.f)().nudgedRows.filter((function(n){return n.rowKey===e&&n.tableViewId===t})).forEach((function(e){re(e.itemId,r,"PinUnpin",e.reason)}))})),Ne(e,t,"PinUnpin")}function ye(e,t,n,r){re(t,n,r,he(e)),L(e,Object(y.G)()),Object(K.i)(e)}function Ne(e,t,n){e.forEach((function(e){if(Object(K.g)(e,t)){var r=he(e);Object(K.i)(e),F(e,n,r)}}))}function he(e){var t=Object(K.f)().nudgedRows.filter((function(t){return t.rowKey===e}));return t.length>0?t[0].reason:null}var pe=n(3);function Re(e,t,n){if(e.tableViewId==t.id){var r,o="Nudge_Render",i=e.rowKey,a=e.conversationId,d=e.itemId;Object(K.a)(i,t.id,y.b.getLastDeliveryOrRenewTimeStamp(i,t))?(r=Object(u.f)(t,0),C.a.updateRowPosition(r,i,t),c.g.info("Nudge: "+n+" updateNudgedRowPosition - row is inserted at "+r)):(o="Nudge_NotRender",c.g.info("Nudge: "+n+" updateNudgedRowPosition - row is pinned")),Object(A.p)(o,{owa_1:n,rKey:i,iId:d,cId:a,index:r},{isCore:!0})}}Object(pe.orchestrator)(K.h,(function(e){e.nudgedRows.forEach((function(t){return Re(t,e.tableView,"onGetNudge")}))})),Object(pe.orchestrator)(u.i,(function(e){var t=Object(K.f)().nudgedRows,n=e.tableView;t.filter((function(e){return e.tableViewId==n.id})).forEach((function(t){return Re(t,e.tableView,"onMerge")}))}));var Ee=n(96);function Te(){Object(se.b)(!0,16),Ee.v.importAndExecute([{key:"FocusedInboxBitFlags",valuetype:"Integer32",value:[""+Object(Ee.h)().ViewStateConfiguration.FocusedInboxBitFlags]}],"OWA.ViewStateConfiguration"),Object(A.p)("TnS_SaveNudgeOption",[!1,"InlineFeedback"]),Object(U.a)()}n.d(t,"getNudgesOnSelectFolderComplete",(function(){return J})),n.d(t,"getNudgesOnNudgeOptionChange",(function(){return q})),n.d(t,"getNudgesOnNudgeRemoved",(function(){return Z})),n.d(t,"removeNudgeOnInfoBarClickedOrchestrator",(function(){return fe})),n.d(t,"removeNudgeOnDismissNudgeClickedOrchestrator",(function(){return be})),n.d(t,"removeNudgeOnItemDeleteStoreUpdateOrchestrator",(function(){return Ie})),n.d(t,"removeNudgeOnRowsDeleteStoreUpdateOrchestrator",(function(){return ge})),n.d(t,"removeNudgeOnItemsPinnedStoreUpdateOrchestrator",(function(){return we})),n.d(t,"removeNudgeOnConversationsPinnedStoreUpdateOrchestrator",(function(){return Oe})),n.d(t,"removeNudgeOnReplyOrReplyAllOrForwardOrchestrator",(function(){return me})),n.d(t,"updateNudgesOnNudgeOptionChange",(function(){return je})),n.d(t,"removeNudgeUponRowUpdate",(function(){return ve})),n.d(t,"disableNudgeOption",(function(){return Te}))},1510:function(e,t,n){"use strict";n.d(t,"q",(function(){return s})),n.d(t,"t",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"i",(function(){return w})),n.d(t,"o",(function(){return O})),n.d(t,"b",(function(){return I})),n.d(t,"m",(function(){return g})),n.d(t,"f",(function(){return m})),n.d(t,"p",(function(){return v})),n.d(t,"s",(function(){return j})),n.d(t,"r",(function(){return _})),n.d(t,"g",(function(){return y})),n.d(t,"j",(function(){return N})),n.d(t,"k",(function(){return h})),n.d(t,"n",(function(){return p})),n.d(t,"d",(function(){return R})),n.d(t,"c",(function(){return E})),n.d(t,"h",(function(){return T})),n.d(t,"l",(function(){return S}));var r=n(0),o=n(74),i=n(1311),a=n(1323),c=n(3),u=n(1431),d=n(30),s=Object(c.action)("SINGLE_SELECT_ROW",(function(e,t,n,r){return Object(o.c)(C(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),l=Object(c.action)("TOGGLE_SELECT_ROW",(function(e,t,n,r){return Object(o.c)(C(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),f=Object(c.action)("ON_AFTER_SELECTION_CHANGED",(function(e,t,n,r,o){return{rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:r,sxsId:o}})),b=Object(c.action)("EXPAND_ROW_FIRST_LEVEL",(function(e,t){return{rowKey:e,latestItemIdsInForks:t}})),w=Object(c.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),O=Object(c.action)("SET_SECOND_LEVEL_LIST_VIEW_EXPANSION",(function(e){return{rowKey:e}})),I=Object(c.action)("ITEM_PART_SELECTED",(function(e,t,n,r,o){return{nodeId:e,itemId:t,allNodeIds:n,tableView:r,mailListItemSelectionSource:o}})),g=Object(c.action)("SELECT_NEXT_ITEM_PART",(function(e,t){return{rowKey:e,tableView:t}})),m=Object(c.action)("ON_ITEM_PART_CONTEXT_MENU",(function(e,t,n){return{contextMenuAnchor:e,nodeId:t,tableViewId:n}})),v=Object(c.action)("SINGLE_SELECT_ITEM_PART",(function(e,t,n,r,o){return{rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:r,currentSelectedNodeIds:o}})),j=Object(c.action)("TOGGLE_SELECT_ITEM_PART",(function(e){return{nodeId:e}})),_=Object(c.action)("TOGGLE_SELECT_ALL_ROWS",(function(e){return{tableView:e}})),y=Object(c.action)("RANGE_SELECT_ROW",(function(e,t,n,r){return{tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:r}})),N=Object(c.action)("RESET_SELECTION",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}})),h=Object(c.action)("RESET_SELECTION",(function(e){return{tableView:e}})),p=Object(c.action)("SELECT_ROW_IN_DIRECTION",(function(e,t,n){return Object(o.c)(C(n,e,void 0,t),{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})})),R=Object(c.action)("KEYBOARD_MULTI_SELECT_ROW",(function(e,t,n,r){return{tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:r}})),E=Object(c.action)("KEYBOARD_COLLAPSE_CONVERSATION",(function(e){return{rowKey:e}})),T=Object(c.action)("RESET_BUS_STOP_STATE_MAP"),S=Object(c.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(function(e,t,n){return{tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}}));function C(e,t,n,o){return{name:function(e,t,n,o){return!(function(e){return e===a.b.MailListItemRichPreview||e===a.b.KeyboardShiftEnter||e===a.b.MailListItemBodyDoubleClick}(e)||Object(u.c)()&&!function(e){var t;return e===a.b.KeyboardEnter||e===a.b.MailListItemBody||e===a.b.RouteHandler||e===a.b.CommandBarArrows||e===a.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(d.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,o){if(Object(u.c)())return!1;if(e===a.b.KeyboardUpDown){var c=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==c&&1===t.selectedRowKeys.size){var d=t.rowKeys.indexOf(Object(r.__spread)(t.selectedRowKeys.keys())[0]);return o===i.d.Next?d===c+1||d===t.rowKeys.length-1&&c===t.rowKeys.length-1:d===c-1||0===d&&0===c}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,o))}(e,t,n,o)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},1676:function(e,t,n){"use strict";function r(e,t){var n=Math.pow(2,32);if(e>=n||t>=n){var r=e%n,o=t%n;return(((e-=r)/n&(t-=o)/n)>>>0)*n+((r&o)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},1815:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r=1,o=16},183:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(10),o=new r.b((function(){return Promise.all([n.e(38),n.e(101),n.e(209),n.e(462)]).then(n.bind(null,586))})),i=new r.a(o,(function(e){return e.createApolloClient})),a=new r.a(o,(function(e){return e.wrapInApolloProvider})),c=new r.a(o,(function(e){return e.unblockBootResolvers}))},308:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d}));var r=n(0),o=n(183),i=null,a=null;function c(){return s(i),i}function u(){return s(a),a}function d(e){var t=e.lazyResolvers,n=e.lazyCreateManagedQueryLink,c=e.sessionPromise;return i=Promise.all([o.a.import(),t,n,c]).then((function(e){var t=Object(r.__read)(e,4),n=t[0],o=t[1],i=t[2],c=t[3];return a=n({resolvers:o,createManagedQueryLink:i,sessionData:c})}))}function s(e){if(!e)throw new Error("Apollo client has not been initialized yet.")}},3144:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(2283),o=n(1311),i=n(1518);function a(e,t,n,r){var a=new Date(o.b.getLastDeliveryTimeStamp(n,r)).getTime()-new Date(t).getTime();if(Object(i.l)(r.tableQuery)){var c=new Date(o.b.getLastDeliveryOrRenewTimeStamp(n,r)).getTime()-new Date(e).getTime();return 0!=c?c:a}return a}function c(e,t,n,o,a){return Object(r.a)(a,n.id,e)?Object(i.f)(n,0):u(e,t,n,o)}function u(e,t,n,i){var c=n.rowKeys.length;if(0==c)return 0;var u,d=Object(o.I)(n).sortDirection==o.c.DESCENDING_SORT_DIR;for(u=i;u<c;u++){var s=n.rowKeys[u];if(!Object(r.a)(s,n.id,e)){var l=a(e,t,s,n);if(d?l<=0:l>0)return u}}return c==n.totalRowsInView?c:-1}},340:function(e,t,n){"use strict";var r=n(308);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.c}));var o=n(183);n.d(t,"d",(function(){return o.c})),n.d(t,"c",(function(){return o.b}))},8281:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1510),o=n(1498);function i(e,t){var n=e[e.length-1],i=t.rowKeys.indexOf(n);i<t.rowKeys.length-1?Object(r.q)(t,t.rowKeys[i+1],!1,o.a.RowRemoval):Object(r.j)(t,o.a.Reset)}}}]);
//# sourceMappingURL=owa.1237.js.map
self.scriptsLoaded['owa.1237.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1237.js'] = (new Date()).getTime();