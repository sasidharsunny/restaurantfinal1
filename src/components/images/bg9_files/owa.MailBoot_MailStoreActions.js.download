self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailStoreActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[633],{1330:function(e,t,n){"use strict";var r,o,i=n(3),a=Object(i.action)("setOptionValue",(function(e,t){return{feature:e,value:t}})),s=Object(i.action)("assignOptionValue",(function(e,t){return{feature:e,value:t}})),c=Object(i.action)("verifyAndSetOptionValues",(function(e){return{potentialOptionValues:e}})),u=Object(i.action)("setOptionValue",(function(e,t){return{feature:e,value:t}})),l=n(0);!function(e){e[e.TestFeature=1]="TestFeature",e[e.SmartSuggestions=2]="SmartSuggestions",e[e.DiverseEmojis=4]="DiverseEmojis",e[e.SurfaceActions=5]="SurfaceActions",e[e.SkypeNotifications=6]="SkypeNotifications",e[e.WebPushNotifications=7]="WebPushNotifications",e[e.Confetti=8]="Confetti",e[e.GdprAdsPrefs=9]="GdprAdsPrefs",e[e.CalendarSurfaceAddins=10]="CalendarSurfaceAddins",e[e.ExternalImages=11]="ExternalImages",e[e.EventCapture=12]="EventCapture",e[e.Translation=14]="Translation",e[e.CalendarSurfaceOptions=15]="CalendarSurfaceOptions",e[e.TxpEventNotifications=16]="TxpEventNotifications",e[e.MentionEventNotifications=17]="MentionEventNotifications",e[e.ComposeAssistance=18]="ComposeAssistance",e[e.ActivityFeed=19]="ActivityFeed",e[e.AmpDeveloper=20]="AmpDeveloper",e[e.CalendarHelp=21]="CalendarHelp",e[e.LinkedInViewProfile=22]="LinkedInViewProfile",e[e.Bohemia=23]="Bohemia",e[e.GdprAdsV2=24]="GdprAdsV2",e[e.Proofing=25]="Proofing",e[e.ActiveProxyAddress=26]="ActiveProxyAddress",e[e.OutlookSpaces=27]="OutlookSpaces",e[e.GdprAdsV3=28]="GdprAdsV3",e[e.SxS=29]="SxS"}(r||(r={}));var d=Object(i.createStore)("owsOptionsStore",{options:(o={},o[r.SmartSuggestions]={feature:r.SmartSuggestions,smartSuggestionsEnabled:!1,browserLocationEnabled:!1},o[r.DiverseEmojis]={feature:r.DiverseEmojis,diverseEmojisSelectedSkinTone:""},o[r.SurfaceActions]={feature:r.SurfaceActions,readSurfaceActions:[],readSurfaceAddins:[],composeSurfaceActions:[],composeSurfaceAddins:[]},o[r.SkypeNotifications]={feature:r.SkypeNotifications,skypeMessageNotification:1,skypeCallingNotification:1},o[r.WebPushNotifications]={feature:r.WebPushNotifications,enabled:!1,applicationServerKey:null},o[r.Confetti]={feature:r.Confetti,confettiEnabled:!1},o[r.GdprAdsPrefs]={feature:r.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},o[r.GdprAdsV2]={feature:r.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},o[r.GdprAdsV3]={feature:r.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},o[r.CalendarSurfaceAddins]={feature:r.CalendarSurfaceAddins,calendarSurfaceAddins:[]},o[r.ExternalImages]={feature:r.ExternalImages,externalImagesSelectedOption:null},o[r.EventCapture]={autoCollectionEnabled:!1},o[r.Translation]={feature:r.Translation,translationMode:0,targetLanguage:"",excludedLanguages:[]},o[r.CalendarSurfaceOptions]={feature:r.CalendarSurfaceOptions,agendaPaneIsClosed:!0,lastKnownRoamingTimeZone:void 0,roamingTimeZoneNotificationsIsDisabled:void 0,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},o[r.MentionEventNotifications]={feature:r.MentionEventNotifications,enabled:!1},o[r.TxpEventNotifications]={feature:r.TxpEventNotifications,enabled:!1},o[r.ComposeAssistance]={feature:r.ComposeAssistance,composeAssistanceEnabled:!1},o[r.AmpDeveloper]={feature:r.AmpDeveloper,enabled:!0,allowedSender:[]},o[r.ActivityFeed]={feature:r.ActivityFeed,OWASurfaceOptions:{SupportedTypes:[],DisabledInFeedPanel:[]}},o[r.LinkedInViewProfile]={dismissed:!1},o[r.CalendarHelp]={feature:r.CalendarHelp,calendarHelpEnabled:!1},o[r.Bohemia]={feature:r.Bohemia,bohemiaEnabled:!1},o[r.Proofing]={feature:r.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!1,proofingLocale:void 0,overriddenOptions:void 0},o[r.ActiveProxyAddress]={feature:r.ActiveProxyAddress,activeProxyAddresses:[]},o[r.OutlookSpaces]={feature:r.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},o[r.SxS]={feature:r.SxS,hideReadingPane:!1},o)}),f=n(20);function m(e){return(null==e?void 0:e.feature)in r}var p,S=n(360);function v(e,t){d().options[e]=t}function b(e){return d().options[e]}Object(i.mutator)(s,(function(e){var t=e.feature,n=e.value;S(d().options[t],n)})),Object(i.mutator)(a,(function(e){v(e.feature,e.value)})),Object(i.mutator)(u,(function(e){var t=e.feature,n=e.value;Object(f.extendObservable)(d().options[t],n)})),Object(i.mutator)(c,(function(e){var t,n,r=e.potentialOptionValues;try{for(var o=Object(l.__values)(r),i=o.next();!i.done;i=o.next()){var a=i.value;a&&m(a)&&v(a.feature,a)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}})),function(e){e[e.Work=1]="Work",e[e.Life=2]="Life"}(p||(p={})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return r}))},16894:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1323),i=n(4257),a=n(285),s=function(e,t){var n=e,r=t;n.ToRecipients=r.ToRecipients,n.CcRecipients=r.CcRecipients,n.BccRecipients=r.BccRecipients};function c(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(t=Object(i.a)()).MaximumRecipientsToReturn=0,[4,Object(o.e)(e.ItemId.Id,t,"ItemPart")];case 1:return!(n=r.sent())||n instanceof Error||s(e,n),[2]}}))}))}s=Object(a.action)("updateItemRecipients")(s);var u=n(9824),l=n(9827),d=n(9828),f=n(4983),m=n(9825),p=n(9826),S=n(83),v=n(10932),b=n(4904),A=n(472);var g=n(80),w=n(1871),h=n(2743),P=n(59),O=n(2759),I=n(440),C="X-OWA-ActionSource",y="X-RedirectToOutlookService";var E=Object(a.action)("parseItemResponse")((function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,a;return Object(r.__generator)(this,(function(s){switch(s.label){case 0:return(n=o.u.items.get(t.Id))&&Object(p.a)(e,n),Object(f.a)()&&Object(m.b)(e),Object(l.a)(e),i=Object(r.__assign)(Object(r.__assign)({Smime:null,TranslationData:{isShowingTranslation:!1,isTranslatable:!1,isTranslating:!1,shouldGetFeedback:!1,isShowingSubjectTranslation:!1,isShowingForwardContentTranslation:!1,isForwardContentTranslatable:!1,manuallyTranslated:!1,userLanguage:null,isWrongLanguage:null},adaptiveCardDetails:null},e),{MailboxInfo:t.mailboxInfo,SmartReplyData:null,SmartTimeData:null,SmartTimeExtendedProperty:null,smartPillFeedbackSubmitted:!1,itemCLPInfo:null,SIGSData:{SmartPillData:null}}),o.u.items.set(t.Id,i),a=o.u.items.get(t.Id),Object(u.a)(a),Object(h.a)(n)?[4,w.l.importAndExecute(a,n)]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}}))}))}));function j(e,t,n,r,a){var s;n&&(s=n.addCheckmark("request_start"));var c=Object(I.a)(e.mailboxInfo)||{},u=new Headers;r&&u.set(O.c,O.d),u.set(C,t),c.headers=u,Object(S.i)("platform-redirectGetItemToOutlookService")&&!Object(g.a)(c)&&c.headers.set(y,"true"),c.datapoint={customData:{actionSource:t}};var l,f=Object(i.a)();return Object(v.a)(f),Object(b.a)(f),l=f,Object(S.i)("rp-omeRevocation")&&l.AdditionalProperties.push(Object(A.a)({PropertyName:"x-ms-exchange-organization-ome-messagestate",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"})),Object(o.e)(e.Id,f,"ItemNormalizedBody","V2017_08_18",e.mailboxInfo,c,a).then((function(r){if(n){var i=n.addCheckmark("request_end");n.addCustomData({requestTime:i-s})}if(r instanceof Error||null===r){switch(t){case"PrefetchFirstN":case"PrefetchSingleRow":case"PrefetchRowInCache":case"PrefetchAdjacentRowsOnDelay":break;default:P.g.warn(t+": "+(r instanceof Error?r.message:r))}return r instanceof Error?Promise.reject(r):Promise.resolve(null)}return E(r,e).then((function(){return o.u.items.get(e.Id)}))})).catch((function(e){return e.message+=", ActionSource="+t,Object(d.a)(t)?Promise.resolve():Promise.reject(e)}))}var D=n(7269);n.d(t,"loadAllRecipientsForItem",(function(){return c})),n.d(t,"loadItem",(function(){return j})),n.d(t,"loadConversation",(function(){return D.b}))},183:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(10),o=new r.b((function(){return Promise.all([n.e(38),n.e(101),n.e(209),n.e(462)]).then(n.bind(null,586))})),i=new r.a(o,(function(e){return e.createApolloClient})),a=new r.a(o,(function(e){return e.wrapInApolloProvider})),s=new r.a(o,(function(e){return e.unblockBootResolvers}))},1847:function(e,t,n){"use strict";var r=n(269),o=n(324),i={tenantTokens:Object(r.e)(),isCore:!0};function a(e,t,n){var a=new o.a(e,t,i);n&&a.addCosmosOnlyData(n),r.l.importAndExecute(a)}function s(e){return new r.a(e,i)}var c=n(556);function u(){return{ariaTenantTokens:Object(c.a)(),flightControls:{client_event:{flight:"ana-client-event",rate:5},client_error:{flight:"ana-client-error"},client_verbose:{flight:"ana-client-verbose",rate:1},client_network_request:{flight:"ana-client-network-request",rate:1}},verboseWhiteListEvents:["AttachmentRefreshDownloadToken","TabViewActivateTab"],qosDatapointNames:["AddMemberModalSave","CreateGrouptoAddMembers","EditGroupModalSave","ForwardInSMIME","GroupFilesHubEnsureAuthToken","GroupFilesHubListsLoad","GroupMailComposeSend","InlineImageLoad","loadSuggestedGroupsAction","MailComposeForward","MailComposeNew","MailComposeReply","MailComposeReplyAll","MailComposeSend","MessageOptionsEmptyInvariantViolation","MessageOptionsMultipleDialogsInvariantViolation","NavigateFromMeToWe","OpenItemPeek","PreviewAttachmentInSxSE2E","ReplyAllInSMIME","ReplyInSMIME","SaveCalendarEvent","SearchEndToEnd","SelectGroup","SelectMailItem","showFullCompose","showFullComposeInEditMode","showQuickCompose","showReadingPane","SwitchGroup","SwitchMailFolder","TnS_DeleteConversation","TnS_DeleteItem","UnreadCountNotification","ViewCalendarEvent"],sampledQosDatapointNames:["LoadGroupsInLeftNavFromSessionData"]}}n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u}))},1871:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return a})),n.d(t,"o",(function(){return s})),n.d(t,"q",(function(){return c})),n.d(t,"p",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return m})),n.d(t,"k",(function(){return p})),n.d(t,"n",(function(){return S})),n.d(t,"r",(function(){return v})),n.d(t,"c",(function(){return b})),n.d(t,"d",(function(){return A})),n.d(t,"j",(function(){return g})),n.d(t,"f",(function(){return w})),n.d(t,"i",(function(){return h})),n.d(t,"a",(function(){return P}));var r=n(77),o=new r.c((function(){return Promise.all([n.e(1),n.e(14),n.e(32),n.e(33),n.e(39),n.e(62),n.e(63),n.e(67),n.e(120),n.e(217),n.e(805)]).then(n.bind(null,3225))})),i=new r.a(o,(function(e){return e.onSmimeItemAttachmentOpened})),a=new r.a(o,(function(e){return e.mergeSmimeDecodedMessageProperties})),s=(new r.b(o,(function(e){return e.fetchAndDecodeSmimeMessage})),new r.b(o,(function(e){return e.setSmimePropertiesInDraftMessage}))),c=new r.b(o,(function(e){return e.trySetSmimeProperties})),u=new r.b(o,(function(e){return e.tryAddSmimeProperties})),l=new r.b(o,(function(e){return e.createMailResponseBodyContent})),d=new r.b(o,(function(e){return e.downloadSmimeAttachment})),f=new r.b(o,(function(e){return e.getMergedSmimeViewState})),m=new r.b(o,(function(e){return e.getMergedSmimeViewStateForDraft})),p=new r.b(o,(function(e){return e.isSmimeItemDecoding})),S=new r.b(o,(function(e){return e.previewSmimeAttachment})),v=new r.b(o,(function(e){return e.updateSmimeAttachmentIds})),b=new r.b(o,(function(e){return e.createSmimeAttachmentsFromFiles})),A=new r.b(o,(function(e){return e.createSmimeAttachmentsViaSmimeQueueManager})),g=new r.b(o,(function(e){return e.initializeAttachmentStateForSmimeAttachments})),w=new r.b(o,(function(e){return e.getAttachmentsForSmimeResponse})),h=new r.b(o,(function(e){return e.getSmimeAttachmentsForRequest})),P=Object(r.d)(o,(function(e){return e.SignatureDetails}))},2131:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}));var r=n(3),o=Object(r.action)("CONVERSATION_READY_TO_LOAD",(function(e,t){return{conversationId:e,nodeIdCollectionChange:t}})),i=Object(r.action)("UPDATE_ATTACHMENTS"),a=Object(r.action)("UPDATE_ITEM_MANDATORY_PROPERTIES",(function(e,t){return{conversationId:e,nodeIdCollectionWithItemMandatoryPropertiesChanged:t}}))},2743:function(e,t,n){"use strict";t.a=function(e){var t;return null===(t=null==e?void 0:e.Smime)||void 0===t?void 0:t.isDecoded}},2759:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r="X-OWA-SmimeInstalled",o="1",i="SmimeWithoutActiveX",a="message/rfc822",s="ErrorSmimeSendCancelled"},308:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var r=n(0),o=n(183),i=null,a=null;function s(){return l(i),i}function c(){return l(a),a}function u(e){var t=e.lazyResolvers,n=e.lazyCreateManagedQueryLink,s=e.sessionPromise;return i=Promise.all([o.a.import(),t,n,s]).then((function(e){var t=Object(r.__read)(e,4),n=t[0],o=t[1],i=t[2],s=t[3];return a=n({resolvers:o,createManagedQueryLink:i,sessionData:s})}))}function l(e){if(!e)throw new Error("Apollo client has not been initialized yet.")}},340:function(e,t,n){"use strict";var r=n(308);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.c}));var o=n(183);n.d(t,"d",(function(){return o.c})),n.d(t,"c",(function(){return o.b}))},440:function(e,t,n){"use strict";var r=n(0);function o(e,t){return e?Object(r.__assign)({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,"a",(function(){return o}))},4904:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(83),o=n(472);function i(e){var t;Object(r.i)("cmp-clp")&&(null===(t=e.AdditionalProperties)||void 0===t||t.push(Object(o.a)({PropertyName:"msip_labels",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"})))}}}]);
//# sourceMappingURL=owa.MailBoot~MailStoreActions.js.map
self.scriptsLoaded['owa.MailBoot~MailStoreActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailStoreActions.js'] = (new Date()).getTime();