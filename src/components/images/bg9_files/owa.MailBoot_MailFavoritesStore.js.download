self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailFavoritesStore.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[617],{12068:function(e){e.exports=JSON.parse('{"a":"gvb"}')},16654:function(e,t,i){"use strict";i.r(t);var r=i(0),a=i(3),n=i(74),o=i(83),s=i(1368),c=1e4,d={folderId:"",timeRemoved:null};function l(e){return!(!d.folderId||d.folderId!=e)&&(new Date).getTime()-d.timeRemoved.getTime()<c}var u=Object(a.action)("ADD_FAVORITE_FOLDER",(function(e,t){return Object(n.c)({name:Object(o.i)("tri-favorites-roaming")?"AddOutlookFavoriteFolder":"AddFavoriteFolder",customData:{actionSource:t,distinguishedFolderName:Object(s.a)(e),wasFolderUnfavoritedRecently:l(e)}},{folderIdToAdd:e,actionSource:t})})),f=i(3363),p=i(547),m=i(6907),v=i(6908);function b(e,t){var i=function(e,t){var i=Object(p.a)({Id:e.FolderId.Id,ChangeKey:e.FolderId.ChangeKey});return Object(m.a)({Folder:Object(f.a)({FolderId:i,DisplayName:e.DisplayName}),Operation:t?0:1})}(e,t);return Object(v.a)({request:i}).then((function(e){return e}))}var w=i(1312),O=i(285),M=i(1338),g=i(1572),j=Object(O.action)("addFavoriteFolderV1")(Object(O.select)({favoritesFolderNodes:function(){return M.favoritesStore.favoritesFolderNodes},orderedFavoritesNodeIds:function(){return M.favoritesStore.orderedFavoritesNodeIds},folder:function(e,t){return void 0===t&&(t=0),0==t?w.d.folderTable.get(e):g.a.folderTable.get(e)}})((function(e,t,i){if(void 0===t&&(t=0),i.favoritesFolderNodes.has(e))throw new Error("addFavoriteFolderV1: Cannot add duplicate folder to favorites.");i.orderedFavoritesNodeIds.push(e),i.favoritesFolderNodes.set(e,{id:e,type:t}),Object(M.updateFavoritesUserOption)(),b(i.folder,!0)}))),F=(Object(a.orchestrator)(u,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return t=e.folderIdToAdd,Object(o.i)("tri-favorites-roaming")?[4,M.lazyAddFavoriteFolderV2.import()]:[3,2];case 1:return i.sent()(t),[3,3];case 2:j(t),i.label=3;case 3:return[2]}}))}))})),Object(a.action)("REMOVE_FAVORITE_FOLDER",(function(e,t){return Object(n.c)({name:Object(o.i)("tri-favorites-roaming")?"RemoveFavoriteFolderV2":"RemoveFavoriteFolderV1",customData:{actionSource:t,distinguishedFolderName:Object(s.a)(e)}},{folderIdToRemove:e,actionSource:t})}))),I=Object(O.action)("removeFavoriteFolderV1")(Object(O.select)({favoritesFolderNodes:function(){return M.favoritesStore.favoritesFolderNodes},orderedFavoritesNodeIds:function(){return M.favoritesStore.orderedFavoritesNodeIds}})((function(e,t){if(!t.favoritesFolderNodes.has(e))throw new Error("removeFavoriteFolderV1: Cannot find the folder id in favorite folder list.");var i=0==M.favoritesStore.favoritesFolderNodes.get(e).type?w.d.folderTable.get(e):g.a.folderTable.get(e);t.orderedFavoritesNodeIds.splice(t.orderedFavoritesNodeIds.indexOf(e),1),t.favoritesFolderNodes.delete(e),Object(M.updateFavoritesUserOption)(),d={folderId:e,timeRemoved:new Date},b(i,!1)}))),V=(Object(a.orchestrator)(F,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return t=e.folderIdToRemove,Object(o.i)("tri-favorites-roaming")?[4,M.lazyRemoveFavoriteFolderV2.import()]:[3,2];case 1:return i.sent()(t),[3,3];case 2:I(t),i.label=3;case 3:return[2]}}))}))})),i(6909)),L=i(5168),h=i(3275),N=i(1454);Object(a.orchestrator)(M.onCategoryFavorited,(function(e){var t=e.categoryId;V.a(t),function(e){var t=Object(h.a)(e),i=Object(N.c)(t,!0);Object(L.d)(i,!1,(function(t,i,r,a){return function(e){V.b(e)}(e)}))}(t)}));Object(a.orchestrator)(M.onCategoryUnfavorited,(function(e){V.b(e.categoryId)}));var R=i(12068),S=i(7451),A=i(6690),y=i(7452),C=i(6691),D=i(12),_=i(2642);function P(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i;return Object(r.__generator)(this,(function(r){return t=e?_.c.RemoveFavoritePersonaFailedNotification:_.c.AddFavoritePersonaFailedNotification,Object(_.g)(t,null),i={actionType:t,title:e?Object(D.b)(A.a):Object(D.b)(C.a),description:e?Object(D.b)(S.a):Object(D.b)(y.a),actionLink:Object(D.b)(R.a)},Object(_.f)(i),[2]}))}))}var T=i(59);function k(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(i){return t=e?Object(D.b)(A.a):Object(D.b)(C.a),T.g.warn(t),[2]}))}))}Object(a.orchestrator)(M.addFavoriteFailed,(function(e){var t=e.favoriteKind;"persona"===t?P(!1):"privatedistributionlist"===t&&k(!1)}));var E=i(2724),x=i(5572),U=(Object(a.orchestrator)(E.a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.personas,i=t.map((function(e){return e.searchFolderId})).filter((function(e){return!!e})),[4,Object(x.b)(i)];case 1:return a=r.sent(),Object(w.U)(a,t),[2]}}))}))})),Object(a.orchestrator)(M.removeFavoriteFailed,(function(e){var t=e.favoriteKind,i=e.error;i&&404===i.statusCode||("persona"===t?P(!0):"privatedistributionlist"===t&&k(!0))})),Object(O.action)("markFavoritePersonaNodeAsAdded")(Object(O.select)({favoritesPersonaNodes:function(){return M.favoritesStore.favoritesPersonaNodes}})((function(e,t){var i=t.favoritesPersonaNodes.get(e);i&&(i.isJustAdded=!1)})))),q=i(9854),z=i(10945),J=i(362),K=i(269),B=i(2300),Q=Object(n.d)("validateAndUpdateFavorite",B.a.ValidateAndUpdateFavorite)((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,a,n,o,s,c,d,l,u,f,p,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(M.getStore)(),i=t.favoritesPersonaNodes.get(e),a=Object(J.b)(e)?e:"",i.personaId?(n=Object(z.a)(i.mainEmailAddress,i.displayName,!1),[4,Object(q.a)(i.personaId)]):[3,5];case 1:return(m=r.sent())?(s=m,[3,4]):[3,2];case 2:return[4,n];case 3:s=r.sent(),r.label=4;case 4:return(o=s)?(c=o.DisplayName,d=G(o.EmailAddress),l=(o.EmailAddresses||[]).map(G),u=i.displayName!==c,f=i.mainEmailAddress!==d,v=i.allEmailAddresses,b=l,p=!(v&&b&&v.length===b.length&&v.every((function(e){return b.includes(e)}))),u||f||p?(Object(K.p)("ValidateAndUpdateFavorite: Change Detected",["ContactToUpdatedContact",a,u,f,p]),H(i,c,d,l,o.PersonaId.Id),[2,!0]):[2,!1]):(Object(K.p)("ValidateAndUpdateFavorite: Change Detected",["ContactToRecipentCache",a]),H(i,i.displayName,i.mainEmailAddress,i.allEmailAddresses),[2,!0]);case 5:return[4,Object(z.a)(i.mainEmailAddress,i.displayName,!1)];case 6:return(m=r.sent())?(Object(K.p)("ValidateAndUpdateFavorite: Change Detected",["RecipientCacheToContact",a]),H(i,m.DisplayName,G(m.EmailAddress),m.EmailAddresses.map(G),m.PersonaId.Id),[2,!0]):[2,!1];case 7:return[2]}var v,b}))}))})),H=Object(O.action)("updatePersona")((function(e,t,i,r,a){e.displayName=t||i,e.mainEmailAddress=i,e.allEmailAddresses=r,a?e.personaId=a:delete e.personaId}));function G(e){return e?e.RoutingType&&"EX"===e.RoutingType.toUpperCase()?e.OriginalDisplayName:e.EmailAddress||e.OriginalDisplayName:""}var X=i(8274),Y=i(1392),W=Object(O.action)("updateSelectedNodeWithNewPersona")((function(e){var t=Object(M.getStore)().favoritesPersonaNodes.get(e),i=Object(Y.d)();i.selectedNode=Object(r.__assign)(Object(r.__assign)({},i.selectedNode),{displayName:t.displayName,mainEmailAddress:t.mainEmailAddress})})),$=i(9856),Z=Object(n.d)("onFavoritePersonaSelected",B.a.OnFavoritePersonaSelectedAction)(Object(O.select)({favoritesPersonaNodes:function(){return M.favoritesStore.favoritesPersonaNodes}})((function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,n,o,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if((i=t.favoritesPersonaNodes.get(e)).isSyncUpdateDone)return[2];r.label=1;case 1:return r.trys.push([1,6,,7]),[4,Q(i.id)];case 2:return(a=r.sent())&&W(i.id),[4,Object(X.a)(i,"OnClick",a)];case 3:return(n=r.sent())&&setTimeout((function(){Object($.b)(i.id)}),$.a),a||n?[4,Object(M.updateFavoritesUserOption)()]:[3,5];case 4:r.sent(),r.label=5;case 5:return[3,7];case 6:return o=r.sent(),s="UpdatePersonaAndSearchFolderFailure",T.g.warn(s+": "+o),Object(K.p)(s,[o.toString()]),[3,7];case 7:return[2]}}))}))}))),ee=Object(n.d)("onFavoritePersonaUpdated",B.a.OnFavoritePersonaUpdatedAction)((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(M.getStore)().favoritesPersonaNodes.get(e),[4,Q(t.id)];case 1:return i=r.sent(),[4,Object(X.a)(t,"OnFavoriteUpdate",i)];case 2:return a=r.sent(),i||a?[4,Object(M.updateFavoritesUserOption)()]:[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}));function te(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,a,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e.markedForDeletion?[4,Object(x.a)([e.searchFolderId],!0)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[3,4];case 3:return t=r.sent(),i=B.a.DeleteFolderFailure,a=i.name,n=i.customData,T.g.warn(a+": "+t),Object(K.p)(a,n(t.toString())),[3,4];case 4:return[2]}}))}))}var ie=i(2301),re=Object(n.d)("removeFavoritePersona",B.a.RemoveFavoritePersonaAction)((function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,a,n,o,s,c,d,l,u,f,p,m;return Object(r.__generator)(this,(function(v){switch(v.label){case 0:t=Object(M.getStore)(),i=t.favoritesPersonaNodes.get(e),a=void 0,n=!1,v.label=1;case 1:if(v.trys.push([1,9,,10]),!i)throw new Error("RemoveFavoritePersona - NodeId could not be found in the store");if(a=i.mainEmailAddress||i.personaId||i.id,Object(ie.a)(a))throw new Error("RemoveFavoritePersona - Favoriting is already in progress");return V.a(a),n=!0,(o=t.orderedFavoritesNodeIds.indexOf(e))>-1&&t.orderedFavoritesNodeIds.splice(o,1),t.favoritesPersonaNodes.delete(e),[4,Object(M.updateFavoritesUserOption)()];case 2:v.sent(),s=i.searchFolderId,v.label=3;case 3:return v.trys.push([3,7,,8]),s?(c=Object(Y.c)()).id!==e?[3,4]:(c.markedForDeletion=!0,[3,6]):[3,6];case 4:return[4,Object(x.a)([s],!0)];case 5:v.sent(),v.label=6;case 6:return[3,8];case 7:return d=v.sent(),l=B.a.DeleteFolderFailure,p=l.name,u=l.customData,T.g.warn(p+": "+d),Object(K.p)(p,u(d.toString())),[3,8];case 8:return V.b(a),[3,10];case 9:throw f=v.sent(),n&&V.b(a),p="RemoveFavoritePersonaFailure",T.g.warn(p+": "+f),m=t.favoritesPersonaNodes.size,Object(K.p)(p,[f.toString(),e,m.toString()]),i&&!t.favoritesPersonaNodes.has(i.id)&&(t.orderedFavoritesNodeIds.push(i.id),t.favoritesPersonaNodes.set(i.id,i)),Object(r.__assign)({type:"RemoveFavoritePersonaError"},f);case 10:return[2]}}))}))}));function ae(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return Object(o.i)("tri-favorites-roaming")?[4,M.lazyRemoveFavoritePersonaV2.import()]:[3,2];case 1:return i.sent()(e,t),[3,4];case 2:return[4,re(e,t)];case 3:return[2,i.sent()];case 4:return[2]}}))}))}var ne=Object(n.d)("RemoveFavoriteSearch",B.a.RemoveFavoriteSearch)((function(e,t){var i=Object(M.getStore)();if(!i.favoriteSearches.has(e))throw new Error("Cannot find the search query in favorite search list.");i.orderedFavoritesNodeIds.splice(i.orderedFavoritesNodeIds.indexOf(e),1),i.favoriteSearches.delete(e),Object(M.updateFavoritesUserOption)()})),oe=i(30),se=i(367);function ce(){var e=!Object(oe.a)().UserOptions.IsFavoritesFolderTreeCollapsed;Object(se.a)((function(t){t.UserOptions.IsFavoritesFolderTreeCollapsed=e}),[{key:"IsFavoritesFolderTreeCollapsed",valuetype:"Boolean",value:[String(e)]}])}var de=i(9294),le=i(9855),ue=i(1783),fe=Object(n.d)("initializeFavoritePersonas",B.a.InitializeFavoritePersonasAction)((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return[4,Object(x.c)()];case 1:return t=i.sent(),Object(ue.getStore)().favoritePersonasRootFolderId=t,[4,pe(t,e)];case 2:return i.sent(),[2]}}))}))}));function pe(e,t){return Object(x.e)(t,e).then((function(e){e.forEach((function(e){Object(le.a)(e)}))})).catch((function(e){var t="RetrievePersonaSearchFoldersFailed";T.g.warn(t+": "+e),Object(K.p)(t,[e.toString()])}))}i.d(t,"addFavoriteFolder",(function(){return u})),i.d(t,"removeFavoriteFolder",(function(){return F})),i.d(t,"addFavoriteFolderV1",(function(){return j})),i.d(t,"removeFavoriteFolderV1",(function(){return I})),i.d(t,"markFavoritePersonaNodeAsAdded",(function(){return U})),i.d(t,"onFavoritePersonaSelected",(function(){return Z})),i.d(t,"onFavoritePersonaUpdated",(function(){return ee})),i.d(t,"onSelectedPersonaNodeChanged",(function(){return te})),i.d(t,"removeFavoritePersona",(function(){return ae})),i.d(t,"handleToggleFavoritePersonaError",(function(){return P})),i.d(t,"removeFavoriteSearch",(function(){return ne})),i.d(t,"toggleFavoritesTreeExpansion",(function(){return ce})),i.d(t,"addFavoritePersona",(function(){return de.a})),i.d(t,"initializeFavoritePersonas",(function(){return fe})),i.d(t,"outlookFavoritePersonasLoaded",(function(){return E.a}))},183:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return o})),i.d(t,"b",(function(){return s}));var r=i(10),a=new r.b((function(){return Promise.all([i.e(38),i.e(101),i.e(209),i.e(462)]).then(i.bind(null,586))})),n=new r.a(a,(function(e){return e.createApolloClient})),o=new r.a(a,(function(e){return e.wrapInApolloProvider})),s=new r.a(a,(function(e){return e.unblockBootResolvers}))},1860:function(e,t,i){"use strict";var r=i(3);t.a=Object(r.createStore)("headerToastNotificationViewState",{notificationViewStates:[]})()},1861:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return n}));var r="Calling",a="UnreadMessage",n="Summary"},1991:function(e,t,i){"use strict";var r=i(285),a=i(1860);t.a=Object(r.action)("removeNotification")((function(e){var t=a.a.notificationViewStates.indexOf(e);t>=0&&a.a.notificationViewStates.splice(t,1)}))},2027:function(e,t,i){"use strict";var r;i.d(t,"a",(function(){return r})),function(e){e[e.AsyncSendFailed=0]="AsyncSendFailed",e[e.AddFavoritePersonaFailedNotification=1]="AddFavoritePersonaFailedNotification",e[e.RemoveFavoritePersonaFailedNotification=2]="RemoveFavoritePersonaFailedNotification",e[e.PeopleHubNotification=3]="PeopleHubNotification",e[e.SkypeNotification=4]="SkypeNotification",e[e.SkypeForBusinessNotification=5]="SkypeForBusinessNotification"}(r||(r={}))},2255:function(e,t,i){"use strict";var r=i(1454),a=i(1518),n=i(1311),o=i(285);t.a=Object(o.action)("onLoadInitialRowsSucceeded")((function(e,t,i,o,s){2==e.tableQuery.type&&s&&(e.serverFolderId=s.Id),o&&(e.serverFolderId=o.Id);var c=Object(n.e)(e);Object(a.h)(t,e,i,c,e.isInitialLoadComplete,"MergeOnInitialRowsFetch"),e.currentLoadedIndex=Math.min(r.b,e.rowKeys.length)}))},2297:function(e,t,i){"use strict";var r=i(0),a=i(285),n=i(1860),o=0;t.a=Object(a.action)("addNotification")((function(e){var t=Object(r.__assign)({id:o++},e);n.a.notificationViewStates.push(t)}))},2298:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return s}));var r=i(2027),a=i(1991),n={};function o(e,t){var i=r.a[e];n[i]||(n[i]=t)}function s(e){var t=n[r.a[e.actionType]];t&&t(e),Object(a.a)(e)}},2482:function(e,t,i){"use strict";var r=i(3);t.a=Object(r.action)("EMPTY_FOLDER_STORE_UPDATE",(function(e,t,i,r){return{folder:e,clientLastSyncTime:t,deletedItemsFolderId:i,rowKeysToExclude:r}}))},2642:function(e,t,i){"use strict";i.d(t,"d",(function(){return u})),i.d(t,"i",(function(){return f}));var r=i(77),a=i(2297);i.d(t,"f",(function(){return a.a}));var n=i(2027);i.d(t,"c",(function(){return n.a}));var o=i(2298);i.d(t,"g",(function(){return o.a}));var s=i(1861);i.d(t,"a",(function(){return s.a})),i.d(t,"b",(function(){return s.b})),i.d(t,"e",(function(){return s.c}));var c=i(1860);i.d(t,"h",(function(){return c.a}));var d=i(1991);i.d(t,"j",(function(){return d.a}));var l=new r.c((function(){return Promise.all([i.e(0),i.e(2),i.e(3),i.e(6),i.e(14),i.e(654)]).then(i.bind(null,4683))})),u=Object(r.d)(l,(function(e){return e.NotificationToast})),f=new r.a(l,(function(e){return e.addNotification}))},2912:function(e,t,i){"use strict";var r=i(2255),a=i(1311),n=i(1493),o=i(1518),s=i(1454),c=i(1892),d=i(547),l=i(2923);var u=i(2411);var f=i(59),p=i(3);function m(e,t,i){switch(v(e),e.tableQuery.listViewType){case 0:return function(e,t,i){var u,f=e.tableQuery,p=null===(u=Object(a.j)(e,!0))||void 0===u?void 0:u.Id,m=f.viewFilter&&"All"!==f.viewFilter,v=a.c.getDefaultSortBy(),b=v.sortColumn,w=v.sortDirection,O=f.sortBy&&(f.sortBy.sortColumn!==b||f.sortBy.sortDirection!==w);return Object(c.d)(f.folderId,s.a,f.viewFilter,f.sortBy,Object(o.l)(f),f.focusedViewFilter,f.requestShapeName,Object(n.d)(f),void 0,f.categoryName,p,{datapoint:{customData:{scenarioType:f.scenarioType,isPrefetch:t,isFilter:m,isSort:O}}},f.shouldTryToUseSessionDataResponse).then((function(a){var n=[];return a.edges&&(n=a.edges.map((function(e){return e.node}))),Object(r.a)(e,n,a.totalConversationRowsInView,a.searchFolderId?Object(d.a)({Id:a.searchFolderId}):null,a.folderId?Object(d.a)({Id:a.folderId}):null),i(e,!0,"200",t),Promise.resolve()})).catch((function(r){var a=Object(l.a)(r);return i(e,!1,a,t),Promise.reject(r)}))}(e,t,i);case 1:return function(e,t,i){var o=e.tableQuery;return Object(c.c)(Object(a.i)(o),0,s.a,o.viewFilter,Object(u.a)(o),o.focusedViewFilter,o.requestShapeName,o.shouldTryToUseSessionDataResponse,Object(n.e)(o),o.categoryName,Object(a.j)(e,!0)).then((function(a){var n=Promise.resolve(),o="Success"==a.ResponseClass;if(o)Object(r.a)(e,a.RootFolder.Items,a.RootFolder.TotalItemsInView,a.SearchFolderId,null);else{var s=new Error("ResponseCode="+a.ResponseCode+", Stacktrace="+a.StackTrace);s.fetchErrorType="ServerFailure",n=Promise.reject(s)}return i(e,o,a.ResponseCode,t),n}),(function(r){var a,n=(null===(a=null==r?void 0:r.response)||void 0===a?void 0:a.status)||"";return i(e,!1,n,t),Promise.reject(r)}))}(e,t,i);default:return f.g.warn("listViewType: "+e.tableQuery.listViewType+" is not supported."),Promise.resolve()}}i.d(t,"a",(function(){return m}));var v=Object(p.mutatorAction)("setTableViewLoading",(function(e){e.isLoading=!0,e.loadErrorStatus=0}))},308:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return c})),i.d(t,"c",(function(){return d}));var r=i(0),a=i(183),n=null,o=null;function s(){return l(n),n}function c(){return l(o),o}function d(e){var t=e.lazyResolvers,i=e.lazyCreateManagedQueryLink,s=e.sessionPromise;return n=Promise.all([a.a.import(),t,i,s]).then((function(e){var t=Object(r.__read)(e,4),i=t[0],a=t[1],n=t[2],s=t[3];return o=i({resolvers:a,createManagedQueryLink:n,sessionData:s})}))}function l(e){if(!e)throw new Error("Apollo client has not been initialized yet.")}},3146:function(e,t,i){"use strict";var r=i(3);t.a=Object(r.action)("UPDATE_TABLE_CURRENT_LOADED_INDEX",(function(e,t){return{tableViewId:e,currentLoadedIndexToSet:t}}))},340:function(e,t,i){"use strict";var r=i(308);i.d(t,"a",(function(){return r.a})),i.d(t,"b",(function(){return r.c}));var a=i(183);i.d(t,"d",(function(){return a.c})),i.d(t,"c",(function(){return a.b}))},3624:function(e,t,i){"use strict";var r;!function(e){e[e.None=-1]="None",e[e.Categories=0]="Categories",e[e.ImportanceHigh=1]="ImportanceHigh",e[e.Attachment=2]="Attachment",e[e.MailListViewReplied=3]="MailListViewReplied",e[e.MailListViewForwarded=4]="MailListViewForwarded",e[e.MailListViewIRM=5]="MailListViewIRM",e[e.MailListViewIRMReplied=6]="MailListViewIRMReplied",e[e.MailListViewIRMForwarded=7]="MailListViewIRMForwarded",e[e.MailListViewVoiceMailItem=8]="MailListViewVoiceMailItem",e[e.MailListViewVoiceMailReplied=9]="MailListViewVoiceMailReplied",e[e.MailListViewVoiceMailForwarded=10]="MailListViewVoiceMailForwarded",e[e.MailListViewVoiceMailIRM=11]="MailListViewVoiceMailIRM",e[e.MailListViewFaxItem=12]="MailListViewFaxItem",e[e.MailListViewAppointmentItem=13]="MailListViewAppointmentItem",e[e.MailListViewAppointmentAccepted=14]="MailListViewAppointmentAccepted",e[e.MailListViewAppointmentDeclined=15]="MailListViewAppointmentDeclined",e[e.MailListViewAppointmentTentative=16]="MailListViewAppointmentTentative",e[e.MailListViewAppointmentCanceled=17]="MailListViewAppointmentCanceled",e[e.MailListViewContactItem=18]="MailListViewContactItem",e[e.MailListViewTaskItem=19]="MailListViewTaskItem",e[e.MailListViewTaskReocurItem=20]="MailListViewTaskReocurItem",e[e.MailListViewJournalItem=21]="MailListViewJournalItem",e[e.MailListViewPostItem=22]="MailListViewPostItem",e[e.MailListViewNoteItem=23]="MailListViewNoteItem",e[e.MailListViewDelivery=24]="MailListViewDelivery",e[e.MailListViewNonDelivery=25]="MailListViewNonDelivery",e[e.MailListViewApprovalRequest=26]="MailListViewApprovalRequest",e[e.MailListViewResponseApprove=27]="MailListViewResponseApprove",e[e.MailListViewResponseReject=28]="MailListViewResponseReject",e[e.MailListViewOutOfOffice=29]="MailListViewOutOfOffice",e[e.MailListViewReadReport=30]="MailListViewReadReport",e[e.MailListViewReminderMessage=31]="MailListViewReminderMessage",e[e.Smime=32]="Smime",e[e.TrustedSender=33]="TrustedSender",e[e.Charm=34]="Charm",e[e.ImportanceLow=35]="ImportanceLow",e[e.GlobalMentionedMe=36]="GlobalMentionedMe",e[e.Like=37]="Like",e[e.Snooze=38]="Snooze",e[e.ReadGlobalMentionedMe=39]="ReadGlobalMentionedMe",e[e.Link=40]="Link"}(r||(r={})),t.a=r},501:function(e,t,i){var r;
/*!
  Copyright (c) 2016 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var i={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var n=typeof r;if("string"===n||"number"===n)e.push(r);else if(Array.isArray(r))e.push(a.apply(null,r));else if("object"===n)for(var o in r)i.call(r,o)&&r[o]&&e.push(o)}}return e.join(" ")}e.exports?e.exports=a:void 0===(r=function(){return a}.apply(t,[]))||(e.exports=r)}()},5168:function(e,t,i){"use strict";var r=i(77),a=i(1510),n=i(2482),o=i(3624),s=i(5623),c=i(14),d=i(501),l=i(7416);function u(e){switch(e){case o.a.ReadGlobalMentionedMe:return d(l.accountsRead,Object(c.getIconClassName)("Accounts"));case o.a.GlobalMentionedMe:return d(l.accounts,Object(c.getIconClassName)("Accounts"));case o.a.Attachment:return Object(c.getIconClassName)("Attach");case o.a.ImportanceLow:return Object(c.getIconClassName)("Down");case o.a.ImportanceHigh:return d(l.redDark,Object(c.getIconClassName)("Important"));case o.a.Like:return Object(c.getIconClassName)("Like");case o.a.Snooze:return d(l.snooze,Object(c.getIconClassName)("Clock"));case o.a.MailListViewReplied:return Object(c.getIconClassName)("Reply");case o.a.MailListViewForwarded:return Object(c.getIconClassName)("Forward");case o.a.MailListViewIRM:case o.a.MailListViewIRMReplied:case o.a.MailListViewIRMForwarded:return Object(c.getIconClassName)("Lock");case o.a.MailListViewVoiceMailItem:return Object(c.getIconClassName)("Memo");case o.a.MailListViewVoiceMailReplied:return Object(c.getIconClassName)("VoicemailReply");case o.a.MailListViewVoiceMailForwarded:return Object(c.getIconClassName)("VoicemailForward");case o.a.MailListViewVoiceMailIRM:return Object(c.getIconClassName)("VoicemailIRM");case o.a.MailListViewFaxItem:return Object(c.getIconClassName)("Fax");case o.a.MailListViewAppointmentItem:return Object(c.getIconClassName)("Event");case o.a.MailListViewAppointmentAccepted:return Object(c.getIconClassName)("EventAccepted");case o.a.MailListViewAppointmentDeclined:return Object(c.getIconClassName)("EventDeclined");case o.a.MailListViewAppointmentTentative:return Object(c.getIconClassName)("EventTentative");case o.a.MailListViewAppointmentCanceled:return Object(c.getIconClassName)("RemoveEvent");case o.a.MailListViewContactItem:return Object(c.getIconClassName)("ContactCard");case o.a.MailListViewTaskItem:return Object(c.getIconClassName)("CheckboxComposite");case o.a.MailListViewTaskReocurItem:return Object(c.getIconClassName)("RecurringTask");case o.a.MailListViewJournalItem:return Object(c.getIconClassName)("DietPlanNotebook");case o.a.MailListViewPostItem:return Object(c.getIconClassName)("NotePinned");case o.a.MailListViewNoteItem:return Object(c.getIconClassName)("QuickNote");case o.a.MailListViewDelivery:return Object(c.getIconClassName)("ReceiptForward");case o.a.MailListViewNonDelivery:case o.a.MailListViewApprovalRequest:case o.a.MailListViewResponseApprove:case o.a.MailListViewResponseReject:return Object(c.getIconClassName)("ReceiptReply");case o.a.MailListViewOutOfOffice:return Object(c.getIconClassName)("OutOfOffice");case o.a.MailListViewReadReport:return Object(c.getIconClassName)("ReceiptCheck");case o.a.MailListViewReminderMessage:return Object(c.getIconClassName)("Ringer");case o.a.Link:return Object(c.getIconClassName)("Link");default:throw new Error("No CSS class icon for the given property icon")}}var f=i(2912),p=i(3146),m=i(1311),v=i(3);Object(v.mutator)(p.a,(function(e){Object(m.J)().tableViews.get(e.tableViewId).currentLoadedIndex=e.currentLoadedIndexToSet}));i.d(t,"a",(function(){return o.a})),i.d(t,"b",(function(){return s.a})),i.d(t,"c",(function(){return u})),i.d(t,"d",(function(){return f.a}));var b=new r.c((function(){return i.e(1269).then(i.bind(null,16954))}));Object(r.f)(a.f,b,(function(e){return e.mailListItemExpansionOrchestrators})),Object(r.f)(n.a,b,(function(e){return e.emptyFolderStoreUpdateOrchestrator}))},5623:function(e,t,i){"use strict";var r=i(3624);var a,n=((a={})["MailReplied".toString()]=r.a.MailListViewReplied,a["MailForwarded".toString()]=r.a.MailListViewForwarded,a["MailIrm".toString()]=r.a.MailListViewIRM,a["MailIrmReplied".toString()]=r.a.MailListViewIRMReplied,a["MailIrmForwarded".toString()]=r.a.MailListViewIRMForwarded,a);function o(){var e={};return e["MailReplied".toString()]=r.a.MailListViewVoiceMailReplied,e["MailForwarded".toString()]=r.a.MailListViewVoiceMailForwarded,e["Default".toString()]=r.a.MailListViewVoiceMailItem,e}function s(){var e={};return e["MailReplied".toString()]=r.a.MailListViewVoiceMailIRM,e["Default".toString()]=r.a.MailListViewVoiceMailIRM,e}var c=function(){var e={};e["ipm.note"]=n,e["ipm.note.irm"]=function(){var e={};return e["MailReplied".toString()]=r.a.MailListViewIRMReplied,e["MailForwarded".toString()]=r.a.MailListViewIRMForwarded,e["Default".toString()]=r.a.MailListViewIRM,e["MailIrmReplied".toString()]=r.a.MailListViewIRMReplied,e["MailIrmForwarded".toString()]=r.a.MailListViewIRMForwarded,e}(),e["ipm.note.microsoft.exchange.voice.um.ca"]=o(),e["ipm.note.microsoft.exchange.voice.um"]=o(),e["ipm.note.microsoft.voicemail.um.ca"]=o(),e["ipm.note.microsoft.voicemail.um"]=o(),e["ipm.note.rpmsg.microsoft.voicemail.um.ca"]=s(),e["ipm.note.rpmsg.microsoft.voicemail.um"]=s();var t={};return t["Default".toString()]=r.a.MailListViewFaxItem,e["ipm.note.microsoft.exchange.fax.ca"]=t,e["ipm.note.microsoft.exchange.fax.um.ca"]=t,e["ipm.note.microsoft.fax.ca"]=t,(t={})["Default".toString()]=r.a.MailListViewAppointmentItem,e["ipm.appointment"]=t,e["ipm.schedule.meeting.request"]=t,(t={})["AppointmentMeetCancel".toString()]=r.a.MailListViewAppointmentCanceled,t["Default".toString()]=r.a.MailListViewAppointmentCanceled,e["ipm.schedule.meeting.canceled"]=t,(t={})["Default".toString()]=r.a.MailListViewContactItem,e["ipm.contact"]=t,e["ipm.distlist"]=t,(t={})["TaskRecur".toString()]=r.a.MailListViewTaskReocurItem,t["TaskItem".toString()]=r.a.MailListViewTaskItem,t["TaskOwned".toString()]=r.a.MailListViewTaskItem,t["TaskDelegated".toString()]=r.a.MailListViewTaskItem,t["Default".toString()]=r.a.MailListViewTaskItem,e["ipm.task"]=t,(t={})["Default".toString()]=r.a.MailListViewJournalItem,e["ipm.activity"]=t,(t={})["Default".toString()]=r.a.MailListViewPostItem,e["ipm.post"]=t,(t={})["Default".toString()]=r.a.MailListViewNoteItem,e["ipm.stickynote"]=t,(t={})["Default".toString()]=r.a.MailListViewNonDelivery,e["report.ipm.note.ndr"]=t,e["report.ipm.ndr"]=t,e["report.ipm.note.mobile.sms.ndr"]=t,e["report.ipm.schedule.meeting.resp.neg.ndr"]=t,e["report.ipm.schedule.meeting.resp.pos.ndr"]=t,e["report.ipm.schedule.meeting.resp.tent.ndr"]=t,e["report.ipm.taskrequest.ndr"]=t,e["report.ipm.oof.ndr"]=t,e["report.report.ipm.note.ipnnrn.ndr"]=t,e["report.ipm.note.smime.ndr"]=t,e["report.ipm.note.smime.multipartsigned.ndr"]=t,(t={})["Default".toString()]=r.a.MailListViewDelivery,e["report.ipm.note.dr"]=t,e["report.ipm.dr"]=t,e["report.ipm.schedule.meeting.request.dr"]=t,e["report.ipm.note.smime.dr"]=t,e["report.ipm.note.smime.multipartsigned.dr"]=t,(t={})["Default".toString()]=r.a.MailListViewApprovalRequest,e["ipm.note.microsoft.approval.request"]=t,(t={})["Default".toString()]=r.a.MailListViewResponseApprove,e["ipm.note.microsoft.approval.reply.approve"]=t,(t={})["Default".toString()]=r.a.MailListViewResponseReject,e["ipm.note.microsoft.approval.reply.reject"]=t,(t={})["Default".toString()]=r.a.MailListViewOutOfOffice,e["ipm.note.rules.ooftemplate.microsoft"]=t,(t={})["Default".toString()]=r.a.MailListViewReadReport,e["report.ipm.note.ipnrn"]=t,(t={})["Default".toString()]=r.a.MailListViewReminderMessage,e["ipm.note.reminder.event"]=t,e}();var d=function(){var e={},t={};return t["AppointmentMeetYes".toString()]=r.a.MailListViewAppointmentAccepted,t["Default".toString()]=r.a.MailListViewAppointmentAccepted,e["ipm.schedule.meeting.resp.pos"]=t,(t={})["AppointmentMeetMaybe".toString()]=r.a.MailListViewAppointmentTentative,t["Default".toString()]=r.a.MailListViewAppointmentTentative,e["ipm.schedule.meeting.resp.tent"]=t,(t={})["AppointmentMeetNo".toString()]=r.a.MailListViewAppointmentDeclined,t["Default".toString()]=r.a.MailListViewAppointmentDeclined,e["ipm.schedule.meeting.resp.neg"]=t,e}();function l(e,t,i){var a=e[t];return(null==a?void 0:a[i])?a[i.toString()]:r.a.None}function u(e,t){var i=l(d,e,t);return i==r.a.None&&Object.keys(d).forEach((function(i){if(0==e.indexOf(i)&&i[t.toString()])return i[t.toString()]})),i}function f(e,t,i){if(i)switch(t){case"MailReplied":t="MailIrmReplied";break;case"MailForwarded":t="MailIrmForwarded";break;default:t="MailIrm"}var a=!1;if(e&&e.length>0){var o=e.length;if(1==o)return function(e,t){if(t||(t="Default"),!e)return r.a.None;e=e.toLowerCase();var i=l(c,e,t);return i==r.a.None&&(i=l(c,e,"Default")),i===r.a.None&&(i=u(e,t)),i===r.a.None&&(i=u(e,"Default")),i}(e[0],t);for(var s=0;s<o;s++)if(-1==e[s].toLowerCase().indexOf("ipm.schedule.meeting")){a=!0;break}}else a=!0;return a?n[t?t.toString():null]:r.a.MailListViewAppointmentItem}i.d(t,"a",(function(){return f}))},6690:function(e){e.exports=JSON.parse('{"a":"evb"}')},6691:function(e){e.exports=JSON.parse('{"a":"cvb"}')},6907:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(0);function a(e){return Object(r.__assign)({__type:"UpdateFavoriteFolderRequest:#Exchange"},e)}},6908:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(29),a=i(6907);function n(e,t){return void 0===e.request||e.request.__type||(e.request=Object(a.a)(e.request)),Object(r.a)("UpdateFavoriteFolder",e,t)}},7416:function(e,t,i){var r=i(7417),a=i(131);"string"==typeof r&&(r=[[e.i,r]]);for(var n=0;n<r.length;n++)a.loadStyles(r[n][1],!1);r.locals&&(e.exports=r.locals)},7417:function(e,t,i){(t=e.exports=i(130)(!1)).push([e.i,'._378AqQXt7Vn66ek8Mf4Fo5:before{color:"[theme:redDark, default:#a80000]"!important}._32S8K94lku5ujN8zmSd9ED:before{color:"[theme:green20, default:#0b6a0b]"!important}html[dir] ._32S8K94lku5ujN8zmSd9ED:before{margin-bottom:2px}._3Y1jo0XOp_HAd3rW6--a2L:before{color:"[theme:themePrimary, default:#0078D4]"!important}._3K512Ld4FHiESFMYdEMLkE:before{color:"[theme:themePrimary, default:#0078D4]"}',""]),t.locals={redDark:"_378AqQXt7Vn66ek8Mf4Fo5",snooze:"_32S8K94lku5ujN8zmSd9ED",accounts:"_3Y1jo0XOp_HAd3rW6--a2L",accountsRead:"_3K512Ld4FHiESFMYdEMLkE"}},7451:function(e){e.exports=JSON.parse('{"a":"fvb"}')},7452:function(e){e.exports=JSON.parse('{"a":"dvb"}')}}]);
//# sourceMappingURL=owa.MailBoot~MailFavoritesStore.js.map
self.scriptsLoaded['owa.MailBoot~MailFavoritesStore.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailFavoritesStore.js'] = (new Date()).getTime();