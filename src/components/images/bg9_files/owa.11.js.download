self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.11.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[11],{2935:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return s}));var n,s,o="change";!function(e){e[e.none=0]="none",e[e.single=1]="single",e[e.multiple=2]="multiple"}(n||(n={})),function(e){e[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical"}(s||(s={}))},4795:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(2935),s=i(229),o=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e[0]||{},s=i.onSelectionChanged,o=i.getKey,l=i.canSelectItem,r=void 0===l?function(){return!0}:l,a=i.items,h=i.selectionMode,d=void 0===h?n.c.multiple:h;this.mode=d,this._getKey=o||c,this._changeEventSuppressionCount=0,this._exemptedCount=0,this._anchoredIndex=0,this._unselectableCount=0,this._onSelectionChanged=s,this._canSelectItem=r,this._isModal=!1,this.setItems(a||[],!0),this.count=this.getSelectedCount()}return e.prototype.canSelectItem=function(e,t){return!("number"==typeof t&&t<0)&&this._canSelectItem(e,t)},e.prototype.getKey=function(e,t){var i=this._getKey(e,t);return"number"==typeof i||i?""+i:""},e.prototype.setChangeEvents=function(e,t){this._changeEventSuppressionCount+=e?-1:1,0===this._changeEventSuppressionCount&&this._hasChanged&&(this._hasChanged=!1,t||this._change())},e.prototype.isModal=function(){return this._isModal},e.prototype.setModal=function(e){this._isModal!==e&&(this.setChangeEvents(!1),this._isModal=e,e||this.setAllSelected(!1),this._change(),this.setChangeEvents(!0))},e.prototype.setItems=function(e,t){void 0===t&&(t=!0);var i={},n={},s=!1;this.setChangeEvents(!1),this._unselectableCount=0;for(var o=0;o<e.length;o++){if(h=e[o]){var c=this.getKey(h,o);c&&(i[c]=o)}n[o]=h&&!this.canSelectItem(h),n[o]&&this._unselectableCount++}(t||0===e.length)&&this._setAllSelected(!1,!0);var l={},r=0;for(var a in this._exemptedIndices)if(this._exemptedIndices.hasOwnProperty(a)){var h,d=Number(a),u=(h=this._items[d])?this.getKey(h,Number(d)):void 0,_=u?i[u]:d;void 0===_?s=!0:(l[_]=!0,r++,s=s||_!==d)}this._items&&0===this._exemptedCount&&e.length!==this._items.length&&this._isAllSelected&&(s=!0),this._exemptedIndices=l,this._exemptedCount=r,this._keyToIndexMap=i,this._unselectableIndices=n,this._items=e,this._selectedItems=null,s&&(this._updateCount(),this._change()),this.setChangeEvents(!0)},e.prototype.getItems=function(){return this._items},e.prototype.getSelection=function(){if(!this._selectedItems){this._selectedItems=[];var e=this._items;if(e)for(var t=0;t<e.length;t++)this.isIndexSelected(t)&&this._selectedItems.push(e[t])}return this._selectedItems},e.prototype.getSelectedCount=function(){return this._isAllSelected?this._items.length-this._exemptedCount-this._unselectableCount:this._exemptedCount},e.prototype.getSelectedIndices=function(){if(!this._selectedIndices){this._selectedIndices=[];var e=this._items;if(e)for(var t=0;t<e.length;t++)this.isIndexSelected(t)&&this._selectedIndices.push(t)}return this._selectedIndices},e.prototype.isRangeSelected=function(e,t){if(0===t)return!1;for(var i=e+t,n=e;n<i;n++)if(!this.isIndexSelected(n))return!1;return!0},e.prototype.isAllSelected=function(){var e=this._items.length-this._unselectableCount;return this.mode===n.c.single&&(e=Math.min(e,1)),this.count>0&&this._isAllSelected&&0===this._exemptedCount||!this._isAllSelected&&this._exemptedCount===e&&e>0},e.prototype.isKeySelected=function(e){var t=this._keyToIndexMap[e];return this.isIndexSelected(t)},e.prototype.isIndexSelected=function(e){return!!(this.count>0&&this._isAllSelected&&!this._exemptedIndices[e]&&!this._unselectableIndices[e]||!this._isAllSelected&&this._exemptedIndices[e])},e.prototype.setAllSelected=function(e){if(!e||this.mode===n.c.multiple){var t=this._items?this._items.length-this._unselectableCount:0;this.setChangeEvents(!1),t>0&&(this._exemptedCount>0||e!==this._isAllSelected)&&(this._exemptedIndices={},(e!==this._isAllSelected||this._exemptedCount>0)&&(this._exemptedCount=0,this._isAllSelected=e,this._change()),this._updateCount()),this.setChangeEvents(!0)}},e.prototype.setKeySelected=function(e,t,i){var n=this._keyToIndexMap[e];n>=0&&this.setIndexSelected(n,t,i)},e.prototype.setIndexSelected=function(e,t,i){if(this.mode!==n.c.none&&!((e=Math.min(Math.max(0,e),this._items.length-1))<0||e>=this._items.length)){this.setChangeEvents(!1);var s=this._exemptedIndices[e];!this._unselectableIndices[e]&&(t&&this.mode===n.c.single&&this._setAllSelected(!1,!0),s&&(t&&this._isAllSelected||!t&&!this._isAllSelected)&&(delete this._exemptedIndices[e],this._exemptedCount--),!s&&(t&&!this._isAllSelected||!t&&this._isAllSelected)&&(this._exemptedIndices[e]=!0,this._exemptedCount++),i&&(this._anchoredIndex=e)),this._updateCount(),this.setChangeEvents(!0)}},e.prototype.selectToKey=function(e,t){this.selectToIndex(this._keyToIndexMap[e],t)},e.prototype.selectToIndex=function(e,t){if(this.mode!==n.c.none)if(this.mode!==n.c.single){var i=this._anchoredIndex||0,s=Math.min(e,i),o=Math.max(e,i);for(this.setChangeEvents(!1),t&&this._setAllSelected(!1,!0);s<=o;s++)this.setIndexSelected(s,!0,!1);this.setChangeEvents(!0)}else this.setIndexSelected(e,!0,!0)},e.prototype.toggleAllSelected=function(){this.setAllSelected(!this.isAllSelected())},e.prototype.toggleKeySelected=function(e){this.setKeySelected(e,!this.isKeySelected(e),!0)},e.prototype.toggleIndexSelected=function(e){this.setIndexSelected(e,!this.isIndexSelected(e),!0)},e.prototype.toggleRangeSelected=function(e,t){if(this.mode!==n.c.none){var i=this.isRangeSelected(e,t),s=e+t;if(!(this.mode===n.c.single&&t>1)){this.setChangeEvents(!1);for(var o=e;o<s;o++)this.setIndexSelected(o,!i,!1);this.setChangeEvents(!0)}}},e.prototype._updateCount=function(e){void 0===e&&(e=!1);var t=this.getSelectedCount();t!==this.count&&(this.count=t,this._change()),this.count||e||this.setModal(!1)},e.prototype._setAllSelected=function(e,t){if(void 0===t&&(t=!1),!e||this.mode===n.c.multiple){var i=this._items?this._items.length-this._unselectableCount:0;this.setChangeEvents(!1),i>0&&(this._exemptedCount>0||e!==this._isAllSelected)&&(this._exemptedIndices={},(e!==this._isAllSelected||this._exemptedCount>0)&&(this._exemptedCount=0,this._isAllSelected=e,this._change()),this._updateCount(t)),this.setChangeEvents(!0)}},e.prototype._change=function(){0===this._changeEventSuppressionCount?(this._selectedItems=null,this._selectedIndices=void 0,s.a.raise(this,n.a),this._onSelectionChanged&&this._onSelectionChanged()):this._hasChanged=!0},e}();function c(e,t){var i=(e||{}).key;return void 0===i?""+t:i}},6719:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i(0),s=i(1),o=i(271),c=i(189),l=i(60),r=i(229),a=i(315),h=i(309),d=i(56),u=i(282),_=i(448),p=i(338),f=i(118),m=i(76),g=i(2935),v="data-selection-toggle",I="data-selection-invoke",S="data-selection-touch-invoke",C="data-selection-all-toggle",y=function(e){function t(t){var i=e.call(this,t)||this;i._root=s.createRef(),i.ignoreNextFocus=function(){i._handleNextFocus(!1)},i._onSelectionChange=function(){var e=i.props.selection,t=e.isModal&&e.isModal();i.setState({isModal:t})},i._onMouseDownCapture=function(e){var t=e.target;if(document.activeElement===t||Object(o.a)(document.activeElement,t)){if(Object(o.a)(t,i._root.current))for(;t!==i._root.current;){if(i._hasAttribute(t,I)){i.ignoreNextFocus();break}t=Object(c.a)(t)}}else i.ignoreNextFocus()},i._onFocus=function(e){var t=e.target,n=i.props.selection,s=i._isCtrlPressed||i._isMetaPressed,o=i._getSelectionMode();if(i._shouldHandleFocus&&o!==g.c.none){var c=i._hasAttribute(t,v),l=i._findItemRoot(t);if(!c&&l){var r=i._getItemIndex(l);s?(n.setIndexSelected(r,n.isIndexSelected(r),!0),i.props.enterModalOnTouch&&i._isTouch&&n.setModal&&(n.setModal(!0),i._setIsTouch(!1))):i.props.isSelectedOnFocus&&i._onItemSurfaceClick(e,r)}}i._handleNextFocus(!1)},i._onMouseDown=function(e){i._updateModifiers(e);var t=e.target,n=i._findItemRoot(t);if(!i._isSelectionDisabled(t))for(;t!==i._root.current&&!i._hasAttribute(t,C);){if(n){if(i._hasAttribute(t,v))break;if(i._hasAttribute(t,I))break;if(!(t!==n&&!i._shouldAutoSelect(t)||i._isShiftPressed||i._isCtrlPressed||i._isMetaPressed)){i._onInvokeMouseDown(e,i._getItemIndex(n));break}if(i.props.disableAutoSelectOnInputElements&&("A"===t.tagName||"BUTTON"===t.tagName||"INPUT"===t.tagName))return}t=Object(c.a)(t)}},i._onTouchStartCapture=function(e){i._setIsTouch(!0)},i._onClick=function(e){var t=i.props.enableTouchInvocationTarget,n=void 0!==t&&t;i._updateModifiers(e);for(var s=e.target,o=i._findItemRoot(s),l=i._isSelectionDisabled(s);s!==i._root.current;){if(i._hasAttribute(s,C)){l||i._onToggleAllClick(e);break}if(o){var r=i._getItemIndex(o);if(i._hasAttribute(s,v)){l||(i._isShiftPressed?i._onItemSurfaceClick(e,r):i._onToggleClick(e,r));break}if(i._isTouch&&n&&i._hasAttribute(s,S)||i._hasAttribute(s,I)){i._onInvokeClick(e,r);break}if(s===o){l||i._onItemSurfaceClick(e,r);break}if("A"===s.tagName||"BUTTON"===s.tagName||"INPUT"===s.tagName)return}s=Object(c.a)(s)}},i._onContextMenu=function(e){var t=e.target,n=i.props,s=n.onItemContextMenu,o=n.selection;if(s){var c=i._findItemRoot(t);if(c){var l=i._getItemIndex(c);i._onInvokeMouseDown(e,l),s(o.getItems()[l],l,e.nativeEvent)||e.preventDefault()}}},i._onDoubleClick=function(e){var t=e.target,n=i.props.onItemInvoked,s=i._findItemRoot(t);if(s&&n&&!i._isInputElement(t)){for(var o=i._getItemIndex(s);t!==i._root.current&&!i._hasAttribute(t,v)&&!i._hasAttribute(t,I);){if(t===s){i._onInvokeClick(e,o);break}t=Object(c.a)(t)}t=Object(c.a)(t)}},i._onKeyDownCapture=function(e){i._updateModifiers(e),i._handleNextFocus(!0)},i._onKeyDown=function(e){i._updateModifiers(e);var t=e.target,n=i._isSelectionDisabled(t),s=i.props.selection,o=e.which===l.a.a&&(i._isCtrlPressed||i._isMetaPressed),r=e.which===l.a.escape;if(!i._isInputElement(t)){var a=i._getSelectionMode();if(o&&a===g.c.multiple&&!s.isAllSelected())return n||s.setAllSelected(!0),e.stopPropagation(),void e.preventDefault();if(r&&s.getSelectedCount()>0)return n||s.setAllSelected(!1),e.stopPropagation(),void e.preventDefault();var h=i._findItemRoot(t);if(h)for(var d=i._getItemIndex(h);t!==i._root.current&&!i._hasAttribute(t,v);){if(i._shouldAutoSelect(t)){n||i._onInvokeMouseDown(e,d);break}if(!(e.which!==l.a.enter&&e.which!==l.a.space||"BUTTON"!==t.tagName&&"A"!==t.tagName&&"INPUT"!==t.tagName))return!1;if(t===h){if(e.which===l.a.enter)return i._onInvokeClick(e,d),void e.preventDefault();if(e.which===l.a.space)return n||i._onToggleClick(e,d),void e.preventDefault();break}t=Object(c.a)(t)}}},i._events=new r.a(i),i._async=new a.a(i),Object(h.a)(i);var n=i.props.selection,d=n.isModal&&n.isModal();return i.state={isModal:d},i}return Object(n.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){var i=e.selection.isModal&&e.selection.isModal();return Object(n.__assign)(Object(n.__assign)({},t),{isModal:i})},t.prototype.componentDidMount=function(){var e=Object(d.a)(this._root.current);this._events.on(e,"keydown, keyup",this._updateModifiers,!0),this._events.on(document,"click",this._findScrollParentAndTryClearOnEmptyClick),this._events.on(document.body,"touchstart",this._onTouchStartCapture,!0),this._events.on(document.body,"touchend",this._onTouchStartCapture,!0),this._events.on(this.props.selection,"change",this._onSelectionChange)},t.prototype.render=function(){var e=this.state.isModal;return s.createElement("div",{className:Object(u.css)("ms-SelectionZone",this.props.className,{"ms-SelectionZone--modal":!!e}),ref:this._root,onKeyDown:this._onKeyDown,onMouseDown:this._onMouseDown,onKeyDownCapture:this._onKeyDownCapture,onClick:this._onClick,role:"presentation",onDoubleClick:this._onDoubleClick,onContextMenu:this._onContextMenu,onMouseDownCapture:this._onMouseDownCapture,onFocusCapture:this._onFocus,"data-selection-is-modal":!!e||void 0},this.props.children,s.createElement(_.a,null))},t.prototype.componentDidUpdate=function(e){var t=this.props.selection;t!==e.selection&&(this._events.off(e.selection),this._events.on(t,"change",this._onSelectionChange))},t.prototype.componentWillUnmount=function(){this._events.dispose(),this._async.dispose()},t.prototype._isSelectionDisabled=function(e){if(this._getSelectionMode()===g.c.none)return!0;for(;e!==this._root.current;){if(this._hasAttribute(e,"data-selection-disabled"))return!0;e=Object(c.a)(e)}return!1},t.prototype._onToggleAllClick=function(e){var t=this.props.selection;this._getSelectionMode()===g.c.multiple&&(t.toggleAllSelected(),e.stopPropagation(),e.preventDefault())},t.prototype._onToggleClick=function(e,t){var i=this.props.selection,n=this._getSelectionMode();if(i.setChangeEvents(!1),this.props.enterModalOnTouch&&this._isTouch&&!i.isIndexSelected(t)&&i.setModal&&(i.setModal(!0),this._setIsTouch(!1)),n===g.c.multiple)i.toggleIndexSelected(t);else{if(n!==g.c.single)return void i.setChangeEvents(!0);var s=i.isIndexSelected(t),o=i.isModal&&i.isModal();i.setAllSelected(!1),i.setIndexSelected(t,!s,!0),o&&i.setModal&&i.setModal(!0)}i.setChangeEvents(!0),e.stopPropagation()},t.prototype._onInvokeClick=function(e,t){var i=this.props,n=i.selection,s=i.onItemInvoked;s&&(s(n.getItems()[t],t,e.nativeEvent),e.preventDefault(),e.stopPropagation())},t.prototype._onItemSurfaceClick=function(e,t){var i=this.props.selection,n=this._isCtrlPressed||this._isMetaPressed,s=this._getSelectionMode();s===g.c.multiple?this._isShiftPressed&&!this._isTabPressed?i.selectToIndex(t,!n):n?i.toggleIndexSelected(t):this._clearAndSelectIndex(t):s===g.c.single&&this._clearAndSelectIndex(t)},t.prototype._onInvokeMouseDown=function(e,t){this.props.selection.isIndexSelected(t)||this._clearAndSelectIndex(t)},t.prototype._findScrollParentAndTryClearOnEmptyClick=function(e){var t=Object(p.f)(this._root.current);this._events.off(document,"click",this._findScrollParentAndTryClearOnEmptyClick),this._events.on(t,"click",this._tryClearOnEmptyClick),(t&&e.target instanceof Node&&t.contains(e.target)||t===e.target)&&this._tryClearOnEmptyClick(e)},t.prototype._tryClearOnEmptyClick=function(e){!this.props.selectionPreservedOnEmptyClick&&this._isNonHandledClick(e.target)&&this.props.selection.setAllSelected(!1)},t.prototype._clearAndSelectIndex=function(e){var t=this.props.selection;if(!(1===t.getSelectedCount()&&t.isIndexSelected(e))){var i=t.isModal&&t.isModal();t.setChangeEvents(!1),t.setAllSelected(!1),t.setIndexSelected(e,!0,!0),(i||this.props.enterModalOnTouch&&this._isTouch)&&(t.setModal&&t.setModal(!0),this._isTouch&&this._setIsTouch(!1)),t.setChangeEvents(!0)}},t.prototype._updateModifiers=function(e){this._isShiftPressed=e.shiftKey,this._isCtrlPressed=e.ctrlKey,this._isMetaPressed=e.metaKey;var t=e.keyCode;this._isTabPressed=!!t&&t===l.a.tab},t.prototype._findItemRoot=function(e){for(var t=this.props.selection;e!==this._root.current;){var i=e.getAttribute("data-selection-index"),n=Number(i);if(null!==i&&n>=0&&n<t.getItems().length)break;e=Object(c.a)(e)}if(e!==this._root.current)return e},t.prototype._getItemIndex=function(e){return Number(e.getAttribute("data-selection-index"))},t.prototype._shouldAutoSelect=function(e){return this._hasAttribute(e,"data-selection-select")},t.prototype._hasAttribute=function(e,t){for(var i=!1;!i&&e!==this._root.current;)i="true"===e.getAttribute(t),e=Object(c.a)(e);return i},t.prototype._isInputElement=function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName},t.prototype._isNonHandledClick=function(e){var t=Object(f.a)();if(t&&e)for(;e&&e!==t.documentElement;){if(Object(m.n)(e))return!1;e=Object(c.a)(e)}return!0},t.prototype._handleNextFocus=function(e){var t=this;this._shouldHandleFocusTimeoutId&&(this._async.clearTimeout(this._shouldHandleFocusTimeoutId),this._shouldHandleFocusTimeoutId=void 0),this._shouldHandleFocus=e,e&&this._async.setTimeout((function(){t._shouldHandleFocus=!1}),100)},t.prototype._setIsTouch=function(e){var t=this;this._isTouchTimeoutId&&(this._async.clearTimeout(this._isTouchTimeoutId),this._isTouchTimeoutId=void 0),this._isTouch=!0,e&&this._async.setTimeout((function(){t._isTouch=!1}),300)},t.prototype._getSelectionMode=function(){var e=this.props.selection,t=this.props.selectionMode;return void 0===t?e?e.mode:g.c.none:t},t.defaultProps={isSelectedOnFocus:!0,selectionMode:g.c.multiple},t}(s.Component)}}]);
//# sourceMappingURL=owa.11.js.map
self.scriptsLoaded['owa.11.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.11.js'] = (new Date()).getTime();