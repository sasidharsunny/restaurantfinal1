self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~GroupList.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[575],{1346:function(e,t,r){"use strict";function n(e,t){Object.keys(t).forEach((function(r){return e.set(r,t[r])}))}function o(e){var t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return o}))},1347:function(e,t,r){"use strict";var n=r(0),o=r(1405),a=r(388),i=r(662),c=r(269),u=r(9),s="X-AnchorMailbox",p="Authorization",d="X-OwaWebSessionType",l="X-OWA-ExplicitLogonUser";function f(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,f,b,g,v;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(r={},f=Object(a.k)(e)){if(f.accountState==a.b.AccessRevoked)return[2,null];if(f.accountState==a.b.AccountDeprovisioned||f.accountState==a.b.AccountNotFound)return Object(a.c)(f.accountState,f.accountProviderType),[2,null]}return t?(r[s]=t,r[l]=t):f&&(r[s]=f.anchorMailbox),f?(b=f.token,!(g=Object(i.g)(f.tokenExpiry))&&b?[3,2]:(Object(c.p)("getAndUpdateAccessToken",{tokenExpiry:Object(u.y)(f.tokenExpiry,Object(u.Pb)()),isTokenExpired_1:g,isTokenInvalid_2:!b},{isCore:!0}),[4,o.a.importAndExecute(f.accountId,e)])):[3,3];case 1:(b=n.sent())||(b=""),n.label=2;case 2:v=void 0,"Outlook"==f.accountProviderType?(v='MSAuth1.0 usertoken="'+b+'", type="MSACT"',r[d]=1..toString()):"Google"!=f.accountProviderType&&"ICloud"!=f.accountProviderType||(v="Bearer "+b,r[d]=2..toString()),r[p]=v,n.label=3;case 3:return[2,r]}}))}))}var b=r(1346),g=r(59);function v(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r=Object(b.a)(),o=r,[4,O(e,t)];case 1:return o.headers=n.sent(),r.authNeededOnUnAuthorized=!1,r.datapoint=r.datapoint||{},r.datapoint.mailbox="Connected",[2,r]}}))}))}function O(e,t){var r;return Object(n.__awaiter)(this,void 0,void 0,(function(){var o,a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return o=t&&(null===(r=e.headers)||void 0===r?void 0:r.set)?new Headers(e.headers):new Headers,[4,f(e.mailboxInfo.userIdentity,h(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null)];case 1:return a=n.sent(),Object(b.b)(o,a),[2,o]}}))}))}function h(e,t){var r="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return r&&null==t&&g.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),r}r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return v})),r.d(t,"c",(function(){return h}))},1348:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3),o=Object(n.action)("triggerReInitializeAccount",(function(e){return{userIdentity:e}}))},1349:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={FavoriteNode:"favoritenode",InboxRule:"inboxrule",LocalFile:"Files",MailFolderNode:"mailfoldernode",MailListItemPart:"maillistitempart",MailListRow:"maillistrow",MultiMailListConversationRows:"multimaillistconversationrows",MultiMailListMessageRows:"multimaillistmessagerows",ReadWriteRecipient:"recipient",NoteFeedItem:"notefeeditem",Todo:"todo",Attachment:"attachment",CommandBarEditorButton:"commandbareditorbutton"}},1405:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(77),o=r(1348);r.d(t,"b",(function(){return o.a}));var a=new n.c((function(){return r.e(1149).then(r.bind(null,1664))})),i=new n.a(a,(function(e){return e.getAndUpdateAccessToken}))},1415:function(e,t,r){"use strict";var n=r(1),o=r(1349);var a=r(285),i=Object(a.action)("setDropState")((function(e,t,r){e.isDragOver=t,e.draggableItemType=r})),c=r(1516),u=r(70);r.d(t,"a",(function(){return p}));var s=50,p=function(){function e(e){var t=this;this.props=e,this.onDragEnter=function(e){e.preventDefault(),t.props.preventBubblingDragEvents&&e.stopPropagation();var r=t.getDragData(e);(Object(u.e)()||Object(u.g)())&&t.setDropEffectInternal(e,t.getDesiredDropEffect(r)),t.props.onDragEnter&&t.props.onDragEnter(r)},this.onDragLeave=function(e){if(t.props.preventBubblingDragEvents&&e.stopPropagation(),!t.props.greedy||t.isReallyLeavingDroppable(e)){var r=t.props.dropViewState.draggableItemType;r||(r=t.getDragType(e));var n={itemType:r};if("none"!=t.getDesiredDropEffect(n)){var o=function(r){return function(){t.props.onDragLeave&&t.props.onDragLeave(r,e.currentTarget),i(t.props.dropViewState,!1,null),t.pendingDragLeaveHandler=null}};t.props.shouldIgnoreTransientOnDragLeave?t.pendingDragLeaveHandler||(e.persist(),t.pendingDragLeaveHandler=setTimeout(o(n),s)):o(n)(),(Object(u.e)()||Object(u.g)())&&t.setDropEffectInternal(e,"none")}}},this.onDragOver=function(e){t.props.preventBubblingDragEvents&&e.stopPropagation();var r=t.props.dropViewState.draggableItemType;r||(r=t.getDragType(e));var n={itemType:r},o=t.getDesiredDropEffect(n);"none"!=o?(t.props.bypassActOnDrop||(e.preventDefault(),t.setDropEffectInternal(e,o)),t.props.shouldUseCopyAsDropEffect&&t.setDropEffectInternal(e,"copy"),t.props.onDragOver&&t.props.onDragOver(n,e.pageX,e.pageY,e.currentTarget),t.cancelPendingDragLeaveHandler(),t.props.dropViewState.isDragOver&&t.props.dropViewState.draggableItemType==r||i(t.props.dropViewState,!0,r)):t.props.bypassActOnDrop||t.setDropEffectInternal(e,"none")},this.onDrop=function(e){t.props.preventBubblingDragEvents&&e.stopPropagation();var r=t.getDragData(e);e.preventDefault(),"none"!=t.getDesiredDropEffect(r)&&(t.props.onDrop(r,e.pageX,e.pageY,e.currentTarget),t.props.onDragLeave&&t.props.onDragLeave(r,e.currentTarget),t.cancelPendingDragLeaveHandler(),Object(c.c)(null),i(t.props.dropViewState,!1,null))},this.refCallback=function(e){t.div=e}}return e.prototype.getDiv=function(){return this.div},e.prototype.cancelPendingDragLeaveHandler=function(){this.pendingDragLeaveHandler&&(clearTimeout(this.pendingDragLeaveHandler),this.pendingDragLeaveHandler=null)},e.prototype.isReallyLeavingDroppable=function(e){var t=document.elementFromPoint(e.pageX,e.pageY);return!this.isDescendantOrSelf(t,e.currentTarget)},e.prototype.isDescendantOrSelf=function(e,t){if(!e||!t)return!1;if(e==t)return!0;for(var r=e;r=r.parentElement;)if(r==t)return!0;return!1},e.prototype.getDesiredDropEffect=function(e){return e?this.props.canDrop?"boolean"==typeof this.props.canDrop(e)?this.props.canDrop(e)?"move":"none":this.props.canDrop(e):"move":"none"},e.prototype.getDragData=function(e){var t,r=null;if(e.dataTransfer.files&&e.dataTransfer.files.length>0)t=e.dataTransfer.files,r={itemType:o.a.LocalFile,files:t};else{for(var n=e.dataTransfer.types,a=null,i=!1,c=0;c<n.length;c++){var u=n[c];if("text"!=u){a=e.dataTransfer.getData(u),i=!0;break}}i||(a=e.dataTransfer.getData("text"));try{r=JSON.parse(a)}catch(e){r={itemType:"nothing"}}}return r},e.prototype.getDragType=function(e){var t=Object(c.a)(),r=e.dataTransfer?e.dataTransfer:e.nativeEvent.dataTransfer;if(!t&&r&&r.types&&r.types.length>0){var n=Array.prototype.slice.apply(e.dataTransfer.types),a=Object.values(o.a),i=n.filter((function(e){return a.indexOf(e)>=0}));i.length>0&&(t=i[0])}return t},e.prototype.setDropEffectInternal=function(e,t){e.dataTransfer&&(e.dataTransfer.dropEffect=t),Object(c.d)(t)},e}();t.b=n.forwardRef((function(e,t){var r=n.useRef(new p(e));return n.useImperativeHandle(t,(function(){return{getDiv:function(){return r.current.getDiv()}}}),[]),n.createElement("div",{ref:r.current.refCallback,className:e.classNames,style:e.style,onDrop:r.current.onDrop,onDragOver:r.current.onDragOver,onDragEnter:r.current.onDragEnter,onDragLeave:r.current.onDragLeave},e.children)}))},1418:function(e,t,r){"use strict";var n=r(0),o=r(1346);function a(e){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":e}}function i(e,t){t&&e&&Object(o.b)(t,a(e))}function c(e,t){var r,o=null!=t?t:{},a=(null===(r=o.headers)||void 0===r?void 0:r.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",i(e,a),Object(n.__assign)(Object(n.__assign)({},o),{headers:a})}var u=r(388),s=r(1347),p=r(121),d=r(360);function l(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r,o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return t=Object(p.a)(),e?Object(u.r)(e.userIdentity)?[4,Object(s.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return r=n.sent(),d(t,r),[3,3];case 2:"GroupMailbox"!=e.type&&"TeamsMailbox"!=e.type||(o=a(e.mailboxSmtpAddress),d(t,o)),n.label=3;case 3:return[2,t]}}))}))}function f(){var e=Object(p.a)();return e.prefer='exchange.Behavior="CalendarInternal"',e}function b(e){void 0===e&&(e=null);var t={};return Object(u.r)(e)?(t=f(),Object(s.a)(e).then((function(e){return Object.keys(e).forEach((function(r){return t[r]=e[r]})),t}))):Promise.resolve(t)}var g=r(43);function v(e,t,r){var n=new Headers;return r&&n.set("X-OWA-CANARY",Object(g.a)()),t&&n.set("X-OWA-ActionName",t),e&&i(e,n),n}r.d(t,"a",(function(){return c})),r.d(t,"d",(function(){return l})),r.d(t,"b",(function(){return b})),r.d(t,"c",(function(){return f})),r.d(t,"f",(function(){return i})),r.d(t,"e",(function(){return v}))},1516:function(e,t,r){"use strict";var n,o;function a(e){n=e}function i(){return n}function c(e){o=e}function u(){return o}r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"d",(function(){return c})),r.d(t,"b",(function(){return u}))},1552:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3),o=Object(n.createStore)("currentGroupInformationStore",{smtpAddress:"",groupId:"",tenantId:""})},1609:function(e,t,r){"use strict";r.d(t,"b",(function(){return a}));var n=r(3),o={myOrgGroups:[],withContextMenuGroup:null,shouldShowAllGroups:!1,hasLoadedFromServer:!1,loadGroupsError:!1,groupNodeViewStates:new(r(20).ObservableMap)({})},a=Object(n.createStore)("leftNavGroupsStore",o),i=a();t.a=i},1687:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"BodyContentType:#Exchange"},e)}},1993:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"UnifiedGroupIdentity:#Exchange"},e)}},2468:function(e,t,r){"use strict";function n(e,t,r){var n,o,a,i,c,u=e.groups.get(t.toLowerCase());if(u||(r.unreadMessageCount=null,r.groupDetailsError=r.groupDetailsError||!1),!r.groupDetailsError||u&&u.basicInformation||(r.basicInformation={SmtpAddress:t,DisplayName:t}),r.groupDetails){var s=r.groupDetails;u&&u.basicInformation&&!u.groupDetailsError||(r.basicInformation={SmtpAddress:s.SmtpAddress,DisplayName:s.DisplayName,AccessType:s.AccessType,LegacyDN:s.LegacyDN,MailboxGuid:s.MailboxGuid}),r.groupDetails.UserGroupRelationship={SubscriptionType:(null===(n=s.UserGroupRelationship)||void 0===n?void 0:n.SubscriptionType)||0,IsSubscribed:(null===(o=s.UserGroupRelationship)||void 0===o?void 0:o.IsSubscribed)||!1,ShouldIgnoreReply:(null===(a=s.UserGroupRelationship)||void 0===a?void 0:a.ShouldIgnoreReply)||!1,IsMember:(null===(i=s.UserGroupRelationship)||void 0===i?void 0:i.IsMember)||!1,IsOwner:(null===(c=s.UserGroupRelationship)||void 0===c?void 0:c.IsOwner)||!1}}return r}var o=r(285),a=r(1552),i=Object(o.action)("addOrUpdateGroup")((function(e,t,r,o,i){var c;t=t.toLowerCase();var u=void 0!==o&&""!==o;if(u&&(o=o.toLowerCase(),t=r.groupDetails.SmtpAddress),r=n(e,u?o:t,r),e.groups.has(t)||u&&e.groups.has(o)){var s=e.groups.has(t)?e.groups.get(t):e.groups.get(o);r.basicInformation&&(s.basicInformation=r.basicInformation),r.groupDetails&&((null===(c=s.groupDetails)||void 0===c?void 0:c.MailboxSettings)&&!r.groupDetails.MailboxSettings&&(r.groupDetails.MailboxSettings=s.groupDetails.MailboxSettings),s.groupDetails=r.groupDetails),r.members&&(s.members=r.members),null!=r.groupDetailsError&&(s.groupDetailsError=r.groupDetailsError),u&&t!==o&&(void 0!==i&&i(t,o),e.groups.set(t,s),e.groups.delete(o),Object(a.a)().smtpAddress=t)}else e.groups.set(t,r)}));t.a=i},3234:function(e,t,r){"use strict";var n=r(285),o=r(1734),a=r(1810),i=r(1395),c=r(2468),u=r(1610),s=r(1504);var p=function(e,t){var r=Object(s.b)(t,"Site");r?!function(e){return-1==e.indexOf("_layouts/groupstatus.aspx")}(r)?Object(u.a)(e,1):Object(u.a)(e,2):Object(u.a)(e,0)},d=r(3),l=Object(d.action)("beforeGetGroupDetailsStartAction",(function(e){return{groupSmtpAddress:e}}));Object(d.orchestrator)(l,(function(e){3==Object(i.h)(e.groupSmtpAddress)&&Object(i.n)(e.groupSmtpAddress,1)}));var f=l,b=r(1552),g=Object(d.mutatorAction)("updateCurrentGroupIdAndTenantIdAction",(function(e,t){Object(b.a)().groupId=e,Object(b.a)().tenantId=t})),v=function(e,t){Object(c.a)(Object(i.j)(),e,{basicInformation:null,groupDetails:null,members:null,groupDetailsError:!0}),Object(i.n)(e,0),t&&t()},O=Object(n.action)("getGroupDetailsAction")((function(e,t,r,n){f(e),(o.g||a.f)(e,t).then((function(t){return function(e,t,r,n){if(e&&e.Body&&Object(a.i)(e.Body)){var o=e.Body.GroupDetails;o?(Object(c.a)(Object(i.j)(),o.SmtpAddress,{basicInformation:null,groupDetails:o,members:null,groupDetailsError:!1}),g(o.ExternalDirectoryObjectId,o.ExternalDirectoryOrganizationId),p(t,o),r&&r()):v(t,n)}else v(t,n)}(t,e,r,n)})).catch((function(t){v(e,n)}))}));t.a=O},3276:function(e,t,r){"use strict";var n=r(0),o=r(1609),a=r(20),i=r(721),c=r(275),u=r(1726),s=r(1),p=r(3449),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){e.stopPropagation(),t.props.selectGroup(t.props.groupId,t.props.customData)},t.toggleFavorite=function(){Object(p.a)(t.props.groupId)},t.onKeyDown=function(e){switch(e.keyCode){case 13:case 32:e.stopPropagation(),t.props.selectGroup(t.props.groupId,t.props.customData)}},t.renderRightCharm=function(){return t.props.renderRightCharm(t.props.groupId,t.props.customData)},t.renderRightCharmHover=function(){return t.props.renderRightCharmHover(t.props.groupId,t.props.customData)},t}return Object(n.__extends)(t,e),Object.defineProperty(t.prototype,"isSelected",{get:function(){return this.props.isSelected(this.props.groupId,this.props.customData)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isWithContextMenuOpen",{get:function(){return o.a.withContextMenuGroup&&this.props.groupId==o.a.withContextMenuGroup.groupId},enumerable:!1,configurable:!0}),t.prototype.shouldComponentUpdate=function(e,t){return!Object(c.f)(this.props,e)},t.prototype.render=function(){return s.createElement(u.a,{chevronProps:this.props.chevronProps,customIcon:this.props.customIcon,depth:1,displayName:this.props.displayName,isBeingDragged:this.props.isBeingDragged,isDroppedOver:this.props.isDroppedOver,isRootNode:!1,isSelected:this.isSelected,isWithContextMenuOpen:this.isWithContextMenuOpen,key:this.props.groupId,onClick:this.onClick,onContextMenu:this.props.onContextMenu,onKeyDown:this.onKeyDown,renderCustomTreeNodeDisplay:this.props.renderCustomTreeNodeDisplay,renderRightCharm:this.renderRightCharm,renderRightCharmHover:this.renderRightCharmHover,showAsHoverOnDroppedOver:this.props.showHoverStateOnDroppedOver,isFavorited:this.props.isFavorited,toggleFavorite:this.toggleFavorite})},Object(n.__decorate)([a.computed],t.prototype,"isSelected",null),Object(n.__decorate)([a.computed],t.prototype,"isWithContextMenuOpen",null),t=Object(n.__decorate)([i.observer],t)}(s.Component);t.a=d},3449:function(e,t,r){"use strict";var n=r(3);t.a=Object(n.action)("TOGGLE_FAVORITE_GROUPNODE_FROM_LEFTNAV",(function(e){return{groupId:e}}))},440:function(e,t,r){"use strict";var n=r(0);function o(e,t){return e?Object(n.__assign)({mailboxInfo:e},t):null!=t?t:void 0}r.d(t,"a",(function(){return o}))},5569:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r(29);function a(e){return Object(n.__assign)({__type:"UpdateUserGroupsSetConfigurationRequest:#Exchange"},e)}function i(e){var t,r;void 0===(t={request:a({GroupsSet:e})}).request||t.request.__type||(t.request=a(t.request)),Object(o.a)("UpdateUserGroupsSetConfiguration",t,r)}var c=r(269),u=r(83),s=r(2701),p=r(6605),d=r(285),l=Object(d.action)("removeGroupFromLeftNav")((function(e,t){var r=t.myOrgGroups.indexOf(e);r>=0&&t.myOrgGroups.splice(r,1)})),f=r(3234),b=r(1373),g=r(1311),v=r(2184),O=r(1425),h=r(2907),m=r(6185),j=r(9288);function y(e){if(("RowModified"==e.EventType||"RowAdded"==e.EventType)&&null!=e.IsMember&&null!=e.Group){var t=e.Group.SmtpAddress.toLowerCase();m.d.importAndExecute(t,e.IsMember);var r=Object(s.b)();e.IsMember?r.myOrgGroups.includes(t)||(J(),function(e){var t=Object(g.G)(),r=t&&Object(O.b)(t.tableQuery);r&&r.toLowerCase()===e&&Object(h.a)(t.tableQuery)}(t)):r.myOrgGroups.includes(t)&&(l(t,r),Object(p.c)(t),Object(f.a)(t),function(e){var t,r=Object(g.G)(),n=r&&Object(O.b)(r.tableQuery);if((null==n?void 0:n.toLowerCase())!==e)return;var o=Object(b.a)().groups.get(e);3!==(null===(t=null==o?void 0:o.basicInformation)||void 0===t?void 0:t.AccessType)&&(v.a.clear(r,null),Object(h.b)(r,"ErrorAccessDenied"))}(t))}}var D=r(3368),S=r(2468),w=r(788),I=r(787),T=r(319),G=r(59),x=r(74),A=r(1395),E=r(9),_=r(1338),C=r(2965),L=r(2913),M=r(2411),R=r(1493),k=r(1892),N=r(3582),H=r(440),F=5,P=1e4,U=30,B="GroupModulePrefetch",V="X-OWA-ActionSource",W="GroupMailbox_WarmUp",q="X-OWA-ActionName",X=!1;function z(){var e=Object(A.j)();X||(X=!0,setTimeout((function(){if(function(e){var t,r;try{for(var o=Object(n.__values)(s.c.myOrgGroups),a=o.next();!a.done;a=o.next()){var i=a.value;if(Y(e,i,U))return!0}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return!1}(e)){Object(N.b)(Date.now());var t=function(e){var t=s.c.myOrgGroups.filter((function(t,r){return Object(_.isGroupInFavorites)(t)&&Y(e,t,U)})).slice(0,F);if(t.length<F){var r=s.c.myOrgGroups.filter((function(t,r){return r<C.a&&!Object(_.isGroupInFavorites)(t)&&Y(e,t,U)}));t=t.concat(r).slice(0,F)}return t}(e);t.forEach((function(e){!function(e){var t=Object(L.b)(),r=Object(L.a)(e,t);switch(t){case 0:!function(e){var t=new Headers;t.set(V,B),t.set(q,W),Object(k.d)("inbox",1,e.viewFilter,e.sortBy,!1,e.focusedViewFilter,e.requestShapeName,Object(R.d)(e),void 0,e.categoryName,void 0,{headers:t})}(r);break;case 1:!function(e){Object(k.c)(Object(g.i)(e),0,1,e.viewFilter,Object(M.a)(e),e.focusedViewFilter,e.requestShapeName,e.shouldTryToUseSessionDataResponse,function(e){var t=Object(H.a)(Object(R.d)(e))||{};return t.headers=new Headers,t.headers.set(V,B),t.headers.set(q,W),t}(e),e.categoryName)}(r)}}(e)})),Object(N.c)(t)}}),P))}function Y(e,t,r){var n=e.groups.get(t.toLowerCase());if(!n||!n.basicInformation)return!1;var o=n.basicInformation;if(!o.LastVisitedTimeUtc)return!1;var a=Object(E.lc)(o.LastVisitedTimeUtc),i=Object(E.Wb)(a),c=Object(E.kc)();return Object(E.Mb)(i,Object(E.e)(c,-r),c)}var Q=r(7872),Z=!1;var J=Object(d.action)("loadGroups")((function(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r,o,a,p;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return Z?[2]:(t=new c.a("loadGroups"),Z=!0,d=new Array,Object(u.i)("tri-favorites-roaming")?d.push({FilterType:0,SortType:4,SortDirection:"Descending"}):(d.push({FilterType:1,SortType:4,SortDirection:"Descending"}),d.push({FilterType:2,SortType:4,SortDirection:"Descending"})),r=Object(w.a)({RequestedGroupsSets:d,AdditionalProperties:[4]}),[4,Object(I.a)({Header:Object(T.b)(),Body:r})]);case 1:return"Success"==(o=n.sent()).Body.ResponseClass?(t.end(),s.c.loadGroupsError=!1,s.c.hasLoadedFromServer=!0,$(a=o.Body.GroupsSets),i(a),e&&z()):(p="There was an error loading groups: "+Object(D.b)(o),t.addCustomData({error:p}),t.endWithError("ServerError",new Error(p)),s.c.loadGroupsError=!0),Z=!1,[2,Promise.resolve()]}var d}))}))})),K=Object(x.d)("loadGroupsFromSessionData",{name:"LoadGroupsInLeftNavFromSessionData",options:{}})((function(){if(!Z){Z=!0;var e=Object(Q.a)();if(!e)return G.g.info("GroupsSets data is not available in session data"),void(Z=!1);$(e.UnifiedGroupsSets),Z=!1}}));function $(e){if(e){s.c.myOrgGroups=[];var t=Object(A.j)();e.forEach((function(e){e.Groups.forEach((function(e){s.c.myOrgGroups.push(e.SmtpAddress.toLowerCase()),Object(S.a)(t,e.SmtpAddress,{basicInformation:e,groupDetails:null,members:null})}))}))}Object(p.b)(),Object(j.a)(y)}var ee=r(30),te=r(367);function re(){var e=!Object(ee.a)().UserOptions.IsGroupsTreeCollapsed;Object(te.a)((function(t){t.UserOptions.IsGroupsTreeCollapsed=e}),[{key:"IsGroupsTreeCollapsed",valuetype:"Boolean",value:[String(e)]}])}function ne(e){return Object(n.__assign)({__type:"SetUnifiedGroupLastVisitedTimeJsonRequest:#Exchange"},e)}var oe=r(1993);function ae(e){var t,r,a,i=Object(oe.a)({Type:0,Value:e});void 0===(t=ne({Header:Object(T.b)(),Body:(a={GroupIdentity:i,LastVisitedTimeUtc:(new Date).toISOString(),PreserveReadState:!0},Object(n.__assign)({__type:"SetUnifiedGroupLastVisitedTimeRequest:#Exchange"},a))}))||t.__type||(t=ne(t)),Object(o.a)("SetUnifiedGroupLastVisitedTime",t,r)}r.d(t,"loadGroups",(function(){return J})),r.d(t,"loadGroupsFromSessionData",(function(){return K})),r.d(t,"removeGroupFromLeftNav",(function(){return l})),r.d(t,"toggleGroupTreeExpansion",(function(){return re})),r.d(t,"unsubscribeFromUnreadNotifications",(function(){return p.c})),r.d(t,"setGroupLastVisitedTime",(function(){return ae}))},6185:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"b",(function(){return c})),r.d(t,"e",(function(){return u})),r.d(t,"d",(function(){return s}));var n=r(77),o=new n.c((function(){return Promise.all([r.e(44),r.e(133),r.e(578)]).then(r.bind(null,9256))})),a=new n.a(o,(function(e){return e.loadGroupAction})),i=new n.a(o,(function(e){return e.onAfterNewGroupSelectedAction})),c=new n.a(o,(function(e){return e.onAfterGroupDetailsSucceededAction})),u=new n.a(o,(function(e){return e.setGroupIsSubscribedAction})),s=new n.a(o,(function(e){return e.setGroupIsMemberAction}))},662:function(e,t,r){"use strict";var n=r(3),o=Object(n.action)("initializeOwaObservableDateTime"),a=Object(n.action)("observableNowChanged"),i=Object(n.action)("observableTodayChanged"),c=r(9),u=r(20),s=Object(n.createStore)("ObservableDateTime",{now:0,today:0}),p=Object(u.computed)((function(){return Object(c.lc)(s().now)})),d=function(){return p.get()},l=Object(u.computed)((function(){return Object(c.lc)(s().today)})),f=function(){return l.get()},b=function(e){return Object(c.Gb)(e,d())},g=function(e){return Object(c.Eb)(e,d())},v=function(e){return h(e,c.Gb)},O=function(e){return h(e,c.Hb)},h=function(e,t){return t(Object(c.Wb)(Object(c.lc)(e)),f())};function m(e){if(!e)return"";var t=Object(c.lc)(e);return function(e,t){var r=Object(c.Wb)(e);if(Object(c.Ib)(r,t))return c.Z;var n=function(e){return Object(c.Mb)(r,Object(c.e)(t,-e),t)};if(n(3))return c.hb;if(n(30))return c.gb;return c.X}(t,f())(t)}function j(e){if(!e)return"";var t=Object(c.lc)(e);return function(e,t){var r=Object(c.Wb)(e);if(Object(c.Ib)(r,t))return c.S;return c.T}(t,f())(t)}function y(e){return e?function(e,t){var r=Object(c.Wb)(e);return Object(c.Ib)(r,t)?Object(c.Z)(e):D(r,t,2)?Object(c.kb)(e):D(r,t,7)?Object(c.H)(Object(c.ab)(e),Object(c.Z)(e)):Object(c.H)(Object(c.J)(e),Object(c.Z)(e))}(Object(c.lc)(e),f()):""}function D(e,t,r){return Object(c.Mb)(e,Object(c.e)(t,-r),t)}var S=Object(n.action)("updateTimes"),w=Object(n.action)("setNow"),I=Object(n.action)("setToday",(function(e){return{today:e}}));Object(n.mutator)(w,(function(){s().now=Object(c.jc)()})),Object(n.mutator)(I,(function(e){var t=e.today;s().today=t}));var T=r(34),G=r(128);Object(n.orchestrator)(o,(function(){S();var e=Object(c.Pb)(),t=Object(c.Yb)(Object(c.h)(e,1)),r=Object(c.w)(t,e);setTimeout((function(){return setInterval(S,T.g)}),r)})),Object(n.orchestrator)(G.l,(function(){S()})),Object(n.orchestrator)(S,(function(){w();var e=Object(c.zb)(Object(c.kc)()),t=s().today!=e;t&&I(e),a(),t&&i()})),r.d(t,"d",(function(){return o})),r.d(t,"j",(function(){return a})),r.d(t,"l",(function(){return i})),r.d(t,"i",(function(){return d})),r.d(t,"k",(function(){return f})),r.d(t,"g",(function(){return b})),r.d(t,"e",(function(){return g})),r.d(t,"f",(function(){return v})),r.d(t,"h",(function(){return O})),r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return j})),r.d(t,"c",(function(){return y}))},666:function(e,t,r){"use strict";var n=r(0),o=r(1),a=r(391),i=r(458),c=r(457),u=r(14),s=r(230),p=r(392),d=r(425),l=Object(s.c)((function(e,t){var r,n=Object(p.a)(e),o=Object(d.a)(e),a=e.palette,i={root:{padding:"0 4px",width:"32px",height:"32px",backgroundColor:"transparent",border:"none",color:e.semanticColors.link},rootHovered:{color:a.themeDarkAlt,backgroundColor:a.neutralLighter,selectors:(r={},r[u.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},r)},rootHasMenu:{width:"auto"},rootPressed:{color:a.themeDark,backgroundColor:a.neutralLight},rootExpanded:{color:a.themeDark,backgroundColor:a.neutralLight},rootChecked:{color:a.themeDark,backgroundColor:a.neutralLight},rootCheckedHovered:{color:a.themeDark,backgroundColor:a.neutralQuaternaryAlt},rootDisabled:{color:a.neutralTertiaryAlt}};return Object(u.concatStyleSets)(n,i,o,t)}));r.d(t,"a",(function(){return f}));var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,r=e.theme;return o.createElement(a.a,Object(n.__assign)({},this.props,{variantClassName:"ms-Button--icon",styles:l(r,t),onRenderText:i.b,onRenderDescription:i.b}))},t=Object(n.__decorate)([Object(c.a)("IconButton",["theme","styles"],!0)],t)}(o.Component)},7872:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(276);function o(){return Object(n.a)().groups}},9288:function(e,t,r){"use strict";var n=r(1467),o=r(5321);function a(e){n.b.import().then((function(t){n.f.importAndExecute({subscriptionId:"GroupAssociationNotification",requiresExplicitSubscribe:!0,subscriptionParameters:Object(o.a)({NotificationType:"GroupAssociationNotification",ChannelId:t()})},e)}))}r.d(t,"a",(function(){return a}))}}]);
//# sourceMappingURL=owa.MailBoot~GroupList.js.map
self.scriptsLoaded['owa.MailBoot~GroupList.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~GroupList.js'] = (new Date()).getTime();