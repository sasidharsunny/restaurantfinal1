self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Addins~Attachments~BulkActions~CalendarFullCompose~CalendarReadingPane~Editor~EventifyClien~c9e3697d.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[28],{1312:function(e,n,r){"use strict";var t=r(77),o=r(1711),i=r(3),d=r(5676),u=r(2057),a=(Object(i.mutator)(d.a,(function(e){var n=e.folderTreeId,r=e.userIdentity,t=e.loadingState;Object(u.a)(r).get(n).loadingState=t})),r(0)),c=Object(i.action)("PERSONA_SEARCH_FOLDERS_LOADED",(function(e,n){return{existingFolders:e,personaOrPdlFavorites:n}})),l=r(1930),f=r(2286),s=(Object(i.mutator)(c,(function(e){e.existingFolders.forEach((function(n){if(n){var r=n.FolderId.Id,t=e.personaOrPdlFavorites.filter((function(e){return e.searchFolderId===r}));if(1===t.length){var o=t[0].displayName,i=Object(a.__assign)(Object(a.__assign)({},Object(f.c)(n)),{DisplayName:o});Object(l.a)().set(n.FolderId.Id,i)}}}))})),r(59)),b=r(2406),v=r(285);function I(e,n){n.forEach((function(n){e.folderTable.delete(n)}))}var O=Object(v.action)("removeFolderFromParentFolder")((function(e,n){if(n.ParentFolderId){var r=e.folderTable.get(n.ParentFolderId.Id).childFolderIds;r.splice(r.indexOf(n.FolderId.Id),1)}}));function F(e,n,r){for(var t=n.folderTable.get(r).childFolderIds,o=!1,i=Q(e).toLowerCase(),d=0;d<t.length&&!o;d++){Q(n.folderTable.get(t[d])).toLowerCase()>i&&(t.splice(d,0,e.FolderId.Id),o=!0)}o||t.push(e.FolderId.Id)}var g=Object(v.action)("moveFolderToParentFolder")((function(e,n,r){F(n,e,r),n.ParentFolderId={Id:r,__typename:"FolderId"},n.treeType=Object(b.c)(r,e)})),h=r(6644),j=r(2506);Object(i.mutator)(j.a,(function(e){!function(e,n,r,t){var o=Object(h.a)(r),i=Object(l.a)().get(r);i||s.g.warn("addFolderToStore: parent folder was not found");var d=i.treeType,u=Object(a.__assign)(Object(a.__assign)({},Object(f.c)(n)),{DisplayName:t,treeType:d});e.folderTable.set(n.FolderId.Id,u),F(u,e,o.Id)}(e.folderStore,e.folder,e.parentFolderId,e.displayName)}));var p=r(20),T=Object(i.mutatorAction)("addFoldersToFolderTableMutator",(function(e){0==Object(l.a)().size?Object(o.a)().folderTable=new p.ObservableMap(e):Object.keys(e).forEach((function(n){Object(l.a)().set(n,e[n])}))})),m=r(1325),E=r(96),_=Object(i.action)("REMOVE_FOLDERTREE_DATA",(function(e,n){return{folderTreeId:e,userIdentity:n}})),y=r(4087),S=Object(i.mutatorAction)("setFolderTreeData",(function(e,n,r,t,o,i){void 0===t&&(t=!1),void 0===o&&(o=0);var d={id:e,rootFolder:n,loadingState:r,hasMoreData:t,currentLoadedIndex:o};Object(u.a)(i).set(e,d)}));function D(e,n,r){return Object(l.a)().has(e.FolderId.Id)?Object(l.a)().get(e.FolderId.Id):Object(a.__assign)({childFolderIds:[],treeType:n,principalSMTPAddress:r},e)}Object(i.orchestrator)(j.f,(function(){var e={DistinguishedFolderId:m.d,DisplayName:Object(E.h)().SessionSettings.ArchiveDisplayName};S(m.d,e,y.a.Uninitialized)})),Object(i.mutator)(_,(function(e){Object(u.a)(e.userIdentity).delete(e.folderTreeId)}));var P=Object(i.mutatorAction)("updateFolder",(function(e,n,r,t){n&&(e.DisplayName=n),t.forEach((function(e){var n=r[e],t=r[n.ParentFolderId.Id]||Object(l.a)().get(n.ParentFolderId.Id);t&&t.childFolderIds.push(e)}))})),R=r(3844);function w(e,n,r,t,o){for(var i={},d=i[r.FolderId.Id]=o(r),u=[],a=0;a<t.length;a++){var c=t[a],l=c.FolderId.Id,f=c.DistinguishedFolderId;Object(R.a)(f)&&(i[l]=o(c),u.push(l))}P(d,n,i,u),T(i)}var L=r(6645);Object(i.orchestrator)(L.b,(function(e){var n=e.rootFolder,r=e.folders,t=e.treeType,o=e.principalSMTPAddress;w(0,null,n,r,(function(e){return D(e,t,o)}))}));var x=r(5677),A=r(12),N=(Object(i.orchestrator)(x.a,(function(e){var n=e.displayName,r=e.folders,t=e.folderTreeIdentifier,o=e.includesLastItemInRange,i=e.indexedPagingOffset,d=e.principalSMTPAddress,u=e.rootFolder,a=e.treeType,c=e.userIdentity;if(w(0,n,u,r,(function(e){return D(e,a,d)})),S(t,Object(l.a)().get(u.FolderId.Id),y.a.Loaded,!o,i,c),a===m.i){for(var f=0;f<r.length;f++){var s=r[f],b=s.FolderId.Id,v=s.DistinguishedFolderId;Object(A.f)(v)||Object(E.a)(v,b)}Object(E.a)(u.DistinguishedFolderId,u.FolderId.Id)}})),r(1322));function M(e,n,r){var t,o=Object(N.a)(r)||r;if(t=e.folderTable.get(o))for(var i=t.childFolderIds,d=n.toLowerCase(),u=0;u<i.length;u++){var a=i[u],c=e.folderTable.get(a);if(c&&c.DisplayName.toLowerCase()==d)return!0}return!1}function C(e,n){var r=[e];return n.folderTable.get(e).childFolderIds.forEach((function(e){Array.prototype.push.apply(r,C(e,n))})),r}function U(e){var n=Object(l.a)().get(e);return!!n.childFolderIds&&n.childFolderIds.map((function(e){return!!Object(l.a)().get(e)})).length>0}function k(e,n){return function e(n,r,t){var o=[];if(0===r){var i=e(n,r+1,t);o.push.apply(o,Object(a.__spread)(i))}else n.forEach((function(n){var i=Object(l.a)().get(n);if(i&&(o.push(Object(a.__assign)(Object(a.__assign)({},i),{depth:r})),U(n)&&t(n))){var d=e(i.childFolderIds,r+1,t);o.push.apply(o,Object(a.__spread)(d))}}));return o}(e,0,n)}var H,V={folderTable:new p.ObservableMap,mailboxFolderTreeData:new p.ObservableMap};var G=function(e,n){V.folderTable.set(e.FolderId.Id,e),e.ParentFolderId&&V.folderTable.get(e.ParentFolderId.Id).childFolderIds.push(e.FolderId.Id),e.DistinguishedFolderId&&(H[e.DistinguishedFolderId]=e.FolderId.Id)};G=Object(v.action)("addFolderToStore-TestMethod")(G);var z=Object(i.action)("INITIALIZE_SHARED_FOLDERS"),W=r(2408),B=r(2407),K=r(6646);function q(e){var n=Object(u.a)(),r=n&&n.get(e);return null==r?void 0:r.hasMoreData}var Y=r(6647),Z=r(2409),J=r(30);function Q(e){return e?Object(J.a)().SessionSettings.IsShadowMailbox&&e.remoteFolderDisplayName?e.remoteFolderDisplayName:e.DisplayName:""}var X=r(269);var $=Object(i.mutatorAction)("setMailboxFolderTreeData",(function(e,n){Object(o.a)().mailboxFolderTreeData.set(e,n)})),ee=new t.b(new t.c((function(){return r.e(238).then(r.bind(null,16688))})),(function(e){return e.fetchPrimaryMailFolders})),ne=r(83),re=r(4088);function te(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,t;return Object(a.__generator)(this,(function(o){switch(o.label){case 0:if(n=Object(E.b)(),Object(u.b)(n)||$(n,function(){var e;return{folderTreeTable:new p.ObservableMap((e={},e[m.j]={id:m.j,rootFolder:{DistinguishedFolderId:m.j,DisplayName:m.j},loadingState:y.a.Uninitialized},e)),sharedFolderUserEmails:[]}}()),(r=Object(K.a)(m.j,n))==y.a.Loading||r==y.a.Loaded&&!e)return[2];Object(d.a)(m.j,y.a.Loading,n),t=!Object(ne.i)("tri-disableSDFolders")&&Object(re.f)(),o.label=1;case 1:return o.trys.push([1,5,,6]),t?[3,4]:[4,ee.import()];case 2:return[4,o.sent()(n,n)];case 3:t=o.sent(),o.label=4;case 4:return[3,6];case 5:return o.sent(),Object(d.a)(m.j,y.a.ErrorLoading,n),[2];case 6:return t?(Object(x.a)(t.RootFolder,t.Folders,m.j,m.i,n,Object(J.a)().SessionSettings.UserDisplayName,m.j,n,t.IncludesLastItemInRange,t.IndexedPagingOffset),function(){var e,n,r=null===(e=Object(l.a)().get(Object(N.a)("inbox")))||void 0===e?void 0:e.childFolderIds.length,t=null===(n=Object(l.a)().get(Object(N.a)("msgfolderroot")))||void 0===n?void 0:n.TotalCount;Object(X.p)("TnS_LoadFolders",[r,t])}(),[2]):(Object(d.a)(m.j,y.a.ErrorLoading,n),[2])}}))}))}var oe=r(5678),ie=Object(v.select)({folderTable:function(){return o.b.folderTable}})((function(e,n){return Object(oe.c)(e,"msgfolderroot",n)}));function de(e){return Object(oe.a)(o.b.folderTable.get(e),"msgfolderroot")}var ue=r(4089),ae=r(7395),ce=r(7394);r.d(n,"L",(function(){return fe})),r.d(n,"M",(function(){return se})),r.d(n,"P",(function(){return be})),r.d(n,"Q",(function(){return ve})),r.d(n,"J",(function(){return Ie})),r.d(n,"N",(function(){return Oe})),r.d(n,"O",(function(){return Fe})),r.d(n,"K",(function(){return ge})),r.d(n,"z",(function(){return o.a})),r.d(n,"b",(function(){return T})),r.d(n,"f",(function(){return M})),r.d(n,"h",(function(){return C})),r.d(n,"k",(function(){return k})),r.d(n,"A",(function(){return U})),r.d(n,"a",(function(){return y.a})),r.d(n,"s",(function(){return h.a})),r.d(n,"U",(function(){return c})),r.d(n,"e",(function(){return I})),r.d(n,"V",(function(){return O})),r.d(n,"R",(function(){return g})),r.d(n,"c",(function(){return j.a})),r.d(n,"B",(function(){return j.f})),r.d(n,"n",(function(){return j.e})),r.d(n,"m",(function(){return j.d})),r.d(n,"ab",(function(){return j.k})),r.d(n,"Z",(function(){return j.i})),r.d(n,"S",(function(){return j.g})),r.d(n,"C",(function(){return z})),r.d(n,"W",(function(){return _})),r.d(n,"T",(function(){return x.a})),r.d(n,"Y",(function(){return d.a})),r.d(n,"i",(function(){return W.a})),r.d(n,"w",(function(){return B.a})),r.d(n,"o",(function(){return l.a})),r.d(n,"r",(function(){return K.a})),r.d(n,"q",(function(){return q})),r.d(n,"p",(function(){return Y.a})),r.d(n,"y",(function(){return Z.a})),r.d(n,"j",(function(){return Q})),r.d(n,"X",(function(){return S})),r.d(n,"x",(function(){return te})),r.d(n,"G",(function(){return ie})),r.d(n,"F",(function(){return de})),r.d(n,"I",(function(){return oe.c})),r.d(n,"E",(function(){return oe.a})),r.d(n,"l",(function(){return b.a})),r.d(n,"t",(function(){return b.b})),r.d(n,"D",(function(){return b.d})),r.d(n,"v",(function(){return ue.a})),r.d(n,"H",(function(){return ae.b})),r.d(n,"u",(function(){return u.b})),r.d(n,"g",(function(){return ce.a}));n.d=o.b;var le=new t.c((function(){return r.e(238).then(r.bind(null,16688))})),fe=new t.b(le,(function(e){return e.getArchiveFolders})),se=new t.b(le,(function(e){return e.getFolderPermissions})),be=new t.b(le,(function(e){return e.updateFolderPermissions})),ve=new t.b(le,(function(e){return e.updateFolderPermissionsInStore})),Ie=new t.b(le,(function(e){return e.arePermissionArraysEqual})),Oe=(new t.b(le,(function(e){return e.arePermissionsEqual})),new t.b(le,(function(e){return e.getSharedFolders}))),Fe=new t.a(le,(function(e){return e.updateFolder})),ge=new t.a(le,(function(e){return e.createNewFolder}))},1325:function(e,n,r){"use strict";r.d(n,"f",(function(){return t})),r.d(n,"d",(function(){return o})),r.d(n,"j",(function(){return i})),r.d(n,"a",(function(){return d})),r.d(n,"g",(function(){return u})),r.d(n,"b",(function(){return a})),r.d(n,"h",(function(){return c})),r.d(n,"l",(function(){return l})),r.d(n,"k",(function(){return f})),r.d(n,"i",(function(){return s})),r.d(n,"c",(function(){return b})),r.d(n,"e",(function(){return v}));var t=["journal","outbox","syncissues"],o="archivemsgfolderroot",i="msgfolderroot",d="archivedeleteditems",u="deleteditems",a="archiverecoverableitemsdeletions",c="recoverableitemsdeletions",l="msgfolderroot",f="sharedFolderTree",s="primaryFolderTree",b="archiveFolderTree",v="favorites"},1368:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(50);function o(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return t.a.defaultFolderIdToNameMap.get(e)||"none"}},1711:function(e,n,r){"use strict";r.d(n,"b",(function(){return d}));var t=r(3),o=r(20),i=Object(t.createStore)("folderStore",{folderTable:new o.ObservableMap,mailboxFolderTreeData:new o.ObservableMap}),d=i();n.a=i},1813:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(2057);function o(e,n){var r=Object(t.a)(n),o=r&&r.get(e);return null==o?void 0:o.rootFolder}},1930:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(1711);function o(){return Object(t.a)().folderTable}},1992:function(e,n,r){"use strict";r.d(n,"a",(function(){return i}));var t=r(320),o=r(83);function i(){var e=Object(t.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(o.i)("notes-folder-view")&&e.push("notes"),e}},2057:function(e,n,r){"use strict";r.d(n,"a",(function(){return i})),r.d(n,"b",(function(){return d}));var t=r(1711),o=r(96);function i(e){return d(e).folderTreeTable}function d(e){return e||(e=Object(o.b)()),Object(t.a)().mailboxFolderTreeData.get(e)}},2251:function(e,n,r){"use strict";r.d(n,"b",(function(){return d}));var t=r(10),o=r(1992);r.d(n,"a",(function(){return o.a}));var i=new t.b((function(){return Promise.all([r.e(9),r.e(12),r.e(17),r.e(20),r.e(22),r.e(666)]).then(r.bind(null,3846))})),d=new t.a(i,(function(e){return e.bootstrapFolderHierarchyCache}))},2286:function(e,n,r){"use strict";var t=function(e,n){var r,t;if(e.ExtendedProperty)for(var o=0;o<e.ExtendedProperty.length;o++){var i=e.ExtendedProperty[o];if((null===(r=null==i?void 0:i.ExtendedFieldURI)||void 0===r?void 0:r.PropertyTag)===n||(null===(t=null==i?void 0:i.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===n)return i.Value}},o=function(e){var n=t(e,"SourceWellKnownFolderType");return n&&parseInt(n,10)||-1},i=function(e){return t(e,"0x7018")||null},d=function(e){return"false"!==t(e,"0x10f4")},u=r(1325),a=r(59);function c(e,n,r,t,o,i){var a,c=e.RootFolder;if(!c||!c.Folders||!c.ParentFolder)throw new Error("folderHierarchyWeb: failed to get folders");var f=[];null==c||c.Folders.forEach((function(e){if(e&&function(e,n,r){if(t=null==e?void 0:e.__type,"Folder:#Exchange"!=t)return!1;var t;if((null==e?void 0:e.DistinguishedFolderId)&&u.f.indexOf(e.DistinguishedFolderId)>=0)return!1;if(d(e))return!1;if("clutter"===e.DistinguishedFolderId&&0===e.TotalCount)return!1;if("junkemail"===e.DistinguishedFolderId)return!!n;if("notes"===e.DistinguishedFolderId)return!!r;return!0}(e,t,o)){var n=l(e);n&&f.push(n)}}));var s=function(e,n){return"SharedMailbox"===n?void 0:e}((null===(a=null==c?void 0:c.ParentFolder)||void 0===a?void 0:a.DistinguishedFolderId)||"none",n);c.ParentFolder.DistinguishedFolderId=s;var b=l(c.ParentFolder);return i&&function(e,n,r){if(e){var t={},o={},i=[];t[e.FolderId.Id]=e,i.push(e.FolderId.Id),n.forEach((function(e){e&&(t[e.FolderId.Id]=e,i.push(e.FolderId.Id))})),i.forEach((function(e){var n,r=t[e],i=null===(n=r.ParentFolderId)||void 0===n?void 0:n.Id;r.DistinguishedFolderId&&(o[r.DistinguishedFolderId]=e);var d=i&&t[i];d&&d.childFolderIds.push(e)}));var d=[];r.forEach((function(e){var n=o[e];n&&d.push(n)}));for(var u=e.childFolderIds||[],a=0;a<u.length;a++){var c=u[a]||null;c&&-1==d.indexOf(c)&&d.push(c)}e.childFolderIds=d}}(b,f,r),{__typename:"FolderHierarchyResult",Folders:f,RootFolder:b,IndexedPagingOffset:c.IndexedPagingOffset,TotalItemsInView:c.TotalItemsInView,IncludesLastItemInRange:c.IncludesLastItemInRange}}function l(e){var n=e,r=n.FolderId,t=n.ParentFolderId,d=n.DisplayName,u=n.ArchiveTag,c=n.PolicyTag,l=n.ChildFolderCount,v=n.UnreadCount,I=n.TotalCount,O=n.FolderClass,F=n.DistinguishedFolderId;if(!r||!t)return a.g.warn("mapOWSFolderToGql: ignoring folder with missing folderId or missing parentFolderId"),null;var g=l||0,h=s(r);return{id:h.Id,__typename:"MailFolder",type:n.__type,FolderId:h,ParentFolderId:s(t),DisplayName:d||"",DistinguishedFolderId:F||null,FolderClass:O||"IPF.Note",UnreadCount:v||0,TotalCount:I||0,ArchiveTag:u?b(u):null,PolicyTag:c?b(c):null,hasChildren:g>0,remoteFolderDisplayName:i(n),sourceWellKnownFolderType:o(n),ReplicaList:n.ReplicaList,PermissionSet:n.PermissionSet,size:f(n),childFolderIds:[],treeType:null,pausedTotalCount:null,principalSMTPAddress:null}}function f(e){var n,r;return null===(r=null===(n=e.ExtendedProperty)||void 0===n?void 0:n[0])||void 0===r?void 0:r.Value}function s(e){return{__typename:"FolderId",Id:e.Id,ChangeKey:e.ChangeKey}}function b(e){return{__typename:"RetentionTagType",IsExplicit:e.IsExplicit,Value:e.Value}}r.d(n,"a",(function(){return o})),r.d(n,"b",(function(){return c})),r.d(n,"c",(function(){return l}))},2406:function(e,n,r){"use strict";r.d(n,"a",(function(){return f})),r.d(n,"b",(function(){return s})),r.d(n,"d",(function(){return b})),r.d(n,"c",(function(){return v}));var t=r(1322),o=r(1368),i=r(1711),d=r(2407),u=r(1930),a=r(2408),c=r(2409),l=r(2251);function f(e){var n=Object(u.a)(),r=Object(t.a)(e);return r?n.get(r):void 0}function s(e,n){if("sharedFolder"===e&&!n)throw new Error("To get all the shared folders you must pass principalSMTPAddress");var r,t=[];switch(e){case"archive":r=Object(a.a)();break;case"sharedFolder":r=Object(c.a)(n);break;default:r=Object(d.a)()}var u=Object(l.a)();"primary"==e&&r.DistinguishedFolderId==Object(d.a)().DistinguishedFolderId&&r.FolderId&&u.forEach((function(e){var n=f(e);(null==n?void 0:n.ParentFolderId.Id)===r.FolderId.Id&&t.push(n.FolderId.Id)}));for(var s=function(e){var n=[];(null==e?void 0:e.childFolderIds)&&e.childFolderIds.map((function(e){var r=i.b.folderTable.get(e);n.push(r.FolderId.Id)}));return n}(r),b=0;b<s.length;b++)-1==u.indexOf(Object(o.a)(s[b]))&&t.push(s[b]);return t}function b(e,n){var r=Object(u.a)().get(e);return!(!r||r.treeType!==n)}function v(e,n){var r=null,t=n.folderTable.get(e);return t&&(r=t.treeType),r}},2407:function(e,n,r){"use strict";r.d(n,"a",(function(){return i}));var t=r(1813),o=r(1325);function i(e){return Object(t.a)(o.j,e)}},2408:function(e,n,r){"use strict";r.d(n,"a",(function(){return i}));var t=r(1813),o=r(1325);function i(e){return Object(t.a)(o.d,e)}},2409:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(1813);function o(e){return Object(t.a)(e)}},2506:function(e,n,r){"use strict";r.d(n,"b",(function(){return o})),r.d(n,"f",(function(){return i})),r.d(n,"c",(function(){return d})),r.d(n,"e",(function(){return u})),r.d(n,"d",(function(){return a})),r.d(n,"h",(function(){return c})),r.d(n,"j",(function(){return l})),r.d(n,"k",(function(){return f})),r.d(n,"i",(function(){return s})),r.d(n,"a",(function(){return b})),r.d(n,"g",(function(){return v}));var t=r(3),o=Object(t.action)("GET_ARCHIVE_FOLDERS",(function(e,n){return{source:e,isLoadingMore:n}})),i=Object(t.action)("INITIALIZE_ARCHIVE_FOLDER_TREE_FROM_SESSIONDATA"),d=Object(t.action)("GET_FOLDER_PERMISSIONS",(function(e){return{folderId:e}})),u=Object(t.action)("GET_FOLDER_PERMISSIONS_SUCCESS"),a=Object(t.action)("GET_FOLDER_PERMISSIONS_FAILED"),c=Object(t.action)("UPDATE_FOLDER_PERMISSIONS",(function(e,n,r){return{folderId:e,permissions:n,mailboxInfo:r}})),l=Object(t.action)("UPDATE_FOLDER_PERMISSIONS_IN_STORE",(function(e,n){return{folderId:e,permissions:n}})),f=Object(t.action)("UPDATE_FOLDER_PERMISSIONS_SUCCESS"),s=Object(t.action)("UPDATE_FOLDER_PERMISSIONS_FAILED"),b=Object(t.action)("ADD_NEW_FOLDER_TO_STORE",(function(e,n,r,t){return{folderStore:e,folder:n,parentFolderId:r,displayName:t}})),v=Object(t.action)("ON_CREATE_NEW_FOLDER_INBOX_RULES_RESPONSE",(function(e,n,r,t){return{folderStore:e,folderId:n,parentFolderId:r,displayName:t}}))},2507:function(e,n,r){"use strict";r.d(n,"c",(function(){return O})),r.d(n,"d",(function(){return F})),r.d(n,"f",(function(){return g})),r.d(n,"e",(function(){return h})),r.d(n,"g",(function(){return j})),r.d(n,"h",(function(){return p})),r.d(n,"a",(function(){return T})),r.d(n,"b",(function(){return m}));var t,o,i,d,u,a,c,l=r(0),f=r(7),s=r(2286),b=r(3844),v=r(604),I=r(59);function O(){return a}function F(e,n){var r,l;t=c?void 0:e.findConversation,o=c?void 0:null==n?void 0:n.conversationRows,u=c?void 0:e.findMailFolderItem,a=null===(l=null===(r=e.findFolders)||void 0===r?void 0:r.Header)||void 0===l?void 0:l.ServerVersionInfo,i=e.findFolders,d=null==n?void 0:n.folderHierarchy}function g(e,n){var r,i=m(t,(function(e){return e.Body}),"fcr");if(t=void 0,o=void 0,c=!0,i){var d=void 0;if(e!=(null===(r=i.FolderId)||void 0===r?void 0:r.Id)?d="wf":i.Conversations?"number"==typeof i.IndexedOffset&&n===i.Conversations.length-i.IndexedOffset||(d="wi"):d="ni",Object(f.b)("fcr",d||"s"),!d)return i}return null}function h(e,n){return Object(l.__awaiter)(this,void 0,void 0,(function(){var r,i,d,u;return Object(l.__generator)(this,(function(a){switch(a.label){case 0:return r="fcr",i=o,d=t,t=void 0,o=void 0,c=!0,i||!d?[3,2]:[4,v.b.importAndExecute(d)];case 1:i=a.sent(),a.label=2;case 2:return i?(e!=i.folderId?u="wf":0!==n&&(u="wi"),Object(f.b)(r,u||"s"),[2,u?null:i]):[2,null]}}))}))}function j(e,n,r){var t=m(u,(function(e){var n,r,t;return null===(t=null===(r=null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseMessages)||void 0===r?void 0:r.Items)||void 0===t?void 0:t[0]}),"fir");if(u=void 0,c=!0,t){var o=void 0,i=null==t?void 0:t.RootFolder;if(e!=r?o="wf":(null==i?void 0:i.Items)?"number"==typeof i.IndexedPagingOffset&&n===i.Items.length-i.IndexedPagingOffset||(o="wi"):o="ni",Object(f.b)("fir",o||"s"),!o)return t}return null}function p(){var e=d,n=i;return d=void 0,i=void 0,!e&&n&&(e=function(e){var n=T(e);if(!n)return;try{return Object(s.b)(n,"UserMailbox",[],Object(b.a)("junkemail"),Object(b.a)("notes"),!1)}catch(e){return void I.g.warn("tryGetFolderHierarchyFromResponse: "+e.message)}}(n)),e&&Object(f.b)("ffr","s"),e}function T(e){return m(e,(function(e){var n,r,t;return null===(t=null===(r=null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseMessages)||void 0===r?void 0:r.Items)||void 0===t?void 0:t[0]}),"ffr")}function m(e,n,r){var t="njr";if(e){var o=n(e);if(o){if("Error"!=o.ResponseClass)return o;t="e",Object(f.b)(r+"_c",o.ResponseCode||"un")}else t="nrm"}return Object(f.b)(r,t),null}},3844:function(e,n,r){"use strict";var t=r(96),o=r(83);function i(e){var n=Object(t.h)().SegmentationSettings;return"junkemail"===e?!!(null==n?void 0:n.JunkEMail):"notes"!==e||!!(null==n?void 0:n.StickyNotes)&&Object(o.i)("cal-stickyNotesFolder")}r.d(n,"a",(function(){return i}))},4087:function(e,n,r){"use strict";var t;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.ErrorLoading=3]="ErrorLoading"}(t||(t={})),n.a=t},4088:function(e,n,r){"use strict";var t=r(2507);r.d(n,"a",(function(){return t.a})),r.d(n,"b",(function(){return t.c})),r.d(n,"d",(function(){return t.f})),r.d(n,"c",(function(){return t.e})),r.d(n,"e",(function(){return t.g})),r.d(n,"f",(function(){return t.h}))},4089:function(e,n,r){"use strict";r.d(n,"a",(function(){return a}));var t=r(295),o=r(1930),i=r(1325),d=r(30),u=r(7394);function a(e,n){var r,a,c,l,f,s=Object(o.a)(),b=null==s?void 0:s.get(e),v=Object(d.a)().SessionSettings;return(null==b?void 0:b.treeType)===i.k?(a=b.principalSMTPAddress,f="SharedMailbox"):e==i.d||e==i.b||(null==b?void 0:b.treeType)==i.c?((l=null===(r=null==b?void 0:b.ReplicaList)||void 0===r?void 0:r[0])&&n?c=l:(c=v.ArchiveMailboxGuid,l=void 0),f="ArchiveMailbox",a=Object(u.a)(c,v.OrganizationDomain)):(a=v.UserEmailAddress,f="UserMailbox"),{type:f,userIdentity:Object(t.d)().userIdentity,mailboxSmtpAddress:a,auxiliaryMailboxGuid:l}}},5676:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(3),o=Object(t.action)("SET_LOADING_STATE_FOR_FOLDER_TREE",(function(e,n,r){return{folderTreeId:e,loadingState:n,userIdentity:r}}))},5677:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(3),o=Object(t.action)("ON_QUERY_FOLDERHIERARCHY",(function(e,n,r,t,o,i,d,u,a,c){return{rootFolder:e,folders:n,distinguishedFolderId:r,treeType:t,principalSMTPAddress:o,displayName:i,folderTreeIdentifier:d,userIdentity:u,includesLastItemInRange:a,indexedPagingOffset:c}}))},5678:function(e,n,r){"use strict";r.d(n,"b",(function(){return i})),r.d(n,"c",(function(){return d}));var t=r(1711),o=r(285);function i(e){return"msgfolderroot"===e.DistinguishedFolderId}var d=Object(o.select)({folderTable:function(){return t.b.folderTable}})((function(e,n,r){var t=!!e&&e.ParentFolderId;if(!t)return!1;for(var o=r.folderTable.get(t.Id);o;){if(o.DistinguishedFolderId==n)return!0;if(!o.ParentFolderId)return!1;o=r.folderTable.get(o.ParentFolderId.Id)}return!1}));n.a=Object(o.select)({folderTable:function(){return t.b.folderTable}})((function(e,n,r){return function(e,n){return!!e&&e.DistinguishedFolderId==n}(e,n)||d(e,n,r)}))},604:function(e,n,r){"use strict";r.d(n,"a",(function(){return o})),r.d(n,"b",(function(){return i}));var t=r(10),o=new t.a(new t.b((function(){return Promise.all([r.e(38),r.e(718)]).then(r.bind(null,1029))})),(function(e){return e.stashSessionDataResponses})),i=new t.a(new t.b((function(){return Promise.all([r.e(38),r.e(734)]).then(r.bind(null,1028))})),(function(e){return e.tryGetConversationRowsFromResponse}))},6644:function(e,n,r){"use strict";r.d(n,"a",(function(){return d}));var t=r(1322),o=r(1711),i=r(547);function d(e){var n=Object(t.a)(e);return n||(n=e),Object(o.a)().folderTable.get(n)?Object(o.a)().folderTable.get(n).FolderId:Object(i.a)({Id:n,__type:"FolderId:#Exchange"})}},6645:function(e,n,r){"use strict";r.d(n,"a",(function(){return o})),r.d(n,"c",(function(){return i})),r.d(n,"b",(function(){return d}));var t=r(3),o=Object(t.action)("FETCH_ARCHIVE_DUMPSTER_FOLDER"),i=Object(t.action)("SET_REPLICA_LIST",(function(e,n){return{folderId:e,replicaList:n}})),d=Object(t.action)("ON_FIND_DUMPSTER_FOLDER_SUCCESS",(function(e,n,r,t){return{rootFolder:e,folders:n,treeType:r,principalSMTPAddress:t}}))},6646:function(e,n,r){"use strict";r.d(n,"a",(function(){return i}));var t=r(4087),o=r(2057);function i(e,n){var r=Object(o.a)(n),i=r&&r.get(e);return(null==i?void 0:i.loadingState)||t.a.Uninitialized}},6647:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(2057);function o(e,n){var r=Object(t.a)(n),o=r&&r.get(e);return(null==o?void 0:o.currentLoadedIndex)||0}},7394:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(12);r(7395),r(59);function o(e,n){if(!e||!n)return null;return t.c("{0}@{1}",e,n)}},7395:function(e,n,r){"use strict";r.d(n,"a",(function(){return o})),r.d(n,"b",(function(){return i}));var t=r(59);function o(e){if(!e)return null;var n=e,r=0;if(1==n[0]){if(!(n=d(n)))return null}else r=1;var o=n[++r]+(n[r+1]>>8);return function(e,n,r){if(n+r>e.length)return t.d("ConvertByteArrayToString: offset + count must not exceed byte array length."),null;for(var o="",i=n;i<n+r;i++)o+=String.fromCharCode(e[i]);return o}(n,r+=2,o)}function i(e){if(!e)return!1;try{for(var n=atob(e),r=new Uint8Array(n.length),t=0;t<n.length;t++)r[t]=n.charCodeAt(t);var o=0;return 1===r[0]?r=d(r):o=1,r&&1===r[o]}catch(e){return!1}}function d(e){var n=u(e,null);if(0==n)return t.d("rleDecompress : Invalid id"),null;var r=new Uint8Array(n);return u(e,r),r}function u(e,n){for(var r=0,o=1;o<e.length;++o)if(o==e.length-1||e[o]!=e[o+1])null!=n&&(n[r]=e[o]),r++;else{if(o==e.length-2)return t.d("decompressEx : Invalid id"),null;for(var i=e[o+2],d=0;d<i+2;d++)null!=n&&(n[r]=e[o]),r++;o+=2}return r}}}]);
//# sourceMappingURL=owa.MailBoot~Addins~Attachments~BulkActions~CalendarFullCompose~CalendarReadingPane~Editor~EventifyClien~c9e3697d.js.map
self.scriptsLoaded['owa.MailBoot~Addins~Attachments~BulkActions~CalendarFullCompose~CalendarReadingPane~Editor~EventifyClien~c9e3697d.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Addins~Attachments~BulkActions~CalendarFullCompose~CalendarReadingPane~Editor~EventifyClien~c9e3697d.js'] = (new Date()).getTime();