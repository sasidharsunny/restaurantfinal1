self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SharedFolders.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[722],{12534:function(e){e.exports=JSON.parse('{"a":"mIb"}')},12535:function(e){e.exports=JSON.parse('{"a":"lIb"}')},1410:function(e,i,n){"use strict";var a,t;n.d(i,"b",(function(){return a})),n.d(i,"a",(function(){return t})),function(e){e[e.None=0]="None",e[e.Cache=1]="Cache",e[e.FindPeople=2]="FindPeople",e[e.SearchDirectory=3]="SearchDirectory",e[e.MixedCacheLive=4]="MixedCacheLive"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Manual=2]="Manual"}(t||(t={}))},3364:function(e){e.exports=JSON.parse('{"a":"tBb"}')},3962:function(e){e.exports=JSON.parse('{"a":"oBb"}')},4162:function(e,i,n){"use strict";n.d(i,"a",(function(){return a}));var a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"MailFolderFromServiceFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MailFolder"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"FolderId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"ChangeKey"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"ParentFolderId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"ChangeKey"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"DisplayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"DistinguishedFolderId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"FolderClass"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"UnreadCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"TotalCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"hasChildren"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"childFolderIds"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"size"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"remoteFolderDisplayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sourceWellKnownFolderType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"ArchiveTag"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"IsExplicit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"Value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"PolicyTag"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"IsExplicit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"Value"},arguments:[],directives:[]}]}}]}}]}},4264:function(e){e.exports=JSON.parse('{"a":"eIb"}')},4422:function(e,i,n){"use strict";n.d(i,"a",(function(){return r}));var a=n(1312),t=n(96);function r(e){return e||(e=Object(t.b)()),Object(a.u)(e).sharedFolderUserEmails}},4588:function(e,i,n){"use strict";n.d(i,"a",(function(){return r}));var a=n(0),t=n(4162),r={kind:"Document",definitions:Object(a.__spread)([{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FolderHierarchy"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"baseFolderDistinguishedIds"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"indexedPageOffset"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userIdentity"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxSmtpAddress"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxType"}},type:{kind:"NamedType",name:{kind:"Name",value:"MailboxType"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shouldPopulateChildFolderIds"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folderHierarchy"},arguments:[{kind:"Argument",name:{kind:"Name",value:"baseFolderDistinguishedIds"},value:{kind:"Variable",name:{kind:"Name",value:"baseFolderDistinguishedIds"}}},{kind:"Argument",name:{kind:"Name",value:"indexedPageOffset"},value:{kind:"Variable",name:{kind:"Name",value:"indexedPageOffset"}}},{kind:"Argument",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"Argument",name:{kind:"Name",value:"foldersToShowFirst"},value:{kind:"ListValue",values:[]}},{kind:"Argument",name:{kind:"Name",value:"shouldShowJunkEmailFolder"},value:{kind:"BooleanValue",value:!0}},{kind:"Argument",name:{kind:"Name",value:"shouldShowNotesFolder"},value:{kind:"BooleanValue",value:!0}},{kind:"Argument",name:{kind:"Name",value:"shouldPopulateChildFolderIds"},value:{kind:"Variable",name:{kind:"Name",value:"shouldPopulateChildFolderIds"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"RootFolder"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"MailFolderFromServiceFragment"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"Folders"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"MailFolderFromServiceFragment"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"IncludesLastItemInRange"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"TotalItemsInView"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"IndexedPagingOffset"},arguments:[],directives:[]}]}}]}}],t.a.definitions)}},5563:function(e,i,n){"use strict";n.r(i);var a=n(0),t=n(49),r=n(12534),d=n(4264),o=n(12),s=n(9297),l=n(1),u=n(3),c=Object(u.createStore)("sharedFolderState",{showPeoplePickerDialog:!1}),m=c(),v=n(12535),b=Object(u.action)("ADD_SHARED_FOLDER_USER_EMAIL",(function(e,i){return{sharedUserMailboxSmtpAddress:e,userIdentity:i}})),k=Object(u.action)("ON_ADD_SHARED_FOLDER_SUCCESS",(function(e,i,n){return{sharedUserMailboxSmtpAddress:e,folder:i,userIdentity:n}})),f=n(29);function p(e,i){return n={displayName:e,primarySMTPAddress:i},Object(f.a)("AddSharedFolders",n,a);var n,a}var h=n(269),S=n(1328),g=n(1325),O=n(3364),F=n(59),N=n(96);function j(e,i,n,t){return void 0===n&&(n=!1),void 0===t&&(t=Object(N.b)()),Object(a.__awaiter)(this,void 0,void 0,(function(){var r,d;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),n?[3,2]:[4,p(e,i)];case 1:if(!a.sent())return[2];a.label=2;case 2:return[3,4];case 3:return r=a.sent(),Object(S.b)(Object(o.b)(O.a),Object(o.b)(v.a),!1,{hideCancelButton:!0}),F.d("Add shared folder API returned error "+r),[2];case 4:return d={FolderId:{Id:i},DisplayName:e,treeType:g.k,principalSMTPAddress:i,UnreadCount:0,TotalCount:0,DistinguishedFolderId:void 0},k(i,d,t),b(i,t),n||Object(h.p)("Triage_SharedFolders_AddFolder"),[2]}}))}))}var y=Object(u.action)("showAddSharedFolderDialog",(function(e){return{showDialogMessageFlag:e}})),I=Object(t.a)((function(){return m.showPeoplePickerDialog&&l.createElement(s.a,{title:Object(o.b)(d.a),subTitle:Object(o.b)(r.a),addCallback:x,cancelCallback:D})}));function x(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(i){return j(e.Name,e.EmailAddress),[2]}))}))}function D(){y(!1)}var _=Object(u.action)("REMOVE_SHARED_FOLDER_USER",(function(e,i){return i||(i=Object(N.b)()),{sharedUserMailboxSmtpAddress:e,userIdentity:i}})),M=n(4422),A=Object(u.action)("REMOVE_SHARED_FOLDER_USER_EMAIL",(function(e,i){return{sharedUserMailboxSmtpAddress:e,userIdentity:i}})),T=(Object(u.mutator)(A,(function(e){var i=Object(M.a)(e.userIdentity),n=i.indexOf(e.sharedUserMailboxSmtpAddress);-1!==n?i.splice(n,1):F.d("Trying to remove a non-existent shared folder user : "+e.sharedUserMailboxSmtpAddress)})),Object(u.mutator)(b,(function(e){var i=Object(M.a)(e.userIdentity);-1==i.indexOf(e.sharedUserMailboxSmtpAddress)&&i.push(e.sharedUserMailboxSmtpAddress)})),Object(u.mutator)(y,(function(e){c().showPeoplePickerDialog=e.showDialogMessageFlag})),n(1312));Object(u.orchestrator)(k,(function(e){var i={};i[e.sharedUserMailboxSmtpAddress]=e.folder,Object(T.b)(i),Object(T.X)(e.sharedUserMailboxSmtpAddress,e.folder,T.a.Uninitialized,!0,0,e.userIdentity)}));var P=Object(u.action)("ON_SHARED_FOLDER_FETCH_FAILED",(function(e,i){return{sharedUserMailboxSmtpAddress:e,actionSource:i}})),E=n(74),R=n(6882),w=n(340),C=n(4588);Object(u.orchestrator)(R.a,(function(e){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var i,n,t,r,d,o,s,l,u,c;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return i=e.userIdentity,n=e.sharedUserMailboxSmtpAddress,t=e.actionSource,r=e.isLoadingMore,(d=Object(T.r)(n,i))===T.a.Loading||d===T.a.Loaded&&!r?[2]:(Object(T.Y)(n,T.a.Loading,i),[4,Object(w.a)()]);case 1:s=a.sent(),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,s.query({query:C.a,variables:{baseFolderDistinguishedIds:[g.l,"inbox"],indexedPageOffset:Object(T.p)(n,i),mailboxInfo:{userIdentity:i,mailboxSmtpAddress:n,type:"SharedMailbox"},shouldPopulateChildFolderIds:!1}})];case 3:return l=a.sent(),o=l.data.folderHierarchy,[3,5];case 4:return u=a.sent(),Object(h.p)("SharedFolders_FetchFailed",[u.ResponseCode,u.diagnosticInfo],{isCore:!0}),P(n,t),Object(T.Y)(n,T.a.ErrorLoading,i),[2];case 5:return c=Object(T.y)(n).DisplayName,Object(T.T)(o.RootFolder,o.Folders,g.l,g.k,n,c,n,i,o.IncludesLastItemInRange,o.IndexedPagingOffset),m=o.TotalItemsInView,Object(h.p)("Triage_SharedFolders_OpenFolder",[Object(E.e)({value:m})]),[2]}var m}))}))}));var V=n(3962),U=n(1983),L=n(2413);function H(e){return i={primarySMTPAddress:e},Object(f.a)("RemoveSharedFolders",i,n);var i,n}Object(u.orchestrator)(P,(function(e){Object(U.l)(Object(o.b)(O.a),Object(o.b)(V.a)),"folderPane"===e.actionSource&&Object(L.a)(e.sharedUserMailboxSmtpAddress,!1)}));Object(u.orchestrator)(_,(function(e){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var i,n,t,r;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:i=e.sharedUserMailboxSmtpAddress,n=e.userIdentity,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,H(i)];case 2:return t=a.sent(),[3,4];case 3:return r=a.sent(),F.d("Remove shared folders server call failed with error "+r),[3,4];case 4:return t?(A(i,n),Object(T.W)(i,n),Object(h.p)("Triage_SharedFolders_RemoveFolder")):F.d("Remove shared folders server call returned false"),[2]}}))}))}));function W(){return e={},Object(f.a)("GetOtherMailboxConfiguration",e,i);var e,i}var B=n(77),J=Object(B.e)(T.C,"initializeSharedFolderRootsOrchestratorClone",(function(e){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var e,i;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return[4,W()];case 1:return e=n.sent(),(i=null==e?void 0:e.OtherMailboxEntries)?i.length>0&&(i.forEach((function(e){j(e.DisplayName,e.PrincipalSMTPAddress,!0)})),a=i.length,Object(h.p)("Triage_SharedFolders_LoadList",[Object(E.e)({value:a})])):F.d("initializeSharedFolderRoots failed with getOtherMailboxConfiguration response as : "+e),[2]}var a}))}))}));n.d(i,"SharedFolderPeoplePicker",(function(){return I})),n.d(i,"showSharedFolderPeoplePickerDialog",(function(){return y})),n.d(i,"removeSharedFolderUser",(function(){return _})),n.d(i,"initializeSharedFolderRootsOrchestrator",(function(){return J}))},6882:function(e,i,n){"use strict";n.d(i,"a",(function(){return r}));var a=n(3),t=n(96),r=Object(a.action)("GET_SHARED_FOLDERS",(function(e,i,n,a){return a||(a=Object(t.b)()),{sharedUserMailboxSmtpAddress:e,actionSource:i,isLoadingMore:n,userIdentity:a}}))},6949:function(e,i,n){"use strict";n.d(i,"b",(function(){return t})),n.d(i,"a",(function(){return r}));var a=n(3),t=Object(a.action)("populateUserMailboxInfo",(function(e){return{userMailboxWrapper:e}})),r=Object(a.action)("ON_DISMISSED")},6950:function(e,i,n){"use strict";n.d(i,"b",(function(){return d}));var a=n(1410),t=n(3),r={userMailboxWrapper:null,findControlViewState:{queryString:"",findResultSet:[],findResultType:a.b.None,isSearching:!1,directorySearchType:a.a.None,findPeopleFeedbackManager:null,numberOfCacheResults:0}},d=Object(t.createStore)("peoplePickerDialogStore",r);i.a=d()},9297:function(e,i,n){"use strict";var a=n(6949),t=n(6950),r=n(1410),d=n(3),o=(Object(d.mutator)(a.b,(function(e){Object(t.b)().userMailboxWrapper=e.userMailboxWrapper})),Object(d.mutator)(a.a,(function(){var e=Object(t.b)();e.userMailboxWrapper=null,e.findControlViewState={queryString:"",findResultSet:[],findResultType:r.b.None,isSearching:!1,directorySearchType:r.a.None,findPeopleFeedbackManager:null,numberOfCacheResults:0}})),n(77));n.d(i,"a",(function(){return l}));var s=new o.c((function(){return Promise.all([n.e(4),n.e(6),n.e(13),n.e(37),n.e(54),n.e(64),n.e(677)]).then(n.bind(null,16960))})),l=Object(o.d)(s,(function(e){return e.PeoplePickerDialog}))}}]);
//# sourceMappingURL=owa.MailBoot~SharedFolders.js.map
self.scriptsLoaded['owa.MailBoot~SharedFolders.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SharedFolders.js'] = (new Date()).getTime();