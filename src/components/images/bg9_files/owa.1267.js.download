self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1267.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1267,1331],{1912:function(e,t,s){"use strict";s.r(t);var n=s(2431),a=s(285);function i(e,t){e.isPendingFetch=!1,document.body.removeChild(t)}var r=Object(a.action)("onConsumerPhotoLoad")((function(e,t,s){t.hasFetchFailed=s.width<5||s.height<5,t.blobUrl=t.hasFetchFailed?null:e,i(t,s)})),o=Object(a.action)("onConsumerPhotoError")((function(e,t){e.hasFetchFailed=!0,i(e,t)}));var c=s(3120),u=s(3910),l=s(1317),h=s(1480),d=s(1376),f=s(1457),p=Object(a.select)({personaViewStates:function(){return l.a.viewStates}})(Object(a.action)("getPersonaPhoto")((function(e,t,s,a,i,l,p,m){var b=Object(h.a)(t,s,a,l,e);m.personaViewStates.has(b)||m.personaViewStates.set(b,Object(u.a)(e,i||Object(f.a)(t),t,s,a,l));var k=m.personaViewStates.get(b);!Object(d.a)()&&k.hexConsumerIdForUser?function(e){var t=e.personaBlob;if(!t.isPendingFetch&&!t.hasFetchFailed){var s=Object(n.b)(e.hexConsumerIdForUser,e.mailboxType,e.size),a=document.createElement("img");a.src=s,a.onload=function(){return r(s,t,a)},a.onerror=function(){return o(t,a)},a.style.visibility="hidden",document.body.appendChild(a)}}(k):c.a.add({name:e,emailAddress:t,personaId:s,size:a,mailboxType:l,skipLoadingPhoto:p})})));s.d(t,"getPersonaPhoto",(function(){return p}))},2431:function(e,t,s){"use strict";s.d(t,"a",(function(){return f})),s.d(t,"b",(function(){return p}));var n=s(2835),a=s(1376),i=s(1391),r=s(270),o=s(5),c="email",u="personId",l="UA",h="size",d="/service.svc/s/GetPersonaPhoto";function f(e,t,s,i){if(Object(a.a)()&&e)return Object(n.a)(e,s);var r=Object(o.a)().baseUrl,f="";return e&&(f=m(f,c,e&&e.toLowerCase())),t&&(f=m(f,u,t)),f=m(f,l,"0"),f=m(f,h,i?"HR96x96":"HR64x64"),""+r+d+"?"+f}function p(e,t,s){return Object(a.a)()?Object(n.a)(e,t):"https://cid-"+e+".users.storage.live.com/users/0x"+e+"/myprofile/expressionprofile/profilephoto:"+function(e){switch(e){case i.c.tiny:case i.c.extraExtraSmall:case i.c.extraSmall:case i.c.small:case i.c.regular:case i.c.large:case i.c.size10:case i.c.size8:case i.c.size16:case i.c.size24:case i.c.size28:case i.c.size32:return"UserTileStatic,UserTileSmall";case i.c.extraLarge:case i.c.size40:case i.c.size48:case i.c.size56:case i.c.size72:case i.c.size100:case i.c.size120:return"UserTileMedium,UserTileStatic,UserTileSmall";default:return Object(r.a)(e)}}(s)+"/MeControlMediumUserTile?ck=1&ex=24&fofoff=1"}function m(e,t,s){s&&(s=encodeURIComponent(s));var n=t+"="+s;return e&&(n=e+"&"+n),n}},2835:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var n=s(12),a="/profile/v1.0/{0}/{1}/image/$value";function i(e,t){var s=e.indexOf("@")>-1,i="GroupMailbox"==t?"groups":"users";return Object(n.c)(a,i,s?e:"cid:"+e)}},3120:function(e,t,s){"use strict";var n=s(444),a=s(77),i=new a.c((function(){return Promise.all([s.e(1),s.e(866)]).then(s.bind(null,16433))})),r=new a.a(i,(function(e){return e.downloadPersonaPhoto})),o=s(1317),c=s(1480),u=new n.a(3,(function(e){var t=Object(c.a)(e.emailAddress,e.personaId,e.size,e.mailboxType,e.name),s=o.a.viewStates.get(t);return r.importAndExecute(s,!1,e.skipLoadingPhoto)}),500);t.a=u},3910:function(e,t,s){"use strict";function n(e,t,s,n,a,i){return{emailAddress:s,hexConsumerIdForUser:t,personaId:n,name:e,personaBlob:{blobUrl:null,isPendingFetch:!1,hasFetchFailed:!1},size:a,mailboxType:i}}s.d(t,"a",(function(){return n}))},444:function(e,t,s){"use strict";var n=function(){function e(e,t,s){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=s,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.tryRunTask=function(){var e=this;if(this.canRunMoreTasks()){var t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()}},e}();s.d(t,"a",(function(){return n}))}}]);
//# sourceMappingURL=owa.1267.js.map
self.scriptsLoaded['owa.1267.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1267.js'] = (new Date()).getTime();