self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailOptin.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[629],{10882:function(e,n,t){"use strict";t.r(n);var r=t(6547),o=t(3568),i=t(320);function a(){Object(r.c)(),Object(r.d)()&&Object(o.c)(),Object(r.d)()&&!Object(i.a)()&&Object(o.d)(),Object(r.a)(window),Object(r.b)(window)}t.d(n,"initializeMailOptinService",(function(){return a}))},1318:function(e,n,t){"use strict";var r=t(77),o=t(1474),i=t(1330),a=t(3),u=[i.a.SurfaceActions];Object(a.orchestrator)(o.a,(function(e){var n=e.defaultOptions;u.forEach((function(e){n[e]&&Object(i.f)(Number(e),n[e])}))}));var c=t(1340);t.d(n,"e",(function(){return d})),t.d(n,"h",(function(){return l})),t.d(n,"f",(function(){return f})),t.d(n,"g",(function(){return p})),t.d(n,"c",(function(){return c.a})),t.d(n,"d",(function(){return i.d})),t.d(n,"b",(function(){return i.b})),t.d(n,"a",(function(){return i.a}));var s=new r.c((function(){return t.e(848).then(t.bind(null,16769))})),d=new r.a(s,(function(e){return e.createOrUpdateOptionsForFeature})),l=new r.a(s,(function(e){return e.updateAddinPinStatus})),f=(new r.a(s,(function(e){return e.updateAddInArray})),new r.b(s,(function(e){return e.getServerOptionsForFeature}))),p=new r.a(s,(function(e){return e.loadOptions}))},1319:function(e,n,t){"use strict";t.d(n,"b",(function(){return a}));var r=t(20),o=t(3),i={conversationNodes:new r.ObservableMap({}),conversations:new r.ObservableMap({}),items:new r.ObservableMap({}),searchFolderDisplayName:null,typeOfItemBeingDragged:null,triageAnnouncement:{message:null,politenessSetting:"off"}},a=Object(o.createStore)("mail",i),u=a();n.a=u},1322:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(50);function o(e){if(!e)throw new Error("Input parameter to folderNameToId must not be null.");return r.a.defaultFolderNameToIdMap.get(e)}},1323:function(e,n,t){"use strict";var r=t(77),o=t(1319),i=t(1623),a=t(1498),u=t(1444),c="ChronologicalNewestOnBottom";function s(e,n){return e[n==c?0:e.length-1]}var d=t(622),l=t(1332);function f(e){return Object(u.a)(e,Object(d.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(l.a)({FieldURI:"TailoredXpEntities"}),Object(l.a)({FieldURI:"TailoredXpCalendarEventIds"}),Object(l.a)({FieldURI:"TailoredXpEntitiesStatus"}),Object(l.a)({FieldURI:"EntityNamesMap"})]}),"ItemTailoredXpData","Exchange2013").then((function(e){if(e&&!(e instanceof Error)){var n=e;return{TailoredXpEntities:n.TailoredXpEntities,TailoredXpCalendarEventIds:n.TailoredXpCalendarEventIds,TailoredXpEntitiesStatus:n.TailoredXpEntitiesStatus,EntityNamesMap:n.EntityNamesMap}}return{}}))}function p(e){return o.a.items.get(e)}var v=t(30);function m(e){var n=o.a.conversations.get(e);if(n){var t=Object(v.a)().UserOptions.ConversationSortOrderReact;return n.conversationNodeIds.length>0&&!n.loadingState.hasLoadFailed&&n.conversationSortOrder==t}return!1}var g=t(1522),b=t(1312),h=t(285),y=Object(h.select)({folderTable:function(){return b.d.folderTable}})((function(e,n){return!!n.folderTable.get(e)})),A=t(1325);function S(e,n){var t=b.d.folderTable.get(e);return!!t&&(Object(b.I)(t,A.d,n)||t.DistinguishedFolderId===A.b)}function w(e){return S(e)||function(e){var n=b.d.folderTable.get(e);return n&&n.DistinguishedFolderId===A.d}(e)}var O=Object(h.select)({folderTable:function(){return b.d.folderTable}})((function(e,n,t){return Object(b.I)(e,n,t)})),I=t(1647),C=t(1530);function j(e){return e&&(Object(C.a)(e,A.h)||Object(C.a)(e,A.b))}function P(e){return e&&(O(e,A.g)||O(e,A.a))}var E=t(1571);function D(e,n){try{return T(e,n)}catch(e){return null}}function T(e,n){if(!e||!n)return null;var t=Object(b.o)().get(e).PermissionSet.Permissions.filter((function(e){return e.UserId.PrimarySmtpAddress===n}));return null==t?void 0:t[0]}var x=t(320),R="OneOff",k="Unknown";function L(e,n,t){return!Object(x.a)()&&(t==R||t==k)&&(null==e?void 0:e.indexOf(n))<0}var M=t(3),_=Object(M.mutatorAction)("setIsDraftQueuedForSubmission",(function(e,n){var t=Object(o.b)().items.get(null==e?void 0:e.Id);t&&(t.isDraftQueuedForSubmission=n)}));t.d(n,"s",(function(){return F})),t.d(n,"u",(function(){return o.a})),t.d(n,"g",(function(){return o.b})),t.d(n,"a",(function(){return i.a})),t.d(n,"b",(function(){return a.a})),t.d(n,"e",(function(){return u.a})),t.d(n,"d",(function(){return s})),t.d(n,"t",(function(){return f})),t.d(n,"v",(function(){return p})),t.d(n,"q",(function(){return m})),t.d(n,"c",(function(){return g.a})),t.d(n,"r",(function(){return y})),t.d(n,"m",(function(){return S})),t.d(n,"l",(function(){return w})),t.d(n,"n",(function(){return O})),t.d(n,"j",(function(){return I.a})),t.d(n,"k",(function(){return j})),t.d(n,"p",(function(){return P})),t.d(n,"f",(function(){return E.a})),t.d(n,"h",(function(){return D})),t.d(n,"i",(function(){return T})),t.d(n,"o",(function(){return L})),t.d(n,"w",(function(){return _}));var N=new r.c((function(){return t.e(1139).then(t.bind(null,16994))})),F=new r.a(N,(function(e){return e.setTriageActionAnnouncement}))},1330:function(e,n,t){"use strict";var r,o,i=t(3),a=Object(i.action)("setOptionValue",(function(e,n){return{feature:e,value:n}})),u=Object(i.action)("assignOptionValue",(function(e,n){return{feature:e,value:n}})),c=Object(i.action)("verifyAndSetOptionValues",(function(e){return{potentialOptionValues:e}})),s=Object(i.action)("setOptionValue",(function(e,n){return{feature:e,value:n}})),d=t(0);!function(e){e[e.TestFeature=1]="TestFeature",e[e.SmartSuggestions=2]="SmartSuggestions",e[e.DiverseEmojis=4]="DiverseEmojis",e[e.SurfaceActions=5]="SurfaceActions",e[e.SkypeNotifications=6]="SkypeNotifications",e[e.WebPushNotifications=7]="WebPushNotifications",e[e.Confetti=8]="Confetti",e[e.GdprAdsPrefs=9]="GdprAdsPrefs",e[e.CalendarSurfaceAddins=10]="CalendarSurfaceAddins",e[e.ExternalImages=11]="ExternalImages",e[e.EventCapture=12]="EventCapture",e[e.Translation=14]="Translation",e[e.CalendarSurfaceOptions=15]="CalendarSurfaceOptions",e[e.TxpEventNotifications=16]="TxpEventNotifications",e[e.MentionEventNotifications=17]="MentionEventNotifications",e[e.ComposeAssistance=18]="ComposeAssistance",e[e.ActivityFeed=19]="ActivityFeed",e[e.AmpDeveloper=20]="AmpDeveloper",e[e.CalendarHelp=21]="CalendarHelp",e[e.LinkedInViewProfile=22]="LinkedInViewProfile",e[e.Bohemia=23]="Bohemia",e[e.GdprAdsV2=24]="GdprAdsV2",e[e.Proofing=25]="Proofing",e[e.ActiveProxyAddress=26]="ActiveProxyAddress",e[e.OutlookSpaces=27]="OutlookSpaces",e[e.GdprAdsV3=28]="GdprAdsV3",e[e.SxS=29]="SxS"}(r||(r={}));var l=Object(i.createStore)("owsOptionsStore",{options:(o={},o[r.SmartSuggestions]={feature:r.SmartSuggestions,smartSuggestionsEnabled:!1,browserLocationEnabled:!1},o[r.DiverseEmojis]={feature:r.DiverseEmojis,diverseEmojisSelectedSkinTone:""},o[r.SurfaceActions]={feature:r.SurfaceActions,readSurfaceActions:[],readSurfaceAddins:[],composeSurfaceActions:[],composeSurfaceAddins:[]},o[r.SkypeNotifications]={feature:r.SkypeNotifications,skypeMessageNotification:1,skypeCallingNotification:1},o[r.WebPushNotifications]={feature:r.WebPushNotifications,enabled:!1,applicationServerKey:null},o[r.Confetti]={feature:r.Confetti,confettiEnabled:!1},o[r.GdprAdsPrefs]={feature:r.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},o[r.GdprAdsV2]={feature:r.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},o[r.GdprAdsV3]={feature:r.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},o[r.CalendarSurfaceAddins]={feature:r.CalendarSurfaceAddins,calendarSurfaceAddins:[]},o[r.ExternalImages]={feature:r.ExternalImages,externalImagesSelectedOption:null},o[r.EventCapture]={autoCollectionEnabled:!1},o[r.Translation]={feature:r.Translation,translationMode:0,targetLanguage:"",excludedLanguages:[]},o[r.CalendarSurfaceOptions]={feature:r.CalendarSurfaceOptions,agendaPaneIsClosed:!0,lastKnownRoamingTimeZone:void 0,roamingTimeZoneNotificationsIsDisabled:void 0,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},o[r.MentionEventNotifications]={feature:r.MentionEventNotifications,enabled:!1},o[r.TxpEventNotifications]={feature:r.TxpEventNotifications,enabled:!1},o[r.ComposeAssistance]={feature:r.ComposeAssistance,composeAssistanceEnabled:!1},o[r.AmpDeveloper]={feature:r.AmpDeveloper,enabled:!0,allowedSender:[]},o[r.ActivityFeed]={feature:r.ActivityFeed,OWASurfaceOptions:{SupportedTypes:[],DisabledInFeedPanel:[]}},o[r.LinkedInViewProfile]={dismissed:!1},o[r.CalendarHelp]={feature:r.CalendarHelp,calendarHelpEnabled:!1},o[r.Bohemia]={feature:r.Bohemia,bohemiaEnabled:!1},o[r.Proofing]={feature:r.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!1,proofingLocale:void 0,overriddenOptions:void 0},o[r.ActiveProxyAddress]={feature:r.ActiveProxyAddress,activeProxyAddresses:[]},o[r.OutlookSpaces]={feature:r.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},o[r.SxS]={feature:r.SxS,hideReadingPane:!1},o)}),f=t(20);function p(e){return(null==e?void 0:e.feature)in r}var v,m=t(360);function g(e,n){l().options[e]=n}function b(e){return l().options[e]}Object(i.mutator)(u,(function(e){var n=e.feature,t=e.value;m(l().options[n],t)})),Object(i.mutator)(a,(function(e){g(e.feature,e.value)})),Object(i.mutator)(s,(function(e){var n=e.feature,t=e.value;Object(f.extendObservable)(l().options[n],t)})),Object(i.mutator)(c,(function(e){var n,t,r=e.potentialOptionValues;try{for(var o=Object(d.__values)(r),i=o.next();!i.done;i=o.next()){var a=i.value;a&&p(a)&&g(a.feature,a)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(n)throw n.error}}})),function(e){e[e.Work=1]="Work",e[e.Life=2]="Life"}(v||(v={})),t.d(n,"g",(function(){return a})),t.d(n,"c",(function(){return u})),t.d(n,"h",(function(){return c})),t.d(n,"f",(function(){return s})),t.d(n,"e",(function(){return l})),t.d(n,"d",(function(){return b})),t.d(n,"b",(function(){return v})),t.d(n,"a",(function(){return r}))},1340:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(320),o=t(1330),i=t(83);function a(){var e;return(e={})[o.a.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[o.a.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[o.a.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(r.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddClassicAttachment","InsertLink","AddInlineImage","AddEmoji","ToggleDictation","ProofingOptions","QuickUse","ToggleRibbon","FluidHeroButton"],composeSurfaceAddins:[]},e[o.a.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[o.a.Confetti]={confettiEnabled:!0},e[o.a.ComposeAssistance]={composeAssistanceEnabled:!0},e[o.a.GdprAdsPrefs]={feature:o.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[o.a.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[o.a.ExternalImages]={externalImagesSelectedOption:0},e[o.a.EventCapture]={autoCollectionEnabled:!1},e[o.a.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[o.a.CalendarSurfaceOptions]={agendaPaneIsClosed:!1,lastKnownRoamingTimeZone:null,roamingTimeZoneNotificationsIsDisabled:!1,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},e[o.a.AmpDeveloper]={enabled:Object(i.i)("rp-ampDefault"),allowedSender:[]},e[o.a.CalendarHelp]={calendarHelpEnabled:!1},e[o.a.LinkedInViewProfile]={dismissed:!1},e[o.a.Bohemia]={bohemiaEnabled:Object(i.i)("cmp-prague")},e[o.a.GdprAdsV2]={feature:o.a.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},e[o.a.GdprAdsV3]={feature:o.a.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},e[o.a.Proofing]={feature:o.a.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!0,proofingLocale:void 0,overriddenOptions:void 0},e[o.a.ActiveProxyAddress]={feature:o.a.ActiveProxyAddress,activeProxyAddresses:[]},e[o.a.OutlookSpaces]={feature:o.a.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},e[o.a.SxS]={feature:o.a.SxS,hideReadingPane:!1},e}},1362:function(e,n,t){"use strict";function r(){return{isDragOver:!1,draggableItemType:null}}t.d(n,"a",(function(){return r}))},1392:function(e,n,t){"use strict";var r=t(3),o=Object(r.createStore)("folderForestStore",{selectedNode:{id:null,treeType:"primaryFolderTree",type:0}}),i=o();function a(){return i.selectedNode}function u(){var e=a();switch(e.type){case 1:return e.searchFolderId;case 5:return e.data.searchFolderId;case 3:return null;default:return e.id}}t.d(n,"c",(function(){return a})),t.d(n,"b",(function(){return u})),t.d(n,"d",(function(){return o})),t.d(n,"a",(function(){return i}))},1408:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return a}));var r=t(30),o=t(96);function i(e){return!!(e&Object(r.a)().ViewStateConfiguration.ListViewBitFlags)}function a(e,n){i(n)!==e&&Object(o.y)((function(t){e?t.ViewStateConfiguration.ListViewBitFlags|=n:t.ViewStateConfiguration.ListViewBitFlags&=~n}))}},1425:function(e,n,t){"use strict";var r=t(77),o=t(1311);function i(){return a(Object(o.G)())}function a(e){return e&&2==e.tableQuery.type?e.tableQuery.folderId:null}function u(){var e=Object(o.G)();return e&&2==e.tableQuery.type}function c(e){return!!e&&(2==e.type||s(e))}function s(e){return!(!e||1!=e.type)&&"Group"==e.searchScope.kind}function d(e){return 2==e.type?e.folderId:s(e)?e.searchScope.groupId:null}function l(){var e=Object(o.G)();return e&&c(e.tableQuery)}t.d(n,"g",(function(){return p})),t.d(n,"h",(function(){return v})),t.d(n,"m",(function(){return m})),t.d(n,"l",(function(){return g})),t.d(n,"j",(function(){return b})),t.d(n,"i",(function(){return h})),t.d(n,"k",(function(){return y})),t.d(n,"c",(function(){return i})),t.d(n,"a",(function(){return a})),t.d(n,"d",(function(){return u})),t.d(n,"e",(function(){return c})),t.d(n,"b",(function(){return d})),t.d(n,"f",(function(){return l}));var f=new r.c((function(){return Promise.all([t.e(0),t.e(2),t.e(3),t.e(14),t.e(19),t.e(51),t.e(85),t.e(665)]).then(t.bind(null,16870))})),p=new r.b(f,(function(e){return e.getGroupDisplayName})),v=new r.b(f,(function(e){return e.getGroupDisplayNameFromTableView})),m=new r.b(f,(function(e){return e.isPrivateUnjoinedGroup})),g=new r.b(f,(function(e){return e.isJoinedGroup})),b=new r.b(f,(function(e){return e.getRetentionPolicyTagsForGroup})),h=new r.b(f,(function(e){return e.getRetentionPolicyTagListForGroupTableQuery})),y=new r.b(f,(function(e){return e.isGroupOwner}))},1436:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(0),o=t(1440);function i(e){var n,t;if(!e)return Promise.reject(a("500","Server returned a null response!",null));var i=Array.isArray(e)?e:[e];try{for(var u=Object(r.__values)(i),c=u.next();!c.done;c=u.next()){var s=c.value;if(s&&!Object(o.a)(s))return Promise.reject(a(s.ResponseCode,s.StackTrace,s.MessageText))}}catch(e){n={error:e}}finally{try{c&&!c.done&&(t=u.return)&&t.call(u)}finally{if(n)throw n.error}}return Promise.resolve()}function a(e,n,t){var r="ResponseCode="+e;n&&(r+=", Stacktrace="+n);var o=new Error(r);return o.responseCode=e,o.fetchErrorType="ServerFailure",t&&(o.diagnosticInfo="MessageText= "+t),o}},1440:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r="Success";function o(e){return e&&e.ResponseClass==r}},1444:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(0),o=t(1825),i=t(83),a=new(t(10).d)((function(){return t.e(789).then(t.bind(null,2709))}));function u(e,n,t,u,c,s,d,l){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(i.i)("mon-rp-loadItemViaGql")?[4,a.import().then((function(r){return r.getItemViaGraphQL(e,n,t,u,c,s,d,l)}))]:[3,2];case 1:return[2,r.sent()];case 2:return[4,Object(o.a)(e,n,t,u,s,d,l)];case 3:return[2,r.sent()]}}))}))}},1474:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(3),o=t(1340),i=Object(r.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",(function(e){return void 0===e&&(e=Object(o.a)()),{defaultOptions:e}}))},1495:function(e,n,t){"use strict";t.d(n,"o",(function(){return u})),t.d(n,"h",(function(){return c})),t.d(n,"b",(function(){return s})),t.d(n,"f",(function(){return d})),t.d(n,"j",(function(){return l})),t.d(n,"m",(function(){return f})),t.d(n,"r",(function(){return p})),t.d(n,"k",(function(){return v})),t.d(n,"q",(function(){return m})),t.d(n,"n",(function(){return g})),t.d(n,"l",(function(){return b})),t.d(n,"d",(function(){return h})),t.d(n,"i",(function(){return y})),t.d(n,"p",(function(){return A})),t.d(n,"c",(function(){return S})),t.d(n,"g",(function(){return w})),t.d(n,"e",(function(){return O})),t.d(n,"s",(function(){return I}));var r=t(77),o=t(1667);t.d(n,"a",(function(){return o.a}));var i=new r.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(4),t.e(5),t.e(6),t.e(7),t.e(8),t.e(11),t.e(13),t.e(14),t.e(16),t.e(18),t.e(21),t.e(26),t.e(32),t.e(34),t.e(35),t.e(37),t.e(39),t.e(41),t.e(43),t.e(50),t.e(811)]).then(t.bind(null,2696))})),a={captureBundleTime:!0},u=new r.a(i,(function(e){return e.replyToMessage}),a),c=new r.a(i,(function(e){return e.forwardMessage}),a),s=new r.a(i,(function(e){return e.closeCompose})),d=new r.a(i,(function(e){return e.discardCompose})),l=new r.a(i,(function(e){return e.loadDraftToCompose})),f=new r.a(i,(function(e){return e.openCompose})),p=new r.a(i,(function(e){return e.trySaveAndCloseCompose})),v=new r.a(i,(function(e){return e.moveComposeToTab})),m=new r.a(i,(function(e){return e.tryCreateResendDraft})),g=new r.a(i,(function(e){return e.replyToApprovalMessage})),b=new r.a(i,(function(e){return e.onEditDraftButtonClicked})),h=new r.b(i,(function(e){return e.createReply})),y=new r.b(i,(function(e){return e.getToCcRecipientsForReply})),A=new r.b(i,(function(e){return e.replyToMessageAndCreateViewState})),S=new r.b(i,(function(e){return e.createAttachments})),w=new r.b(i,(function(e){return e.extractComposePopoutData})),O=new r.b(i,(function(e){return e.didInsertLinksHaveIssuesOnBlockDialogDismiss})),I=new r.b(i,(function(e){return e.insertSignature}))},1498:function(e,n,t){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.CommandBarArrows=1]="CommandBarArrows",e[e.KeyboardUpDown=2]="KeyboardUpDown",e[e.KeyboardEnter=3]="KeyboardEnter",e[e.KeyboardShiftEnter=4]="KeyboardShiftEnter",e[e.KeyboardCtrlSpace=5]="KeyboardCtrlSpace",e[e.MailListItemBody=6]="MailListItemBody",e[e.MailListItemBodyDoubleClick=7]="MailListItemBodyDoubleClick",e[e.MailListItemCheckbox=8]="MailListItemCheckbox",e[e.MailListItemContextMenu=9]="MailListItemContextMenu",e[e.MailListItemExpansion=10]="MailListItemExpansion",e[e.MailListItemRichPreview=11]="MailListItemRichPreview",e[e.MailListItemTwisty=12]="MailListItemTwisty",e[e.NewConversation=13]="NewConversation",e[e.Reset=14]="Reset",e[e.RowRemoval=15]="RowRemoval",e[e.ImmersiveReadingPaneDelete=16]="ImmersiveReadingPaneDelete",e[e.RouteHandler=17]="RouteHandler",e[e.ToggleCheckAll=18]="ToggleCheckAll",e[e.MessageAd=19]="MessageAd",e[e.SearchSuggestionClick=20]="SearchSuggestionClick",e[e.SingleLineClearSelection=21]="SingleLineClearSelection",e[e.KeyboardHome=22]="KeyboardHome",e[e.KeyboardEnd=23]="KeyboardEnd"}(r||(r={})),n.a=r},1522:function(e,n,t){"use strict";var r=new(t(761).a)(50);n.a=r},1530:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(50);function o(e,n){if(!e||!n)throw new Error("Input parameters to doesFolderIdEqualName must not be null.");return r.a.defaultFolderNameToIdMap.get(n)==e}},1571:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1312),o=t(1392);function i(){var e=Object(o.c)(),n=null;return null==(n=1===e.type?e.searchFolderId:5===e.type?e.data.searchFolderId:e.id)?null:r.d.folderTable.get(n)}},1623:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete"}(r||(r={}))},1647:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1530),o=t(1325);function i(e){return e&&(Object(r.a)(e,o.g)||Object(r.a)(e,o.a))}},1667:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("conversationSendStateChanged",(function(e,n){return{viewState:e,isSendPending:n}}))},1825:function(e,n,t){"use strict";var r=t(766),o=t(723),i=t(0);var a=t(767),u=t(319),c=t(59),s=t(1436);function d(e,n,t,d,l,f,p){var v,m=Object(u.b)();if(d&&(m.RequestServerVersion=d),f){var g=(v={UserRoles:["MailboxSearch"]},Object(i.__assign)({__type:"ManagementRoleType:#Exchange"},v));m.ManagementRole=g}return Object(a.a)({Header:m,Body:Object(r.a)({ItemShape:n,ItemIds:Array.isArray(e)?e.map((function(e){return Object(o.a)({Id:e})})):e?[Object(o.a)({Id:e})]:[],ShapeName:null!=t?t:void 0,InternetMessageId:p})},l).then((function(e){var n,t,r;return null===(r=null===(t=null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseMessages)||void 0===t?void 0:t.Items)||void 0===r?void 0:r[0]})).then((function(e){return Object(s.a)(e).then((function(){return e}))})).then((function(n){return(null==n?void 0:n.Items.length)?Array.isArray(e)||void 0!==p?n.Items:n.Items[0]:null})).catch((function(e){return c.g.warn("GetItem:"+e.message),e}))}t.d(n,"a",(function(){return d}))},2370:function(e,n,t){var r,o;
/*!
 * JavaScript Cookie v2.1.3
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(i){if(void 0===(o="function"==typeof(r=i)?r.call(n,t,n,e):r)||(e.exports=o),!0,e.exports=i(),!!0){var a=window.Cookies,u=window.Cookies=i();u.noConflict=function(){return window.Cookies=a,u}}}((function(){function e(){for(var e=0,n={};e<arguments.length;e++){var t=arguments[e];for(var r in t)n[r]=t[r]}return n}return function n(t){function r(n,o,i){var a;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(i=e({path:"/"},r.defaults,i)).expires){var u=new Date;u.setMilliseconds(u.getMilliseconds()+864e5*i.expires),i.expires=u}try{a=JSON.stringify(o),/^[\{\[]/.test(a)&&(o=a)}catch(e){}return o=t.write?t.write(o,n):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),n=(n=(n=encodeURIComponent(String(n))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape),document.cookie=[n,"=",o,i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}n||(a={});for(var c=document.cookie?document.cookie.split("; "):[],s=/(%[0-9A-Z]{2})+/g,d=0;d<c.length;d++){var l=c[d].split("="),f=l.slice(1).join("=");'"'===f.charAt(0)&&(f=f.slice(1,-1));try{var p=l[0].replace(s,decodeURIComponent);if(f=t.read?t.read(f,p):t(f,p)||f.replace(s,decodeURIComponent),this.json)try{f=JSON.parse(f)}catch(e){}if(n===p){a=f;break}n||(a[p]=f)}catch(e){}}return a}}return r.set=r,r.get=function(e){return r.call(r,e)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(n,t){r(n,"",e(t,{expires:-1}))},r.withConverter=n,r}((function(){}))}))},3856:function(e,n,t){"use strict";var r=t(29),o=t(0);function i(e,n){if(void 0!==e.datapoints)for(var t=0;t<e.datapoints.length;t++)void 0===e.datapoints[t]||e.datapoints[t].__type||(e.datapoints[t]=(i=e.datapoints[t],Object(o.__assign)({__type:"Datapoint:#Exchange"},i)));var i;return Object(r.a)("LogDatapoint",e,n)}t.d(n,"a",(function(){return i}))},622:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(0);function o(e){return Object(r.__assign)({__type:"ItemResponseShape:#Exchange"},e)}},6547:function(e,n,t){"use strict";var r=t(269),o=t(29);var i=t(2370);function a(e){return i.get(e)}function u(e,n,t){n?i.set(e,n,t):i.remove(e)}var c="OptInPrg";function s(){return d(2)}function d(e){return a(c)==""+e}function l(e){null==e?u(c):u(c,""+e,{path:"/"})}var f=2,p=1e4,v=0;function m(e){s()&&(l(0),e.addEventListener("unload",(function(){d(1)||l(null)})),Object(r.p)("optInReactClient"),function e(n){(t={clientTypeOptInState:2},Object(o.a)("UpdateClientTypeOptInState",t,r)).then((function(e){l(null)})).catch((function(t){v++<f&&n.setTimeout((function(){e(n)}),p)}));var t,r}(e))}var g=t(8),b="appcacheuninstaller",h="owa/manifests/appCacheManifestHandler.ashx",y="?manifest=0&layout=mouse&UA=0",A="UnInstallAppcache",S="AppcacheObsolete",w=null;function O(e){var n,t;e.applicationCache&&(function(e){return Object(g.a)(e,S)}(e)||((w=e.document.createElement("iframe")).src=(n=e.location.href,(t=new URL(n)).pathname=h,t.search=y,t.href),w.setAttribute("id",b),w.style.display="none",w.onload=function(){w.onload=null;try{!function(e){var n=w.contentWindow.applicationCache;n.onobsolete=function(){C(e),I(n)},n.onerror=function(){C(e),I(n)}}(e)}catch(n){C(e)}},u(A,"true",{path:"/"}),e.document.body.appendChild(w)))}function I(e){e.onerror=null,e.onobsolete=null}function C(e){!function(e){Object(g.e)(e,S,"1")}(e),u(A),e.document.body.removeChild(w),w=null}var j=t(0);function P(e,n){var t;return void 0===e||e.__type||(t=e,e=Object(j.__assign)({__type:"UpdateLightningRequest:#Exchange"},t)),Object(o.a)("UpdateLightning",e,n)}var E=t(3856),D=69,T=75,x=1,R="ReOptInClk",k="CalReOptInClk";function L(){if(s()){var e=0;M(D,R)&&(e=D),M(T,k)&&(e=T),Object(r.p)("cleanupOptInCallout",[e])}}function M(e,n){var t=!1;return a(n)&&(t=!0,Object(E.a)({datapoints:[{Id:"PerfTraceCTQ",Consumers:1,Time:new Date(Date.now()).toISOString(),Keys:["S","cd"],Values:["lightningPeekMore","id_"+e+"|category_4"]}]}),u(n)),P({Identities:[e],Command:x}),t}t.d(n,"a",(function(){return m})),t.d(n,"b",(function(){return O})),t.d(n,"c",(function(){return L})),t.d(n,"d",(function(){return s}))},723:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(0);function o(e){return Object(r.__assign)({__type:"ItemId:#Exchange"},e)}},761:function(e,n,t){"use strict";var r=t(0),o=t(285),i=function(){function e(e){this.maxSize=e,this.references=[],this.mruList=[]}return e.prototype.initialize=function(e,n){var t,o;if(!this.store){this.store=e,this.deleteCallback=n;try{for(var i=Object(r.__values)(e.keys()),a=i.next();!a.done;a=i.next()){var u=a.value;this.mruList.push(u)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}}},e.prototype.add=function(e,n){var t=this;Object(o.action)("MruCache_add")((function(){t.store.set(e,n),t.mruList.indexOf(e)>=0?t.touch(e):(t.mruList.push(e),t.purgeIfNecessary())}))()},e.prototype.get=function(e){return this.store.get(e)},e.prototype.getAndTouch=function(e){var n=this.store.get(e);return n&&this.touch(e),n},e.prototype.has=function(e){return this.store.has(e)},e.prototype.remove=function(e){var n=this;Object(o.action)("MruCache_remove")((function(){if(n.store.has(e)&&!n.isReferenced(e))return n.removeItemAtIndex(n.mruList.indexOf(e))}))()},e.prototype.registerReference=function(e){this.references.push(e)},e.prototype.clear=function(){var e=this;Object(o.action)("MruCache_clear")((function(){e.purgeTillSize(0)}))()},e.prototype.getItemIds=function(){return new(Array.bind.apply(Array,Object(r.__spread)([void 0],this.mruList)))},e.prototype.touch=function(e){var n=this.mruList.indexOf(e);if(n<0)throw new Error("Item with key '"+e+"' does not exist in the cache.");this.mruList.splice(n,1),this.mruList.push(e)},e.prototype.purgeIfNecessary=function(){this.purgeTillSize(this.maxSize)},e.prototype.purgeTillSize=function(e){for(var n=0;this.mruList.length>e&&n<this.mruList.length;){var t=this.mruList[n];this.isReferenced(t)?n++:this.removeItemAtIndex(n)}},e.prototype.removeItemAtIndex=function(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);var n=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(n):this.store.delete(n)},e.prototype.isReferenced=function(e){for(var n=0;n<this.references.length;n++){var t=this.references[n]();if(Array.isArray(t)){if(-1!=t.indexOf(e))return!0}else if(t==e)return!0}return!1},e}();t.d(n,"a",(function(){return i}))},766:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(0);function o(e){return Object(r.__assign)({__type:"GetItemRequest:#Exchange"},e)}},767:function(e,n,t){"use strict";var r=t(29),o=t(0);function i(e,n){var t;return void 0===e||e.__type||(t=e,e=Object(o.__assign)({__type:"GetItemJsonRequest:#Exchange"},t)),Object(r.a)("GetItem",e,n)}t.d(n,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.MailBoot~MailOptin.js.map
self.scriptsLoaded['owa.MailBoot~MailOptin.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailOptin.js'] = (new Date()).getTime();