self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FolderOrchestration.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[408],{17e3:function(e,i,n){"use strict";n.r(i);var a=n(2129),d=n(3008),t=n(9233),l=n(1312),r=n(1325),s=n(1529),m=n(77),o=n(59),u=Object(m.e)(a.a,"getFolderDataClone",(function(e){var i,n,a,m,u;i=e.folderId,n=Object(l.o)().get(i),a=n&&n.treeType===r.k,m=Object(s.b)(i),u=a?"CountsAndPermissions":"Counts",Object(t.a)(i,u,m).then((function(e){e&&(Object(d.a)(e.UnreadCount,e.TotalCount,i,!1),a&&l.Q.import().then((function(n){n(i,e.PermissionSet.Permissions)})))})).catch((function(e){o.g.warn("GetFolderDataOrchestrator: "+e)}))}));n.d(i,"getFolderDataOrchestrator",(function(){return u}))},5378:function(e,i,n){"use strict";n.d(i,"a",(function(){return a}));var a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"MailFolderPermissionsFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MailFolderPermissions"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"PermissionSet"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Permissions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"PermissionLevel"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"ReadItems"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"UserId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"PrimarySmtpAddress"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"DisplayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"DistinguishedUser"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"CanCreateItems"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"CanCreateSubFolders"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"IsFolderOwner"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"IsFolderVisible"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"IsFolderContact"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"EditItems"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"DeleteItems"},arguments:[],directives:[]}]}}]}}]}}]}},9233:function(e,i,n){"use strict";var a=n(0),d=n(340),t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FolderCounts"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"ObjectField",name:{kind:"Name",value:"additionalProperties"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"TotalCount",block:!1},{kind:"StringValue",value:"UnreadCount",block:!1}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"FolderId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"TotalCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"UnreadCount"},arguments:[],directives:[]}]}}]}}]},l=n(5378),r={kind:"Document",definitions:Object(a.__spread)([{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FolderCountsAndPermissions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"ObjectField",name:{kind:"Name",value:"additionalProperties"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"TotalCount",block:!1},{kind:"StringValue",value:"UnreadCount",block:!1},{kind:"StringValue",value:"PermissionSet",block:!1}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"FolderId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"TotalCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"UnreadCount"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"MailFolderPermissionsFragment"},directives:[]}]}}]}}],l.a.definitions)},s={kind:"Document",definitions:Object(a.__spread)([{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FolderPermissions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"ObjectField",name:{kind:"Name",value:"additionalProperties"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"PermissionSet",block:!1}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"FolderId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"},arguments:[],directives:[]}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"MailFolderPermissionsFragment"},directives:[]}]}}]}}],l.a.definitions)},m=n(4089);function o(e,i){return u(e,"Permissions",i||Object(m.a)(e,!0))}function u(e,i,n){return Object(a.__awaiter)(this,void 0,void 0,(function(){var l,m;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(d.a)()];case 1:switch(l=a.sent(),i){case"Counts":m=t;break;case"CountsAndPermissions":m=r;break;case"Permissions":m=s}a.label=2;case 2:return a.trys.push([2,4,,5]),[4,l.query({query:m,variables:{id:e,mailboxInfo:n}})];case 3:return[2,a.sent().data.folder];case 4:return a.sent(),[2,null];case 5:return[2]}}))}))}n.d(i,"b",(function(){return o})),n.d(i,"a",(function(){return u}))}}]);
//# sourceMappingURL=owa.FolderOrchestration.js.map
self.scriptsLoaded['owa.FolderOrchestration.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FolderOrchestration.js'] = (new Date()).getTime();