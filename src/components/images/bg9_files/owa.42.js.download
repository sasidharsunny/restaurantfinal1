self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.42.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[42],{1320:function(e,t,n){"use strict";var r=n(2654),a=n(177),o=n(1722),i=n(471);function c(e){return!!e.EffectiveRights&&!!e.EffectiveRights.Modify&&!Object(a.J)(e.ParentFolderId.Id)&&!Object(o.c)(e)&&("Private"!==e.Sensitivity||(t=e.ParentFolderId.Id,n=Object(a.o)(t),Object(i.d)(n)));var t,n}var u=function(e){return J(e)&&c(e)&&!e.IsCancelled},d=function(e){var t;return(null===(t=null==e?void 0:e.ParentFolderId)||void 0===t?void 0:t.mailboxInfo)&&"GroupMailbox"==e.ParentFolderId.mailboxInfo.type};function s(e,t){if(!e)return!1;var n=!d(e),r=function(t){return t?n?t.filter((function(t){return!e.Organizer||t.Mailbox.EmailAddress!=e.Organizer.Mailbox.EmailAddress})):t:[]},a=r(e.RequiredAttendees).length,o=r(e.OptionalAttendees).length;return t?a+o>0:a+o+r(e.Resources).length>0}function l(e){var t=e.RequiredAttendees,n=e.OptionalAttendees;return t&&0!=t.length||n&&0!=n.length}function f(e){return!!e&&(e.IsDraft?s(e):e.IsMeeting||s(e))}var v=function(e){return!f(e)&&!e.IsOrganizer&&c(e)&&!e.IsCancelled},b=function(e){return!(!e.IsOrganizer||f(e)&&e.MeetingRequestWasSent||!c(e))},I=n(96),O=n(1708);function j(e){var t=Object(a.o)(e.ParentFolderId.Id),n=Object(O.c)(e);return c(e)&&f(e)&&!!t&&!!n&&!([3,6,7].includes(t.CalendarFolderType)||n.IsMeetingPollEvent)}function m(e){return!!(e.IsOrganizer&&e.IsMeeting&&e.MeetingRequestWasSent&&c(e))}var p=function(e){return b(e)||u(e)||v(e)};function E(e){return!d(e)&&!e.IsOrganizer&&e.IsMeeting&&!e.IsCancelled&&c(e)}function y(e){return 0==Object(I.h)().SessionSettings.WebSessionType&&E(e)&&e.IsResponseRequested&&!e.IsAllDayEvent&&(!e.IsRecurring||_(e))}function g(e){return!e.IsOrganizer&&e.IsCancelled&&c(e)}function h(e){return!Object(r.a)(e.EntityNamesMap)&&e.IsOrganizer&&c(e)}function _(e){return e.IsRecurring&&"RecurringMaster"!==e.CalendarItemType&&"ThisAndFollowingInstancesMaster"!==e.CalendarItemType}function R(e){return"RecurringMaster"===e.CalendarItemType}function S(e){return"ThisAndFollowingInstancesMaster"===e.CalendarItemType}function C(e){return d(e)&&!e.IsCancelled&&!e.DoNotForwardMeeting}function T(e){if(e){var t=Object(a.o)(e.ParentFolderId.Id);if(t)return t.IsSharedWithMe||Object(i.e)(t)}return!1}var P=n(83);function A(e){return!!d(e)||(!T(e)||Object(P.i)("cal-mf-enableFTDFOnSharedCalendar"))}var F=function(e){var t=Object(a.o)(e.ParentFolderId.Id),n=t?t.CalendarFolderType:void 0;return(Object(o.c)(e)||c(e))&&(!n||1==n||3==n||5==n)};function N(e){var t;return!!(null===(t=e.EffectiveRights)||void 0===t?void 0:t.Read)}var w=n(362);function M(e){return e&&N(e)&&x(e.ItemId)}function x(e){return(null==e?void 0:e.Id)&&!Object(w.b)(e.Id)}var D=n(388);function L(e){return e.IsMeeting&&!Object(D.r)(e.ParentFolderId.mailboxInfo.userIdentity)}var k=n(2150);function K(e,t){var n,r;return!(t&&t.length>0)||(e.Subject&&-1!=e.Subject.toLowerCase().indexOf(t.toLowerCase())||(null===(n=e.Location)||void 0===n?void 0:n.DisplayName)&&-1!=Object(k.d)(e.Location.DisplayName,e.Location.PostalAddress).toLowerCase().indexOf(t.toLowerCase())||(null===(r=e.Organizer)||void 0===r?void 0:r.Mailbox)&&-1!=e.Organizer.Mailbox.Name.toLowerCase().indexOf(t.toLowerCase()))}var U=function(e){if(!e)return!1;var t=e.ParentFolderId.mailboxInfo.mailboxSmtpAddress;return q(e.RequiredAttendees,t)||q(e.OptionalAttendees,t)};function q(e,t){return e&&e.some((function(e){return e.Mailbox.EmailAddress.toLowerCase()==t}))}var B=n(1482);function V(e){if(!e)return!1;var t=!1;return e.forEach((function(e){var n;n=e.Mailbox,Object(B.a)(n.EmailAddress)||n.ItemId&&"PrivateDL"==n.MailboxType||(t=!0)})),t}function H(e){if(!e)return!1;var t=Object(a.o)(e.ParentFolderId.Id);return t&&3==t.CalendarFolderType}function z(e){return"Exception"===e}function W(e){return"Occurrence"===e}function G(e){return W(e.CalendarItemType)||z(e.CalendarItemType)}function J(e){return(null==e?void 0:e.IsMeeting)&&!e.IsOrganizer}function Z(e){return(null==e?void 0:e.IsMeeting)&&(null==e?void 0:e.IsOrganizer)}function Q(e){return Object(o.c)(e)&&f(e)}var Y=n(9);function $(e,t){return e&&t&&!Object(o.c)(e)&&Object(Y.Hb)(t.Start,e.Start)&&Object(Y.Hb)(t.End,e.End)&&t.IsAllDayEvent==e.IsAllDayEvent}function X(e){return"RecurringMaster"===e}function ee(e){return!(!e.IsMeeting||!e.IsOrganizer||!e.IsDraft&&e.MeetingRequestWasSent)}function te(e){return!(!e.ItemId||!e.IsDraft||function(e){return!!(e.ItemId&&e.IsDraft&&e.IsMeeting&&e.IsOrganizer)}(e))}n.d(t,"j",(function(){return j})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"q",(function(){return E})),n.d(t,"n",(function(){return y})),n.d(t,"o",(function(){return g})),n.d(t,"h",(function(){return h})),n.d(t,"L",(function(){return _})),n.d(t,"M",(function(){return R})),n.d(t,"B",(function(){return S})),n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return A})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return v})),n.d(t,"g",(function(){return b})),n.d(t,"i",(function(){return F})),n.d(t,"k",(function(){return c})),n.d(t,"l",(function(){return M})),n.d(t,"m",(function(){return x})),n.d(t,"p",(function(){return L})),n.d(t,"r",(function(){return K})),n.d(t,"s",(function(){return s})),n.d(t,"w",(function(){return l})),n.d(t,"t",(function(){return U})),n.d(t,"u",(function(){return V})),n.d(t,"v",(function(){return N})),n.d(t,"x",(function(){return H})),n.d(t,"y",(function(){return f})),n.d(t,"z",(function(){return G})),n.d(t,"A",(function(){return z})),n.d(t,"C",(function(){return J})),n.d(t,"D",(function(){return T})),n.d(t,"E",(function(){return Z})),n.d(t,"F",(function(){return Q})),n.d(t,"H",(function(){return W})),n.d(t,"I",(function(){return d})),n.d(t,"J",(function(){return $})),n.d(t,"K",(function(){return X})),n.d(t,"N",(function(){return ee})),n.d(t,"G",(function(){return te}))},1359:function(e,t,n){"use strict";var r=n(1624),a=n(3287),o=n(3),i=Object(o.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK",(function(e,t,n,r,a){return{lockId:e,folderId:t,eventKey:n,itemResponseShapeType:r,partialCalendarEvent:a}})),c=Object(o.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK_FAILED",(function(e,t,n,r){return{lockId:e,folderId:t,eventKey:n,itemResponseShapeType:r}})),u=Object(o.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED_FOR_LOCK",(function(e,t,n,r,a,o,i){return{lockId:e,folderId:t,eventKey:n,itemResponseShapeType:r,event:a,hasEventChanged:o,forceOverrideAllPropertiesForEventIfAvailable:i}})),d=Object(o.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED",(function(e,t,n,r){return{folderId:e,eventKey:t,itemResponseShapeType:n,event:r}})),s=Object(o.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_SERVER",(function(e){return{partialCalendarEvent:e}})),l=Object(o.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_PARTIAL_CALENDAR_EVENT",(function(e){return{partialCalendarEvent:e}})),f=Object(o.action)("CALENDAR_EVENT_MERGE_EVENTS_INTO_CACHE",(function(e){return{event:e}})),v=Object(o.action)("CALENDAR_EVENTS_REMOVE_FULL_CALENDAR_EVENT",(function(e,t){return{folderId:e,eventKey:t}})),b=Object(o.action)("CALENDAR_EVENTS_REMOVE_ALL_FULL_CALENDAR_EVENTS_INFO_FOR_CACHE",(function(e){return{folderId:e}})),I=Object(o.action)("ADD_CALENDAR_EVENTS_TO_EVENTS_CACHE",(function(e,t,n,r){return void 0===r&&(r=!1),{folderId:e,calendarEvents:t,dateRanges:n,forceReplace:r}})),O=Object(o.action)("ADD_CALENDAR_EVENTS_WITHING_CURRENT_LOCKED_DATE_RANGES",(function(e,t){return{folderId:e,calendarEvents:t}})),j=Object(o.action)("REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",(function(e,t){return{folderId:e,instanceKey:t}})),m=Object(o.action)("INTERNAL_REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",(function(e,t,n){return{folderId:e,instanceKey:t,onEventsRemoved:n}})),p=Object(o.action)("REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",(function(e,t){return{folderId:e,predicate:t}})),E=Object(o.action)("INTERNAL_REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",(function(e,t,n){return{folderId:e,predicate:t,onEventsRemoved:n}})),y=Object(o.action)("CALENDAR_EVENTS_RELEASE_LOCK",(function(e){return{lockId:e}})),g=Object(o.action)("RELEASE_LOCK",(function(e){return{lockId:e}})),h=Object(o.action)("CALENDAR_EVENTS_IN_EVENTS_CACHE_RELOADED",(function(e,t,n,r){return void 0===r&&(r=!1),{folderId:e,eventsReloaded:t,dateRanges:n,forceReplace:r}})),_=Object(o.action)("CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",(function(e,t,n,r){return{lockId:e,folderId:t,dateRange:n,calendarEvents:r}})),R=Object(o.action)("INTERNAL_CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",(function(e,t,n,r){return{lockId:e,folderId:t,dateRange:n,calendarEvents:r}})),S=Object(o.action)("INTERNAL_DELETE_EVENTS_CACHE",(function(e){return{folderId:e}})),C=Object(o.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_WAS_USED",(function(e,t){return{lockId:e,eventKey:t}})),T=Object(o.action)("UpdateItem",(function(e,t){return{existingItem:e,updatedItem:t}})),P=n(2925),A=n(3288),F=n(3289),N=n(12),w=n(74),M=Object(o.action)("calendarEventsRemoved",(function(e){return{eventsRemoved:e}})),x=Object(o.action)("calendarEventsAdded",(function(e){return{eventsAdded:e}})),D=Object(o.action)("calendarEventUpdated",(function(e){return{eventUpdated:e}})),L=Object(o.action)("calendarEventsRemovedMatchedFilter",(function(e){return{removePredicate:e}})),k=Object(o.action)("cacheReloaded",(function(e,t){return{previousEvents:e,reloadedEvents:t}})),K=Object(o.action)("deleteEventsCache",(function(e){return{folderId:e}})),U=Object(o.action)("loadingCalendarEvents",(function(e,t,n){return Object(w.c)({name:"CalendarLoadState",customData:{loadingState:n},options:{isVerbose:!0}},{lockId:e,calendarId:t,loadingState:n})})),q=Object(o.action)("instantCalendarEventCreate",(function(e,t,n,r,a,o,i){return void 0===r&&(r=function(){}),void 0===a&&(a=void 0),void 0===o&&(o=Object(N.b)(A.a)),void 0===i&&(i=function(){}),{eventToCreate:e,actionToExecute:t,onEventCreatedSuccess:n,onEventCreatedFailed:r,actionSource:a,errorMessage:o,onEventCreatedLocally:i}})),B=Object(o.action)("instantCalendarEventUpdate",(function(e,t,n,r,a,o,i,c,u){return void 0===o&&(o=function(){}),void 0===i&&(i=void 0),void 0===c&&(c=Object(N.b)(P.a)),void 0===u&&(u=function(){}),{eventId:e,eventChanges:t,eventScope:n,actionToExecute:r,onEventUpdateSuccess:a,onEventUpdateFailed:o,actionSource:i,errorMessage:c,onEventUpdatedLocally:u}})),V=Object(o.action)("instantCalendarEventDelete",(function(e,t,n,r,a,o,i,c,u,d){return void 0===o&&(o=function(){}),void 0===i&&(i=void 0),void 0===c&&(c=Object(N.b)(F.a)),void 0===u&&(u=!1),void 0===d&&(d=function(){return Promise.resolve(!1)}),{eventId:e,eventScope:t,dataPoint:n,actionToExecute:r,onEventDeleteSuccess:a,onEventDeleteFailed:o,actionSource:i,errorMessage:c,responseSent:u,asyncUndoAction:d}})),H=n(0),z=n(534);function W(e){if(0===e.length)return[];var t=[];return e.forEach((function(e){return function(e,t){for(var n=!1,r=0;r<t.length&&!n;r++){var a=t[r];0===Object(z.j)(a,e,!0)&&(t[r]=Object(z.f)(a,e),n=!0)}n||t.push(e)}(e,t)})),t}var G=n(2341),J=n(2305),Z=n(3124);function Q(e,t){var n=Object(J.a)().calendarFolderEvents.get(e);return n?Object(H.__spread)(n.events.values()).filter(t):[]}function Y(e,t){return void 0===t&&(t=null),t?Object(H.__read)(Q(t,(function(t){return t.ItemId.Id===e})),1)[0]||null:function(e){for(var t=Object(J.a)(),n=Object(H.__spread)(t.calendarFolderEvents.keys()),r=0;r<n.length;r++){var a=n[r],o=t.calendarFolderEvents.get(a),i=Object(H.__read)(o?Object(H.__spread)(o.events.values()).filter(e):[null],1)[0];if(i)return i}return null}((function(t){return t.ItemId.Id===e}))}function $(e,t){void 0===t&&(t=null);var n=Object(J.a)();return t?n.calendarFolderEvents.get(t).events.get(e)||null:function(e){for(var t=Object(J.a)(),n=Object(H.__spread)(t.calendarFolderEvents.keys()),r=0;r<n.length;r++){var a=n[r],o=$(e,a);if(o)return o}return null}(e)}function X(e,t,n){var r=null,a=(r=e?function(e,t,n){var r=Object(J.a)().calendarFolderEvents.get(e);return r&&Object(H.__read)(Object(G.l)([t],n,r),1)[0]||null}(e,t,n):function(e,t){for(var n=Object(J.a)(),r=Object(H.__spread)(n.calendarFolderEvents.keys()),a=0;a<r.length;a++){var o=r[a],i=n.calendarFolderEvents.get(o),c=Object(H.__read)(i?Object(G.l)([e],t,i):[null],1)[0];if(c)return c}return null}(t,n))?"1":"no";return Object(Z.a)({lockId:n,updateMessage:"Got "+a+" item from the cache for given folder and key"}),r}var ee=n(269),te=n(177),ne=n(1320),re=n(1708),ae=n(440),oe=n(83),ie=n(9);var ce=n(723),ue=n(29);function de(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(H.__assign)({__type:"ExpandCalendarEventJsonRequest:#Exchange"},n)),Object(ue.a)("ExpandCalendarEvent",e,t)}var se=n(319);function le(e,t){return Object(H.__awaiter)(this,void 0,void 0,(function(){return Object(H.__generator)(this,(function(n){switch(n.label){case 0:return[4,de({Header:Object(se.b)(),Body:(r={EventId:Object(ce.a)({Id:e.Id}),WindowStart:Object(ie.qb)(t.start),WindowEnd:Object(ie.qb)(t.end),ReturnMaster:!0,ReturnRegularOccurrences:!0,ReturnExceptions:!0,ReturnCancellations:!0,IncludeDeclinedMeetings:Object(oe.i)("cal-surface-declinedMeetings")},Object(H.__assign)({__type:"ExpandCalendarEventRequest:#Exchange"},r))},Object(ae.a)(e.mailboxInfo))];case 1:return[2,n.sent().Body]}var r}))}))}var fe=n(3628),ve=function(e){Object(oe.i)("cal-notificationDiagnostics")&&setTimeout((function(){return Object(fe.a)(e)}),0)},be=n(1722),Ie=n(1467);function Oe(e,t,n){var a=Object(G.k)(n,e,Object(r.f)(t));return(a||[]).filter((function(e){return!Object(ne.K)(e.CalendarItemType)}))}var je=3,me=1,pe=n(3629);function Ee(e,t,n){return function(r){if(!ye(r)||r.ParentFolderId.Id!==e)return!1;var a=function(e,t){return function(n){return ye(n)&&n.ParentFolderId.Id===e&&n.ItemId.Id===t}}(r.ParentFolderId.Id,r.ItemId.Id);return n?t.some(a):!t.some(a)}}function ye(e){var t;return(null===(t=null==e?void 0:e.ItemId)||void 0===t?void 0:t.Id)&&e.ParentFolderId&&e.ParentFolderId.Id}var ge=n(676);function he(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(H.__assign)({__type:"GetBirthdayCalendarViewJsonRequest:#Exchange"},n)),Object(ue.a)("GetBirthdayCalendarView",e,t)}function _e(e,t,n){return Object(H.__awaiter)(this,void 0,void 0,(function(){return Object(H.__generator)(this,(function(r){switch(r.label){case 0:return[4,he({Header:Object(se.b)(),Body:(a={StartRange:Object(ie.qb)(e),EndRange:Object(ie.qb)(t)},Object(H.__assign)({__type:"GetBirthdayCalendarViewRequest:#Exchange"},a))},Object(ae.a)(n.mailboxInfo))];case 1:return[2,r.sent().Body]}var a}))}))}var Re=n(2208),Se=n(394),Ce=n(96);function Te(e,t,n,r){return Object(H.__awaiter)(this,void 0,void 0,(function(){var a,o;return Object(H.__generator)(this,(function(i){return a=Object(Ce.h)().UserOptions.TimeZone,o="ows/api/beta/TeamsCalendarEvents/items?id="+encodeURIComponent(n)+"&rangeStart="+encodeURIComponent(Object(ie.qb)(e))+"&rangeEnd="+encodeURIComponent(Object(ie.qb)(t))+"&channelId="+r+"&timeZone="+a,[2,Object(Se.b)("getTeamsCalendarView",null,o)]}))}))}var Pe=n(59),Ae=n(471),Fe=Object(o.mutatorAction)("updateCalendarWorkingHours",(function(e,t){Object(J.a)().calendarFolderWorkingHours.set(e,t)}));function Ne(e,t,n,r){void 0===r&&(r=0);var a=function(e,t,n,r){void 0===r&&(r=0);return Object(H.__awaiter)(this,void 0,void 0,(function(){var a,o,i,c;return Object(H.__generator)(this,(function(u){switch(u.label){case 0:return(a=Object(ee.r)())&&a.addCustomData({outOfCacheRange:!0}),o=Object(te.u)(t),n(o,"Loading"),Object(te.I)(t)?3!=(i=Object(te.o)(t)).CalendarFolderType?[3,2]:[4,xe(e,o,t,n,r)]:[3,5];case 1:return[2,u.sent()];case 2:return[4,Me(e,o,t,n,null,r)];case 3:return[2,u.sent()];case 4:return[3,8];case 5:return i=Object(te.l)({id:o}),Object(te.M)(i)?(c=Object(te.p)({id:{id:i.ItemId.Id,mailboxInfo:o.mailboxInfo}}),[4,we(t,c,i,e,o,n,r)]):[3,7];case 6:return[2,u.sent()];case 7:return n(o,"Failed"),[2,null];case 8:return[2]}}))}))}(e,t,n,r);return Object(H.__assign)({fetchPromise:a},function(e,t){var n;if(Object(oe.i)("cal-mf-noPeekJump")&&e==(null===(n=Object(te.w)())||void 0===n?void 0:n.calculatedFolderId)){var r=Nn.importAndExecute(t);return{enhancedFetchPromise:r.then((function(e){return e.requestPromise})),cancelEnhancedFetchPromise:function(){r.then((function(e){e.cancel()}))}}}return{enhancedFetchPromise:null,cancelEnhancedFetchPromise:null}}(t,e))}function we(e,t,n,o,i,c,u){return void 0===u&&(u=0),Object(H.__awaiter)(this,void 0,void 0,(function(){var d,s,l,f,v,b;return Object(H.__generator)(this,(function(I){switch(I.label){case 0:if(!(!t&&Object(Ae.e)(n)||n.hasOwnProperty("OwnerEmailAddress")&&!n.IsGroupMailboxCalendar&&t&&!t.EffectiveRights||t&&(!t.EffectiveRights||!t.EffectiveRights.Read)&&n.IsGeneralScheduleCalendar))return[3,7];I.label=1;case 1:if(!(u>=0))return[3,6];I.label=2;case 2:return I.trys.push([2,4,,5]),[4,Object(ge.b)(o.start,o.end,[n.OwnerEmailAddress],"DetailedMerged",null,i.mailboxInfo)];case 3:return"NoError"==(d=I.sent()).ResponseCode?(c(i,"Loaded"),function(e,t){var n=Object(r.a)(e);if(null==n?void 0:n.length){var o=Object(a.a)(n,[t]).eventsOverlapping;p(e,Ee(e,o,!0))}}(e,o),function(e){var t=Object(r.f)(e),n=t?Object(H.__spread)(t.events.values()):[];L(Ee(e,n,!1))}(e),s=d.Responses[0].CalendarView,l=s.WorkingHours,f=s.Items,Fe(e,l),[2,f.map((function(e){return Object(re.a)(e,i.mailboxInfo)}))]):(u--,[3,5]);case 4:return v=I.sent(),Pe.g.warn("[loadCalendarEventsInDateRange:loadCalendarEventsUsingFolderId: Exception occured: "+v),v.message&&(v.message.indexOf("ErrorApiQuarantined")>=0||v.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(c(i,"Throttled"),[2,null]):(u--,[3,5]);case 5:return[3,1];case 6:return c(i,"Failed"),[2,null];case 7:return b=t?t.FolderId.Id:n.SharedFolderId.Id,[4,Me(o,i,b,c,n.IsGroupMailboxCalendar?null:n.OwnerEmailAddress,u)];case 8:return[2,I.sent()]}}))}))}function Me(e,t,n,r,a,o){return void 0===o&&(o=0),Object(H.__awaiter)(this,void 0,void 0,(function(){var i,c;return Object(H.__generator)(this,(function(u){switch(u.label){case 0:if(!(o>=0))return[3,8];u.label=1;case 1:return u.trys.push([1,6,,7]),i=void 0,t.mailboxInfo&&"TeamsMailbox"==t.mailboxInfo.type?[4,Te(e.start,e.end,Object(te.f)(n),t.id)]:[3,3];case 2:return(i=u.sent())&&(i=i.Body),[3,5];case 3:return[4,Object(Re.a)(e.start,e.end,n,t,a,Object(oe.i)("cal-surface-declinedMeetings"))];case 4:i=u.sent(),u.label=5;case 5:return"NoError"==i.ResponseCode?(r(t,"Loaded"),[2,i.Items.map((function(e){return t.mailboxInfo&&"TeamsMailbox"==t.mailboxInfo.type&&(e.ParentFolderId.Id=n),Object(re.a)(e,t.mailboxInfo)}))]):(o--,[3,7]);case 6:return c=u.sent(),Pe.g.warn("[loadCalendarEventsInDateRange:getCalendarView: Exception occured: "+c),c.message&&(c.message.indexOf("ErrorApiQuarantined")>=0||c.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(r(t,"Throttled"),[2,null]):(o--,[3,7]);case 7:return[3,0];case 8:return r(t,"Failed"),[2,null]}}))}))}function xe(e,t,n,r,a){return void 0===a&&(a=0),Object(H.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(H.__generator)(this,(function(c){switch(c.label){case 0:if(!(a>=0))return[3,5];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,_e(e.start,e.end,t)];case 2:return"NoError"==(o=c.sent()).ResponseCode?(r(t,"Loaded"),[2,o.BirthdayEvents.map((function(r){return Object(pe.a)(r,n,e,t.mailboxInfo)}))]):(a--,[3,4]);case 3:return i=c.sent(),Pe.g.warn("[loadCalendarEventsInDateRange:getBirthdayCalendarView: Exception occured: "+i),i.message&&(i.message.indexOf("ErrorApiQuarantined")>=0||i.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(r(t,"Throttled"),[2,null]):(a--,[3,4]);case 4:return[3,0];case 5:return r(t,"Failed"),[2,null]}}))}))}var De={};function Le(e,t){return function(e,t){ke(e);for(var n=De[e],r=0;r<n.length;r++)if(Object(z.c)(n[r].dateRange,t,!0))return{index:r,info:n[r]};return{index:-1,info:null}}(e,t).index>=0}function ke(e){De[e]||(De[e]=[])}var Ke={};function Ue(e){Ke[e]||(Ke[e]=[])}function qe(e,t){Ue(e);for(var n=Ke[e],r=0;r<n.length;r++)if(t(n[r]))return{index:r,info:n[r]};return{index:-1,info:null}}function Be(e,t){return qe(e,(function(e){return Object(z.c)(e.dateRange,t,!0)}))}function Ve(e,t,n){var a=Object(r.g)(e,t);!function(e,t,n){var r,a,o=function(e,t){return qe(e,(function(e){return e.lockIds.indexOf(t)>-1}))}(e,n).info;if(o){var i=1==o.lockIds.length,c=Object(z.c)(o.dateRange,t,!0);i&&!c&&(null===(a=null===(r=o.requestPromises)||void 0===r?void 0:r.cancelEnhancedFetchPromise)||void 0===a||a.call(r))}}(t,n,e);var o=Be(t,n).info;if(a&&a.lockedDateRange&&Object(z.c)(a.lockedDateRange,n,!0)){var i=Object(te.u)(t);U(e,i,"Loaded");var c=Oe(e,t,n);m=He(c,t,n,o);return{fetchPromise:Promise.resolve(c),enhancedFetchPromise:m,events:c}}var u=function(e,t){var n=Object(r.d)(e),a=Object(r.f)(e);return n.some((function(e){return Object(z.c)(e,t,!0)}))&&a?Object(G.j)(t,a.events).map((function(e){return Object(H.__assign)({},e)})):null}(t,n);if(u){var d=ze(e,t,n,Promise.resolve(u),"existing"),s=He(u,t,n,o);return null==d||d.then((function(n){var r=Object(te.u)(t);U(e,r,"Loaded")})),{fetchPromise:d,enhancedFetchPromise:s,events:u}}if(null==o?void 0:o.requestPromises){var l=o.requestPromises,v=l.fetchPromise,b=l.enhancedFetchPromise;return o.lockIds.push(e),{fetchPromise:ze(e,t,n,null==v?void 0:v.then((function(e){return e?e.filter((function(e){var t=e.Start,r=e.End;return 0==Object(z.j)(n,{start:t,end:r},!0)})):[]})),"new"),enhancedFetchPromise:null==b?void 0:b.then((function(e){return We(n)(e)})),events:null}}!function(e,t,n){Ue(t),Ke[t].push({dateRange:n,requestPromises:null,lockIds:[e]})}(e,t,n);var I=function(e,t,n){var r=this,a=Ne(t,e,n,me);return{fetchPromise:Object(H.__awaiter)(r,void 0,void 0,(function(){return Object(H.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,,2,3]),[4,null==a?void 0:a.fetchPromise];case 1:return[2,n.sent()];case 2:return function(e,t){var n=Be(e,t).index;-1!==n&&Ke[e].splice(n,1)}(e,t),[7];case 3:return[2]}}))})),enhancedFetchPromise:null==a?void 0:a.enhancedFetchPromise}}(t,n,function(e,t){return function(n,r){var a=Be(e,t),o=a.index,i=a.info;-1!==o&&i.lockIds.forEach((function(e){U(e,n,r)}))}}(t,n)),O=null==I?void 0:I.fetchPromise,j=null==I?void 0:I.enhancedFetchPromise;!function(e,t,n){var r=Be(e,t),a=r.index,o=r.info;-1!==a&&(o.requestPromises=n)}(t,n,I);var m,p=ze(e,t,n,O,"new");return{fetchPromise:p,enhancedFetchPromise:m=function(e,t,n,r){return Object(H.__awaiter)(this,void 0,void 0,(function(){var a,o;return Object(H.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([n,r])];case 1:return a=H.__read.apply(void 0,[i.sent(),1]),(o=a[0])&&(!function(e,t){ke(e),De[e].push({dateRange:t})}(e,t),o.forEach((function(e){return f(e)}))),[2,o]}}))}))}(t,n,j,p),events:null}}function He(e,t,n,r){var a,o,i=null;if(t===(null===(a=Object(te.w)())||void 0===a?void 0:a.calculatedFolderId))if(Le(t,n))i=Promise.resolve(e);else if(null===(o=null==r?void 0:r.requestPromises)||void 0===o?void 0:o.enhancedFetchPromise){i=r.requestPromises.enhancedFetchPromise.then(We(n))}else Pe.g.warn("[loadEnhancedEvents] - Failed to load GetCalendarView++ events on an existing lock.");return i}function ze(e,t,n,r,a){return Object(H.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(H.__generator)(this,(function(c){switch(c.label){case 0:return[4,r];case 1:return o=c.sent(),i=o?o.length:"no",Object(Z.a)({lockId:e,updateMessage:"Fetched "+i+" "+a+" items for date range: "+n.start+" - "+n.end}),o&&_(e,t,n,o),[2,o]}}))}))}function We(e){return function(t){return t?t.filter((function(t){var n=t.Start,r=t.End;return!(!n||!r)&&0==Object(z.j)(e,{start:n,end:r},!0)})):[]}}var Ge=n(360);function Je(e,t){var n,a;return void 0===t&&(t=!1),Object(H.__awaiter)(this,void 0,void 0,(function(){var o,i,c,u,d,l;return Object(H.__generator)(this,(function(f){switch(f.label){case 0:o=function(e){var t=function(e){return Ue(e),Ke[e].map((function(e){return e.dateRange}))}(e),n=null==t?void 0:t.filter((function(e){return null!==e})),a=Object(r.d)(e);return W(Object(H.__spread)(n,a))}(e),i=o.map((function(t){return Ne(t,e,function(e,t){return function(n,a){"Loading"!==a&&Object(r.c)(e,t).forEach((function(e){U(e,n,a)}))}}(e,t),me)})),c=[],u=0,f.label=1;case 1:return u<i.length?[4,Promise.all([null===(n=i[u])||void 0===n?void 0:n.fetchPromise,null===(a=i[u])||void 0===a?void 0:a.enhancedFetchPromise]).then((function(e){var t=e[0],n=e[1];if(t&&n)for(var r=function(e){var r=t[e].ItemId.Id,a=Object(H.__read)(n.filter((function(e){return e.ItemId.Id===r})),1)[0];a&&Ge(t[e],a),c.push(t[e])},a=0;a<t.length;a++)r(a);else t&&c.push.apply(c,Object(H.__spread)(t))}))]:[3,4];case 2:f.sent(),f.label=3;case 3:return u++,[3,1];case 4:return c.length>0?(c.forEach((function(e){return s(e)})),d=c.reduce((function(e,t){return t&&e.push(t),e}),[]),v=function(e){return e.ItemId.Id},b={},I=[],d.forEach((function(e){var t=v(e);b.hasOwnProperty(t)||(I.push(e),b[t]=!0)})),h(e,l=I,o,t),[2,l]):[2,null]}var v,b,I}))}))}function Ze(e,t,n,r){void 0===r&&(r=!1);var a=e.ParentFolderId.Id,o=!1,i=function(e,t,n){var r,a,o=null;if(n)o=Y(t.ItemId.Id,e);else{r=Object(H.__read)(Q(e,(function(e){return e.InstanceKey==t.InstanceKey})),1),o=r[0]}if(!o){var i=t.ClientSeriesId;if(i){a=Object(H.__read)(Q(e,(function(e){return e.ClientSeriesId==i})),1),o=a[0]}}return o}(a,e,t);i?i.IsRecurring&&!t?r?M([i]):o=!0:(null==e.IsOnlineMeeting&&null!=i.IsOnlineMeeting&&(e.IsOnlineMeeting=i.IsOnlineMeeting),null==e.OnlineMeetingJoinUrl&&null!=i.OnlineMeetingJoinUrl&&(e.OnlineMeetingJoinUrl=i.OnlineMeetingJoinUrl),M([i])):Pe.g.info("[SharedCacheFunctions] addOrModifyItemInCache: Skipping removal of old item from cache as no old item was found"),!i&&n||(o||(I(a,[e],[{start:e.Start,end:e.End}]),x([e])),r?s(e):l(e))}function Qe(e,t){return void 0===t&&(t=!1),Object(H.__awaiter)(this,void 0,void 0,(function(){return Object(H.__generator)(this,(function(n){switch(n.label){case 0:return[4,Je(e,t)];case 1:return n.sent(),[2]}}))}))}var Ye=Object(o.action)("CALENDAR_EVENTS_CLEAR_ALL_FULL_CALENDAR_EVENTS",(function(){return{}}));function $e(){Ye(),Object(r.b)().map((function(e){return Je(e,!0)}))}var Xe=n(2782),et=864e5;var tt,nt={RowAdded:"RowAdded",RowModified:"RowModified",RowDeleted:"RowDeleted",Reload:"Reload"},rt=2e3,at={},ot={},it=[],ct=!0,ut=!0;function dt(e,t){if(ut&&(Object(Xe.b)($e,"RELOAD_CALENDAR_SUBSCRIPTIONS",et),ut=!1),at[e])return at[e].locks[t]=!0,void ve({message:"Already subscribed to calendar item notifications for folder",folderId:e});var n=Object(te.o)(e);if(n){var r=Object(te.C)(n);if(r){var a=Object(oe.i)("cal-surface-declinedMeetings");Ie.b.import().then((function(n){var o,i=Object(H.__assign)(Object(H.__assign)({},r),{ChannelId:n(),NotificationType:"CalendarItemNotification",IncludeDeclinedMeetings:a}),c={subscriptionId:""+i.NotificationType+e+(a?"declinedMeetings":""),requiresExplicitSubscribe:!0,subscriptionParameters:i},u={folderId:e,subscription:c,locks:(o={},o[t]=!0,o)};ve({message:"Subscribing to calendar item notifications for folder with includeDeclinedMeetings = "+a,folderId:e}),Ie.f.importAndExecute(c,st),at[e]=u}))}}else ve({message:"Calendar entry not found to subscribe to notifications for folder",folderId:e})}function st(e){vt(e,!0),function(e){if(it.some((function(e){return bt(e.NotificationPayload)})))ve({message:"A reload notification is in the queue. No additional notifications will be added",notificationPayload:e.NotificationPayload});else if(bt(e.NotificationPayload))ve({message:"A reload notification will be enqueued. All existing notifications will be discarded.",notificationPayload:e.NotificationPayload}),(it=[])[0]=e;else{for(var t=it.length-1;t>=0;t--){var n=it[t].NotificationPayload.Item,r=void 0,a=void 0,o=void 0;if(null!=e.NotificationPayload.Item.InstanceKey?(a=e.NotificationPayload.Item.InstanceKey,r=n.InstanceKey,o="InstanceKey"):(a=e.NotificationPayload.Item.ItemId.Id,r=n.ItemId.Id,o="ItemId"),a===r){ve({message:"Found an existing notification in the queue for the same "+o+". Old notification will be removed.",notificationPayload:e.NotificationPayload}),it[t].InstanceKeyToDelete&&(e.InstanceKeyToDelete=it[t].InstanceKeyToDelete),it.splice(t,1);break}}var i=!1;if(null!=e.NotificationPayload.Item.InstanceKey)if(e.NotificationPayload.EventType==nt.RowModified&&Object(ne.K)(e.NotificationPayload.Item.CalendarItemType)&&null!=e.NotificationPayload.Item.UID&&(ot[e.NotificationPayload.Item.InstanceKey]=e.NotificationPayload.Item.UID),e.NotificationPayload.EventType===nt.RowAdded||e.NotificationPayload.EventType===nt.RowModified){for(t=it.length-1;t>=0;t--)if(it[t].NotificationPayload.EventType===nt.RowDeleted&&it[t].OriginalUID==e.NotificationPayload.Item.UID){ve({message:"Found an existing RowDeleted notification in the queue for the same UID, which will be removed from the queue.",notificationPayload:e.NotificationPayload}),e.InstanceKeyToDelete=it[t].NotificationPayload.Item.InstanceKey,it.splice(t,1);break}}else if(e.NotificationPayload.EventType===nt.RowDeleted){var c=ot[e.NotificationPayload.Item.InstanceKey];if(delete ot[e.NotificationPayload.Item.InstanceKey],c){e.OriginalUID=c;for(t=it.length-1;t>=0;t--){var u=it[t].NotificationPayload.Item.UID;if((it[t].NotificationPayload.EventType===nt.RowAdded||it[t].NotificationPayload.EventType===nt.RowModified)&&u==c){ve({message:"Found an existing RowAdded or RowModified notification in the queue for the same UID, which will be merged with the RowDelete.",notificationPayload:e.NotificationPayload}),it[t].InstanceKeyToDelete=e.NotificationPayload.Item.InstanceKey,i=!0;break}}}}i?ve({message:"RowDeleted notification was merged with a RowAdded notification for the same UID and will not be enqueued",notificationPayload:e.NotificationPayload}):(ve({message:"Notification will be enqueued",notificationPayload:e.NotificationPayload}),it.push(e))}ve({message:"Notification queue length is "+it.length})}({NotificationPayload:e,InstanceKeyToDelete:null,OriginalUID:null}),ct?(tt&&(ve({message:"Notification processing timer was already started. It will be cancelled and restarted."}),clearTimeout(tt)),tt=setTimeout(ft,rt),ve({message:"Timer to drain queue has started"})):ve({message:"The notification was received while notification processing was suspended"})}function lt(e){var t,n;if(vt(e.NotificationPayload,!1),bt(e.NotificationPayload))It();else{var a=e.NotificationPayload.FolderId,o=null===(t=e.NotificationPayload.Item)||void 0===t?void 0:t.SkypeTeamsProperties;Object(oe.i)("cal-showAddTeamsCalendars")&&o&&!Object(te.o)(a)&&(a=function(e,t){var n=JSON.parse(t);if(null==n?void 0:n.cid){var r=n.cid.split("@")[0];e=r?Object(te.O)(e,r):e}return e}(a,o),(null===(n=e.NotificationPayload.Item)||void 0===n?void 0:n.ParentFolderId)&&(e.NotificationPayload.Item.ParentFolderId.Id=a));var i=Object(r.h)(a),c=Object(r.d)(a),u=Object(r.e)(a),d=Object(te.o)(a),l=Object(te.y)(a);d&&3==d.CalendarFolderType?It(a):i&&(c.length>0||Object.keys(u).length>0)?e.NotificationPayload.EventType==nt.RowDeleted?function(e,t){var n=t.Item.InstanceKey;j(e,n)}(a,e.NotificationPayload):Object(ne.K)(e.NotificationPayload.Item.CalendarItemType)?function(e,t,n){var r=Object(re.a)(n.NotificationPayload.Item,t);if(r.UID){Et(e).forEach((function(a){var o=le(r.ItemId,a);o.then((function(i){i&&"Success"==i.ResponseClass?function(e,t,n,r,a,o,i){if(ve({message:"Action to expand series completed successfully. Retrieved "+(a?a.length:0)+" items for dates: "+n.start.toString()+" - "+n.end.toString()+" ",folderId:r,notificationItem:e}),Et(r).some((function(e){return Object(z.b)(n,e)}))){ve({message:"Updating all cached items for the series and removing nonexistant ones",folderId:r});var c=[];a&&c.push.apply(c,Object(H.__spread)(a)),o&&c.push(o);var u=c.map((function(e){return e.UID}));jt(n,e.ItemId.Id,e.InstanceKey,i,r,(function(e){return!u.includes(e.UID)})),s(o),O(r,a),a.forEach((function(e){s(e)}))}else ve({message:"Range in the cache is different from what we originally requested - reloading cache",folderId:r}),Qe(r,!0)}(r,0,a,e,i.Occurrences.map((function(e){return Object(re.a)(e,t)})),Object(re.a)(i.RecurrenceMaster,t),n.InstanceKeyToDelete):Ot(r,o,a,e,n.InstanceKeyToDelete,i)})).catch((function(t){Ot(r,o,a,e,n.InstanceKeyToDelete,null,t.message)}))}))}}(a,l,e):function(e,t,n){var r=Object(re.a)(n.Item,t),a=!1;switch(n.EventType){case nt.RowAdded:a=!0;break;case nt.RowModified:a=null==r.InstanceKey||Object(ne.H)(r.CalendarItemType)||Object(ne.A)(r.CalendarItemType)}Ze(r,a,!1,!0)}(0,l,e.NotificationPayload):ve({message:i?"Events cache was empty for folder":"Events cache has not been loaded for folder yet",folderId:e.NotificationPayload.FolderId,notificationPayload:e.NotificationPayload})}}function ft(){var e=it.length;if(e>=8||it.some((function(e){return bt(e.NotificationPayload)})))It();else for(var t=0;t<e;t++){lt(it[t])}it=[],ot={},clearTimeout(tt)}function vt(e,t){var n,r=(null===(n=e.Item)||void 0===n?void 0:n.ItemId)?e.Item.ItemId.Id:"<null>";if(ve({message:(t?"Got calendar notification":"Processing calendar notification")+" for event type "+e.EventType,folderId:e.FolderId,notificationPayload:e}),t){var a=e.Item?e.Item.CalendarItemType:"<null>";Object(ee.p)("IncomingNotification",{NotificationType:e.EventType,ItemType:a,ItemId:r},{isCosmosDatapoint:!0})}}function bt(e){return e.EventType==nt.Reload||e.Reload}function It(e){var t,n,r=e?[e]:Object.keys(at);try{for(var a=Object(H.__values)(r),o=a.next();!o.done;o=a.next()){Qe(o.value,!0)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}function Ot(e,t,n,r,a,o,i){if(void 0===i&&(i=null),o&&"ErrorItemNotFound"==o.ResponseCode)ve({message:"Action to expand recurring series failed with item not found because item is not on the server. Removing series.",folderId:r,notificationItem:e}),jt(n,e.ItemId.Id,e.InstanceKey,a,r);else{var c=o?o.ResponseCode+": "+o.MessageText:i;ve({message:"Action to expand recurring series failed for unknown reason, reloading cache",folderId:r,notificationItem:e,errorMessage:c}),Qe(r,!0)}}function jt(e,t,n,r,a,o){var i=function(a){var i,c={start:a.Start,end:a.End},u=0==Object(z.j)(e,c,!0),d=a.InstanceKey==n||r&&a.InstanceKey==r||t&&t===(null===(i=a.SeriesMasterItemId)||void 0===i?void 0:i.Id);return u&&(Object(be.c)(a)||d&&(!o||o(a)))};p(a,i);var c=Q(a,i);M(c)}function mt(){ct&&(clearTimeout(tt),ve({message:"Processing of notifications will be suspended"}),ct=!1)}function pt(){ct||(ct=!0,ve({message:"Processing of notifications will be resumed"}),tt=setTimeout(ft,rt))}function Et(e){return W(Object(r.d)(e))}Object(o.orchestrator)(k,(function(e){var t=e.previousEvents,n=e.reloadedEvents;n&&(t&&M(t),x(n))})),Object(o.orchestrator)(p,(function(e){var t=e.folderId,n=e.predicate,r=null;E(t,n,(function(e){r=e})),r&&(r.forEach((function(e){return v(t,e.Key)})),M(r))})),Object(o.orchestrator)(j,(function(e){var t=e.folderId,n=e.instanceKey,r=null;m(t,n,(function(e){r=e})),r&&(r.forEach((function(e){return v(t,e.Key)})),M(r))})),Object(o.orchestrator)(_,(function(e){var t=e.lockId,n=e.folderId,r=e.dateRange,a=e.calendarEvents;R(t,n,r,a),a&&x(a)})),Object(o.orchestrator)(O,(function(e){var t=e.folderId,n=e.calendarEvents,o=Object(r.d)(t),i=Object(a.a)(n,o).eventsOverlapping;i.length>0&&(I(t,i,o),x(i))})),Object(o.orchestrator)(h,(function(e){var t=e.folderId,n=e.eventsReloaded,o=e.dateRanges,i=e.forceReplace,c=Object(r.a)(t),u=Object(a.a)(c,o).eventsOverlapping;I(t,n,o,i),k(u,n)})),Object(o.orchestrator)(K,(function(e){var t=e.folderId;!function(e){var t=at[e];t?(ve({message:"Unsubscribing from calendar item notifications for folder",folderId:e}),Ie.g.importAndExecute(t.subscription,st),delete at[e]):ve({message:"Could not unsubscribe calendar item notifications for folder due to subscription data not found",folderId:e})}(t),b(t),S(t)}));var yt=n(3030),gt=n(1678),ht=n(360);function _t(e,t){var n=function(e){return Object(gt.d)(e)?Rt:Object(gt.h)(e)?St:Object(gt.e)(e)?Ct:(Object(gt.i)(e),null)}(e.Recurrence);if(!n)return[Object(H.__assign)({},e)];var r=W(t),a=[],o=e.Recurrence.RecurrencePattern.Interval;r.forEach((function(t){var r=function(e,t){var n=Object(ie.Wb)(e.Start),r=Object(yt.a)(n.tz,e.Recurrence),a={start:n,end:r};return function(e,t){e.start=Object(ie.p)(e.start,t.start)>0?e.start:t.start,e.end=null!=e.end&&Object(ie.p)(e.end,t.end)<0?e.end:t.end}(a,t),a}(e,t),i=n(e,r,o);a.push.apply(a,Object(H.__spread)(i))}));var i=Object(ie.x)(e.Start,Object(ie.Wb)(e.Start)),c=Object(ie.x)(e.End,Object(ie.Wb)(e.Start));return function(e,t,n,r){var a=[];return r.forEach((function(r){var o={};ht(o,e),o.Start=Object(ie.h)(r,t),o.End=Object(ie.h)(r,n),o.CalendarItemType="Occurrence",a.push(o)})),a}(e,i,c,a)}function Rt(e,t,n){for(var r=[],a=Object(ie.s)(t.end,t.start),o=0;o<=a;o+=n){var i=Object(ie.e)(t.start,o);r.push(i)}return r}function St(e,t,n){for(var r=[],a=e.Recurrence.RecurrencePattern,o=a.DaysOfWeek.split(" ").map((function(e){return Tt(e)})),i=Math.max(Tt(a.FirstDayOfWeek),0),c=t.start;Object(ie.p)(c,t.end)<=0;){for(var u=c,d=Object(ie.C)(u,i);Object(ie.p)(u,d)<=0;)o.includes(Object(ie.nb)(u))&&Object(z.t)(t,u)&&r.push(u),u=Object(ie.e)(u,1);c=Object(ie.ac)(Object(ie.e)(c,7*n),i)}return r}function Ct(e,t,n){var r=[];if(Object(gt.b)(e.Recurrence))for(var a=(u=e.Recurrence.RecurrencePattern).DayOfMonth,o=t.start;Object(ie.p)(o,t.end)<=0;){for(var i=o,c=Object(ie.B)(i);Object(ie.p)(i,c)<=0;)Object(ie.lb)(i)==a&&Object(z.t)(t,i)&&r.push(i),i=Object(ie.e)(i,1);o=Object(ie.Zb)(Object(ie.i)(o,n))}else{var u,d=Tt((u=e.Recurrence.RecurrencePattern).DaysOfWeek),s=-1;switch(u.DayOfWeekIndex){case"First":s=1;break;case"Second":s=2;break;case"Third":s=3;break;case"Fourth":s=4}for(o=t.start;Object(ie.p)(o,t.end)<=0;){var l=void 0;l=s>0?Pt(d,s,o):At(d,o),Object(z.t)(t,l)&&r.push(l),o=Object(ie.Zb)(Object(ie.i)(o,n))}}return r}function Tt(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].indexOf(e)}function Pt(e,t,n){var r=Object(ie.Zb)(n),a=(e-Object(ie.nb)(r)+7)%7+7*(t-1);return Object(ie.e)(r,a)}function At(e,t){var n=Pt(e,5,t);return Object(ie.xb)(n)==Object(ie.xb)(t)?n:Pt(e,4,t)}function Ft(e,t){if(t){var n=e.ParentFolderId.Id;e.Recurrence&&p(n,(function(t){return t.InstanceKey==e.InstanceKey})),p(n,(function(t){return t.ItemId.Id===e.ItemId.Id}))}}Object(o.orchestrator)(q,(function(e){return Object(H.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,o,i,c,u,d,s,l,f,v;return Object(H.__generator)(this,(function(b){switch(b.label){case 0:t=e.eventToCreate,n=e.actionToExecute,a=e.actionSource,o=e.onEventCreatedFailed,i=e.onEventCreatedSuccess,c=e.errorMessage,u=e.onEventCreatedLocally,I=t,d=Object(r.h)(I.ParentFolderId.Id),function(e,t,n,a){if(t){var o=e.ParentFolderId.Id;if(e.Recurrence){var i=Object(r.d)(o),c=_t(e,i);Object(be.a)(c,!1);var u=c.map((function(e){return Object(H.__assign)(Object(H.__assign)({},e),{CalendarItemType:"Occurrence"})}));O(o,u)}Object(be.b)(e);var d=e.Recurrence?Object(H.__assign)(Object(H.__assign)({},e),{CalendarItemType:"RecurringMaster"}):e;O(o,[d])}n(a)}(t,d,u,a),s=function(){return q(t,n,(function(){return o(c,null,a)}),i,a,c)},l=null,b.label=1;case 1:return b.trys.push([1,3,,4]),[4,n(t)];case 2:return l=b.sent(),[3,4];case 3:throw f=b.sent(),Ft(t,d),o(f,s,a),f;case 4:if(v=null,!l.isSuccessful)throw Ft(t,d),o(c,s,a),c;return v=l.createdItem,function(e,t,n){t.ParentFolderId||(t.ParentFolderId=Object(H.__assign)({},e.ParentFolderId));if(n){var r=t.ParentFolderId.Id;p(r,(function(t){return t.ItemId.Id===e.ItemId.Id})),Ze(t,!0,!1)}}(t,v,d),i(v),[2]}var I}))}))}));var Nt=n(360);function wt(e,t){var n={Key:e,Start:t.Start,End:t.End};return Nt(t,n),t}var Mt=n(2365);var xt=n(119),Dt=n(1846);function Lt(e,t){return void 0===t&&(t=!1),t?kt(e):Object(Dt.c)(e)}function kt(e){var t;return null===(t=e.SeriesMasterItemId)||void 0===t?void 0:t.Id}var Kt=n(360);function Ut(e){if(e){var t=Object(J.a)();t.calendarFolderEvents.get(e)||t.calendarFolderEvents.set(e,Object(G.f)())}}Object(o.mutator)(y,(function(e){var t=e.lockId,n=Object(J.a)();Object(H.__spread)(n.calendarFolderEvents.keys()).forEach((function(e){n.calendarFolderEvents.get(e).locksInfo.get(t)&&Object(G.n)(t,n.calendarFolderEvents.get(e))})),n.fullItemsMruMap.delete(t)})),Object(o.mutator)(d,(function(e){var t=e.folderId,n=e.eventKey,r=e.event,a=$(n,t);a&&Object(G.q)(a,r,!0)})),Object(o.mutator)(l,(function(e){!function(e){var t;if(r=e,a=r,a.Key&&void 0!==a.Start&&void 0!==a.End){e.Key;var n=Object(H.__rest)(e,["Key"]);e=n}var r,a;var o=Lt(e),i=null===(t=e.ParentFolderId)||void 0===t?void 0:t.Id;if(i){var c=$(o,i);c&&Object(G.q)(c,e)}}(e.partialCalendarEvent)})),Object(o.mutator)(f,(function(e){var t=e.event,n=Y(t.ItemId.Id);n&&(Object(ne.w)(n)&&(delete t.RequiredAttendees,delete t.OptionalAttendees),Object(G.q)(n,t))})),Object(o.mutator)(R,(function(e){var t=e.lockId,n=e.folderId,a=e.dateRange,o=e.calendarEvents;Ut(n);var i=Object(r.f)(n),c=Object(Mt.a)(),u=o.filter((function(e){return!Object(ne.K)(e.CalendarItemType)})).map((function(e){return wt(e.ItemId.Id,e)})).filter((function(e){return!c[e.Key]}));Object(G.b)(a,u,t,i);var d=i.locksInfo.get(t).lockedDateRange,s=Object(ie.s)(d.end,d.start),l=Object(xt.d)()?42:110;if(s>l){var f=function(e,t,n){var r=Object(ie.s)(t.end,t.start);if(r===n)return t;if(r>n)return{start:t.start,end:Object(ie.e)(t.start,n)};var a=n-r,o=Math.abs(Object(ie.s)(t.end,e.end)),i=Math.abs(Object(ie.s)(e.start,t.start)),c=t.start,u=t.end;if(o>0){var d=Math.min(a,o);u=Object(ie.e)(u,d),a-=d}if(a>0&&i>0){var s=Math.min(a,i);c=Object(ie.e)(c,-1*s)}return{start:c,end:u}}(d,a,l);Object(G.h)(f,t,i)}})),Object(o.mutator)(m,(function(e){var t=e.folderId,n=e.instanceKey,a=e.onEventsRemoved;Ut(t);var o=Object(r.f)(t);a(Object(G.o)((function(e){return e.InstanceKey===n}),o))})),Object(o.mutator)(E,(function(e){var t=e.folderId,n=e.predicate,a=e.onEventsRemoved;Ut(t);var o=Object(r.f)(t);a(Object(G.o)(n,o))})),Object(o.mutator)(S,(function(e){var t=e.folderId;Object(J.a)().calendarFolderEvents.delete(t)})),Object(o.mutator)(I,(function(e){var t=e.folderId,n=e.calendarEvents,a=e.dateRanges,o=e.forceReplace;Ut(t);var i=n.map((function(e){return wt(e.ItemId.Id,e)})),c=Object(r.f)(t);o?Object(G.p)(i,c,a):Object(G.r)(i,c.events)})),Object(o.mutator)(T,(function(e){Kt(e.existingItem,e.updatedItem)}));var qt=new Map;var Bt=5;function Vt(e,t,n,r){zt(t,n);var a=e.eventKey,o=n.get(t),i=o.eventInfos,c=Object(H.__read)(i.filter((function(e){return e.eventKey===a})),1)[0];c?Wt(o.eventInfos.indexOf(c),e,o):(i.push(e),function(e,t){!function(e,t,n){for(;e.eventInfos.length>t&&0<e.eventInfos.length;)Gt(0,e,n)}(e,e.maxSize||Bt,t)}(o,r));Object(H.__spread)(n.keys()).forEach((function(t){n.get(t).eventInfos.forEach((function(t){e.eventKey===t.eventKey&&(t.itemResponseShapeType=e.itemResponseShapeType)}))}))}function Ht(e,t,n,r){void 0===r&&(r=function(){}),zt(t,n);var a=n.get(t),o=Object(H.__read)(a.eventInfos.filter((function(t){return t.eventKey===e})),1)[0],i=a.eventInfos.indexOf(o);return-1!==i&&Gt(i,a,r),-1!==i}function zt(e,t){if(!t.get(e)){var n=function(e){return qt.get(e)}(e);t.set(e,{eventInfos:[],maxSize:n})}}function Wt(e,t,n){if(-1===e)throw new Error("Item with eventKey "+t.eventKey+" does not exist in the MRU");n.eventInfos.splice(e,1),n.eventInfos.push(t)}function Gt(e,t,n){if(e<0||e>=t.eventInfos.length)throw new Error("Invalid index to remove "+e);var r=t.eventInfos[e];t.eventInfos.splice(e,1),n(r.eventKey)}function Jt(e){if(e){var t=Object(J.a)();t.calendarFolderEvents.get(e)||t.calendarFolderEvents.set(e,Object(G.f)())}}function Zt(e,t){return function(n){Object(G.i)([n],e,Object(J.a)().calendarFolderEvents.get(t))}}Object(o.mutator)(i,(function(e){var t=e.eventKey,n=e.folderId,r=e.lockId,a=e.partialCalendarEvent,o=e.itemResponseShapeType;Jt(n);var i=Object(J.a)();if(a){var c=wt(t,a);Object(G.a)(c,r,i.calendarFolderEvents.get(n))}Vt({eventKey:t,itemResponseShapeType:o,folderId:n,loadState:0},r,i.fullItemsMruMap,Zt(r,n))})),Object(o.mutator)(c,(function(e){var t=e.eventKey,n=e.folderId,r=e.lockId,a=e.itemResponseShapeType;Jt(n),Vt({eventKey:t,itemResponseShapeType:a,folderId:n,loadState:2},r,Object(J.a)().fullItemsMruMap,Zt(r,n))})),Object(o.mutator)(u,(function(e){var t=e.lockId,n=e.eventKey,r=e.folderId,a=e.event,o=e.hasEventChanged,i=e.itemResponseShapeType,c=e.forceOverrideAllPropertiesForEventIfAvailable;Jt(r);var u=Object(J.a)(),d=wt(n,a);Object(G.a)(d,t,u.calendarFolderEvents.get(r),o,c),Vt({eventKey:n,itemResponseShapeType:i,folderId:r,loadState:1},t,u.fullItemsMruMap,Zt(t,r))})),Object(o.mutator)(v,(function(e){var t=e.folderId,n=e.eventKey,r=Object(J.a)();r.calendarFolderEvents.get(t)&&Object(H.__spread)(r.fullItemsMruMap.keys()).forEach((function(e){Ht(n,e,r.fullItemsMruMap)}))})),Object(o.mutator)(b,(function(e){var t=e.folderId,n=Object(J.a)(),r=n.calendarFolderEvents.get(t);if(r){var a=Object(H.__spread)(r.locksInfo.entries()).reduce(Object(G.d)(),{}),o=Object.keys(a);Object(H.__spread)(n.fullItemsMruMap.keys()).forEach((function(e){o.forEach((function(t){return Ht(t,e,n.fullItemsMruMap)}))}))}})),Object(o.mutator)(Ye,(function(){var e=Object(J.a)();Object(H.__spread)(e.fullItemsMruMap.keys()).forEach((function(t){!function(e,t){zt(e,t),t.get(e).eventInfos=[]}(t,e.fullItemsMruMap)}))})),Object(o.mutator)(C,(function(e){var t=Object(J.a)(),n=e.lockId;!function(e,t,n){zt(t,n);var r=n.get(t),a=r.eventInfos,o=Object(H.__read)(a.filter((function(t){return t.eventKey===e})),1)[0];o&&Wt(r.eventInfos.indexOf(o),o,r)}(e.eventKey,n,t.fullItemsMruMap)}));var Qt=n(796);function Yt(e,t){var n;if(3==t){var r=Y(e);n=(null==r?void 0:r.SeriesMasterItemId)?Object(ce.a)({Id:r.SeriesMasterItemId.Id}):n=Object(Qt.a)({OccurrenceId:e})}else n=Object(ce.a)({Id:e});return n}function $t(e,t){t&&Qe(e.ParentFolderId.Id)}Object(o.orchestrator)(V,(function(e){return Object(H.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,o,i,c,u,d,s,l,f,v,b,I,O;return Object(H.__generator)(this,(function(j){switch(j.label){case 0:t=e.eventId,n=e.eventScope,a=e.dataPoint,o=e.actionToExecute,i=e.onEventDeleteSuccess,c=e.onEventDeleteFailed,u=e.responseSent,d=e.actionSource,s=e.errorMessage,l=e.asyncUndoAction,f=Y(t.Id),v=(m=f)&&Object(r.h)(m.ParentFolderId.Id),function(e,t,n){if(n){var r=e.ParentFolderId.Id;if(3==t||2==t){var a=e.Start;p(r,(function(n){return n.InstanceKey==e.InstanceKey&&(3==t||2==t&&!Object(ie.Gb)(n.Start,a))}))}else p(r,(function(t){return t.ItemId.Id===e.ItemId.Id}))}}(f,n,v),a&&a.markUserPerceivedTime(),b=Yt(t.Id,n),null,j.label=1;case 1:return j.trys.push([1,4,,5]),[4,l(f,u,d)];case 2:return j.sent()?($t(f,v),[2]):[4,o(b)];case 3:if(!j.sent().isSuccessful)throw new Error(s);return[3,5];case 4:throw I=j.sent(),$t(f,v),O=function(){return V(t,n,null,o,i,(function(){return c(I,null,d)}),d,s,u)},c(I,O,d),I;case 5:return i(),[2]}var m}))}))}));var Xt=n(3567),en=n(3583),tn=(Object(o.orchestrator)(s,(function(e){return Object(H.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,a,o,i;return Object(H.__generator)(this,(function(c){switch(c.label){case 0:return t=e.partialCalendarEvent,n=Lt(t),r=t.ParentFolderId.Id,null===Object(Mt.f)(t.ItemId.Id)?[3,2]:(a=Object(Mt.b)(t.ItemId.Id),o=Object(en.a)(a),[4,Object(Xt.a)(t.ItemId,r,o)]);case 1:(i=c.sent().calendarEvent)&&d(r,n,a,i),c.label=2;case 2:return[2]}}))}))})),n(388));Object(o.orchestrator)(B,(function(e){return Object(H.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,o,i,c,u,d,s,l,f,v,b,I,j,m;return Object(H.__generator)(this,(function(E){switch(E.label){case 0:t=e.eventId,n=e.eventChanges,a=e.errorMessage,o=e.actionToExecute,i=e.onEventUpdateFailed,c=e.onEventUpdateSuccess,u=e.onEventUpdatedLocally,d=e.actionSource,s=e.eventScope,l=Y(t.Id),f=Yt(t.Id,e.eventScope),l&&Object(ne.K)(l.CalendarItemType)&&(s=3),(v=function(e,t){if(!e)return!1;var n=e.ParentFolderId.Id;if(!Object(r.h)(n))return!1;var a=t.ParentFolderId;if(a&&a.Id!=n)return!1;return!0}(l,n))&&function(e,t,n,a,o){var i,c,u=e.ParentFolderId.Id;!Object(ne.H)(e.CalendarItemType)||0!=n&&1!=n||(t.CalendarItemType="Exception");var d=Object(H.__assign)(Object(H.__assign)({},e),t);if(3==n||2==n)if(t.Recurrence||t.Start||t.StartTimeZoneId||t.End||t.EndTimeZoneId||2==n){var s=e.Start;if(p(u,(function(t){return(Object(ne.H)(t.CalendarItemType)||Object(ne.A)(t.CalendarItemType))&&t.InstanceKey==e.InstanceKey&&(3==n||2==n&&!Object(ie.Gb)(t.Start,s))})),3===n||2===n){var l=Object(r.d)(u);2===n&&(l=l.map((function(e){return{start:Object(ie.Qb)(e.start.tz,e.start),end:Object(ie.Qb)(e.end.tz,e.end)}})),y=l,g=e.Start,h=[],y.forEach((function(e,t){Object(ie.p)(e.start,g)<=0&&Object(ie.p)(e.end,g)<=0&&h.push(t),Object(ie.p)(e.start,g)<=0&&Object(ie.p)(e.end,g)>0&&(e.start=Object(ie.Wb)(g))})),h.reverse().forEach((function(e){y.splice(e,1)})));var f=d;"Occurrence"!=d.CalendarItemType||d.Recurrence||(f=Y(d.SeriesMasterItemId.Id))||(f=d);var v=_t(f,l);Object(be.a)(v.concat(d),!0),delete t.Start,delete t.End;var b=v.map((function(e){return Object(H.__assign)(Object(H.__assign)(Object(H.__assign)({},e),t),{CalendarItemType:"Occurrence"})}));O(d.ParentFolderId.Id,b)}}else{var I=Q(u,(function(t){return t.InstanceKey==e.InstanceKey&&Object(ne.H)(t.CalendarItemType)}));try{for(var j=Object(H.__values)(I),m=j.next();!m.done;m=j.next()){var E=m.value;T(E,t),D(E)}}catch(e){i={error:e}}finally{try{m&&!m.done&&(c=j.return)&&c.call(j)}finally{if(i)throw i.error}}}var y,g,h;if(!Object(ne.A)(e.CalendarItemType)||3!=n){var _=null==e.InstanceKey||Object(ne.H)(e.CalendarItemType)||Object(ne.A)(e.CalendarItemType);Ze(d,_,!0)}a(d,o)}(l,n,s,u,d),b=function(){return B(t,n,s,o,c,(function(){return i(a,null,d)}),d,a)},I=null,E.label=1;case 1:return E.trys.push([1,3,,4]),[4,o(f)];case 2:return I=E.sent(),[3,4];case 3:throw j=E.sent(),v&&Qe(l.ParentFolderId.Id),i(j,b,d),j;case 4:if(!I.isSuccessful)throw v&&Qe(l.ParentFolderId.Id),i(a,b,d),a;return(null===(m=n.ParentFolderId)||void 0===m?void 0:m.mailboxInfo)&&Object(tn.r)(n.ParentFolderId.mailboxInfo.userIdentity)&&(Qe(n.ParentFolderId.Id,!0),Qe(l.ParentFolderId.Id,!0)),c(),[2]}}))}))}));var nn=n(128),rn=(Object(o.orchestrator)(nn.l,$e),n(77));function an(e){var t=Object(te.u)(e),n=t&&Object(te.p)({id:t});return n?n.CharmId:null}function on(e){return(null==e?void 0:e.CharmId)||an(e.ParentFolderId.Id)}function cn(){Object(r.b)().map((function(e){Object(Ae.f)(Object(te.o)(e))&&Je(e,!0)}))}var un=3e5;function dn(e){e?Object(Xe.b)(cn,"RELOAD_LINKEDCALENDAR_ENTRIES",un):Object(Xe.a)("RELOAD_LINKEDCALENDAR_ENTRIES")}function sn(e,t,n){return{FreeBusyType:"Decline"===n?"Free":"Free"===e&&"Decline"!==t?"Free":"Accept"===n?"Busy":"Tentative",AppointmentReplyTime:Object(ie.Pb)(),ResponseType:n}}var ln=n(3453),fn=n(270),vn=n(2731),bn=n(20),In={};function On(e,t){return e+t}function jn(e,t){var n=On(e,t);return In[n]||Promise.resolve({calendarEvent:null,error:"Could not find full event promise in existing promises"})}function mn(e,t,n,r,a,o){var i,c,u;void 0===n&&(n=null),void 0===a&&(a={fetchSource:"unknown"});var d=En(n,r);o||(o=Object(Mt.b)(t.Id));var s,l=Object(Mt.e)(t.Id,o);if(l)s=function(e,t,n,r,a,o){var i=a(t);switch(n.loadState){case 1:return{event:i,fullEventPromise:Promise.resolve({calendarEvent:i,error:null}),promiseSource:2};case 0:return{event:i,fullEventPromise:jn(t.Id,o),promiseSource:0};case 2:var c=gn(i,t,r,e,o);return Object(H.__assign)({event:i},c);default:return Object(fn.a)(n.loadState)}}(n=n||l.folderId,t,l,!1,d,o);else{var f=d(t),v=gn(f,t,!1,n||(null===(i=null==f?void 0:f.ParentFolderId)||void 0===i?void 0:i.Id)||null,o);s=Object(H.__assign)({event:f},v)}var b=null;return s&&(n=n||(null===(u=null===(c=s.event)||void 0===c?void 0:c.ParentFolderId)||void 0===u?void 0:u.Id)||null,b={event:s.event,fullEventPromise:hn(s.fullEventPromise,s.promiseSource,s.event,e,n,a,t.Id,!1,o)}),b}function pn(e,t,n,r,a,o){var i,c,u;void 0===n&&(n=null),void 0===a&&(a={fetchSource:"unknown"});var d,s=En(n,r)(t);n=n||(null===(i=null==s?void 0:s.ParentFolderId)||void 0===i?void 0:i.Id);var l=s&&kt(s);o||(o=l?Object(Mt.b)(l):Object(Mt.c)());var f=null;return(d=function(e,t,n,r,a){var o=r&&Object(Mt.e)(r,n);if(o&&1===o.loadState){var i=$(r,e);return{event:i,fullEventPromise:Promise.resolve({calendarEvent:i,error:null}),promiseSource:2}}return o&&0===o.loadState?{event:$(r,e)||yn(a),fullEventPromise:jn(r,n),promiseSource:0}:{event:yn(a),fullEventPromise:_n(t,!0,e,n),promiseSource:0}}(n,t,o,l,s))&&(n=n||(null===(u=null===(c=d.event)||void 0===c?void 0:c.ParentFolderId)||void 0===u?void 0:u.Id)||null,f={event:d.event,fullEventPromise:hn(d.fullEventPromise,d.promiseSource,d.event,e,n,a,l,!0,o)}),f}function En(e,t){return function(n){return Y(n.Id,e)||(null==t?void 0:t(n))}}function yn(e){return e&&Object(H.__assign)(Object(H.__assign)({},Object(vn.a)(Object(bn.toJS)(e))),{ItemId:Object(H.__assign)({},null==e?void 0:e.SeriesMasterItemId),CalendarItemType:"RecurringMaster"})}function gn(e,t,n,r,a){return e&&e.EffectiveRights&&!Object(ne.v)(e)?{fullEventPromise:Promise.resolve({calendarEvent:e,error:null}),promiseSource:1}:{fullEventPromise:_n(t,n,r,a),promiseSource:0}}function hn(e,t,n,r,a,o,d,s,l){return Object(H.__awaiter)(this,void 0,void 0,(function(){var f,v,b,I,O,j,m,p,E,y;return Object(H.__generator)(this,(function(g){switch(g.label){case 0:f=Object(Mt.d)(r,d,l),v=null,b=null,I=null,g.label=1;case 1:return g.trys.push([1,5,6,7]),Pe.g.info("[fetchFullCalendarEvent] Handling loading full calendar event Key: "+d+", Lock: "+r),!a||f&&1===f.loadState||d&&(Pe.g.info("[fetchFullCalendarEvent] Loading full calendar event Key: "+d+", Lock: "+r),function(e,t,n){var r=On(e,t);In[r]=n}(d,l,e),i(r,a,d,l,n)),2!=t?[3,2]:(v=n,[3,4]);case 2:return[4,e];case 3:O=g.sent(),v=null==O?void 0:O.calendarEvent,b=null==O?void 0:O.error,I=null==O?void 0:O.responseCode,void 0===d&&(d=Lt(O.calendarEvent)),g.label=4;case 4:if(!v)throw j=new Error("[fetchFullCalendarEvent] Action source:"+o.fetchSource+" with response code: "+(null!=I?I:"<null>")+" and error: "+b),I&&(j.responseCode=I,j.fetchErrorType="ServerFailure"),j.diagnosticInfo=JSON.stringify({responseCode:I,eventKey:d}),j;return m=a||v.ParentFolderId.Id,y=f,f=Object(Mt.d)(r,d,l),!m||f&&1===f.loadState?(Pe.g.info('[fetchFullCalendarEvent] Full calendar event already loaded. EventKey: "'+d+'", Lock: "'+r+'", FolderId: "'+m+'"'),C(r,d)):(Pe.g.info('[fetchFullCalendarEvent] Loaded full calendar event Key: "'+d+'", Lock: "'+r+'", FolderId: "'+m+'"'),Object(ee.p)("FullCalendarEventLoaded",Object(H.__assign)({eventKey:d,lockId:r,prevFullItemLoadState:y?y.loadState:null,fullItemLoadState:f?f.loadState:null,isFullItem:void 0!==v.RequiredAttendees,isSameAsExistingEvent:n===v,eventScope:s?3:0,errorMessage:null},o)),u(r,m,d,l,v,s,0===t)),(p=$(d,a))&&D(p),[2,p];case 5:throw E=g.sent(),y=f,f=Object(Mt.d)(r,d,l),Object(ee.p)("FullCalendarEventLoaded",Object(H.__assign)({eventKey:d,lockId:r,prevFullItemLoadState:y?y.loadState:null,fullItemLoadState:f?f.loadState:null,isFullItem:!1,isSameAsExistingEvent:!1,eventScope:s?3:0,errorMessage:E.toString()},o)),a&&c(r,a,d,l),E;case 6:return function(e,t){var n=On(e,t);delete In[n]}(d,l),[7];case 7:return[2]}}))}))}function _n(e,t,n,r){var a=this;return Object(H.__awaiter)(a,void 0,void 0,(function(){return Object(H.__generator)(this,(function(a){switch(a.label){case 0:return[4,Rn(je,e,t,n,r)];case 1:return[2,a.sent()]}}))}))}function Rn(e,t,n,r,a){return Object(H.__awaiter)(this,void 0,void 0,(function(){var o,i,c;return Object(H.__generator)(this,(function(u){switch(u.label){case 0:o=0,u.label=1;case 1:if(!(o<e))return[3,6];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,Object(Xt.a)(t,r,Object(en.a)(a),n)];case 3:return i=u.sent(),o++,!i.error||o>=e?[2,i]:[3,5];case 4:if(c=u.sent(),Pe.g.warn('[fetchFullCalendarEvent] Received error when trying to load calendar event from server for "'+t.Id+'" with try '+o+": Error "+c.toString()),++o>=e)throw c;return[3,5];case 5:return[3,1];case 6:return[2,{calendarEvent:null,error:"Error: Unable to fetch event"}]}}))}))}function Sn(e){var t=this;if(!e)throw new Error("The lock id should be provided");return{fetchCalendarEventsForDateRange:function(t,n){var r=Ve(e,t,n);return{fetchPromise:r.fetchPromise,enhancedFetchPromise:r.enhancedFetchPromise,events:r.events}},subscribeNotifications:function(t){return dt(t,e)},fetchFullCalendarEvent:function(n,r,a,o,i){var c=Y(n.Id),u=Cn(e,n,r,a,o,i,(null==c?void 0:c.IsOrganizer)?"WithBlockedExternalContent":null),d=u.event,s=u.fullEventPromise;return s=s.then((function(c){return Object(H.__awaiter)(t,void 0,void 0,(function(){return Object(H.__generator)(this,(function(t){switch(t.label){case 0:return c.IsOrganizer&&c.HasBlockedImages?[4,Cn(e,n,r,a,o,i,"WithBlockedExternalContent").fullEventPromise]:[3,2];case 1:c=t.sent(),t.label=2;case 2:return[2,c]}}))}))})),{event:d,fullEventPromise:s}},fetchFullCalendarEventAndUpdateItemResponseShapeType:function(t,n,r,a,o,i){return Cn(e,t,r,a,o,i,n)},getLockId:function(){return e},release:function(){return g(e)}}}function Cn(e,t,n,r,a,o,i){return a?pn(e,t,n,r,o,i):mn(e,t,n,r,o,i)}function Tn(e,t){var n=Object(G.g)(e);return t&&function(e,t){t?qt.set(e,t):qt.delete(e)}(n,t.maxMruSize),Sn(n)}function Pn(e){return{getCalendarEventsForDateRange:function(t,n){return Oe(e,t,n)},getEnhancedCalendarEventsForDateRange:function(t,n){return function(e,t,n){return Le(t,n)?Oe(e,t,n):null}(e,t,n)},getFullCalendarEvent:function(t,n){return X(t,n,e)}}}function An(e){return Object(J.a)().calendarFolderWorkingHours.get(e)}n.d(t,"u",(function(){return Nn})),n.d(t,"k",(function(){return Y})),n.d(t,"c",(function(){return M})),n.d(t,"b",(function(){return x})),n.d(t,"a",(function(){return D})),n.d(t,"d",(function(){return L})),n.d(t,"g",(function(){return K})),n.d(t,"v",(function(){return U})),n.d(t,"r",(function(){return q})),n.d(t,"t",(function(){return B})),n.d(t,"s",(function(){return V})),n.d(t,"x",(function(){return pt})),n.d(t,"y",(function(){return mt})),n.d(t,"i",(function(){return an})),n.d(t,"m",(function(){return on})),n.d(t,"o",(function(){return Yt})),n.d(t,"n",(function(){return Mt.f})),n.d(t,"w",(function(){return dn})),n.d(t,"j",(function(){return sn})),n.d(t,"h",(function(){return le})),n.d(t,"e",(function(){return ln.a})),n.d(t,"f",(function(){return Tn})),n.d(t,"q",(function(){return Sn})),n.d(t,"p",(function(){return Pn})),n.d(t,"l",(function(){return An}));var Fn=new rn.c((function(){return Promise.all([n.e(1),n.e(390)]).then(n.bind(null,17001))})),Nn=new rn.a(Fn,(function(e){return e.getCalendarEventsFromRest}))},1625:function(e,t,n){"use strict";n.d(t,"z",(function(){return r})),n.d(t,"p",(function(){return a})),n.d(t,"B",(function(){return o})),n.d(t,"C",(function(){return i})),n.d(t,"A",(function(){return c})),n.d(t,"m",(function(){return u})),n.d(t,"y",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"q",(function(){return l})),n.d(t,"s",(function(){return f})),n.d(t,"e",(function(){return v})),n.d(t,"D",(function(){return b})),n.d(t,"u",(function(){return I})),n.d(t,"a",(function(){return O})),n.d(t,"w",(function(){return j})),n.d(t,"c",(function(){return m})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return E})),n.d(t,"E",(function(){return y})),n.d(t,"v",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"x",(function(){return _})),n.d(t,"d",(function(){return R})),n.d(t,"r",(function(){return S})),n.d(t,"t",(function(){return C})),n.d(t,"l",(function(){return T})),n.d(t,"i",(function(){return P})),n.d(t,"j",(function(){return A})),n.d(t,"k",(function(){return F})),n.d(t,"o",(function(){return N})),n.d(t,"n",(function(){return w}));var r="Sunday",a="Monday",o="Tuesday",i="Wednesday",c="Thursday",u="Friday",d="Saturday",s=[r,a,o,i,c,u,d],l=["January","February","March","April","May","June","July","August","September","October","November","December"],f="None",v="DailyRecurrence",b="WeeklyRecurrence",I="RelativeMonthlyRecurrence",O="AbsoluteMonthlyRecurrence",j="RelativeYearlyRecurrence",m="AbsoluteYearlyRecurrence",p=["None","First","Second","Third","Fourth","Last"],E="DailyRecurrence:#Exchange",y="WeeklyRecurrence:#Exchange",g="RelativeMonthlyRecurrence:#Exchange",h="AbsoluteMonthlyRecurrence:#Exchange",_="RelativeYearlyRecurrence:#Exchange",R="AbsoluteYearlyRecurrence:#Exchange",S="NoEndRecurrence:#Exchange",C="NumberedRecurrence:#Exchange",T="EndDateRecurrence:#Exchange",P=3,A=25,F=1,N=1,w=99},1678:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"i",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"h",(function(){return f}));var r=n(1625);function a(e){return e?l(e)?r.e:f(e)?r.D:d(e)?r.u:c(e)?r.a:s(e)?r.w:u(e)?r.c:r.s:r.s}function o(e){return c(e)||d(e)}function i(e){return u(e)||s(e)}function c(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.b}function u(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.d}function d(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.v}function s(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.x}function l(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.f}function f(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.E}},1708:function(e,t,n){"use strict";var r=n(0),a=n(83),o=255,i=175,c="_____";function u(e){if(!e)return null;var t=e.indexOf(c);-1!=t&&(e=e.substring(0,t));var n=Object(a.i)("cal-mf-joinButton")?i:o;if((e=e.trim()).length<n)return e;var r=e.substr(0,n).trim();return r.length>0?r.concat("..."):null}var d=n(295),s=n(128),l=n(5),f=n(9),v=n(2822),b=n(2823),I=n(1778),O=n(2824),j=n(2825);n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return g}));var m=Object(v.a)(),p=[[Object(f.mc)("2019-11-03T00:00:00.000-03:00"),Object(f.mc)("2020-02-15T23:59:59.999-03:00")],[Object(f.mc)("2020-11-08T00:00:00.000-03:00"),Object(f.mc)("2021-02-20T23:59:59.999-03:00")],[Object(f.mc)("2021-11-07T00:00:00.000-03:00"),Object(f.mc)("2022-02-20T23:59:59.999-03:00")]];function E(e,t){t=t||Object(d.d)();var n=[],o=!1,i=null;if(null==e?void 0:e.ExtendedProperty){var c=e.ExtendedProperty.filter((function(e){var t;return(null===(t=e.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===b.a.PropertyName}))[0];if(null==c?void 0:c.Value)try{n=JSON.parse(c.Value)}catch(e){n=[]}e.ExtendedProperty.some((function(e){var t;return(null===(t=e.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===O.a.PropertyName&&!!e.Value}))&&(o=!0),(null==(c=e.ExtendedProperty.filter((function(e){var t;return(null===(t=e.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===j.a.PropertyName}))[0])?void 0:c.Value)&&(i=c.Value)}var l=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},m),e),{ItemId:e.ItemId?Object(r.__assign)(Object(r.__assign)({},e.ItemId),{mailboxInfo:t}):e.ItemId,ParentFolderId:e.ParentFolderId?Object(r.__assign)(Object(r.__assign)({},e.ParentFolderId),{mailboxInfo:t}):e.ParentFolderId,Start:y(e.Start),End:y(e.End),StartTimeZoneId:Object(s.b)(e.StartTimeZoneId),EndTimeZoneId:Object(s.b)(e.EndTimeZoneId),LastModifiedTime:y(e.LastModifiedTime),FreeBusyType:e.FreeBusyType,ResponseType:e.ResponseType,AppointmentReplyTime:y(e.AppointmentReplyTime),ExperienceType:e.ExperienceType?e.ExperienceType:"Unspecified",SeriesMasterItemId:e.SeriesMasterItemId?Object(r.__assign)(Object(r.__assign)({},e.SeriesMasterItemId),{mailboxInfo:t}):null,Sensitivity:"GroupMailbox"==t.type&&"Private"==e.Sensitivity?"Normal":e.Sensitivity,Preview:u(e.Preview),AppendOnSend:n,IsBookedFreeBlocks:o,CollabSpace:i});if(!e.IsAllDayEvent&&e.SeriesId&&"Occurrence"==e.CalendarItemType&&"tzone://Microsoft/Custom"==e.StartTimeZoneId&&"E. South America Standard Time"==e.EndTimeZoneId&&!Object(a.i)("cal-killSwitch-63446")&&l.Start&&l.End&&p.some((function(e){var t=Object(r.__read)(e,2),n=t[0],a=t[1];return Object(f.Mb)(l.Start,n,a)}))){var v=Object(f.x)(l.End,l.Start);l.Start=Object(f.f)(l.Start,1),l.End=Object(f.h)(l.Start,v),l.StartTimeZoneId=l.EndTimeZoneId,l.__BrazilHack__=1}return l}function y(e){if(e){if(Object(a.i)("cal-assumeTzOffsetFromCalendarItem")){var t=Object(l.a)().timezone,n=!!t;return Object(f.Rb)(t,e,n)}return Object(f.pb)(e)}}function g(e){var t=[];return e.AppendOnSend&&e.AppendOnSend.length>0&&t.push(Object(I.a)({ExtendedFieldURI:b.a,Value:JSON.stringify(e.AppendOnSend)})),e.IsBookedFreeBlocks&&t.push(Object(I.a)({ExtendedFieldURI:O.a,Value:e.IsBookedFreeBlocks.toString()})),e.CollabSpace&&t.push(Object(I.a)({ExtendedFieldURI:j.a,Value:e.CollabSpace})),Object(r.__assign)(Object(r.__assign)({__type:"CalendarItem:#Exchange"},e),{Start:e.Start&&Object(f.qb)(e.Start),End:e.End&&Object(f.qb)(e.End),LastModifiedTime:e.LastModifiedTime&&Object(f.qb)(e.LastModifiedTime),AppointmentReplyTime:e.AppointmentReplyTime&&Object(f.qb)(e.AppointmentReplyTime),FreeBusyType:e.FreeBusyType,CharmId:e.CharmId,IsDraft:e.IsDraft,IsRoomRequested:e.IsRoomRequested,SkypeTeamsProperties:e.SkypeTeamsProperties&&JSON.stringify(e.SkypeTeamsProperties),ExtendedProperty:t})}},1722:function(e,t,n){"use strict";function r(e){var t;if(null===(t=null==e?void 0:e.ItemId)||void 0===t?void 0:t.Id){var n=e.ClientSeriesId;return!!n&&(e.IsRecurring?n==e.InstanceKey:n==e.ItemId.Id)}return!0}var a=n(0),o=n(723),i=n(362);function c(e,t){var n=Object(i.a)();e.forEach((function(e){var r=Object(i.a)();d(e,n,r,t),e.IsRecurring=!0,e.InstanceKey=e.InstanceKey&&!t?e.InstanceKey:n}))}function u(e){var t=Object(i.a)();d(e,t,t,!1)}function d(e,t,n,r){e.ItemId=Object(a.__assign)(Object(a.__assign)({},Object(o.a)({Id:n})),{mailboxInfo:e.ParentFolderId.mailboxInfo}),e.ClientSeriesId&&!r||(e.ClientSeriesId=t),e.EffectiveRights={Read:!0,Modify:!0,Delete:!0,ViewPrivateItems:!0},e.IsOrganizer=!0}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}))},1778:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"ExtendedPropertyType:#Exchange"},e)}},1846:function(e,t,n){"use strict";var r=n(2053),a=n(3012),o=(n(3013),n(9));var i=n(1817),c=function(e,t){return Object(o.zb)(e.Start)<Object(o.zb)(t.End)&&Object(o.zb)(e.End)>Object(o.zb)(t.Start)},u=function(e,t){return t.filter((function(t){return t!=e&&c(e,t)})).sort(r.a)};function d(e,t){var n,r,a,i,c;e.Start=t.Start,e.ItemId=t.ItemId,e.End=t.End,e.CalendarItemType="ThisAndFollowingInstancesMaster",e.Recurrence.RecurrenceRange.StartDate=(r=(n=t).StartTimeZoneId,a=n.Start,i=Object(o.Qb)(r,a),c=Object(o.Wb)(i),Object(o.ub)(c))}var s=n(2132);function l(e){e.Start=Object(o.Qb)(e.StartTimeZoneId,e.Start),e.End=Object(o.Qb)(e.EndTimeZoneId,e.End)}n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return a.a})),n.d(t,"c",(function(){return i.a})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return s.a})),n.d(t,"h",(function(){return l}))},1998:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l}));var r=2,a=4,o=8,i=32,c=64,u=128,d=4294967296,s=8589934592,l=17179869184},2053:function(e,t,n){"use strict";var r=n(34),a=n(3012),o=n(2132),i=n(9),c=n(177);function u(e){var t=Object(c.w)();return e.ParentFolderId&&t&&e.ParentFolderId.Id===t.calculatedFolderId}function d(e){if(!e.ParentFolderId)return!1;var t=Object(c.l)(Object(c.w)()).ParentGroupId,n=Object(c.o)(e.ParentFolderId.Id);return n&&n.ParentGroupId===t}function s(e,t){var n=Object(o.a)(e);if(n!=Object(o.a)(t))return n?-1:1;var r=f(t)-f(e);if(0!=r)return r;if(0!=(r=Object(i.w)(e.Start,t.Start)))return r;if(v(e)&&v(t)){var c=u(e);if(c!=u(t))return c?-1:1;var s=d(e);if(s!=d(t))return s?-1:1}return 0!=(r=Object(a.a)(e,t))?r:0!=(r=Object(i.w)(t.End,e.End))?r:0!=(r=l(e.Subject,t.Subject))?r:0!=(r=l(e.CalendarItemType,t.CalendarItemType))?r:0!=(r=l(e.ParentFolderId.Id,t.ParentFolderId.Id))?r:l(e.ItemId.Id,t.ItemId.Id)}function l(e,t){return(e||"").localeCompare(t||"")}function f(e){var t=Object(i.w)(e.End,e.Start);return Math.max(Math.ceil(t/r.e),1)}function v(e){return"Booking"!=e.__type&&"AnonymousCalendarEvent"!=e.__type}n.d(t,"a",(function(){return s}))},2132:function(e,t,n){"use strict";var r=n(9);t.a=function(e){return e.IsAllDayEvent||Object(r.u)(e.End,e.Start)>0}},2365:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return f}));var r=n(0),a=n(20),o=n(2305);function i(){return v.get()}function c(e,t){var n=u(e);return n&&n.itemResponseShapeType===t?n:null}function u(e){var t=i()[e];return t||null}function d(e,t,n){var a=Object(o.a)().fullItemsMruMap.get(e);if(a){var i=Object(r.__read)(a.eventInfos.filter((function(e){return e.eventKey===t})),1)[0];if(i&&i.itemResponseShapeType===n)return i}return null}function s(e){var t=u(e);return t?t.loadState:null}function l(e){var t,n=null===(t=u(e))||void 0===t?void 0:t.itemResponseShapeType;return n||"Default"}function f(){return"Default"}var v=Object(a.computed)((function(){var e=Object(o.a)();return Object(r.__spread)(e.fullItemsMruMap.keys()).reduce((function(t,n){return e.fullItemsMruMap.get(n).eventInfos.forEach((function(e){return t[e.eventKey]=e})),t}),{})}))},2654:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(77),a=n(2991);n.d(t,"a",(function(){return a.a}));var o=new r.c((function(){return Promise.all([n.e(98),n.e(859)]).then(n.bind(null,6216))})),i=new r.a(o,(function(e){return e.getTxpObjectFromTxpEntities}))},2731:function(e,t,n){"use strict";var r=n(3561),a=1,o=4;t.a=function(e){return Object(r.a)(e,a|o)}},2782:function(e,t,n){"use strict";var r=n(3),a=Object(r.action)("poll",(function(e,t,n){return{requestFunction:e,requestIdentifier:t,interval:n}})),o=Object(r.action)("cancelPoll",(function(e){return{requestIdentifier:e}})),i={currentRequest:new(n(20).ObservableMap)},c=Object(r.createStore)("requestIdStore",i);Object(r.mutator)(o,(function(e){var t=c().currentRequest.get(e.requestIdentifier);if(t){var n=t.timer;clearTimeout(n),t.timer=null}}));var u=n(0),d=Object(r.mutatorAction)("setCurrentRequestId",(function(e,t){var n=c().currentRequest.get(e);n?n.requestId=t:c().currentRequest.set(e,{requestId:t,timer:null})}));function s(e,t){return c().currentRequest.get(e).requestId===t}function l(e,t){return Object(u.__awaiter)(this,void 0,void 0,(function(){var n,r,a;return Object(u.__generator)(this,(function(o){switch(o.label){case 0:return n=Math.random(),d(t,n),[4,e()];case 1:return r=o.sent(),a={isCurrent:s(t,n)},[2,Object(u.__assign)({response:r},a)]}}))}))}var f=Object(r.mutatorAction)("setPollTimer",(function(e,t){var n=c().currentRequest.get(e);n&&(n.timer=t)}));Object(r.orchestrator)(a,(function(e){var t=e.requestFunction,n=e.requestIdentifier,r=e.interval;o(n);var i=setTimeout((function(){return function(e,t,n){return Object(u.__awaiter)(this,void 0,void 0,(function(){return Object(u.__generator)(this,(function(r){switch(r.label){case 0:return[4,l((function(){return e()}),t)];case 1:return r.sent(),a(e,t,n),[2]}}))}))}(t,n,r)}),r);f(n,i)})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}))},2822:function(e,t,n){"use strict";function r(){return{__type:void 0,ItemId:void 0,ParentFolderId:void 0,Subject:void 0,ReminderIsSet:void 0,ReminderMinutesBeforeStart:void 0,LastModifiedTime:void 0,InstanceKey:void 0,Preview:void 0,EffectiveRights:void 0,HasAttachments:void 0,HasBlockedImages:void 0,Attachments:void 0,Sensitivity:void 0,Body:void 0,EntityNamesMap:void 0,TailoredXpEntities:void 0,IsDraft:void 0,Categories:void 0,Start:void 0,End:void 0,IsAllDayEvent:void 0,IsRoomRequested:void 0,AutoRoomBookingStatus:void 0,FreeBusyType:void 0,IsMeeting:void 0,IsCancelled:void 0,IsRecurring:void 0,IsResponseRequested:void 0,CalendarItemType:void 0,ResponseType:void 0,Organizer:void 0,RequiredAttendees:void 0,OptionalAttendees:void 0,Resources:void 0,AppointmentReplyTime:void 0,Recurrence:void 0,Location:void 0,IntendedFreeBusyStatus:void 0,IsOrganizer:void 0,AppointmentReplyName:void 0,IsSeriesCancelled:void 0,CharmId:void 0,Locations:void 0,ClientSeriesId:void 0,UID:void 0,ExperienceType:void 0,DoNotForwardMeeting:void 0,IsOnlineMeeting:void 0,JoinOnlineMeetingUrl:void 0,InboxReminders:void 0,MeetingRequestWasSent:void 0,ExtractionSourceId:void 0,StartTimeZoneId:void 0,EndTimeZoneId:void 0,OnlineMeetingProvider:void 0,OnlineMeetingJoinUrl:void 0,OnlineMeetingConferenceId:void 0,OnlineMeetingTollNumber:void 0,OnlineMeetingTollFreeNumbers:void 0,SeriesMasterItemId:void 0,ExtractionSourceInternetMessageId:void 0,HideAttendees:void 0,PersonId:void 0,InReplyTo:void 0,IsFreeBusyOnly:void 0,MeetingNotesWebUrl:void 0,ConversationId:void 0,SkypeTeamsProperties:void 0,DocLinks:void 0,AppendOnSend:void 0,IsBookedFreeBlocks:void 0,AssociatedTasks:void 0,CollabSpace:void 0}}n.d(t,"a",(function(){return r}))},2823:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(472),a=Object(r.a)({DistinguishedPropertySetId:"Common",PropertyName:"AppendOnSend",PropertyType:"String"})},2824:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(319),a=Object(r.a)("6ed8da90-450b-101b-98da-00aa003f1305","IsBookedFreeBlocks","Boolean")},2825:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(472),a=Object(r.a)({DistinguishedPropertySetId:"PublicStrings",PropertyName:"MeetingAgenda",PropertyType:"String"})},2925:function(e){e.exports=JSON.parse('{"a":"zfa"}')},2991:function(e,t,n){"use strict";var r=n(1998),a=n(1815),o=n(1676);var i=n(3115);function c(e){return function(e){return!(e<=0)&&(Object(o.a)(e,a.a)==a.a||Object(o.a)(e,r.d)==r.d||Object(o.a)(e,r.e)==r.e||Object(o.a)(e,a.b)==a.b||Object(o.a)(e,r.a)==r.a||Object(o.a)(e,r.b)==r.b||Object(o.a)(e,r.f)==r.f)}(e)||function(e){return Object(o.a)(e,r.g)==r.g||Object(o.a)(e,r.h)==r.h||Object(o.a)(e,r.i)==r.i}(e)||Object(i.a)(e)}n.d(t,"a",(function(){return c}))},3012:function(e,t,n){"use strict";var r=n(3013);t.a=function(e,t){return Object(r.a)(e.FreeBusyType)-Object(r.a)(t.FreeBusyType)}},3013:function(e,t,n){"use strict";t.a=function(e){switch(e){case"OOF":return 0;case"Busy":return 1;case"Tentative":return 2;case"WorkingElsewhere":return 3;case"Free":return 4;default:return 5}}},3030:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(9);function a(e,t){if(null==t?void 0:t.RecurrenceRange){var n=t.RecurrenceRange.EndDate;if(n)return Object(r.Qb)(e,n)}return null}},3115:function(e,t,n){"use strict";var r=n(1676);var a=n(1998),o=n(83),i="cal-txp-invoice";function c(e){return function(e,t,n){return Object(r.a)(e,t)==t&&n}(e,a.c,Object(o.i)(i))}n.d(t,"a",(function(){return c}))},3287:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(534);function a(e,t){var n=[],a=[];return e.forEach((function(e){var o={start:e.Start,end:e.End};t.some((function(e){return 0===Object(r.j)(e,o,!0)}))?n.push(e):a.push(e)})),{eventsOverlapping:n,eventsNotOverlapping:a}}},3288:function(e){e.exports=JSON.parse('{"a":"Bfa"}')},3289:function(e){e.exports=JSON.parse('{"a":"Afa"}')},3453:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1637),a=n(1708),o=n(30),i=n(295);function c(e){for(var t,n,o=[],c=0;c<e.length;c++){var l=e[c],f=d(l.Attendees),v=f.requiredAttendees,b=f.optionalAttendees,I={ItemId:{Id:Object(r.b)(l.Id),mailboxInfo:Object(i.d)()},ResponseType:u(null===(t=l.ResponseStatus)||void 0===t?void 0:t.Response),AppointmentReplyTime:Object(a.b)(s(l.Attendees)),IsOnlineMeeting:l.IsOnlineMeeting,OnlineMeetingProvider:l.OnlineMeetingProvider,OnlineMeetingJoinUrl:null===(n=l.OnlineMeeting)||void 0===n?void 0:n.JoinUrl,RequiredAttendees:v,OptionalAttendees:b};o.push(I)}return o}function u(e){var t;switch(e){case"Accepted":t="Accept";break;case"TentativelyAccepted":t="Tentative";break;case"Organizer":t="Organizer";break;case"Declined":t="Decline";break;case"NotResponded":t="NoResponseReceived";break;default:t="Unknown"}return t}function d(e){var t=[],n=[];return null==e||e.forEach((function(e){var r,a,o,i,c={Mailbox:{Name:null===(r=e.EmailAddress)||void 0===r?void 0:r.Name,EmailAddress:null===(a=e.EmailAddress)||void 0===a?void 0:a.Address},ResponseType:u(null===(o=e.Status)||void 0===o?void 0:o.Response),LastResponseTime:null===(i=e.Status)||void 0===i?void 0:i.Time};"Required"==e.Type?t.push(c):"Optional"==e.Type&&n.push(c)})),{requiredAttendees:t,optionalAttendees:n}}function s(e){var t,n,r,a;if(!e)return null;for(var i=0;i<e.length;i++){var c=e[i];if((a=c.EmailAddress)&&(n=a.Address,r=Object(o.a)().SessionSettings.UserEmailAddress,n===r||n&&r&&n.toLowerCase()==r.toLowerCase()))return null===(t=c.Status)||void 0===t?void 0:t.Time}return null}},3561:function(e,t,n){"use strict";var r=n(1735),a=n(2003),o=n(1520),i=n(1593),c=n(1447);var u=function(e,t){return e&&Object(i.a)(t,Object(c.a)(t),e)},d=n(1638);var s=function(e,t){return e&&Object(i.a)(t,Object(d.a)(t),e)},l=n(2e3),f=n(1999),v=n(1470);var b=function(e,t){return Object(i.a)(e,Object(v.a)(e),t)},I=n(1686);var O=function(e,t){return Object(i.a)(e,Object(I.a)(e),t)},j=n(1790),m=n(2002),p=n(1620),E=Object.prototype.hasOwnProperty;var y=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&E.call(e,"index")&&(n.index=e.index,n.input=e.input),n},g=n(1626);var h=function(e,t){var n=t?Object(g.a)(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},_=/\w*$/;var R=function(e){var t=new e.constructor(e.source,_.exec(e));return t.lastIndex=e.lastIndex,t},S=n(535),C=S.a?S.a.prototype:void 0,T=C?C.valueOf:void 0;var P=function(e){return T?Object(T.call(e)):{}},A=n(2001),F="[object Boolean]",N="[object Date]",w="[object Map]",M="[object Number]",x="[object RegExp]",D="[object Set]",L="[object String]",k="[object Symbol]",K="[object ArrayBuffer]",U="[object DataView]",q="[object Float32Array]",B="[object Float64Array]",V="[object Int8Array]",H="[object Int16Array]",z="[object Int32Array]",W="[object Uint8Array]",G="[object Uint8ClampedArray]",J="[object Uint16Array]",Z="[object Uint32Array]";var Q=function(e,t,n){var r=e.constructor;switch(t){case K:return Object(g.a)(e);case F:case N:return new r(+e);case U:return h(e,n);case q:case B:case V:case H:case z:case W:case G:case J:case Z:return Object(A.a)(e,n);case w:return new r;case M:case L:return new r(e);case x:return R(e);case D:return new r;case k:return P(e)}},Y=n(2025),$=n(1334),X=n(1448),ee=n(725),te="[object Map]";var ne=function(e){return Object(ee.a)(e)&&Object(p.a)(e)==te},re=n(1463),ae=n(1487),oe=ae.a&&ae.a.isMap,ie=oe?Object(re.a)(oe):ne,ce=n(546),ue="[object Set]";var de=function(e){return Object(ee.a)(e)&&Object(p.a)(e)==ue},se=ae.a&&ae.a.isSet,le=se?Object(re.a)(se):de,fe=1,ve=2,be=4,Ie="[object Arguments]",Oe="[object Function]",je="[object GeneratorFunction]",me="[object Object]",pe={};pe[Ie]=pe["[object Array]"]=pe["[object ArrayBuffer]"]=pe["[object DataView]"]=pe["[object Boolean]"]=pe["[object Date]"]=pe["[object Float32Array]"]=pe["[object Float64Array]"]=pe["[object Int8Array]"]=pe["[object Int16Array]"]=pe["[object Int32Array]"]=pe["[object Map]"]=pe["[object Number]"]=pe[me]=pe["[object RegExp]"]=pe["[object Set]"]=pe["[object String]"]=pe["[object Symbol]"]=pe["[object Uint8Array]"]=pe["[object Uint8ClampedArray]"]=pe["[object Uint16Array]"]=pe["[object Uint32Array]"]=!0,pe["[object Error]"]=pe[Oe]=pe["[object WeakMap]"]=!1;t.a=function e(t,n,i,d,v,I){var E,g=n&fe,h=n&ve,_=n&be;if(i&&(E=v?i(t,d,v,I):i(t)),void 0!==E)return E;if(!Object(ce.a)(t))return t;var R=Object($.a)(t);if(R){if(E=y(t),!g)return Object(f.a)(t,E)}else{var S=Object(p.a)(t),C=S==Oe||S==je;if(Object(X.a)(t))return Object(l.a)(t,g);if(S==me||S==Ie||C&&!v){if(E=h||C?{}:Object(Y.a)(t),!g)return h?O(t,s(E,t)):b(t,u(E,t))}else{if(!pe[S])return v?t:{};E=Q(t,S,g)}}I||(I=new r.a);var T=I.get(t);if(T)return T;I.set(t,E),le(t)?t.forEach((function(r){E.add(e(r,n,i,r,t,I))})):ie(t)&&t.forEach((function(r,a){E.set(a,e(r,n,i,a,t,I))}));var P=_?h?m.a:j.a:h?keysIn:c.a,A=R?void 0:P(t);return Object(a.a)(A||t,(function(r,a){A&&(r=t[a=r]),Object(o.a)(E,a,e(r,n,i,a,t,I))})),E}},3567:function(e,t,n){"use strict";var r=n(723),a=n(796),o=n(0),i=n(440),c=n(83),u=n(1708),d=n(2209),s=n(2248),l=n(319),f=n(765),v=n(3452),b=n(1446);var I=n(756),O="X-RedirectToCalendarService",j=7,m=null;function p(e,t,n,r,a){return void 0===a&&(a=void 0),Object(o.__awaiter)(this,void 0,void 0,(function(){var I,j,m,p,y,g,h,_,R;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:I=e.Id,j=e.mailboxInfo,p=null,y=null,(g=Object(i.a)(j)||{}).datapoint={customData:{itemId:I,fetchingMasterItem:n},jsonCustomData:function(e){var t=e.Body.ResponseMessages.Items[0];return{responseClass:t.ResponseClass,responseCode:t.ResponseCode}}},Object(c.i)("platform-redirectToCalendarService")&&(g.headers||(g.headers=new Headers),g.headers.set(O,"true")),o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,E().add((function(){return Object(s.a)({Header:Object(l.b)(),Body:Object(d.a)({EventIds:r,ItemShape:t,IncludeDeclinedMeetings:Object(c.i)("cal-surface-declinedMeetings")})},g)}))];case 2:return p=o.sent(),"Success"==(m=p.Body.ResponseMessages.Items[0]).ResponseClass?null!=m?null!=(h=m.Items[0])&&(!function(e){e.Locations?e.Locations=e.Locations.filter((function(e){return e})):e.Locations=[],e.Resources&&e.Resources.map((function(t){Object(v.c)(e.Locations,t.Mailbox.EmailAddress)||(e.Locations=e.Locations.filter((function(e){return e.DisplayName!==t.Mailbox.Name||Object(b.r)(e.PostalAddress)})),e.Locations.push(Object(b.g)(t.Mailbox.Name,t.Mailbox.EmailAddress)))}))}(h),a&&(h.ParentFolderId.Id=a),y={calendarEvent:Object(u.a)(h,e.mailboxInfo),error:null,responseCode:m.ResponseCode}):y={calendarEvent:null,error:"[getCalendarEventService] null response.",responseCode:m.ResponseCode}:(_="[getCalendarEventService] request failed. Message: "+m.MessageText+", ResponseCode: "+m.ResponseCode+", ResponseClass: "+m.ResponseClass,y={calendarEvent:null,error:_,responseCode:m.ResponseCode}),[3,5];case 3:return R=o.sent(),y={calendarEvent:null,error:R.message},[3,5];case 4:return Object(c.i)("cal-mf-diagnostics")&&Object(f.a)({action:"GetCalendarEvent",status:(null==m?void 0:m.ResponseClass)||"Error",response:null==p?void 0:p.Body}),[7];case 5:return[2,y]}}))}))}function E(){return null==m&&(m=Object(I.a)(j)),m}var y=n(29);function g(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(o.__assign)({__type:"GetBirthdayEventJsonRequest:#Exchange"},n)),Object(y.a)("GetBirthdayEvent",e,t)}var h=n(3629);var _=n(177);function R(e,t,n,c){void 0===c&&(c=!1);var u=Object(_.o)(t);return u&&3==u.CalendarFolderType?function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,a,c,u,d;return Object(o.__generator)(this,(function(s){switch(s.label){case 0:return n=e.Id,a=e.mailboxInfo,(c=Object(i.a)(a)||{}).datapoint={customData:{itemId:n},jsonCustomData:function(e){var t,n;return{responseClass:null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseClass,responseCode:null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseCode}}},[4,g({Header:Object(l.b)(),Body:(f={CalendarItemId:Object(r.a)({Id:n})},Object(o.__assign)({__type:"GetBirthdayEventRequest:#Exchange"},f))},c)];case 1:return null!=(u=s.sent()).Body&&"Success"==u.Body.ResponseClass&&null!=(d=u.Body.BirthdayEvent)?[2,{calendarEvent:Object(h.a)(d,t,void 0,e.mailboxInfo),error:null}]:[2,{calendarEvent:null,error:"[getBirthdayEventService] request failed"}]}var f}))}))}(e,t):p(e,n,c,[c?Object(a.a)({OccurrenceId:e.Id}):Object(r.a)({Id:e.Id})],Object(_.L)(u)?t:void 0)}n.d(t,"a",(function(){return R}))},3583:function(e,t,n){"use strict";var r=n(0),a=n(1568),o=n(2823),i=n(1545),c=n(1943),u=n(83),d=n(270);var s=n(2824),l=n(2825);function f(e){var t=[o.a];Object(u.i)("cal-time-panel-focusTime")&&t.push(s.a),Object(u.i)("cal-cmp-fluidCollaborativeSpace")&&t.push(l.a);var n={BaseShape:"IdOnly",MaximumBodySize:0,BodyType:"HTML",FilterHtmlContent:!0,InlineImageCustomDataTemplate:a.e,InlineImageUrlTemplate:a.f,AddBlankTargetToLinks:!0,CssScopeClassName:"cal_"+Math.ceil(65534*Math.random()+1).toString(16),AdditionalProperties:t,ImageProxyCapability:Object(u.i)("cal-bodyImageProxy")&&Object(i.a)()?c.a.OwaAndConnectorsProxy:c.a.None};if(!Object(u.i)("cal-mf-blockExternalContent"))return n;switch(e){case"Default":return Object(r.__assign)(Object(r.__assign)({},n),{BlockContentFromUnknownSenders:!0,BlockExternalImages:!0});case"WithBlockedExternalContent":return n;default:return Object(d.a)(e)}}n.d(t,"a",(function(){return f}))},3628:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3),a=Object(r.action)("logNotificationUpdateForDiagnostics",(function(e){return{notificationUpdateLog:e}}))},3629:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),a=n(9),o=n(2822),i=n(295),c=n(534),u=n(1624),d=n(377);function s(e,t,n,d){if(d=d||Object(i.d)(),!n){var s=Object(u.d)(t);s&&s.length>0&&(n=s.sort((function(e,t){var n=Object(c.l)(e),r=Object(c.l)(t);return n>r?-1:n<r?1:0}))[0])}var f=Object(o.a)(),v=function(e,t){var n=Object(a.lc)(e),r=l(n,Object(a.Cb)(t.start));return Object(c.t)(t,r)?r:l(n,Object(a.Cb)(t.end))}(e.Birthday,n),b=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f),e),{Subject:e.Name,Start:v,End:Object(a.e)(v,1),IsAllDayEvent:!0,ParentFolderId:{Id:t,mailboxInfo:d},ItemId:{Id:e.Id.Id,mailboxInfo:d},PersonId:e.PersonId,EffectiveRights:{Delete:!0,Modify:!0,Read:!0},FreeBusyType:"Free",ReminderIsSet:e.PopupReminderSettings[0].IsReminderSet,ReminderMinutesBeforeStart:e.PopupReminderSettings[0].ReminderMinutesBeforeStart,InboxReminders:e.EmailReminderSettings});return b||null}function l(e,t){var n=Object(a.xb)(e),r=Object(a.lb)(e),o=Object(d.a)(t,n),i=Math.min(r,o);return Object(a.lc)(t,n,i)}}}]);
//# sourceMappingURL=owa.42.js.map
self.scriptsLoaded['owa.42.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.42.js'] = (new Date()).getTime();