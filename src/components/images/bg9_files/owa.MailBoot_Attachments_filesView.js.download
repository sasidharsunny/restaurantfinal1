self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Attachments~filesView.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[216],{10948:function(t,e,n){"use strict";var r=n(0),a=n(4562),i=n(4561),o=n(1503),c=n(59),u=n(285),s=Object(u.action)("replaceAttachmentInWell")((function(t,e,n,r){var u=t.docViewAttachments.indexOf(e);u>-1?(Object(i.a)(t,e),t.docViewAttachments.splice(u,0,n)):(u=t.imageViewAttachments.indexOf(e))>-1?(Object(i.a)(t,e),t.imageViewAttachments.splice(u,0,n)):c.d("Can't find the oldAttachment when invoking replaceAttachmentInWell"),n.isCloudy||Object(a.a)(t,r,n.attachmentId),Object(o.o)(n.attachmentId)})),l=n(1811);function d(t,e,n,a,i){var o=Object(l.h)(Object(r.__assign)(Object(r.__assign)({},n.AttachmentId),{mailboxInfo:e.attachmentId.mailboxInfo}),n,a,i,!0,!1,null,null,!1);s(t,e,o,n.Size)}n.d(e,"a",(function(){return d}))},13176:function(t){t.exports=JSON.parse('{"a":"Mja"}')},13177:function(t){t.exports=JSON.parse('{"a":"llb"}')},13178:function(t){t.exports=JSON.parse('{"b":"elb","d":"flb","e":"glb","c":"hlb","f":"ilb","a":"jlb"}')},1379:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(1679);function a(t){return Object(r.a)().attachments.get(t.Id)}},1471:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"e",(function(){return o})),n.d(e,"d",(function(){return c}));var r="FileAttachment:#Exchange",a="ItemAttachment:#Exchange",i="ItemIdAttachment:#Exchange",o="ReferenceAttachment:#Exchange",c="LinkAttachment:#Exchange"},1500:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"g",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"b",(function(){return s})),n.d(e,"e",(function(){return l}));var r=n(3),a=Object(r.action)("ADD_SHARING_LINK",(function(t,e,n,r,a,i,o,c){return{linkId:t,url:e,sharingLinkIds:n,response:r,source:a,providerType:i,unwrappedUrl:o,creationDateTime:c}})),i=Object(r.action)("SHARING_LINK_REMOVED",(function(t,e){return{linkId:t,sharingLinkIds:e}})),o=Object(r.action)("DELETE_LINK",(function(t,e){return{linkId:t,targetWindow:e}})),c=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",(function(t,e,n,r){return{linkId:t,providerId:e,isTryAgain:n,targetWindow:r}})),u=Object(r.action)("ON_LINK_HAS_CHANGED",(function(t,e,n,r){return{linkId:t,recipientInfos:e,composeId:n,isCalendar:r}})),s=Object(r.action)("ADD_SHARING_LINK_TO_CONTAINER",(function(t,e){return{linkId:t,linkIdContainer:e}})),l=Object(r.action)("ON_FLUID_LINK_CREATED",(function(t,e,n,r){return{linkId:t,containerId:e,owaSource:n,url:r}}))},1505:function(t,e,n){"use strict";var r=n(3),a=n(20),i=n(1604),o={providers:new a.ObservableMap,loadState:i.a.NotLoaded,removalPending:new a.ObservableMap},c=Object(r.createStore)("fileProviderStore",o);e.a=c},1506:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a})),n.d(e,"c",(function(){return o}));var r=n(3),a=Object(r.action)("FILE_PROVIDER_ADDED",(function(t){return{providerViewState:t}})),i=Object(r.action)("FILE_PROVIDER_REMOVED",(function(t){return{providerType:t}})),o=Object(r.action)("PROVIDERS_LOADED",(function(t){return{providers:t}}))},1526:function(t,e,n){"use strict";n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return i})),n.d(e,"g",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return s})),n.d(e,"d",(function(){return l}));var r=n(3),a=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",(function(t,e){return{linkId:t,sharingDialogResponse:e}})),i=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",(function(t,e){return{linkId:t,newPermission:e}})),o=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",(function(t,e,n,r){return{linkId:t,newLinkUrl:e,oldLinkUrl:n,expirationDate:r}})),c=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",(function(t,e){return{linkId:t,actionStatus:e}})),u=Object(r.action)("CREATE_OR_UPDATE_SHARING_LINK",(function(t,e,n,r,a,i,o,c,u){return{linkId:t,sharingUrl:e,currentUrl:n,canonicalUrl:r,newPermissionLevel:a,providerType:i,composeId:o,recipientInfos:c,isCalendar:u}})),s=Object(r.action)("ADD_SHARING_LINK_INFO",(function(t,e){return{linkId:t,linkModel:e}})),l=Object(r.action)("TOKEN_UNAVAILABLE",(function(t){return{linkId:t}}))},1527:function(t,e,n){"use strict";var r;function a(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a})),function(t){t.noPermissionToShare="WarningNoPermissionToShare",t.getSharingInfoFailed="WarningGetSharingInfoFailed",t.linkHasExpired="WarningLinksHasExpired",t.linkWillExpire="WarningLinksWillExpire",t.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",t.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",t.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",t.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1528:function(t,e,n){"use strict";var r,a=n(77),i=n(1500),o=n(1526),c=n(2229);!function(t){t.PasteHtml="PasteHtml",t.InsertLinkFromToolbar="InsertLinkFromToolbar",t.InsertLinkFromAttachMenu="InsertLinkFromAttachMenu",t.AutoLink="AutoLink",t.ReplyOrForward="ReplyOrForward",t.LinkContextMenu="LinkContextMenu",t.Undo="Undo",t.EditorLoadedOrDraftOrReply="EditorLoadedOrDraftOrReply",t.RestoreCursor="RestoreCursor",t.ShareLinkCompose="ShareLinkCompose",t.NewFluidFile="NewFluidFile",t.Unknown="Unknown"}(r||(r={}));var u=n(2043),s=n(1693),l=n(1596),d=[r.PasteHtml,r.InsertLinkFromToolbar,r.AutoLink,r.ShareLinkCompose,r.InsertLinkFromAttachMenu];function f(t){var e=Object(l.a)(t);return e&&-1!==d.indexOf(e.source)}var h=n(2044);function m(t){var e=Object(l.a)(t);return e?{id:e.linkId,name:e.fileName,supportsDownsell:!1,currentPermissionLevel:e.permissionLevel,sharingInfo:e.sharingInfo,sharingTipsIgnored:e.sharingTipsIgnored,sharingRecipientsInfo:e.sharingRecipientsInfo,typeOfLink:f(t)?"newLink":"oldLink"}:null}var p=n(2228);function b(){return Object(p.a)().sharingLinks.size}var v=n(2230);n.d(e,"q",(function(){return O})),n.d(e,"u",(function(){return I})),n.d(e,"y",(function(){return j})),n.d(e,"w",(function(){return _})),n.d(e,"v",(function(){return A})),n.d(e,"t",(function(){return C})),n.d(e,"x",(function(){return y})),n.d(e,"s",(function(){return w})),n.d(e,"r",(function(){return S})),n.d(e,"B",(function(){return g})),n.d(e,"c",(function(){return i.a})),n.d(e,"d",(function(){return i.b})),n.d(e,"e",(function(){return i.c})),n.d(e,"g",(function(){return i.d})),n.d(e,"E",(function(){return i.g})),n.d(e,"z",(function(){return i.e})),n.d(e,"A",(function(){return i.f})),n.d(e,"F",(function(){return o.e})),n.d(e,"G",(function(){return o.f})),n.d(e,"H",(function(){return o.g})),n.d(e,"D",(function(){return o.c})),n.d(e,"f",(function(){return o.b})),n.d(e,"C",(function(){return c.b})),n.d(e,"a",(function(){return r})),n.d(e,"n",(function(){return u.a})),n.d(e,"h",(function(){return s.a})),n.d(e,"i",(function(){return s.b})),n.d(e,"p",(function(){return s.c})),n.d(e,"o",(function(){return f})),n.d(e,"b",(function(){return h.a})),n.d(e,"l",(function(){return l.a})),n.d(e,"k",(function(){return m})),n.d(e,"j",(function(){return b})),n.d(e,"m",(function(){return v.a}));var g=new a.c((function(){return Promise.all([n.e(1),n.e(33),n.e(70),n.e(610)]).then(n.bind(null,16638))})),O=new a.b(g,(function(t){return t.addRecipientsIntoLink})),I=new a.b(g,(function(t){return t.removeRecipientsFromLink})),j=new a.b(g,(function(t){return t.updateRecipientPermissionInfos})),_=new a.b(g,(function(t){return t.setGetPermissionInfoFailure})),A=new a.b(g,(function(t){return t.resetSharingRecipientsInfo})),C=new a.b(g,(function(t){return t.ignoreSharingTip})),y=new a.b(g,(function(t){return t.setLinkActionStatus})),w=new a.b(g,(function(t){return t.getSharingTipRecipientInfo})),S=new a.b(g,(function(t){return t.createCloudFileFromSharingLink}))},1536:function(t,e,n){"use strict";n.d(e,"l",(function(){return h})),n.d(e,"n",(function(){return m})),n.d(e,"k",(function(){return p})),n.d(e,"m",(function(){return b}));var r=n(77),a=n(1754);n.d(e,"b",(function(){return a.a}));var i=n(1700);n.d(e,"i",(function(){return i.a}));n(1505);var o=n(1506);n.d(e,"d",(function(){return o.a})),n.d(e,"e",(function(){return o.b})),n.d(e,"o",(function(){return o.c}));var c=n(1701);n.d(e,"a",(function(){return c.b}));var u=n(1567);n.d(e,"g",(function(){return u.a})),n.d(e,"h",(function(){return u.b}));var s=n(1691);n.d(e,"j",(function(){return s.a}));var l=n(1604);n.d(e,"c",(function(){return l.a}));var d=n(1680);n.d(e,"f",(function(){return d.b}));var f=new r.c((function(){return Promise.all([n.e(1),n.e(549)]).then(n.bind(null,2984))})),h=new r.b(f,(function(t){return t.loadProviders})),m=new r.b(f,(function(t){return t.removeFileProvider})),p=new r.b(f,(function(t){return t.addFileProvider})),b=new r.b(f,(function(t){return t.removeAndAddFileProvider}))},1553:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(1471);function a(t){return(t.__type||t.OwsTypeName)===r.e}},1567:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));var r=n(0),a=n(1505),i=function(){return Object(r.__spread)(Object(a.a)().providers.values())},o=function(t){return Object(a.a)().providers.get(t)||null}},1596:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(2228),a=n(1693);function i(t){var e=Object(r.a)(),n=Object(a.b)(t);return e.sharingLinks.get(n)}},1604:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Loaded=0]="Loaded",t[t.Loading=1]="Loading",t[t.NotLoaded=2]="NotLoaded",t[t.Throttled=3]="Throttled"}(r||(r={}))},1612:function(t,e,n){"use strict";var r=n(0),a=n(2105),i=n(285),o=Object(i.action)("addInfoBarMessage")((function(t,e,n){if(t){-1==t.infoBarIds.indexOf(e)?t.infoBarIds.push(e):t.infoBarIds=Object(r.__spread)(t.infoBarIds);var i=t.infoBarHostKey;n&&(a.b[i]||(a.b[i]={}),a.b[i][e]=n)}}));e.a=o},1644:function(t,e,n){"use strict";var r=n(0),a=n(2105),i=n(3);var o=Object(i.mutatorAction)("removeInfoBarMessages",(function(t,e){t&&(Array.isArray(e)?e:e?[e]:t.infoBarIds?Object(r.__spread)(t.infoBarIds):[]).forEach((function(e){return function(t,e){var n=t.infoBarIds&&t.infoBarIds.indexOf(e);n>=0&&t.infoBarIds.splice(n,1);var r=t.infoBarHostKey;a.b[r]&&(delete a.b[r][e],0===Object.keys(a.b[r]).length&&delete a.b[r])}(t,e)}))}));e.a=o},1680:function(t,e,n){"use strict";var r=n(0),a=n(29);function i(t){return Object(r.__assign)({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},t)}function o(t){var e,n,r=i({ProviderType:t});return void 0===(e=r)||e.__type||(e=i(e)),Object(a.a)("GetNewAttachmentDataProviderCreationInfo",e,n)}function c(t){return Object(r.__assign)({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},t)}function u(t){var e,n,r=c({ProviderType:t});return void 0===(e=r)||e.__type||(e=c(e)),Object(a.a)("GetAttachmentDataProviderCreator",e,n)}var s=n(2026),l=n(1953);n.d(e,"a",(function(){return g})),n.d(e,"b",(function(){return j}));var d="code",f="token",h=3e3,m=3;function p(t){return{state:t}}function b(t){return t.state}function v(t){return t.code}function g(t,e,n,a,i){var c={providerType:t,getAuthUrlInfo:null,getCSRFToken:b,getOAuthCode:v};return function t(e,n,a,i,c,l,d){return Object(r.__awaiter)(this,void 0,void 0,(function(){var f,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),f=void 0,7!==e&&9!==e&&8!==e?[3,2]:[4,u(e)];case 1:return m=r.sent(),f=m.AttachmentDataProviderCreator.ProviderAppKey,a=m.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,o(e)];case 3:m=r.sent(),f=m.ProviderAppKey,r.label=4;case 4:return n.getAuthUrlInfo=Object(s.d)(e,a,i,f,c,l),[3,6];case 5:return r.sent(),d>0&&setTimeout((function(){return t(e,n,a,i,c,l,--d)}),h),[3,6];case 6:return[2]}}))}))}(t,c,e,n,a,i,m),c}var O=null;function I(){if(!O){if(O={},Object(l.a)(3)&&(O[3]=g(3,"https://app.box.com/api/oauth2/authorize",Object(s.c)(3),d,p)),Object(l.a)(2)&&(O[2]=g(2,"https://www.dropbox.com/oauth2/authorize",Object(s.b)(2),d,p)),Object(l.a)(6)){var t=g(6,"https://www.facebook.com/dialog/oauth",Object(s.b)(6),f,(function(t){return{state:t,scope:"user_photos,email"}}));t.getCSRFToken=b,t.getOAuthCode=function(t){return t.access_token},O[6]=t}if(Object(l.a)(5)){var e=g(5,"https://accounts.google.com/o/oauth2/auth",s.a+"/ADPRedirect.aspx",d,(function(t){var e={state:t,provider:5..toString(),url:Object(s.b)()};return{state:JSON.stringify(e),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}}));e.getCSRFToken=function(t){return JSON.parse(t.state).state},O[5]=e}Object(l.a)(1)&&(O[1]=g(1,"https://login.live.com/oauth20_authorize.srf",Object(s.c)(1),d,(function(t){return{state:t,scope:"wl.basic onedrive.readwrite wl.offline_access"}}))),Object(l.a)(7)&&(O[7]=g(7,"",Object(s.c)(7),d,p)),Object(l.a)(8)&&(O[8]=g(8,"",Object(s.c)(8),d,p)),Object(l.a)(9)&&(O[9]=g(9,"",Object(s.c)(9),d,p))}return O}function j(t){var e=I();return t in e?e[t]:null}},1691:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(1505);function a(){return Object(r.a)().loadState}},1693:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return c}));var r=n(83),a="_ODSPPSL";function i(t){return Object(r.i)("doc-link-savePermission")&&t&&-1!==t.indexOf(a)?t.substring(0,t.length-a.length):t}function o(t){return!!Object(r.i)("doc-link-savePermission")&&t.lastIndexOf(a)===t.length-a.length}function c(t,e){return!Object(r.i)("doc-link-savePermission")||2!==e&&1!==e?t:t+a}},1694:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.InProgress=0]="InProgress",t[t.Failed=1]="Failed",t[t.Succeeded=2]="Succeeded"}(r||(r={}))},1700:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2077),a=n(1973),i=n(2041),o=n(12),c=n(270);function u(t,e){if(void 0===e&&(e=!1),e)return"";switch(t){case 0:return Object(o.b)(i.b);case 1:return Object(o.b)(i.a);case 2:case 9:return Object(o.b)(r.b);case 3:case 7:return Object(o.b)(r.a);case 5:return Object(o.b)(r.e);case 6:return Object(o.b)(r.d);case 4:return Object(o.b)(r.f);case 10:return Object(o.b)(a.b);case 8:return Object(o.b)(r.c);default:return Object(c.a)(t)}}},1701:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o}));var r,a=n(0);!function(t){t[t.Groups=1e4]="Groups"}(r||(r={}));var i=Object.freeze([1,3,2,6,5,7,8,9]),o=Object.freeze(Object(a.__spread)(i,[0,4,10]))},1718:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(3),a=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(t){return{id:t}}))},1719:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.ignore=0]="ignore",t[t.refreshExpiration=1]="refreshExpiration",t[t.changePermission=2]="changePermission",t[t.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1754:function(t,e,n){"use strict";var r;!function(t){t[t.None=0]="None",t[t.Images=1]="Images"}(r||(r={})),e.a=r},1851:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0);function a(t){return Object(r.__assign)({__type:"Constant:#Exchange"},t)}},1852:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0);function a(t){return Object(r.__assign)({__type:"RestrictionType:#Exchange"},t)}},1868:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0);function a(t){return Object(r.__assign)({__type:"FieldURIOrConstantType:#Exchange"},t)}},1874:function(t,e,n){"use strict";n.d(e,"h",(function(){return s})),n.d(e,"i",(function(){return l})),n.d(e,"f",(function(){return d})),n.d(e,"k",(function(){return f})),n.d(e,"m",(function(){return h})),n.d(e,"e",(function(){return m})),n.d(e,"g",(function(){return p})),n.d(e,"j",(function(){return b})),n.d(e,"l",(function(){return v}));var r=n(77),a=n(1718);n.d(e,"n",(function(){return a.a}));var i=n(1694);n.d(e,"a",(function(){return i.a}));var o=n(1527);n.d(e,"d",(function(){return o.b})),n.d(e,"c",(function(){return o.a}));var c=n(1719);n.d(e,"b",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(1),n.e(33),n.e(70),n.e(724)]).then(n.bind(null,2900))})),s=new r.b(u,(function(t){return t.getSharingInformation})),l=new r.b(u,(function(t){return t.getSharingIssuesForSharingData})),d=new r.b(u,(function(t){return t.getInfoBarCreator})),f=new r.b(u,(function(t){return t.hasLargeDLRecipient})),h=new r.b(u,(function(t){return t.hasRecipientExpansionFailure})),m=new r.b(u,(function(t){return t.getGroupsAndSmallDLs})),p=new r.b(u,(function(t){return t.getInvididualRecipients})),b=new r.b(u,(function(t){return t.hasGetRecipientPermissionFailed})),v=new r.b(u,(function(t){return t.logSharingTipChangesForLinkRemoval}))},1903:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Initial=0]="Initial",t[t.Adaptive=1]="Adaptive",t[t.Show=2]="Show",t[t.Hide=3]="Hide",t[t.AlwaysHide=4]="AlwaysHide"}(r||(r={}))},1917:function(t,e,n){"use strict";var r=function(){function t(){this.eventDictionary={}}return t.prototype.on=function(t,e,n){return(this.eventDictionary[t]||(this.eventDictionary[t]=[])).push({callback:e,callbackThis:n}),this},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=(this.eventDictionary[t]||[]).slice();return r.forEach((function(t){return t.callback.apply(t.callbackThis,e)})),this},t.prototype.off=function(t,e){var n=this.eventDictionary[t];if(n){var r=n.filter((function(t){return t.callback!==e}));r.length?this.eventDictionary[t]=r:delete this.eventDictionary[t]}return this},t.prototype.once=function(t,e,n){var r=this,a=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return r.off(t,a),e.apply(n,i)};return(this.eventDictionary[t]||(this.eventDictionary[t]=[])).push({callback:a,callbackThis:n}),this},t}();e.a=r},1919:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Blank=0]="Blank",t[t.Loading=1]="Loading",t[t.Error=2]="Error",t[t.Custom=3]="Custom",t[t.Image=4]="Image",t[t.Wac=5]="Wac",t[t.Audio=6]="Audio",t[t.Video=7]="Video",t[t.Text=8]="Text",t[t.NativePdf=9]="NativePdf",t[t.PdfJs=10]="PdfJs",t[t.IFrame=11]="IFrame"}(r||(r={}))},1953:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(1384),a=n(320),i=n(270),o=n(83);function c(t){var e=Object(r.a)();switch(t){case 5:return(null==e?void 0:e.GoogleDriveAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return(null==e?void 0:e.BoxAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-box");case 2:return(null==e?void 0:e.DropboxAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-dropbox");case 6:return(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-facebook");case 1:return!!Object(a.a)()||(null==e?void 0:e.OnedriveAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled);case 10:return Object(o.i)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-wopiClient");default:return Object(i.a)(t)}}},1973:function(t){t.exports=JSON.parse('{"a":"cga","b":"dga"}')},2014:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"e",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"d",(function(){return s})),n.d(e,"b",(function(){return l}));var r=n(77),a=new r.c((function(){return n.e(900).then(n.bind(null,2987))})),i=new r.b(a,(function(t){return t.extractFileUrlFromOfficeSharePointLink})),o=new r.b(a,(function(t){return t.isLinkPrefixedWithBaseUrl})),c=new r.b(a,(function(t){return t.isSharePointLink})),u=new r.b(a,(function(t){return t.isSharePointServiceGeneratedLink})),s=new r.b(a,(function(t){return t.isOfficeSharePointLink})),l=new r.b(a,(function(t){return t.getParsedQueryStringFromUrl}))},2026:function(t,e,n){"use strict";var r=n(722),a=n(2);function i(t,e,n){if(!t||!e||!n)throw new Error("Key and Value parameters should not be null");return t.indexOf("?")>0?t+"&"+e+"="+n:t+"?"+e+"="+n}n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return u})),n.d(e,"d",(function(){return s}));var o=Object(a.G)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(t){var e=t?encodeURIComponent("?provider="+t):"",n=t&&6===t?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.l)()+"/mail/"+n+e}function u(t){var e=Object(r.l)()+"/mail/AddFileProvider.html",n=encodeURIComponent("provider="+t+"&url="+e);return o+"/ADPRedirect.aspx?"+n}function s(t,e,n,r,a,o){return function(){var t=function(){for(var t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),e=t.length-1,n=[],r=0;r<16;r++)n.push(t[Math.round(Math.random()*e)]);return"owa_csrf_token_"+n.join("")}(),c=i(e,"client_id",r);if(c=i(c,"redirect_uri",n),c=i(c,"response_type",a),o){var u=o(t);c=Object.keys(u).reduce((function(t,e){return i(t,e,u[e])}),c)}return{authUrl:c,redirectUrl:n,csrfToken:t}}}},2041:function(t){t.exports=JSON.parse('{"b":"qga","a":"rga"}')},2043:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(1326);function a(t){var e=(Object(r.a)(t)||"").toLowerCase();return!!t&&".fluid"===e}},2044:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.none=0]="none",t[t.refreshing=1]="refreshing",t[t.refreshFailed=2]="refreshFailed",t[t.refreshSucceeded=3]="refreshSucceeded",t[t.attachingAsACopy=4]="attachingAsACopy",t[t.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(r||(r={}))},2077:function(t){t.exports=JSON.parse('{"b":"kga","a":"lga","e":"mga","d":"nga","f":"oga","c":"pga"}')},2105:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return a}));var r={};function a(t,e){var n,a=t.infoBarHostKey;return null===(n=r[a])||void 0===n?void 0:n[e]}},2106:function(t,e,n){"use strict";n.d(e,"n",(function(){return s})),n.d(e,"m",(function(){return l})),n.d(e,"j",(function(){return d})),n.d(e,"i",(function(){return f})),n.d(e,"k",(function(){return h})),n.d(e,"f",(function(){return m})),n.d(e,"a",(function(){return p})),n.d(e,"c",(function(){return b})),n.d(e,"g",(function(){return v})),n.d(e,"d",(function(){return g})),n.d(e,"h",(function(){return O})),n.d(e,"e",(function(){return j})),n.d(e,"l",(function(){return _})),n.d(e,"b",(function(){return A}));var r=n(2520),a=n(2310),i=n(57),o=n(1592),c=n(1995),u=n(2218);function s(){return Object(i.e)()||Object(i.f)()}function l(t){return function(t){if(t.length<2)return!1;var e=t[0]-parseInt(o.b),n=t[1]-parseInt(o.c);return 0==e&&n>=0}("string"==typeof t?t.split(".").map((function(t){return parseInt(t)})):[])}function d(t){var e="string"==typeof t?t.split("."):[];return e.length&&e[0]!=o.b}function f(){return Object(i.r)()&&(Object(i.i)()&&Object(i.b)()[0]==o.i&&Object(a.a)()||Object(r.a)())}function h(t){return 0!==t}function m(t){var e=[];e.push(t.UserEmailAddress),e.push(t.LogonEmailAddress),e.push(t.UserPrincipalName),e.push(t.UserLegacyExchangeDN);var n=t.UserProxyAddresses;return n&&n.length>0&&n.forEach((function(t){e.indexOf(t)>=0||e.push(t)})),e}function p(t){var e=65001;return t.UseGB18030?e=54936:t.UseISO885915&&(e=28605),e}function b(t){return{AllowUserChoiceOfSigningCertificate:t.AllowUserChoiceOfSigningCertificate,IncludeCertificateChainWithoutRootCertificate:t.IncludeCertificateChainWithoutRootCertificate,IncludeCertificateChainAndRootCertificate:t.IncludeCertificateChainAndRootCertificate,EncryptTemporaryBuffers:t.EncryptTemporaryBuffers,SignedEmailCertificateInclusion:t.SignedEmailCertificateInclusion,IncludeSmimeCapabilitiesInMessage:t.IncludeSMIMECapabilitiesInMessage,CopyRecipientHeaders:t.CopyRecipientHeaders,OnlyUseSmartCard:t.OnlyUseSmartCard,EncryptionAlgorithms:t.EncryptionAlgorithms,SigningAlgorithms:t.SigningAlgorithms}}function v(t,e){var n=Object(u.a)().ClearSign;return e||t&&!n?c.a:o.e}function g(t){return btoa(unescape(encodeURIComponent(t)))}function O(t,e){var n=Object(u.a)();return t&&e?n.TripleWrapSignedEncryptedMail?14:12:t?n.ClearSign?11:10:6}function I(){return(Math.floor(4026531839*Math.random())+268435456).toString(16)}function j(){return o.m+I()+I()+I()+I()}function _(t,e){return e.IsInline&&-1===t.indexOf(e.ContentId)}function A(){return o.d+I()+"@"+I()+"."+I()}},2218:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(276);function a(){return Object(r.a)().smime}},2228:function(t,e,n){"use strict";var r=n(20),a=n(3),i={sharingLinks:new r.ObservableMap({})},o=Object(a.createStore)("sharingLinkStore",i);e.a=o},2229:function(t,e,n){"use strict";function r(t){return void 0!==t.recipients}function a(t){return void 0!==t.length}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return a}))},2230:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0),a=n(2014),i=n(97),o=n(317);function c(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,a.b.import()];case 1:return e=n.sent(),[2,u(e(t))]}}))}))}function u(t){if(!Object(i.b)(null==t?void 0:t.nav)){var e={nav:t.nav};return Object(o.stringify)(e)}return null}},2262:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0);function a(t){return Object(r.__assign)({__type:"And:#Exchange"},t)}},2310:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(57);function a(){if(Object(r.i)())try{return new ActiveXObject("htmlfile"),!0}catch(t){return!1}return!1}},2520:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(57),a=n(1592);function i(){return Object(r.e)()&&Object(r.o)([a.f])||Object(r.g)()&&Object(r.o)([a.h])||Object(r.f)()&&Object(r.o)([a.g])}},265:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));var r=n(4),a=n(33);function i(){var t,e=Object(a.a)("DefaultAnchorMailbox");return null==e||0==e.trim().length||(t=Object(r.b)(window.location),Object.keys(t).indexOf("anonRetry")>=0)}function o(){var t=Object(r.b)(window.location);return Object.keys(t).indexOf("anonymous")>=0}},2650:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1592),a=function(t,e){return t.substring(0,e.length)===e},i=function(t,e){return t.substring(t.length-e.length)===e},o=function(t){return t.ContentType&&(a(t.ContentType,r.v)||a(t.ContentType,r.l))},c=function(t){return t.ContentType&&t.ContentType===r.j};function u(t){return(null==t?void 0:t.Name)&&i(t.Name,r.t)&&(o(t)||c(t))}},2778:function(t,e,n){"use strict";n.r(e);var r=n(1528),a=n(3);function i(t,e){e&&!t.includes(e)&&t.push(e)}Object(a.mutator)(r.c,(function(t){i(t.sharingLinkIds,t.linkId)})),Object(a.mutator)(r.E,(function(t){var e,n,r;e=t.sharingLinkIds,n=t.linkId,-1!==(r=e.indexOf(n))&&e.splice(r,1)})),Object(a.mutator)(r.d,(function(t){i(t.linkIdContainer,t.linkId)}));var o=n(6145);Object(a.mutator)(o.a,(function(t){var e=t.attachmentWell,n=t.message;e.announcedComponentMessage=n}));var c=n(0),u=n(13176),s=n(12),l=Object(a.action)("REFRESH_SHARING_TIPS_ATTACHMENT_WELL",(function(t,e,n,r,a){return{attachmentWellViewState:t,parentItemId:e,recipientInfo:n,infoBarIds:r,infoBar:a}})),d=n(6992),f=n(10948),h=n(1379);function m(t){var e,n=t.docViewAttachments.concat(t.imageViewAttachments);return(e=n,e.filter((function(t){return t.isCloudy})).map((function(t){return function(t,e){if(1!==t.type)return null;var n=t.model;return{id:t.id,name:n.Name,supportsDownsell:e,currentPermissionLevel:n.PermissionType,sharingInfo:t.info.sharingInfo,sharingRecipientsInfo:{recipientPermissionInfos:[]},sharingTipsIgnored:[],typeOfLink:"referenceAttachment"}}(Object(h.a)(t.attachmentId),t.strategy.isConvertCloudyToClassicSupported)}))).filter((function(t){var e;return null===(e=t.sharingInfo)||void 0===e?void 0:e.getSharingInfoSucceeded}))}var p=n(269),b=n(1612),v=n(1644),g=n(1811),O=n(1874);function I(t,e,n,r){return j(t,m(e),n,[],null,r,!0,null)}function j(t,e,n,r,a,i,o,c){for(var u,s=0;s<t.length;s++){var l=_(t[s],e,n,r,a,i,o,c);l&&(u=l)}if("function"==typeof u){var d=u(null);if((null==d?void 0:d.messageParts)&&d.messageParts.length>0&&"string"==typeof d.messageParts[0])return d.messageParts[0]}else if("object"==typeof u&&u.length>0)return u[0];return null}function _(t,e,n,r,a,i,o,c){var u=i(e,t,n,o,c);return Object(v.a)(a,[t]),u&&(Object(b.a)(a,t,u),r.push(t)),u}Object(a.orchestrator)(l,(function(t){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var e,n,r,a,i,o,l,b,v,I,_;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:return e=t.attachmentWellViewState,n=t.parentItemId,r=t.recipientInfo,a=t.infoBarIds,i=t.infoBar,o=m(e),l=new p.a("AttachmentRefreshSharingTips"),b=function(t){var r=Object(d.a)(e,t);if(r){var a=Object(h.a)(r.attachmentId);return{text:Object(s.b)(u.a),action:function(){var t=a.model;Object(p.p)("SharingTipsConvertToClassic"),Object(g.f)(r,n.Id,t.AttachLongPathName,t.PermissionType,(function(t,n,r,a){Object(f.a)(e,t,n,r,a)}),1)}}}return null},v=Object(O.d)(),I=[],[4,O.f.import()];case 1:return _=c.sent(),j(v,o,r,I,i,_,!1,b),function(t,e){var n=Object(O.d)(),r=t.filter((function(t){return-1!==n.indexOf(t)})),a=e.filter((function(t){return-1===r.indexOf(t)})),i=r.filter((function(t){return-1===e.indexOf(t)}));0!==a.length&&Object(p.p)("AttachmentSharingTipAdded",a);0!==i.length&&Object(p.p)("AttachmentSharingTipsRemoved",i)}(a,I),Promise.resolve().then((function(){return l.end()})),[2]}}))}))}));Object(a.orchestrator)(o.a,(function(t){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(c.__generator)(this,(function(n){return e=t.attachmentWell,null!==t.message&&setTimeout((function(){Object(o.a)(e,null)}),2e3),[2]}))}))}));var A=n(8512),C=n(74),y=n(2933),w=n(2836);var S=n(6165),T=n(2650),F=n(5451),E=n(2837),k=n(4562);var P=Object(C.d)("initializeAttachments",F.a.AttachmentWellInitialization)((function(t,e,n,r,a,i,o,u,s){if(t){var l=function(t){return t?Object(g.o)().filter((function(e){return!t.includes(e)})):null}(i);u&&n.docViewAttachments.length>0&&n.docViewAttachments.forEach((function(t){var e;(function(t){var e=Object(h.a)(t);if(null==e?void 0:e.model){return"IPM.Appointment"===e.model.EmbeddedItemClass}return!1})(t.attachmentId)&&((e=t.strategy).previewMethod=w.a.Unsupported,e.supportedOpenActions=e.supportedOpenActions.filter((function(t){return t!==y.a.Preview})))})),n.isInitialized||t.forEach((function(t){!function(t,e,n,r,a,i,o){if(!("application/x-sharing-metadata-xml"===t.ContentType||o&&Object(T.a)(t))){var u=Object(g.h)(Object(c.__assign)(Object(c.__assign)({},t.AttachmentId),{mailboxInfo:e}),t,n.isReadOnly,!0,r,o,null,a,!0),s=!!n.parentItemIdMap;if(t.IsInline&&t.__type!==E.d&&t.ContentId&&""!=t.ContentId&&"unknown"!=t.ContentId.toLowerCase()?n.inlineAttachments.push(Object(g.i)(t.AttachmentId,t.AttachmentId.Id,!0,4)):Object(S.a)(t)&&!s?n.imageViewAttachments.push(u):n.docViewAttachments.push(u),u.isCloudy){var l=Object(h.a)(u.attachmentId);l.requiresFetchingSharingInformation&&i&&Object(g.m)(l)}else Object(k.a)(n,t.Size,t.AttachmentId)}}(t,e,n,r,l,o,s)})),n.supportedMenuActions=l,n.isInitialized=!0}}));var x=n(285),B=Object(x.action)("reinitializeAttachments")((function(t,e,n,r,a){t&&(n.docViewAttachments=[],n.imageViewAttachments=[],n.inlineAttachments=[],n.isInitialized=!1,P(t,e,n,r,!1,a))})),R=n(4558);function N(t,e){var n=Object(R.a)(!1,void 0===e,t);if(e){var r=e.attachments,a=e.mailboxInfo,i=e.parentItemId;P(r,a,n,!0,!0,null,i)}return n}var D=n(6321);function L(t,e){var n=Object(R.a)(!0,!1,"");return Object(c.__assign)(Object(c.__assign)({},n),{parentItemIdMap:t,itemReceivedTimeMap:e,isVisible:!1,maxHeight:0})}var U=n(3907),M=n(2100),W=n(2106),H=function(t,e,n,r){if(t){var a=t.docViewAttachments,i=t.imageViewAttachments,o=t.inlineAttachments.filter((function(t){var r=Object(h.a)(t.attachmentId);if((null==r?void 0:r.model)&&"HTML"===n){var a=e;return a&&!Object(W.l)(a,r.model)}return!1})),u=Object(c.__spread)(a,i,o);return r?u.filter((function(t){return Object(M.b)(t.attachmentId.Id)})):u.filter((function(t){return!Object(M.b)(t.attachmentId.Id)}))}return[]},z=n(7286),V=n(5383),G=n(6164),q=n(7239),K=n(1443),Q=n(1512),J=n(1553);function Z(t,e,n,r,a,i){return Object(c.__awaiter)(this,void 0,void 0,(function(){var o,u,s,l;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:return[4,Q.c.import()];case 1:return o=c.sent(),u=n.filter((function(t){return e=t,!(Object(J.a)(e)&&e.IsInline);var e})).map(o),s=u.filter((function(t){return t.fileType===K.a.Cloud})),(l=u.filter((function(t){return t.fileType===K.a.AttachmentItem}))).length>0&&X(e,t,l,r,!1,!1,a,i),s.length>0&&X(e,t,s,r,!1,!0,a,i),[2]}}))}))}function X(t,e,n,r,a,i,o,u){var s={isInline:a,isHiddenInline:!1},l=i?Object(c.__assign)(Object(c.__assign)({},s),{shouldShare:!0}):Object(c.__assign)(Object(c.__assign)({},s),{shouldShare:!1});Q.f.import().then((function(a){a(t,e,n,r,l,null,o,u)}))}var Y=n(6194),$=Object(a.mutatorAction)("mergeToConversationAttachmentWell",(function(t,e,n,r){t&&(t.docViewAttachments.forEach((function(t){tt(t,e,n,r)})),t.imageViewAttachments.forEach((function(t){tt(t,e,n,r)})))}));function tt(t,e,n,r){e.parentItemIdMap[t.attachmentId.Id]||(e.docViewAttachments.push(Object(c.__assign)({},t)),e.parentItemIdMap[t.attachmentId.Id]=n,e.itemReceivedTimeMap[t.attachmentId.Id]=r)}var et=Object(a.mutatorAction)("sortConversationAttachmentWell",(function(t,e){t.docViewAttachments=t.docViewAttachments.sort((function(n,r){return(e?1:-1)*(new Date(t.itemReceivedTimeMap[n.attachmentId.Id]).getTime()-new Date(t.itemReceivedTimeMap[r.attachmentId.Id]).getTime())}))})),nt=n(2247),rt=Object(a.mutatorAction)("convertImageViewAttachmentToInlineAttachment",(function(t,e,n){var r=Object(h.a)(e.attachmentId);if(r){var a=t.imageViewAttachments,i=t.inlineAttachments,o=a.indexOf(e);if(o>=0){a.splice(o,1),r.model.ContentId=n,r.model.IsInline=!0,r.model.AttachmentOriginalUrl=Object(nt.b)(e.attachmentId,1);var c=Object(g.i)(e.attachmentId,e.attachmentId.Id,!1);c.status=3,i.push(c)}}})),at=n(8519);n.d(e,"refreshSharingTipsAttachmentWell",(function(){return l})),n.d(e,"addAttachmentIntoWellBeforeUpload",(function(){return A.a})),n.d(e,"initializeAttachments",(function(){return P})),n.d(e,"reinitializeAttachments",(function(){return B})),n.d(e,"getAttachmentWellForCompose",(function(){return N})),n.d(e,"getAttachmentWellInitialValue",(function(){return R.a})),n.d(e,"getAvailableLocalAttachmentSize",(function(){return D.a})),n.d(e,"getConversationAttachmentWellInitialValue",(function(){return L})),n.d(e,"getMaxClassicAttachmentsSize",(function(){return U.a})),n.d(e,"getAllValidAttachments",(function(){return H})),n.d(e,"createAttachmentFullViewStateAndStoreBackingModel",(function(){return z.a})),n.d(e,"setInlineAttachmentStatus",(function(){return V.a})),n.d(e,"createAttachmentFullViewState",(function(){return G.a})),n.d(e,"createAttachmentsViaQueueManager",(function(){return q.a})),n.d(e,"deleteAttachmentViaQueueManager",(function(){return q.b})),n.d(e,"createAttachmentsFromRecentAttachments",(function(){return Z})),n.d(e,"createAttachmentFileFromExistingMailboxAttachment",(function(){return Y.a})),n.d(e,"mergeToConversationAttachmentWell",(function(){return $})),n.d(e,"sortConversationAttachmentWell",(function(){return et})),n.d(e,"convertImageViewAttachmentToInlineAttachment",(function(){return rt})),n.d(e,"getLastCloudyAttachmentsSharingIssueForBlockOnSend",(function(){return I})),n.d(e,"uploadLocalFile",(function(){return at.a}))},2837:function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o}));var r="ReferenceAttachment:#Exchange",a=1024,i=1048576,o="Not support special characters"},3229:function(t,e,n){"use strict";var r,a=n(3),i={uploadFolders:new(n(20).ObservableMap)},o=Object(a.createStore)("attachmentsUploadFolderStore",i),c=n(96);!function(t){t.User="User",t.Group="Group"}(r||(r={}));var u=Object(a.action)("preloadUploadFolder",(function(t,e){return void 0===t&&(t=Object(c.h)().SessionSettings.UserEmailAddress),void 0===e&&(e=r.User),{mailboxId:t,uploadFolderMailboxType:e}})),s=Object(a.action)("uploadFolderLoaded",(function(t,e){return{mailboxId:t,uploadFolder:e}}));Object(a.mutator)(s,(function(t){var e=t.mailboxId,n=t.uploadFolder;o().uploadFolders.set(e,n)}));var l=n(0),d=n(3951),f=n(12),h=n(270),m=n(97),p="Email attachments";function b(t){switch(t){case r.Group:return p;case r.User:return Object(f.b)(d.a);default:return Object(h.a)(t)}}var v=n(29);var g=n(1418);function O(t,e){switch(e){case r.Group:var n=new Headers;return Object(g.f)(t,n),n;case r.User:return null;default:return Object(h.a)(e)}}function I(t){return void 0===t&&(t=Object(c.h)().SessionSettings.UserEmailAddress),o().uploadFolders.get(t)||null}var j=n(59);function _(t,e){return void 0===t&&(t=null),void 0===e&&(e=r.User),Object(l.__awaiter)(this,void 0,void 0,(function(){var n,r,a,i;return Object(l.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t=t||Object(c.h)().SessionSettings.UserEmailAddress,(n=I(t))?[2,n]:[4,(u={},l={headers:O(t,e)},Object(v.a)("GetAttachmentDataProviderUploadFolderProps",u,l))];case 1:return r=o.sent(),a=function(t,e,n){return{mailboxId:t,folderId:n.FolderId,folderName:Object(m.b)(n.FolderName)?b(e):n.FolderName}}(t,e,r),s(t,a),[2,a];case 2:return i=o.sent(),j.g.warn("fetchUploadFolder got error: "+i.message),[2,null];case 3:return[2]}var u,l}))}))}Object(a.orchestrator)(u,(function(t){return Object(l.__awaiter)(void 0,void 0,void 0,(function(){var e,n;return Object(l.__generator)(this,(function(r){switch(r.label){case 0:return e=t.mailboxId,n=t.uploadFolderMailboxType,I(e)?[3,2]:[4,_(e,n)];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))})),n.d(e,"d",(function(){return u})),n.d(e,"b",(function(){return _})),n.d(e,"c",(function(){return I})),n.d(e,"a",(function(){return r}))},3903:function(t){t.exports=JSON.parse('{"a":"Wva"}')},3907:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(2837),a=n(20),i=n(30),o=25*r.b;function c(){return u.get()}var u=Object(a.computed)((function(){var t=Object(i.a)();return t&&t.SessionSettings?(t.SessionSettings.MaxMessageSizeInKb-2048)*r.a:o}))},3951:function(t){t.exports=JSON.parse('{"a":"K6a"}')},396:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return u}));var r=n(0),a=n(14),i=n(342),o=function(){return{position:"absolute",width:1,right:31,top:8,bottom:8}};function c(t){var e,n,i,c,u,s=t.semanticColors,l=t.palette,d=s.buttonBackground,f=s.buttonBackgroundPressed,h=s.buttonBackgroundHovered,m=s.buttonText,p=s.buttonTextHovered,b=s.buttonTextChecked,v=s.buttonTextCheckedHovered;return{root:{backgroundColor:d,color:m},rootHovered:{backgroundColor:h,color:p,selectors:(e={},e[a.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},e)},rootPressed:{backgroundColor:f,color:b},rootExpanded:{backgroundColor:f,color:b},rootChecked:{backgroundColor:f,color:b},rootCheckedHovered:{backgroundColor:f,color:v},rootDisabled:{selectors:(n={},n[a.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},n)},splitButtonContainer:{selectors:(i={},i[a.HighContrastSelector]={border:"none"},i)},splitButtonMenuButton:{color:l.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:l.neutralLight,selectors:(c={},c[a.HighContrastSelector]={color:"Highlight"},c)}}},splitButtonMenuButtonDisabled:{backgroundColor:s.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:s.buttonBackgroundDisabled}}},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},o()),{backgroundColor:l.neutralTertiaryAlt,selectors:(u={},u[a.HighContrastSelector]={backgroundColor:"WindowText"},u)}),splitButtonDividerDisabled:{backgroundColor:t.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:l.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:l.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:l.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:l.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:s.buttonText},splitButtonMenuIconDisabled:{color:s.buttonTextDisabled}}}function u(t){var e,n,c,u,s,l,d,f,h,m=t.palette,p=t.semanticColors;return{root:{backgroundColor:p.primaryButtonBackground,border:"1px solid "+p.primaryButtonBackground,color:p.primaryButtonText,selectors:(e={},e[a.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},e["."+i.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:m.white}}},e)},rootHovered:{backgroundColor:p.primaryButtonBackgroundHovered,border:"1px solid "+p.primaryButtonBackgroundHovered,color:p.primaryButtonTextHovered,selectors:(n={},n[a.HighContrastSelector]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},n)},rootPressed:{backgroundColor:p.primaryButtonBackgroundPressed,border:"1px solid "+p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed,selectors:(c={},c[a.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},c)},rootExpanded:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootChecked:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootDisabled:{selectors:(u={},u[a.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},u)},splitButtonContainer:{selectors:(s={},s[a.HighContrastSelector]={border:"none"},s)},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},o()),{backgroundColor:m.white,selectors:(l={},l[a.HighContrastSelector]={backgroundColor:"Window"},l)}),splitButtonMenuButton:{backgroundColor:p.primaryButtonBackground,color:p.primaryButtonText,selectors:(d={},d[a.HighContrastSelector]={backgroundColor:"WindowText"},d[":hover"]={backgroundColor:p.primaryButtonBackgroundHovered,selectors:(f={},f[a.HighContrastSelector]={color:"Highlight"},f)},d)},splitButtonMenuButtonDisabled:{backgroundColor:p.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:p.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:p.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:p.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:p.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:p.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:p.primaryButtonText},splitButtonMenuIconDisabled:{color:m.neutralTertiary,selectors:(h={},h[a.HighContrastSelector]={color:"GrayText"},h)}}}},4375:function(t,e,n){"use strict";var r=n(1644),a=["ErrorTooLargeForLocalAttachmentSingle","ErrorTooLargeForLocalAttachmentMultiple","WarningFilesCanNotBeAttachedGenericError","WarningEmptyFilesCanNotBeAttached","WarningFilesCanNotBeAttachedWithNamesGenericError","WarningFilesCannotBeAttachedFromOtherMailboxes","WarningSeveralFilesCanNotBeAttachedGenericError","WarningInlineImageTypeNotSupported","WarningAttachmentsCanNotBeDeleted","InfoIncludeMostRecentAttachmentsMessage","ErrorSmimeHasCloudOrUriAttachments","ErrorAttachmentDownloadFailed","ErrorAttachmentDownloadFailedMultipleFiles","WarningSpecialCharactersAreNotSupported"];function i(t){t&&Object(r.a)(t,a)}n.d(e,"a",(function(){return i}))},4378:function(t,e,n){"use strict";var r=n(29),a=n(0);function i(t,e){var n;return void 0===t||t.__type||(n=t,t=Object(a.__assign)({__type:"DeleteAttachmentJsonRequest:#Exchange"},n)),Object(r.a)("DeleteAttachment",t,e)}n.d(e,"a",(function(){return i}))},440:function(t,e,n){"use strict";var r=n(0);function a(t,e){return t?Object(r.__assign)({mailboxInfo:t},e):null!=e?e:void 0}n.d(e,"a",(function(){return a}))},4558:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r,a=n(3907);function i(t,e,n){return r||(r=Object(a.a)()),{composeId:n,allowShowMultipleRows:!t,didViewOverflowOneRow:!1,canOverrideAllowShowMultipleRows:!0,docViewAttachments:[],imageViewAttachments:[],inlineAttachments:[],isInitialized:e,isReadOnly:t,groupId:null,maxTotalClassicAttachmentSize:r,totalClassicAttachmentSize:0,saveAllToCloudStatus:0,supportedMenuActions:null,sharingLinkIds:[],announcedComponentMessage:null}}},4561:function(t,e,n){"use strict";var r=n(4562),a=n(4964),i=n(1379),o=n(285);e.a=Object(o.action)("removeAttachmentFromWell")((function(t,e){var n=Object(i.a)(e.attachmentId);if(n){var o,c;1===e.attachmentType?(o=t.inlineAttachments,c=!0):o=t.imageViewAttachments.some((function(t){return t.attachmentId===e.attachmentId}))?t.imageViewAttachments:t.docViewAttachments;for(var u=!1,s=0;s<o.length;s++)if(o[s].attachmentId===e.attachmentId){o.splice(s,1),u=!0;break}!u||!c&&e.isCloudy||Object(r.a)(t,-1*n.model.Size,n.model.AttachmentId),Object(a.a)(e.attachmentId)}}))},4562:function(t,e,n){"use strict";var r=n(285);e.a=Object(r.action)("changeTotalClassicAttachmentSize")((function(t,e,n){t.totalClassicAttachmentSize+=e}))},4570:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0);function a(t){return Object(r.__assign)({__type:"Item:#Exchange"},t)}},460:function(t,e,n){"use strict";var r=n(0),a=n(1),i=n(391),o=n(458),c=n(457),u=n(14),s=n(230),l=n(392),d=n(425),f=n(396),h=Object(s.c)((function(t,e,n){var r=Object(l.a)(t),a=Object(d.a)(t),i={root:{minWidth:"80px",height:"32px"},label:{fontWeight:u.FontWeights.semibold}};return Object(u.concatStyleSets)(r,i,n?Object(f.a)(t):Object(f.b)(t),a,e)}));n.d(e,"a",(function(){return m}));var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.__extends)(e,t),e.prototype.render=function(){var t=this.props,e=t.primary,n=void 0!==e&&e,c=t.styles,u=t.theme;return a.createElement(i.a,Object(r.__assign)({},this.props,{variantClassName:n?"ms-Button--primary":"ms-Button--default",styles:h(u,c,n),onRenderDescription:o.b}))},e=Object(r.__decorate)([Object(c.a)("DefaultButton",["theme","styles"],!0)],e)}(a.Component)},5046:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0);function a(t){return Object(r.__assign)({__type:"CreateAttachmentJsonRequest:#Exchange"},t)}},519:function(t,e,n){"use strict";var r,a=n(0),i=n(1),o=n(721),c=n(59);!function(t){t[t.Full=0]="Full",t[t.Simple=1]="Simple",t[t.None=2]="None"}(r||(r={}));var u=function(t){function e(e){var n=t.call(this,e)||this;return n.state={},n}return Object(a.__extends)(e,t),e.prototype.componentDidCatch=function(t,e){var n,r;null===(r=(n=this.props).onError)||void 0===r||r.call(n,t,e),this.props.suppressErrorReport||(t.component=!0,t.diagnosticInfo=(t.diagnosticInfo||"")+e.componentStack,Object(c.d)(t)),this.setState({error:t})},e.prototype.render=function(){var t=this.state.error,e=this.props,n=e.children,o=e.type;if(t){if(o==r.None)return null;if(o==r.Simple||!this.props.fullErrorComponent)return i.createElement("div",null,t);var c=this.props.fullErrorComponent;return i.createElement(c,Object(a.__assign)({error:t},this.props.fullErrorComponentProps))}return n},e=Object(a.__decorate)([o.observer],e)}(i.Component);n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return r}))},5451:function(t,e,n){"use strict";e.a={AttachmentCreationClassicFromLocalFile:{name:"AttachmentCreationClassicFromLocalFile",customData:function(t,e,n,r,a){return r?[r.size]:[0]}},AttachmentCreationFromRecentAttachment:{name:"AttachmentCreationFromRecentAttachment",customData:function(t,e,n,r,a,i){return[(null==r?void 0:r.size)||0,null==r?void 0:r.fileType]}},AttachmentCreationCloudyFromAttachmentDataProvider:{name:"AttachmentCreationCloudyFromAttachmentDataProvider",customData:function(t,e,n,r){return[n.providerType,n.fileType]}},AttachmentCreationCloudyFromLocalFile:{name:"AttachmentCreationCloudyFromLocalFile"},AttachmentDeletionAction:{name:"AttachmentDeletionAction",customData:function(t,e,n,r){return{generatedAttachmentId:e.attachmentId.Id}},cosmosOnlyData:function(t,e,n,r){return JSON.stringify({attachmentId:e.attachmentId.Id,fileType:r})},options:{isCore:!0}},AttachmentWellInitialization:{name:"AttachmentWellInitialization",customData:function(t,e,n,r,a,i,o){return{hasAttachments:t&&t.length>0,isCompose:a}},options:{sessionSampleRate:1}}}},5452:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0);function a(t){return Object(r.__assign)({__type:"CreateAttachmentRequest:#Exchange"},t)}},5453:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0);function a(t){return Object(r.__assign)({__type:"ItemIdAttachment:#Exchange"},t)}},555:function(t,e,n){"use strict";var r,a=n(557),i=n(3),o=Object(i.createStore)("nonBootUserConfiguration",{nonBootUserConfiguration:null})(),c=n(265),u=Object(i.mutatorAction)("setNonBootUserConfiguration",(function(t){o.nonBootUserConfiguration=t}));function s(){return Object(c.b)()?Promise.resolve({}):o.nonBootUserConfiguration?Promise.resolve(o.nonBootUserConfiguration):(r||(r=Object(a.a)().then((function(t){return u(t),t})).catch((function(t){throw r=void 0,t}))),r)}var l=s;function d(){return o.nonBootUserConfiguration||s(),o.nonBootUserConfiguration}function f(){var t=(d()||{}).IsEdu;return void 0!==t&&t}function h(){var t=(d()||{}).ExternalInOutlookEnabled;return void 0!==t&&t}n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return d})),n.d(e,"d",(function(){return f})),n.d(e,"a",(function(){return h}))},557:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(29);function a(t){return Object(r.a)("GetOwaNonBootUserConfiguration",{},t)}},6145:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(3),a=Object(r.action)("setAnnouncedComponentMessage",(function(t,e){return{attachmentWell:t,message:e}}))},6166:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0);function a(t){return Object(r.__assign)({__type:"ReferenceAttachment:#Exchange"},t)}},6194:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1443),a=n(1553),i=n(1471);function o(t){if(Object(a.a)(t)){var e=t;return{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:"",providerType:4,location:e.AttachLongPathName,providerEndpointUrl:"",isFolder:!1,thumbnailUrl:e.AttachmentThumbnailUrl,previewUrl:e.AttachmentPreviewUrl,fileId:e.AttachmentId.Id,fileParentId:"",type:e.ContentType}}return{attachmentItemId:t.AttachmentId.Id,name:t.Name,size:t.Size,fileType:r.a.AttachmentItem,type:i.c,EmbeddedItemClass:t.EmbeddedItemClass,ContentType:t.ContentType}}},6321:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(59);function a(t){var e=t.maxTotalClassicAttachmentSize-t.totalClassicAttachmentSize;return e<0?(r.d("AttachmentWellAvailableSize is smaller than zero: "+t.composeId),0):e}},670:function(t,e,n){"use strict";function r(t){void 0===t&&(t={}),function(t){t.timeBetweenRetryInMS=t.timeBetweenRetryInMS||function(){return 6e4}}(t);var e=t.maximumAttempts,n=t.timeBetweenRetryInMS;return function(t){var r=0,a=!1,i=function(o,c){a?c(new Error("The function retry was cancelled")):(r++,t().then((function(t){return o(t)})).catch((function(t){e&&r>=e?c(t):setTimeout((function(){return i(o,c)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(t,e){return i(t,e)}))},cancel:function(){return a=!0}}}}function a(t){return function(e){return Math.pow(2,e)*t}}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return a}))},6865:function(t){t.exports=JSON.parse('{"a":"klb"}')},6867:function(t,e,n){"use strict";var r=n(285);e.a=Object(r.action)("updateChangeKeyOnItemId")((function(t,e){t.ChangeKey=e}))},6990:function(t,e,n){"use strict";var r=n(2368),a=n(1379),i=n(8225),o=n(83),c=n(285);e.a=Object(c.action)("setAttachmentPermissionLevel")((function(t,e,n,c){var u=Object(a.a)(t),s=u.model;s.PermissionType=e,n&&(s.AttachLongPathName=n,u.openUrl=Object(i.a)(s)),Object(o.i)("doc-attachment-referenceAttachmentExpiration")&&u.info&&u.info.sharingInfo&&(u.info.sharingInfo.expirationDate=c),Object(r.a)(t)}))},6991:function(t,e,n){"use strict";var r=n(0),a=n(1379),i=n(2007),o=n(5381),c=n(1780),u=n(2247),s=n(285);e.a=Object(s.action)("refreshThumbnailImageUrl")((function(t,e,n){return void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(s=Object(a.a)(t),!Object(c.b)(s.model))return[3,7];switch(s.model.ProviderType){case i.e:return[3,1]}return[3,5];case 1:return r.trys.push([1,3,,4]),[4,Object(o.a)(s.model)];case 2:return l=r.sent(),s.thumbnailImage.url=l,[3,4];case 3:return r.sent(),s.thumbnailImage.url=null,[3,4];case 4:case 5:return[3,6];case 6:return[3,8];case 7:l=Object(u.a)(t,s.model,2,Object(c.b)(s.model),e,n),s.thumbnailImage.url=l,r.label=8;case 8:return[2]}}))}))}))},6992:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(295);function a(t,e){var n=t.docViewAttachments.filter((function(t){return Object(r.e)(t.attachmentId,e)}));return 0===n.length&&(n=t.imageViewAttachments.filter((function(t){return Object(r.e)(t.attachmentId,e)}))),0===n.length?null:n[0]}},6993:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0);function a(t){return Object(r.__assign)({__type:"ItemAttachment:#Exchange"},t)}},6994:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0);function a(t){return Object(r.__assign)({__type:"MimeContentType:#Exchange"},t)}},7239:function(t,e,n){"use strict";var r=n(8513),a=n(12),i=n(1715),o=n(1716),c=n(4375),u=n(269),s=n(270),l=n(1379),d=n(1363),f=n(0),h=n(8514),m=n(8516);var p=n(8512),b=n(1811),v=n(59),g=n(285),O=n(1467),I=n(1503),j=n(6990),_=n(3832);var A=n(4561),C=n(6145),y=n(6867),w=n(13177);function S(t,e,n,r,i,o,c){Object(C.a)(c,Object(a.b)(w.a)),Object(b.E)(t,e,n,r,o),Object(y.a)(i,r.AttachmentId.RootItemChangeKey),function(t,e,n){n&&0===n.ResultCode&&0===t.attachmentType&&(n.CanShareInternally||Object(_.f)(e.PermissionType)||(Object(u.p)("AttachmentsCanNotShareInternally"),Object(j.a)(t.attachmentId,0)),Object(I.o)(e.AttachmentId))}(t,n,o)}function T(t,e,n,r){1===t.attachmentType&&Object(b.z)(t,2),e&&Object(A.a)(e,t),n&&r&&O.g.importAndExecute(n,r)}var F=Object(g.action)("handleCreateAttachmentNotification")((function(t,e,n,r,a,i,o,c){var u=t;try{if(0!==u.ResultCode)throw new Error("ResultCode:"+u.ResultCode+", Id:"+u.Id+", Exception: "+u.Exception);var s=u.Response.ResponseMessages.Items[0];if(s&&s.Attachments.length>0)return Object(b.C)(a.attachmentId,!0),i(s.Attachments[0]),void S(a,n,r,s.Attachments[0],e,u.Response.SharingInformation,c.attachmentWellViewState)}catch(t){v.d("Error handling the create attachment notification: "+t)}Object(b.C)(a.attachmentId,!1),o(new Error(u.Exception)),T(a,c.attachmentWellViewState,null,null)})),E=n(362);function k(t,e){return Object(f.__awaiter)(this,void 0,void 0,(function(){var n,r,a,i;return Object(f.__generator)(this,(function(o){switch(o.label){case 0:return n=Object(E.a)(),r={subscriptionId:n,requiresExplicitSubscribe:!1,subscriptionParameters:null},a=function(t){e(t),O.g.importAndExecute(r,a)},[4,O.f.import()];case 1:return o.sent()(r,a),[4,O.b.import()];case 2:return i=o.sent()(),t(n,r,i,a),[2]}}))}))}var P=n(29),x=n(723);var B=n(440);function R(t,e,n,r,a,i){return Object(f.__awaiter)(this,void 0,void 0,(function(){var o;return Object(f.__generator)(this,(function(c){switch(c.label){case 0:return o=Object(B.a)(t.mailboxInfo)||{},[4,(u={itemId:t,attachmentDataProviderId:n.providerId,location:n.location,attachmentId:n.fileId||"",subscriptionId:r,channelId:a,dataProviderParentItemId:n.fileParentId||"",providerEndpointUrl:n.providerEndpointUrl,cancellationId:e,isInline:i},s=o,void 0===u.itemId||u.itemId.__type||(u.itemId=Object(x.a)(u.itemId)),Object(P.a)("CreateAttachmentFromAttachmentDataProvider",u,s))];case 1:return[2,c.sent()]}var u,s}))}))}var N=n(2837),D=Object(g.action)("createAttachmentFromAttachmentDataProvider")((function(t,e,n,r,a,i,o,c,s){return Object(f.__awaiter)(this,void 0,void 0,(function(){var l,d,h,m=this;return Object(f.__generator)(this,(function(p){return(l=new u.a("AttachmentCreationClassicFromAttachmentDataProvider")).addCustomData([a.providerType]),d=function(t){o(t),l.end()},h=function(t){c(),l.endWithError("ServerError",t)},k((function(e,n,o,u){return Object(f.__awaiter)(m,void 0,void 0,(function(){var l;return Object(f.__generator)(this,(function(d){switch(d.label){case 0:if(d.trys.push([0,2,,3]),0===a.providerType&&(f=a.name,-1!==f.indexOf("%")||-1!==f.indexOf("#")))throw new Error(N.c);return 0===i.attachmentType&&Object(b.B)(Object(b.k)(a.size),.05,(function(t){Object(b.x)(i,t)}),i.attachmentId),[4,R(t,r,a,e,o,!1)];case 1:if(!d.sent())throw new Error("Empty response for createAttachmentFromAttachmentDataProvider request");return[3,3];case 2:return l=d.sent(),Object(b.C)(i.attachmentId,!1),c(l),T(i,s.attachmentWellViewState,n,u),[2];case 3:return[2]}var f}))}))}),(function(r){F(r,t,e,n,i,d,h,s)})),[2]}))}))}));var L=n(5451),U=n(1418);function M(t,e,n,r,a,i){var o=this;return new Promise((function(c,u){return Object(f.__awaiter)(o,void 0,void 0,(function(){var o,s,l;return Object(f.__generator)(this,(function(d){switch(d.label){case 0:return(o=new XMLHttpRequest).onreadystatechange=function(){if(4===o.readyState)if(200===o.status){var t=void 0;try{t=JSON.parse(o.responseText)}catch(t){v.d("Attachment: Deserialize response failed with error: "+t.Message),v.d("Attachment: Deserialize response Failure Stack Trace: "+t.stack),u(t)}c(t)}else u(new Error("Request failed with status "+o.status+". Message: "+o.responseText))},o.ontimeout=function(){u(new Error("Request timed out"))},i&&(o.upload.onprogress=i),o.open("POST",t,!0),o.setRequestHeader("X-OWA-Action",n),[4,Object(U.d)(r)];case 1:return(s=d.sent())&&Object.keys(s).forEach((function(t){o.setRequestHeader(t,s[t])})),l=JSON.stringify(e),a?(o.setRequestHeader("X-OWA-UrlPostData",encodeURI(l)),o.send(a)):o.send(l),[2]}}))}))}))}var W=n(5);function H(t){var e=Object(W.a)();return e.baseUrl?""+e.baseUrl+t:"/owa"+t}var z=n(5046),V=n(5452),G=n(319),q=H("/service.svc/CreateAttachmentFromLocalFile");function K(t,e,n,r,a,i){return Object(f.__awaiter)(this,void 0,void 0,(function(){var o,c,u;return Object(f.__generator)(this,(function(s){switch(s.label){case 0:return o=Object(V.a)({ParentItemId:t,Attachments:[e],RequireImageType:e.IsInline,IncludeContentIdInResponse:e.IsInline,ClientSupportsIrm:!0,CancellationId:n}),i&&(o.SliceNumber=i.sliceNumber,o.TotalSlices=i.totalSlices),c=Object(z.a)({Header:Object(G.b)(),Body:o}),u=e,v.g.info("Attachment: createAttachment Id: "+t.Id+", ChangeKey: "+t.ChangeKey),[4,M(q,c,"CreateAttachmentFromLocalFile",t.mailboxInfo,u&&r?r:null,a)];case 1:return[2,s.sent().Body]}}))}))}function Q(t,e){var n="Attachment: createAttachment failed",r=null!=e?e:"genericError";return(null==t?void 0:t.MessageText)&&(n+=" with MessageText: "+t.MessageText),v.g.warn(n),(null==t?void 0:t.ResponseCode)&&(r=t.ResponseCode),{errorMessage:n,errorCode:r}}function J(t){var e=Object(f.__assign)({},t);return Object.keys(e).forEach((function(t,n){null===e[t]&&(e[t]=void 0)})),e}var Z=n(74),X=Object(Z.d)("createAttachmentFromLocalFile",L.a.AttachmentCreationClassicFromLocalFile)((function(t,e,n,r,a){return Object(f.__awaiter)(this,void 0,void 0,(function(){var i,o,c,u;return Object(f.__generator)(this,(function(s){switch(s.label){case 0:return i=null,0===a.attachmentType&&(i=function(t){var e=t.loaded/t.total;Object(b.x)(a,e)}),o=J(e),[4,K(t,o,n,r,i)];case 1:if(c=s.sent(),(u=c.ResponseMessages.Items[0])&&u.Attachments.length>0&&u.Attachments[0])return[2,{attachment:u.Attachments[0],sharingInfo:null}];throw Q(u)}}))}))})),Y=n(5453),$=Object(Z.d)("createAttachmentFromMailboxFile",L.a.AttachmentCreationFromRecentAttachment)((function(t,e,n,r,a,i){return Object(f.__awaiter)(this,void 0,void 0,(function(){var o,c,u,s;return Object(f.__generator)(this,(function(l){switch(l.label){case 0:return o=null,0===a.attachmentType&&(o=function(t){var e=t.loaded/t.total;Object(b.x)(a,e)}),c=J(e),i&&(c=function(t,e){return Object(Y.a)({AttachmentId:t.AttachmentId,AttachmentIdToAttach:e,ContentType:t.ContentType,Name:t.Name,Size:t.Size,Thumbnail:t.Thumbnail,ThumbnailMimeType:t.ThumbnailMimeType,CreateAttachmentInlineType:2})}(c,r.fileId)),[4,K(t,c,n,null,o)];case 1:if(u=l.sent(),(s=u.ResponseMessages.Items[0])&&s.Attachments.length>0&&s.Attachments[0])return[2,{attachment:s.Attachments[0],sharingInfo:u.SharingInformation}];throw Q(s)}}))}))}));function tt(t,e,n,r,a,i){return Object(f.__awaiter)(this,void 0,void 0,(function(){var o;return Object(f.__generator)(this,(function(c){switch(c.label){case 0:return o=Object(B.a)(t.mailboxInfo)||{},[4,(u={itemId:t,uri:e,name:n,subscriptionId:r,isInline:a,contentId:i},s=o,void 0===u.itemId||u.itemId.__type||(u.itemId=Object(x.a)(u.itemId)),Object(P.a)("CreateAttachmentFromUri",u,s))];case 1:return[2,c.sent()]}var u,s}))}))}var et=Object(g.action)("createAttachmentFromUri")((function(t,e,n,r,a,i,o,c,s){var l=this,d=new u.a("AttachmentCreationFromUri");d.addCustomData({size:a?a.size:0});var h=function(t){o(t),d.end()},m=function(t){c(),d.endWithError("ServerError",t)};k((function(e,r,o,u){return Object(f.__awaiter)(l,void 0,void 0,(function(){return Object(f.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),0===i.attachmentType&&Object(b.B)(Object(b.l)(a.size),.05,(function(t){Object(b.x)(i,t)}),i.attachmentId),[4,tt(t,a.uri,a.name,e,n.IsInline,null)];case 1:if(!o.sent())throw new Error("Empty response for createAttachmentFromUriProvider request");return[3,3];case 2:return o.sent(),Object(b.C)(i.attachmentId,!1),c(),T(i,s.attachmentWellViewState,r,u),[3,3];case 3:return[2]}}))}))}),(function(r){F(r,t,e,n,i,h,m,s)}))})),nt=n(8518);function rt(t,e,n){return Object(f.__awaiter)(this,void 0,void 0,(function(){var r;return Object(f.__generator)(this,(function(a){switch(a.label){case 0:return r=Object(B.a)(t.mailboxInfo)||{},[4,Object(nt.a)({itemId:t,attachmentDataProviderId:n.providerId,location:n.location,attachmentId:n.fileId||"",dataProviderParentItemId:n.fileParentId||"",providerEndpointUrl:n.providerEndpointUrl,cancellationId:e,thumbnailUrl:n.thumbnailUrl,previewUrl:n.previewUrl,isFolder:n.isFolder,mimeType:n.type},r)];case 1:return[2,a.sent()]}}))}))}var at=n(83),it=n(6746),ot=Object(Z.d)("createReferenceAttachmentFromAttachmentDataProvider",L.a.AttachmentCreationCloudyFromAttachmentDataProvider)((function(t,e,n,r){return Object(f.__awaiter)(this,void 0,void 0,(function(){var i=this;return Object(f.__generator)(this,(function(o){return 0===r.attachmentType&&Object(b.B)(4e3,.05,(function(t){Object(b.x)(r,t)}),r.attachmentId),[2,rt(t,e,n).then((function(t){return Object(f.__awaiter)(i,void 0,void 0,(function(){var e,n;return Object(f.__generator)(this,(function(i){switch(i.label){case 0:return(e=t.ResponseMessages.Items.length>0?t.ResponseMessages.Items[0]:null)&&e.Attachments.length>0?(Object(b.C)(r.attachmentId,!0),[2,{attachment:e.Attachments[0],sharingInfo:t.SharingInformation}]):[3,1];case 1:return Object(b.C)(r.attachmentId,!1),Object(at.i)("doc-authContext")?!t.SharingInformation||Object(a.f)(t.SharingInformation.ClaimsChallenge)?[3,4]:(n=t.SharingInformation.ClaimsChallenge,[4,it.a.import()]):[3,4];case 2:return[4,i.sent()(n)];case 3:throw i.sent(),Q(e,t.SharingInformation.ResultCode.toString());case 4:throw Q(e)}}))}))}))]}))}))}));var ct=H("/service.svc/CreateReferenceAttachmentFromLocalFile");function ut(t,e,n,r,a,i,o,c,u,s){return Object(f.__awaiter)(this,void 0,void 0,(function(){var l;return Object(f.__generator)(this,(function(d){switch(d.label){case 0:return h={ParentItemId:t,FileName:e.Name,SubscriptionId:a,ChannelId:i,FileSizeInBytes:e.Size,SliceNumber:o,TotalSlices:c,CancellationId:n,FileContentToUpload:"",GroupSmtpAddress:u,UploadFolderId:s},l=Object(f.__assign)({__type:"CreateReferenceAttachmentFromLocalFileRequest:#Exchange"},h),[4,M(ct,{requestObject:l},"CreateReferenceAttachmentFromLocalFile",t.mailboxInfo,r,void 0)];case 1:return[2,d.sent()]}var h}))}))}var st=n(3229),lt=Object(Z.d)("createReferenceAttachmentFromLocalFile",L.a.AttachmentCreationCloudyFromLocalFile)((function(t,e,n,r,a,i,o,c,u){return Object(f.__awaiter)(this,void 0,void 0,(function(){var s=this;return Object(f.__generator)(this,(function(l){return k((function(e,o,l,d){return Object(f.__awaiter)(s,void 0,void 0,(function(){return Object(f.__generator)(this,(function(s){return function(t,e,n,r,a,i,o,c,u,s,l,d){var h;Object(f.__awaiter)(this,void 0,void 0,(function(){var m,p,v,g,O,I,j,_;return Object(f.__generator)(this,(function(f){switch(f.label){case 0:return m=Math.ceil(r.size/s),Object(b.B)(Object(b.q)(r.size),.05,(function(t){Object(b.x)(a,t)}),a.attachmentId),p=null,(v=null===(h=null==d?void 0:d.attachmentWellViewState)||void 0===h?void 0:h.groupId)?(p=Object(st.c)(v)?Object(st.c)(v).folderId:null)?[3,2]:[4,Object(st.b)(v,st.a.Group)]:[3,2];case 1:(_=f.sent())&&(p=_.folderId),f.label=2;case 2:g=0,f.label=3;case 3:if(!(g<m))return[3,8];O=0+g*s,I=Math.min(O+s,r.size),j=r.slice(O,I),f.label=4;case 4:return f.trys.push([4,6,,7]),[4,ut(t,e,n,j,i,c,g,m,v,p)];case 5:if(!(_=f.sent()))throw new Error("Empty response for createReferenceAttachmentFromLocalFile request");return[3,7];case 6:return f.sent(),Object(b.C)(a.attachmentId,!1),l(),T(a,d.attachmentWellViewState,o,u),[2];case 7:return g++,[3,3];case 8:return[2]}}))}))}(t,n,r,a,i,e,o,l,d,10485760,c,u),[2]}))}))}),(function(r){F(r,t,e,n,i,o,c,u)})),[2]}))}))}));var dt=n(1443),ft=n(4671),ht=n(313),mt=n(8519);function pt(t,e,n,r,a,i,o,c){var s=this,l=new u.a("UploadLocalFileAndCreateCloudyAttachment",{timeout:3e5}),d=Object(f.__read)(Object(mt.a)(n.Name,i,a,(function(t){var e=t.loaded/t.total;Object(b.x)(o,e)})),2),h=d[0],m=h.uploadPromise,p=h.cancel,v=d[1].model,g=v.Id,O=v.EndPointUrl,I=v.Type,j=!1;return{onCompletePromise:Object(f.__awaiter)(s,void 0,void 0,(function(){var a,i,s,d,h,p,v,_,A,C;return Object(f.__generator)(this,(function(f){switch(f.label){case 0:a=null,f.label=1;case 1:return f.trys.push([1,6,7,8]),[4,m];case 2:return i=f.sent(),s=i.errorResponse,d=i.result,s?[4,s.text()]:[3,4];case 3:throw h=f.sent(),new Error("Unable to upload file with status code: "+s.status+"; response: "+h);case 4:return p=function(t,e,n,r){return{fileType:dt.a.Cloud,name:t.name,size:t.size,providerId:e,providerType:n,location:bt(t,n),providerEndpointUrl:r,isFolder:!1,fileId:t.id,fileParentId:t.parentReference.id,thumbnailUrl:"",previewUrl:"",type:Object(ft.c)(t)}}(d,g,I,O),[4,rt(t,r,p)];case 5:if(v=f.sent(),(_=v.ResponseMessages.Items[0])&&_.Attachments.length>0)return Object(b.C)(o.attachmentId,!0),A=_.Attachments[0],S(o,e,n,A,t,v.SharingInformation,c.attachmentWellViewState),[2,A];throw new Error(_.MessageText);case 6:if(C=f.sent(),Object(b.C)(o.attachmentId,!1),T(o,c.attachmentWellViewState),j)return[2,null];throw a=C,C;case 7:return a?(new u.a("UploadLocalFileAndCreateCloudyAttachmentError",{isCore:!0}).endWithError(a),l.endWithError(a)):l.end(),[7];case 8:return[2]}}))})),cancel:function(){j=!0,p()}}}function bt(t,e){return 1===e?t.parentReference.path+"/"+t.name:Object(ht.parse)(t.webUrl).path}var vt=n(10877),gt=14680064;function Ot(t,e,n,r){t.addCustomData([e]),n?t.end():t.endWithError("ServerError",r)}function It(t,e,n,r,a,i){void 0===i&&(i={}),i.sliceSizeInBytes=i.sliceSizeInBytes||gt;var o=new u.a("AttachmentCreationClassicFromLocalFileSliced",{timeout:3e5}),c=function(t,e,n,r,a){var i=this,o=null,c=!1,u=null;return{action:function(s,l,d){return Object(f.__awaiter)(i,void 0,void 0,(function(){var i,h,m;return Object(f.__generator)(this,(function(p){switch(p.label){case 0:return u||(u=function(t){for(var e=[],n=0;n<t;n++)e[n]=0;return e}(d)),i=null,0===a.attachmentType&&(i=function(t){u[l]=t.loaded;var e=u.reduce((function(t,e){return t+e}),0)/r.size;Object(b.x)(a,e)}),h=J(e),[4,K(t,h,n,s,i,{sliceNumber:l,totalSlices:d})];case 1:if(m=p.sent(),!function(t){return t&&t.Attachments.length>0&&t.Attachments[0]}(o=m.ResponseMessages.Items[0]))throw Q(o);return c||(e=Object(f.__assign)(Object(f.__assign)({},e),{AttachmentId:o.Attachments[0].AttachmentId}),c=!0),[2]}}))}))},getLastResponseMessage:function(){return o}}}(t,e,n,r,a),l=c.action,d=c.getLastResponseMessage,h=Object(vt.a)(r,l,{sliceSize:i.sliceSizeInBytes,numberOfSlicesToParallelize:1}),m=h.onCompletePromise,p=h.cancel,v=!1;return{onCompletePromise:m.then((function(t){switch(t){case 0:return Ot(o,r.size,!0),{status:0,attachment:d().Attachments[0]};case 1:return{status:1};default:return Object(s.a)(t)}})).catch((function(t){if(v)return{status:1};throw Ot(o,r.size,!1,t),t})),cancel:function(){v=!0,p()}}}function jt(t,e,n,r,a,i,o){void 0===o&&(o={shouldShare:!1});var c,u=r&&(r.fileType===dt.a.Cloud||r.fileType===dt.a.CloudSuggestion||r.fileType===dt.a.ContextualSuggestion),l=null,d=Object(f.__assign)(Object(f.__assign)({},e.AttachmentId),{mailboxInfo:t.mailboxInfo}),h=o.shouldShare,m=function(){};if((c=r).fileType===dt.a.AttachmentItem||c.fileType===dt.a.AttachmentItemSuggestion||(c.fileType===dt.a.Cloud||c.fileType===dt.a.CloudSuggestion||c.fileType===dt.a.ContextualSuggestion)&&4===c.providerType)l=$(t,e,n,r,a,u).then((function(t){return t}));else if(h||u){if(!h&&u)return{createAttachmentPromise:new Promise((function(o,c){D(t,d,e,n,r,a,o,c,i)})),cancelCreateAttachment:m};if(!h||!u){if(o.shouldShare&&o.shareProperties&&!o.shareProperties.groupMailboxId){var p=pt(t,d,e,n,o.shareProperties.folderInfo,r.fileObject,a,i);return{createAttachmentPromise:v=p.onCompletePromise,cancelCreateAttachment:p.cancel}}return{createAttachmentPromise:new Promise((function(o,c){return lt(t,d,e,n,r.fileObject,a,o,c,i),e})),cancelCreateAttachment:m}}l=ot(t,n,r,a)}else if(r&&r.fileType===dt.a.Local&&r.fileObject){var b=It(t,e,n,r.fileObject,a),v=b.onCompletePromise;m=b.cancel,l=v.then((function(t){switch(t.status){case 0:return{attachment:t.attachment,sharingInfo:null};case 1:return null;default:return Object(s.a)(t)}}))}else{if(r&&r.fileType===dt.a.Uri)return{createAttachmentPromise:new Promise((function(o,c){et(t,d,e,n,r,a,o,c,i)})),cancelCreateAttachment:m};l=X(t,e,n,r&&r.fileType===dt.a.Local?r.fileObject:null,a)}return function(t,e,n,r,a,i,o){return{createAttachmentPromise:i.then((function(i){return i?(S(r,e,n,i.attachment,t,i.sharingInfo,a.attachmentWellViewState),i.attachment):null})).catch((function(t){throw T(r,a.attachmentWellViewState,null,null),t})),cancelCreateAttachment:o}}(t,d,e,a,i,l,m)}var _t=n(7329),At=Object(Z.d)("deleteAttachment",L.a.AttachmentDeletionAction)((function(t,e,n,r){return Object(_t.a)(e.attachmentId).then((function(r){var a=r.ResponseMessages.Items[0];"Success"===a.ResponseClass?(Object(A.a)(t,e),Object(y.a)(n,a.RootItemId.RootItemChangeKey)):v.g.warn("Attachment: Failed to delete attachment with ResponseClass= "+a.ResponseClass+", ResponseCode="+a.ResponseCode)})).catch((function(t){throw v.g.warn("Attachment: deleteAttachment got error: "+t.message),t}))}));function Ct(t){return e={cancellationId:t},Object(P.a)("CancelAttachment",e,n);var e,n}var yt=n(2007);function wt(t){if(null==t)return null;switch(t){case 0:return yt.i;case 5:return yt.e;case 1:return yt.h;case 2:return yt.c;case 3:return yt.b;case 7:return yt.j;case 9:return yt.k;case 8:return yt.l;case 4:return yt.f;case 6:return yt.d;case 10:return yt.g;default:return Object(s.a)(t)}}var St=n(4979),Tt=n(4570),Ft=n(6993),Et=n(6994),kt=n(6166),Pt=n(6865),xt=n(1612);function Bt(t,e){var n=Object(l.a)(t.item.attachmentId);if(n){!function(t,e,n){Object(xt.a)(n,t,[e])}("WarningAttachmentsCanNotBeDeleted",Object(a.c)(Object(a.b)(Pt.a),n.model.Name),e)}}var Rt=n(13178),Nt=n(1389),Dt=4;function Lt(t,e,n){Object(xt.a)(n,t,[e])}function Ut(t,e){var n,r=(n=function(t){return t.reason},t.reduce((function(t,e){var r=n(e);return t[r]?t[r].push(e):t[r]=[e],t}),{}));Object.keys(r).forEach((function(t){var n=r[t];switch(parseInt(t)){case 0:!function(t,e){var n=null,r=null;if(1===t.length&&null!==t[0].item.tryAgainCallback){var i=t[0],o=i.item.file.name,c=Object(a.c)(Object(a.b)(Rt.e),o),u={key:"WarningFilesCanNotBeAttachedWithNamesGenericError",source:Nt.c.Compose,rank:Nt.b.Info,message:c,messageParts:[c]},s={text:Object(a.b)(Rt.a),action:function(){return i.item.tryAgainCallback()}};return u.messageParts.push(s),void Object(xt.a)(e,"WarningFilesCanNotBeAttachedWithNamesGenericError",(function(t){return u}))}if(t.length<Dt){var l=t.map((function(t){return t.item.file.name})).join(", ");r="WarningFilesCanNotBeAttachedWithNamesGenericError",n=Object(a.c)(Object(a.b)(Rt.b),l)}else r="WarningSeveralFilesCanNotBeAttachedGenericError",n=Object(a.c)(Object(a.b)(Rt.d),t.length);Lt(r,n,e)}(n,e);break;case 1:!function(t,e){Lt("WarningFilesCannotBeAttachedFromOtherMailboxes",Object(a.b)(Rt.c),e)}(0,e);break;case 2:!function(t,e){Lt("WarningSpecialCharactersAreNotSupported",Object(a.b)(Rt.f),e)}(0,e)}}))}var Mt=function(){function t(t,e,n,r,a){var i=this;void 0===r&&(r=null),void 0===a&&(a=null),this.attachmentWellViewState=t,this.parentItemId=e,this.infoBar=n,this.onAnyAttachmentCreatedInParentItemCallback=r,this.onAnyAttachmentDeletedInParentItemCallback=a,this.uploadQueue=[],this.deleteQueue=[],this.uploadFailures=[],this.onFinishPromise=new Promise((function(t,e){i.onFinish=function(e){t(e)}}))}return t.prototype.enqueueAttachmentCreation=function(t,e,n,r,a){void 0===n&&(n=null),void 0===r&&(r=null),void 0===a&&(a=null);var i=e.isInline,o=e.shouldShare,u=e.isHiddenInline,s=e.skipProcessInlineImage;if(Object(c.a)(this.infoBar),!o&&Object(m.a)(t,this.infoBar,this.attachmentWellViewState))return[];t=Object(h.a)(t,i,this.infoBar);for(var l=0,d=void 0;d=t[l];l++){var g=void 0,O=null,I={Name:null,ContentType:null,ContentId:null,ContentLocation:null,AttachmentOriginalUrl:null,Size:0,LastModifiedTime:null,IsInline:!1,IsInlineToUniqueBody:!1,IsInlineToNormalBody:!1,ThumbnailMimeType:null,Thumbnail:null};if(o){var j=d;g=Object(kt.a)(Object(f.__assign)(Object(f.__assign)({},I),{Name:j.name,Size:j.size,ContentType:j.type,ProviderType:wt(j.providerType),AttachmentIsFolder:j.isFolder,IsInline:!1,PermissionType:0,AttachLongPathName:null,ProviderEndpointUrl:null,AttachmentThumbnailUrl:null,AttachmentPreviewUrl:null,OriginalPermissionType:0}))}else if(d.fileType===dt.a.Base64InlineImage||d.fileType===dt.a.ExpirableBase64InlineImage){var _=d;g=Object(St.a)(Object(f.__assign)(Object(f.__assign)({},I),{Name:_.name,Size:_.size,ContentType:_.type,IsInline:!0,Content:_.dataUri,IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0})),O=_.tempId}else if(d.fileType===dt.a.MailItem){var A=d;if(A.mimeContent)g=Object(Ft.a)(Object(f.__assign)(Object(f.__assign)({},I),{Name:d.name,Size:d.size,IsInline:!1,Item:Object(Tt.a)({MimeContent:Object(Et.a)({Value:A.mimeContent})}),ContentType:"message/rfc822"}));else{var C=Object(x.a)({Id:A.itemId});g=Object(Y.a)(Object(f.__assign)(Object(f.__assign)({},I),{Name:d.name,IsInline:!1,ItemId:C,Size:d.size,AttachmentIdToAttach:null,CreateAttachmentInlineType:0}))}}else if(d.fileType===dt.a.AttachmentItem||d.fileType===dt.a.AttachmentItemSuggestion){var y=d;g=Object(Y.a)(Object(f.__assign)(Object(f.__assign)({},I),{Name:y.name,AttachmentIdToAttach:y.attachmentItemId,__type:y.type,Size:d.size,ItemId:null,CreateAttachmentInlineType:0}))}else d.fileType===dt.a.Uri?g=Object(St.a)(Object(f.__assign)(Object(f.__assign)({},I),{Name:d.name,AttachmentOriginalUrl:d.uri,Size:d.size,ContentType:d.type,IsInline:i,Content:"",IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0})):(g=Object(St.a)(Object(f.__assign)(Object(f.__assign)({},I),{Name:d.name,Size:d.size,ContentType:d.type,IsInline:i,Content:"",IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0})),O=d.tempId);var w={Id:O||Object(E.a)(),mailboxInfo:this.parentItemId.mailboxInfo},S=void 0;i?S=Object(b.i)(w,w.Id,u,0,s):(S=Object(b.g)(w,!1,!1,o,d.fileType,!0),e.isAddedFromSmartDoc&&(S.fileType=dt.a.SmartDoc),this.attachmentWellViewState.supportedMenuActions&&(S.strategy.supportedMenuActions=this.attachmentWellViewState.supportedMenuActions),e.downsellFromLink&&Object(b.A)(S,6,11)),Object(p.a)(S,this.attachmentWellViewState,g,w);var T={attachmentState:S,file:d,attachment:g,shouldShareInfo:e,cancelPendingUpload:function(){},onAttachmentCreatedCallback:n,onAttachmentCanceledOrFailedCallback:r,tryAgainCallback:a};v.g.info("Attachment: UploadQueue enqueue attachment: Name="+d.name),this.uploadQueue.push(T)}return this.startProcessIfNotStarted(),t},t.prototype.deleteAttachment=function(t,e){var n=this;void 0===e&&(e=null),Object(c.a)(this.infoBar);var r=1===t.attachmentType;if(r||Object(b.A)(t,3,6),(r?0===t.status:t.actionCompletePercent<=1)&&this.currentUploadItem)if(this.currentUploadItem.attachmentState.attachmentId===t.attachmentId){v.g.info("Attachment: Cancelling attachment: TempId="+t.attachmentId);var a=this.currentUploadItem;if(a.cancelPendingUpload(),0===t.attachmentType&&t.isCloudy){if(v.g.info("Attachment: Put attachment: Id= "+t.attachmentId+" into deleteQueue"),0===this.deleteQueue.filter((function(e){return e.attachmentState.attachmentId===t.attachmentId})).length){var i={attachmentState:t,onAttachmentDeletedCallback:e};this.deleteQueue.push(i)}this.startProcessIfNotStarted()}else this.isCancelling||(this.isCancelling=!0,Ct(t.attachmentId.Id).then((function(e){n.isCancelling=!1,e?(Object(A.a)(n.attachmentWellViewState,t),a.onAttachmentCanceledOrFailedCallback&&a.onAttachmentCanceledOrFailedCallback(!0)):n.onAttachmentDeleteFailure(t)})))}else v.g.info("Attachment: Removing attachment: TempId= "+t.attachmentId+" from queue"),function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.attachmentState.attachmentId===t.attachmentId&&(r.onAttachmentCanceledOrFailedCallback&&r.onAttachmentCanceledOrFailedCallback(!0),e.splice(n,1))}}(t,this.uploadQueue),Object(A.a)(this.attachmentWellViewState,t);else{if(v.g.info("Attachment: Put attachment: Id= "+t.attachmentId+" into deleteQueue"),0===this.deleteQueue.filter((function(e){return e.attachmentState.attachmentId===t.attachmentId})).length){i={attachmentState:t,onAttachmentDeletedCallback:e};this.deleteQueue.push(i)}this.startProcessIfNotStarted()}},t.prototype.onAttachmentDeleteFailure=function(t){var e,n;e={item:t,reason:0},n=this.infoBar,Object(c.a)(n),Bt(e,n),1!==t.attachmentType&&Object(b.A)(t,0,0),v.g.warn("Attachment: Failed to cancel attachment: TempId="+t.attachmentId)},t.prototype.startProcessIfNotStarted=function(){this.isInProgress||(this.datapoint=new u.a("AttachmentQueueManager"),this.isInProgress=!0,this.processNextAttachment("NewProcess"))},t.prototype.processNextAttachment=function(t){var e=this;if(v.g.info("Attachment: Invoking processNextAttachment from: "+t),0!==this.deleteQueue.length){var n=this.deleteQueue[0],r=n.attachmentState,a=n.onAttachmentDeletedCallback,i=Object(l.a)(r.attachmentId);v.g.info("Attachment: Deleting attachment: Id= "+r.attachmentId),At(this.attachmentWellViewState,r,this.parentItemId,r.fileType).then((function(){e.deleteQueue.shift(),Wt(a,e.parentItemId,r.attachmentId,i.model),Wt(e.onAnyAttachmentDeletedInParentItemCallback,e.parentItemId,r.attachmentId,i.model),e.processNextAttachment("DeleteAttachmentFinish")})).catch((function(t){e.deleteQueue.shift(),e.onAttachmentDeleteFailure(r),e.logDeletionFailure(t.message,r),e.processNextAttachment("DeleteAttachmentFinish")}))}else if(0!==this.uploadQueue.length){this.currentUploadItem=this.uploadQueue.shift();var o=this.currentUploadItem.onAttachmentCreatedCallback,c={attachmentWellViewState:this.attachmentWellViewState,parentItemId:this.parentItemId,infoBar:this.infoBar},u=jt(this.parentItemId,this.currentUploadItem.attachment,this.currentUploadItem.attachmentState.attachmentId.Id,this.currentUploadItem.file,this.currentUploadItem.attachmentState,c,this.currentUploadItem.shouldShareInfo),s=u.createAttachmentPromise,d=u.cancelCreateAttachment;this.currentUploadItem.cancelPendingUpload=d,s.then((function(t){if(t){var n=Object(f.__assign)(Object(f.__assign)({},t.AttachmentId),{mailboxInfo:e.parentItemId.mailboxInfo});Wt(o,e.parentItemId,n,t),Wt(e.onAnyAttachmentCreatedInParentItemCallback,e.parentItemId,n,t)}e.processNextAttachment("CreateAttachmentFinish")})).catch((function(t){var n=0;(null==t?void 0:t.message)===N.c&&(n=2),t&&"ErrorNonExistentMailbox"===t.errorCode&&(n=1),e.uploadFailures.push({item:e.currentUploadItem,reason:n}),e.currentUploadItem.onAttachmentCanceledOrFailedCallback&&e.currentUploadItem.onAttachmentCanceledOrFailedCallback(!1),e.logCreationFailure(),e.processNextAttachment("CreateAttachmentFinish")}))}else this.finishProcess()},t.prototype.finishProcess=function(){v.g.info("Attachment: AttachmentQueueManager: finishProcess"),this.isInProgress=!1;var t=this.currentUploadItem&&this.currentUploadItem.attachmentState?this.currentUploadItem.attachmentState.attachmentId:null;this.currentUploadItem=null,this.onFinish(t),this.datapoint.end(),this.datapoint=null,Ut(this.uploadFailures,this.infoBar),this.uploadFailures=[]},t.prototype.logCreationFailure=function(){Object(u.p)("AttachmentCreationFailure")},t.prototype.logDeletionFailure=function(t,e){Object(u.p)("AttachmentDeletionFailure",[t],{cosmosOnlyData:JSON.stringify({attachmentId:e.attachmentId.Id})})},t}();function Wt(t,e,n,r){t&&t(e,n,r)}n.d(e,"a",(function(){return zt})),n.d(e,"b",(function(){return Vt}));var Ht={};function zt(t,e,n,i,o,s,l,f,h){if(void 0===o&&(o={isInline:!1,isHiddenInline:!1,shouldShare:!1,skipProcessInlineImage:!1}),!e)return Object(c.a)(i),Object(xt.a)(i,"WarningFilesCanNotBeAttachedGenericError",[Object(a.b)(r.a)]),[];var m=Gt(t,e,i,s);return function(t,e,n){for(var r=0;r<t.length;r++){var a=t[r];Object(u.p)("AttachmentCreation",[e,n],{cosmosOnlyData:JSON.stringify({fileType:a.fileType,size:a.size,ext:Object(d.d)(a.name)||""})})}}(n,o.isInline,o.shouldShare),m.enqueueAttachmentCreation(n,o,l,f,h)}function Vt(t,e,n,r,a){var i=Gt(t,n,r);!function(t){var e=t.attachmentType;switch(e){case 1:Object(u.p)("AttachmentDeletion",[!0,!1,0]);break;case 0:var n=Object(l.a)(t.attachmentId);Object(u.p)("AttachmentDeletion",[!1,t.isCloudy],{cosmosOnlyData:JSON.stringify({size:n.model.Size})});break;default:Object(s.a)(e)}}(e),i.deleteAttachment(e,a)}function Gt(t,e,n,r){var a=Ht[e.Id];return a||(a=function(t,e,n,r,a){return void 0===r&&(r=null),void 0===a&&(a=null),new Mt(t,e,n,r,a)}(t,e,n,i.a,o.a),Ht[e.Id]=a,a.onFinishPromise.then((function(t){delete Ht[e.Id],r&&r(t)}))),a}},7292:function(t,e,n){"use strict";var r=n(0),a=n(285),i=n(9),o=n(6990);function c(t){return Object(r.__assign)({__type:"SetAttachmentPermissionsRequest:#Exchange"},t)}var u=n(29);function s(t,e,n,r){void 0===n&&(n=null),void 0===r&&(r=!1);var a,i,o=function(t,e,n,r){return void 0===n&&(n=null),void 0===r&&(r=!1),c({AttachmentIds:t,PermissionLevel:e,NewAttachLongPathNames:n,SetToOriginalPermissionLevel:r})}(t,e,n,r);return void 0===(a={request:o}).request||a.request.__type||(a.request=c(a.request)),Object(u.a)("SetAttachmentPermissionsV2",a,i)}e.a=Object(a.action)("changeAttachmentPermission")((function(t,e,n,a){return void 0===n&&(n=null),void 0===a&&(a=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,s(t.map((function(t){return t.Id})),e,n,a)];case 1:if(!(c=r.sent()).OperationSucceeded||!c.NewAttachLongPathNames||c.NewAttachLongPathNames.length!==t.length)throw new Error("Error setting attachment permissions");return t.forEach((function(t,n){var r,a=null;(null===(r=c.ExpirationDates)||void 0===r?void 0:r[n])&&(a=Object(i.lc)(c.ExpirationDates[n])),Object(o.a)(t,e,c.NewAttachLongPathNames[n],a)})),[2]}}))}))}))},7329:function(t,e,n){"use strict";var r=n(0),a=n(440);var i=n(4378),o=n(319);function c(t){return e={ClientSupportsIrm:!0,AttachmentIds:[t]},Object(r.__assign)({__type:"DeleteAttachmentRequest:#Exchange"},e);var e}function u(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,u,s;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return n=c(t),u=Object(a.a)(t.mailboxInfo)||{},s=Object(r.__assign)(Object(r.__assign)({},u),e||{}),[4,Object(i.a)({Header:Object(o.b)(),Body:n},s)];case 1:return[2,l.sent().Body]}}))}))}n.d(e,"a",(function(){return u}))},757:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(118);function a(t){for(var e,n=[],a=Object(r.a)(t)||document;t!==a.body;){for(var i=0,o=t.parentElement.children;i<o.length;i++){var c=o[i];c!==t&&"true"!==(null===(e=c.getAttribute("aria-hidden"))||void 0===e?void 0:e.toLowerCase())&&n.push(c)}if(!t.parentElement)break;t=t.parentElement}return n.forEach((function(t){t.setAttribute("aria-hidden","true")})),function(){!function(t){t.forEach((function(t){t.setAttribute("aria-hidden","false")}))}(n),n=[]}}},8512:function(t,e,n){"use strict";var r=n(0),a=n(4562),i=n(5599),o=n(6165),c=n(285),u=n(1811);e.a=Object(c.action)("addAttachmentIntoWellBeforeUpload")((function(t,e,n,c,s){var l;void 0===s&&(s=null),n.AttachmentId=c,Object(i.a)([{attachmentId:Object(r.__assign)(Object(r.__assign)({},n.AttachmentId),{mailboxInfo:c.mailboxInfo}),attachment:n,modelInitializationValues:s}],!1,!0,!0),Object(u.s)(t)?(e.inlineAttachments.push(t),l=!0):(t.isPlaceholderAttachment=!0,Object(o.a)(n)?e.imageViewAttachments.push(t):e.docViewAttachments.push(t)),!l&&t.isCloudy||Object(a.a)(e,n.Size,n.AttachmentId)}))},8513:function(t){t.exports=JSON.parse('{"a":"pia"}')},8514:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(8515),a=n(1612),i=n(12),o=n(4375),c=n(1443),u=n(1363);function s(t,e,n,r){var i=[],o=[];if(t.forEach((function(t){n(t)?i.push(t):o.push(t)})),o.length>0){var c=r(o.map((function(t){return t.name})).join(", ")),u=c.messageId,s=c.message;Object(a.a)(e,u,[s])}return i}function l(t,e,n){Object(o.a)(n);for(var a=[],l=0;l<t.length;l++)a.push(t[l]);return a=function(t,e){return s(t,e,(function(t){return!(t.fileType===c.a.Local&&0===t.size)}),(function(t){return{messageId:"WarningEmptyFilesCanNotBeAttached",message:Object(i.c)(Object(i.b)(r.a),t)}}))}(a,n),e&&(a=function(t,e){return s(t,e,(function(t){return Object(u.g)(t.name,t.type)}),(function(t){return{messageId:"WarningInlineImageTypeNotSupported",message:Object(i.c)(Object(i.b)(r.b),t)}}))}(a,n)),a}},8515:function(t){t.exports=JSON.parse('{"a":"Zia","b":"_ia"}')},8516:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(8517),a=n(12),i=n(59),o=n(2837),c=n(6321),u=n(1612);function s(t,e,n){for(var s=0,l=0,d=void 0;d=t[l];l++)s+=d.size;var f=Object(c.a)(n);if(s>f){var h=Math.floor(f/o.b),m=void 0,p=void 0;return t.length>1?(p="ErrorTooLargeForLocalAttachmentMultiple",m=Object(a.c)(Object(a.b)(r.a),h)):(p="ErrorTooLargeForLocalAttachmentSingle",m=Object(a.c)(Object(a.b)(r.b),h)),Object(u.a)(e,p,[m]),!0}return i.g.info("Attachment: TotalSize = "+Math.floor(n.totalClassicAttachmentSize/1048576)),!1}},8517:function(t){t.exports=JSON.parse('{"a":"Xia","b":"Yia"}')},8518:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(29),a=n(723);function i(t,e){return void 0===t.itemId||t.itemId.__type||(t.itemId=Object(a.a)(t.itemId)),Object(r.a)("CreateReferenceAttachmentFromAttachmentDataProvider",t,e)}},8519:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(0),a=n(270),i=n(2697),o=n(1536),c=n(320);function u(t,e,n,a){var u=Object(c.a)()?1:0,l=Object(o.h)(),d=Object(r.__read)(l.filter((function(t){return t.type===u})),1)[0];if(!d)throw new Error("Unable to upload file as couldnt find OneDrive provider");var f=d.model.EndPointUrl,h={fileToUpload:{fileName:t,fileBlob:e},conflictBehavior:"rename",folderInfo:s(n),onProgress:a};return[1===u?Object(i.v)(1,i.e,h):Object(i.v)(0,f,h),d]}function s(t){var e=t.identifierType,n=t.identifier;switch(e){case 0:return{type:0,identifier:n};case 1:return{type:1,identifier:n};default:return Object(a.a)(e)}}},940:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(0),a=n(1),i=n(757),o=n(271),c=n(76),u=n(309),s=n(61),l=n(284),d=n(118),f=function(t){function e(n){var r=t.call(this,n)||this;return r._root=a.createRef(),r._firstBumper=a.createRef(),r._lastBumper=a.createRef(),r._hasFocus=!1,r._onRootFocus=function(t){r.props.onFocus&&r.props.onFocus(t),r._hasFocus=!0},r._onRootBlur=function(t){r.props.onBlur&&r.props.onBlur(t);var e=t.relatedTarget;null===t.relatedTarget&&(e=r._getDocument().activeElement),Object(o.a)(r._root.current,e)||(r._hasFocus=!1)},r._onFirstBumperFocus=function(){r._onBumperFocus(!0)},r._onLastBumperFocus=function(){r._onBumperFocus(!1)},r._onBumperFocus=function(t){if(!r.props.disabled){var e=t===r._hasFocus?r._lastBumper.current:r._firstBumper.current;if(r._root.current){var n=t===r._hasFocus?Object(c.i)(r._root.current,e,!0,!1):Object(c.f)(r._root.current,e,!0,!1);n&&(r._isBumper(n)?r.focus():n.focus())}}},r._onFocusCapture=function(t){r.props.onFocusCapture&&r.props.onFocusCapture(t),t.target===t.currentTarget||r._isBumper(t.target)||(r._previouslyFocusedElementInTrapZone=t.target)},r._forceFocusInTrap=function(t){if(!r.props.disabled&&e._focusStack.length&&r===e._focusStack[e._focusStack.length-1]){var n=r._getDocument().activeElement;Object(o.a)(r._root.current,n)||(r.focus(),r._hasFocus=!0,t.preventDefault(),t.stopPropagation())}},r._forceClickInTrap=function(t){if(!r.props.disabled&&e._focusStack.length&&r===e._focusStack[e._focusStack.length-1]){var n=t.target;n&&!Object(o.a)(r._root.current,n)&&(r.focus(),r._hasFocus=!0,t.preventDefault(),t.stopPropagation())}},Object(u.a)(r),r}return Object(r.__extends)(e,t),e.prototype.componentDidMount=function(){this._bringFocusIntoZone(),this._updateEventHandlers(this.props),!this.props.disabled&&this._root.current&&this.props.enableAriaHiddenSiblings&&(this._unmodalize=Object(i.a)(this._root.current))},e.prototype.UNSAFE_componentWillReceiveProps=function(t){var e=t.elementToFocusOnDismiss;e&&this._previouslyFocusedElementOutsideTrapZone!==e&&(this._previouslyFocusedElementOutsideTrapZone=e),this._updateEventHandlers(t)},e.prototype.componentDidUpdate=function(t){var e=void 0===t.forceFocusInsideTrap||t.forceFocusInsideTrap,n=void 0===this.props.forceFocusInsideTrap||this.props.forceFocusInsideTrap,r=void 0!==t.disabled&&t.disabled,a=void 0!==this.props.disabled&&this.props.disabled;!e&&n||r&&!a?(this._bringFocusIntoZone(),!this._unmodalize&&this._root.current&&this.props.enableAriaHiddenSiblings&&(this._unmodalize=Object(i.a)(this._root.current))):(e&&!n||!r&&a)&&(this._returnFocusToInitiator(),this._unmodalize&&this._unmodalize())},e.prototype.componentWillUnmount=function(){this.props.disabled&&!this.props.forceFocusInsideTrap&&Object(o.a)(this._root.current,this._getDocument().activeElement)||this._returnFocusToInitiator(),this._disposeClickHandler&&(this._disposeClickHandler(),this._disposeClickHandler=void 0),this._disposeFocusHandler&&(this._disposeFocusHandler(),this._disposeFocusHandler=void 0),this._unmodalize&&this._unmodalize(),delete this._previouslyFocusedElementInTrapZone,delete this._previouslyFocusedElementOutsideTrapZone},e.prototype.render=function(){var t=this.props,e=t.className,n=t.disabled,i=void 0!==n&&n,o=t.ariaLabelledBy,c=Object(s.j)(this.props,s.h),u={"aria-hidden":!0,style:{pointerEvents:"none",position:"fixed"},tabIndex:i?-1:0,"data-is-visible":!0};return a.createElement("div",Object(r.__assign)({},c,{className:e,ref:this._root,"aria-labelledby":o,onFocusCapture:this._onFocusCapture,onFocus:this._onRootFocus,onBlur:this._onRootBlur}),a.createElement("div",Object(r.__assign)({},u,{ref:this._firstBumper,onFocus:this._onFirstBumperFocus})),this.props.children,a.createElement("div",Object(r.__assign)({},u,{ref:this._lastBumper,onFocus:this._onLastBumperFocus})))},e.prototype.focus=function(){var t=this.props,e=t.focusPreviouslyFocusedInnerElement,n=t.firstFocusableSelector,r=t.firstFocusableTarget;if(e&&this._previouslyFocusedElementInTrapZone&&Object(o.a)(this._root.current,this._previouslyFocusedElementInTrapZone))this._focusAsync(this._previouslyFocusedElementInTrapZone);else{var a="string"==typeof n?n:n&&n(),i=null;this._root.current&&("string"==typeof r?i=this._root.current.querySelector(r):r?i=r(this._root.current):a&&(i=this._root.current.querySelector("."+a)),i||(i=Object(c.j)(this._root.current,this._root.current.firstChild,!1,!1,!1,!0))),i&&this._focusAsync(i)}},e.prototype._focusAsync=function(t){this._isBumper(t)||Object(c.b)(t)},e.prototype._bringFocusIntoZone=function(){var t=this.props,n=t.elementToFocusOnDismiss,r=t.disabled,a=void 0!==r&&r,i=t.disableFirstFocus,c=void 0!==i&&i;a||(e._focusStack.push(this),this._previouslyFocusedElementOutsideTrapZone=n||this._getDocument().activeElement,c||Object(o.a)(this._root.current,this._previouslyFocusedElementOutsideTrapZone)||this.focus())},e.prototype._returnFocusToInitiator=function(){var t=this,n=this.props.ignoreExternalFocusing;e._focusStack=e._focusStack.filter((function(e){return t!==e}));var r=this._getDocument(),a=r.activeElement;n||!this._previouslyFocusedElementOutsideTrapZone||"function"!=typeof this._previouslyFocusedElementOutsideTrapZone.focus||!Object(o.a)(this._root.current,a)&&a!==r.body||this._focusAsync(this._previouslyFocusedElementOutsideTrapZone)},e.prototype._updateEventHandlers=function(t){var e=t.isClickableOutsideFocusTrap,n=void 0!==e&&e,r=t.forceFocusInsideTrap,a=void 0===r||r;a&&!this._disposeFocusHandler?this._disposeFocusHandler=Object(l.a)(window,"focus",this._forceFocusInTrap,!0):!a&&this._disposeFocusHandler&&(this._disposeFocusHandler(),this._disposeFocusHandler=void 0),n||this._disposeClickHandler?n&&this._disposeClickHandler&&(this._disposeClickHandler(),this._disposeClickHandler=void 0):this._disposeClickHandler=Object(l.a)(window,"click",this._forceClickInTrap,!0)},e.prototype._isBumper=function(t){return t===this._firstBumper.current||t===this._lastBumper.current},e.prototype._getDocument=function(){return Object(d.a)(this._root.current)},e._focusStack=[],e}(a.Component)}}]);
//# sourceMappingURL=owa.MailBoot~Attachments~filesView.js.map
self.scriptsLoaded['owa.MailBoot~Attachments~filesView.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Attachments~filesView.js'] = (new Date()).getTime();