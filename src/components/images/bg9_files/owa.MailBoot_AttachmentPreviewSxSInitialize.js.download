self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentPreviewSxSInitialize.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[470],{10866:function(t,n,e){"use strict";e.r(n);var r=e(0),o=e(3),i=e(3386),u=e(2371),c=e(4629),a=e(8614),s=e(6382),d=e(5068),l=e(5473),f=e(8615);Object(o.orchestrator)(i.b,(function(t){var n=t.element,e=t.href,o=t.itemId,p=t.isSafeLinkWrapped,b=t.isSafeLinkVerified,h=t.isOfficeSPLink;Object(i.j)(e);var v=function(t){!function(t,n,e,o,i,c,a){var p=this,b=null;if(!(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)){var h=Object(d.b)(e),v=h.docLinkPreviewInfo,g=h.reason;if((null==v?void 0:v.needRedeem)||"Expired"===g)return Object(u.a)((function(){return Object(r.__awaiter)(p,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(u){switch(u.label){case 0:return[4,Object(s.a)(e,!0,!0)];case 1:return t=u.sent(),n=(null==v?void 0:v.needRedeem)?"redeem":"retryAfterCacheExpire",Object(l.a)(null,o,i,n,c),[2,Object(r.__assign)(Object(r.__assign)({},t.wacUrlInfo),{extraInfo:n})]}}))}))}),n,a),void t.preventDefault();if(v)return Object(u.a)((function(){return Promise.resolve(v.wacUrlInfo)}),n,a),t.preventDefault(),void Object(l.a)(null,o,i,null,c);b=g}Object(f.a)(t,o,i,b)}(t,o,e,p,b,h,n.ownerDocument.defaultView)};n.addEventListener("click",v),n[c.a]=v;var g=function(t){Object(a.a)(t,p,b)};n.addEventListener("mouseup",g),n[c.b]=g}));e(8331);var p=e(2381),b=e(6387);Object(o.orchestrator)(p.h,(function(t){var n=t.itemAttachmentId,e=t.perfDatapoint;b.a.importAndExecute(n,e)}));var h=e(4143);Object(o.orchestrator)(h.a,(function(t){var n=t.context;p.d.importAndExecute(n)}));var v=e(3404),g=e(1416);Object(o.orchestrator)(v.l,(function(t){var n=t.wacUrlGetter,e=t.linkId,r=t.readOnly,o=t.targetWindow;p.g.importAndExecute(n,null,p.a.ComposeDocLink,{method:p.b.CopyMailReadingPaneContainer},null,e,r,o)})),Object(o.orchestrator)(g.M,(function(t){var n=t.selectedLinkId,e=t.isSelectedLinkReadOnly;Object(v.k)(n,e)}));var m=e(3159);Object(o.orchestrator)(m.f,(function(t){var n=t.wacUrlGetter,e=t.itemId,r=t.targetWindow;p.g.importAndExecute(n,e,p.a.ReadingPaneDocLink,{method:p.b.CopyMailReadingPaneContainer},null,null,null,r)}))},1326:function(t,n,e){"use strict";function r(t){if(!t)return null;var n=t.lastIndexOf(".");return n>0?t.substr(n).toLowerCase():null}function o(t){var n=r(t);return n?n.replace(".",""):null}function i(t){var n;return(null===(n=o(t))||void 0===n?void 0:n.substring(0,4))||""}e.d(n,"a",(function(){return r})),e.d(n,"b",(function(){return o})),e.d(n,"c",(function(){return i}))},1379:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(1679);function o(t){return Object(r.a)().attachments.get(t.Id)}},1382:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(0);function o(t){return Object(r.__assign)({__type:"TargetFolderId:#Exchange"},t)}},1445:function(t,n,e){"use strict";e.d(n,"a",(function(){return ReactEditor})),e.d(n,"d",(function(){return i})),e.d(n,"c",(function(){return u})),e.d(n,"b",(function(){return a}));var r=e(77),o=new r.c((function(){return Promise.all([e.e(14),e.e(21),e.e(26),e.e(32),e.e(35),e.e(39),e.e(584)]).then(e.bind(null,2465))})),ReactEditor=Object(r.d)(o,(function(t){return t.ReactEditor})),i=new r.b(o,(function(t){return t.setTableHeaderRow})),u=new r.b(o,(function(t){return t.operateContent})),c=new r.b(o,(function(t){return t.focusToEditor}));function a(t){c.import().then((function(n){return n(t)}))}},1469:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(0);function o(t){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},t)}},1500:function(t,n,e){"use strict";e.d(n,"a",(function(){return o})),e.d(n,"g",(function(){return i})),e.d(n,"d",(function(){return u})),e.d(n,"c",(function(){return c})),e.d(n,"f",(function(){return a})),e.d(n,"b",(function(){return s})),e.d(n,"e",(function(){return d}));var r=e(3),o=Object(r.action)("ADD_SHARING_LINK",(function(t,n,e,r,o,i,u,c){return{linkId:t,url:n,sharingLinkIds:e,response:r,source:o,providerType:i,unwrappedUrl:u,creationDateTime:c}})),i=Object(r.action)("SHARING_LINK_REMOVED",(function(t,n){return{linkId:t,sharingLinkIds:n}})),u=Object(r.action)("DELETE_LINK",(function(t,n){return{linkId:t,targetWindow:n}})),c=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",(function(t,n,e,r){return{linkId:t,providerId:n,isTryAgain:e,targetWindow:r}})),a=Object(r.action)("ON_LINK_HAS_CHANGED",(function(t,n,e,r){return{linkId:t,recipientInfos:n,composeId:e,isCalendar:r}})),s=Object(r.action)("ADD_SHARING_LINK_TO_CONTAINER",(function(t,n){return{linkId:t,linkIdContainer:n}})),d=Object(r.action)("ON_FLUID_LINK_CREATED",(function(t,n,e,r){return{linkId:t,containerId:n,owaSource:e,url:r}}))},1505:function(t,n,e){"use strict";var r=e(3),o=e(20),i=e(1604),u={providers:new o.ObservableMap,loadState:i.a.NotLoaded,removalPending:new o.ObservableMap},c=Object(r.createStore)("fileProviderStore",u);n.a=c},1506:function(t,n,e){"use strict";e.d(n,"b",(function(){return i})),e.d(n,"a",(function(){return o})),e.d(n,"c",(function(){return u}));var r=e(3),o=Object(r.action)("FILE_PROVIDER_ADDED",(function(t){return{providerViewState:t}})),i=Object(r.action)("FILE_PROVIDER_REMOVED",(function(t){return{providerType:t}})),u=Object(r.action)("PROVIDERS_LOADED",(function(t){return{providers:t}}))},1526:function(t,n,e){"use strict";e.d(n,"e",(function(){return o})),e.d(n,"f",(function(){return i})),e.d(n,"g",(function(){return u})),e.d(n,"c",(function(){return c})),e.d(n,"b",(function(){return a})),e.d(n,"a",(function(){return s})),e.d(n,"d",(function(){return d}));var r=e(3),o=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",(function(t,n){return{linkId:t,sharingDialogResponse:n}})),i=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",(function(t,n){return{linkId:t,newPermission:n}})),u=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",(function(t,n,e,r){return{linkId:t,newLinkUrl:n,oldLinkUrl:e,expirationDate:r}})),c=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",(function(t,n){return{linkId:t,actionStatus:n}})),a=Object(r.action)("CREATE_OR_UPDATE_SHARING_LINK",(function(t,n,e,r,o,i,u,c,a){return{linkId:t,sharingUrl:n,currentUrl:e,canonicalUrl:r,newPermissionLevel:o,providerType:i,composeId:u,recipientInfos:c,isCalendar:a}})),s=Object(r.action)("ADD_SHARING_LINK_INFO",(function(t,n){return{linkId:t,linkModel:n}})),d=Object(r.action)("TOKEN_UNAVAILABLE",(function(t){return{linkId:t}}))},1527:function(t,n,e){"use strict";var r;function o(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}e.d(n,"a",(function(){return r})),e.d(n,"b",(function(){return o})),function(t){t.noPermissionToShare="WarningNoPermissionToShare",t.getSharingInfoFailed="WarningGetSharingInfoFailed",t.linkHasExpired="WarningLinksHasExpired",t.linkWillExpire="WarningLinksWillExpire",t.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",t.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",t.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",t.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1528:function(t,n,e){"use strict";var r,o=e(77),i=e(1500),u=e(1526),c=e(2229);!function(t){t.PasteHtml="PasteHtml",t.InsertLinkFromToolbar="InsertLinkFromToolbar",t.InsertLinkFromAttachMenu="InsertLinkFromAttachMenu",t.AutoLink="AutoLink",t.ReplyOrForward="ReplyOrForward",t.LinkContextMenu="LinkContextMenu",t.Undo="Undo",t.EditorLoadedOrDraftOrReply="EditorLoadedOrDraftOrReply",t.RestoreCursor="RestoreCursor",t.ShareLinkCompose="ShareLinkCompose",t.NewFluidFile="NewFluidFile",t.Unknown="Unknown"}(r||(r={}));var a=e(2043),s=e(1693),d=e(1596),l=[r.PasteHtml,r.InsertLinkFromToolbar,r.AutoLink,r.ShareLinkCompose,r.InsertLinkFromAttachMenu];function f(t){var n=Object(d.a)(t);return n&&-1!==l.indexOf(n.source)}var p=e(2044);function b(t){var n=Object(d.a)(t);return n?{id:n.linkId,name:n.fileName,supportsDownsell:!1,currentPermissionLevel:n.permissionLevel,sharingInfo:n.sharingInfo,sharingTipsIgnored:n.sharingTipsIgnored,sharingRecipientsInfo:n.sharingRecipientsInfo,typeOfLink:f(t)?"newLink":"oldLink"}:null}var h=e(2228);function v(){return Object(h.a)().sharingLinks.size}var g=e(2230);e.d(n,"q",(function(){return O})),e.d(n,"u",(function(){return _})),e.d(n,"y",(function(){return k})),e.d(n,"w",(function(){return j})),e.d(n,"v",(function(){return y})),e.d(n,"t",(function(){return I})),e.d(n,"x",(function(){return w})),e.d(n,"s",(function(){return C})),e.d(n,"r",(function(){return T})),e.d(n,"B",(function(){return m})),e.d(n,"c",(function(){return i.a})),e.d(n,"d",(function(){return i.b})),e.d(n,"e",(function(){return i.c})),e.d(n,"g",(function(){return i.d})),e.d(n,"E",(function(){return i.g})),e.d(n,"z",(function(){return i.e})),e.d(n,"A",(function(){return i.f})),e.d(n,"F",(function(){return u.e})),e.d(n,"G",(function(){return u.f})),e.d(n,"H",(function(){return u.g})),e.d(n,"D",(function(){return u.c})),e.d(n,"f",(function(){return u.b})),e.d(n,"C",(function(){return c.b})),e.d(n,"a",(function(){return r})),e.d(n,"n",(function(){return a.a})),e.d(n,"h",(function(){return s.a})),e.d(n,"i",(function(){return s.b})),e.d(n,"p",(function(){return s.c})),e.d(n,"o",(function(){return f})),e.d(n,"b",(function(){return p.a})),e.d(n,"l",(function(){return d.a})),e.d(n,"k",(function(){return b})),e.d(n,"j",(function(){return v})),e.d(n,"m",(function(){return g.a}));var m=new o.c((function(){return Promise.all([e.e(1),e.e(33),e.e(70),e.e(610)]).then(e.bind(null,16638))})),O=new o.b(m,(function(t){return t.addRecipientsIntoLink})),_=new o.b(m,(function(t){return t.removeRecipientsFromLink})),k=new o.b(m,(function(t){return t.updateRecipientPermissionInfos})),j=new o.b(m,(function(t){return t.setGetPermissionInfoFailure})),y=new o.b(m,(function(t){return t.resetSharingRecipientsInfo})),I=new o.b(m,(function(t){return t.ignoreSharingTip})),w=new o.b(m,(function(t){return t.setLinkActionStatus})),C=new o.b(m,(function(t){return t.getSharingTipRecipientInfo})),T=new o.b(m,(function(t){return t.createCloudFileFromSharingLink}))},1536:function(t,n,e){"use strict";e.d(n,"l",(function(){return p})),e.d(n,"n",(function(){return b})),e.d(n,"k",(function(){return h})),e.d(n,"m",(function(){return v}));var r=e(77),o=e(1754);e.d(n,"b",(function(){return o.a}));var i=e(1700);e.d(n,"i",(function(){return i.a}));e(1505);var u=e(1506);e.d(n,"d",(function(){return u.a})),e.d(n,"e",(function(){return u.b})),e.d(n,"o",(function(){return u.c}));var c=e(1701);e.d(n,"a",(function(){return c.b}));var a=e(1567);e.d(n,"g",(function(){return a.a})),e.d(n,"h",(function(){return a.b}));var s=e(1691);e.d(n,"j",(function(){return s.a}));var d=e(1604);e.d(n,"c",(function(){return d.a}));var l=e(1680);e.d(n,"f",(function(){return l.b}));var f=new r.c((function(){return Promise.all([e.e(1),e.e(549)]).then(e.bind(null,2984))})),p=new r.b(f,(function(t){return t.loadProviders})),b=new r.b(f,(function(t){return t.removeFileProvider})),h=new r.b(f,(function(t){return t.addFileProvider})),v=new r.b(f,(function(t){return t.removeAndAddFileProvider}))},1567:function(t,n,e){"use strict";e.d(n,"b",(function(){return i})),e.d(n,"a",(function(){return u}));var r=e(0),o=e(1505),i=function(){return Object(r.__spread)(Object(o.a)().providers.values())},u=function(t){return Object(o.a)().providers.get(t)||null}},1596:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(2228),o=e(1693);function i(t){var n=Object(r.a)(),e=Object(o.b)(t);return n.sharingLinks.get(e)}},1604:function(t,n,e){"use strict";var r;e.d(n,"a",(function(){return r})),function(t){t[t.Loaded=0]="Loaded",t[t.Loading=1]="Loading",t[t.NotLoaded=2]="NotLoaded",t[t.Throttled=3]="Throttled"}(r||(r={}))},1680:function(t,n,e){"use strict";var r=e(0),o=e(29);function i(t){return Object(r.__assign)({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},t)}function u(t){var n,e,r=i({ProviderType:t});return void 0===(n=r)||n.__type||(n=i(n)),Object(o.a)("GetNewAttachmentDataProviderCreationInfo",n,e)}function c(t){return Object(r.__assign)({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},t)}function a(t){var n,e,r=c({ProviderType:t});return void 0===(n=r)||n.__type||(n=c(n)),Object(o.a)("GetAttachmentDataProviderCreator",n,e)}var s=e(2026),d=e(1953);e.d(n,"a",(function(){return m})),e.d(n,"b",(function(){return k}));var l="code",f="token",p=3e3,b=3;function h(t){return{state:t}}function v(t){return t.state}function g(t){return t.code}function m(t,n,e,o,i){var c={providerType:t,getAuthUrlInfo:null,getCSRFToken:v,getOAuthCode:g};return function t(n,e,o,i,c,d,l){return Object(r.__awaiter)(this,void 0,void 0,(function(){var f,b;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),f=void 0,7!==n&&9!==n&&8!==n?[3,2]:[4,a(n)];case 1:return b=r.sent(),f=b.AttachmentDataProviderCreator.ProviderAppKey,o=b.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,u(n)];case 3:b=r.sent(),f=b.ProviderAppKey,r.label=4;case 4:return e.getAuthUrlInfo=Object(s.d)(n,o,i,f,c,d),[3,6];case 5:return r.sent(),l>0&&setTimeout((function(){return t(n,e,o,i,c,d,--l)}),p),[3,6];case 6:return[2]}}))}))}(t,c,n,e,o,i,b),c}var O=null;function _(){if(!O){if(O={},Object(d.a)(3)&&(O[3]=m(3,"https://app.box.com/api/oauth2/authorize",Object(s.c)(3),l,h)),Object(d.a)(2)&&(O[2]=m(2,"https://www.dropbox.com/oauth2/authorize",Object(s.b)(2),l,h)),Object(d.a)(6)){var t=m(6,"https://www.facebook.com/dialog/oauth",Object(s.b)(6),f,(function(t){return{state:t,scope:"user_photos,email"}}));t.getCSRFToken=v,t.getOAuthCode=function(t){return t.access_token},O[6]=t}if(Object(d.a)(5)){var n=m(5,"https://accounts.google.com/o/oauth2/auth",s.a+"/ADPRedirect.aspx",l,(function(t){var n={state:t,provider:5..toString(),url:Object(s.b)()};return{state:JSON.stringify(n),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}}));n.getCSRFToken=function(t){return JSON.parse(t.state).state},O[5]=n}Object(d.a)(1)&&(O[1]=m(1,"https://login.live.com/oauth20_authorize.srf",Object(s.c)(1),l,(function(t){return{state:t,scope:"wl.basic onedrive.readwrite wl.offline_access"}}))),Object(d.a)(7)&&(O[7]=m(7,"",Object(s.c)(7),l,h)),Object(d.a)(8)&&(O[8]=m(8,"",Object(s.c)(8),l,h)),Object(d.a)(9)&&(O[9]=m(9,"",Object(s.c)(9),l,h))}return O}function k(t){var n=_();return t in n?n[t]:null}},1691:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(1505);function o(){return Object(r.a)().loadState}},1693:function(t,n,e){"use strict";e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return u})),e.d(n,"a",(function(){return c}));var r=e(83),o="_ODSPPSL";function i(t){return Object(r.i)("doc-link-savePermission")&&t&&-1!==t.indexOf(o)?t.substring(0,t.length-o.length):t}function u(t){return!!Object(r.i)("doc-link-savePermission")&&t.lastIndexOf(o)===t.length-o.length}function c(t,n){return!Object(r.i)("doc-link-savePermission")||2!==n&&1!==n?t:t+o}},1694:function(t,n,e){"use strict";var r;e.d(n,"a",(function(){return r})),function(t){t[t.InProgress=0]="InProgress",t[t.Failed=1]="Failed",t[t.Succeeded=2]="Succeeded"}(r||(r={}))},1700:function(t,n,e){"use strict";e.d(n,"a",(function(){return a}));var r=e(2077),o=e(1973),i=e(2041),u=e(12),c=e(270);function a(t,n){if(void 0===n&&(n=!1),n)return"";switch(t){case 0:return Object(u.b)(i.b);case 1:return Object(u.b)(i.a);case 2:case 9:return Object(u.b)(r.b);case 3:case 7:return Object(u.b)(r.a);case 5:return Object(u.b)(r.e);case 6:return Object(u.b)(r.d);case 4:return Object(u.b)(r.f);case 10:return Object(u.b)(o.b);case 8:return Object(u.b)(r.c);default:return Object(c.a)(t)}}},1701:function(t,n,e){"use strict";e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return i})),e.d(n,"c",(function(){return u}));var r,o=e(0);!function(t){t[t.Groups=1e4]="Groups"}(r||(r={}));var i=Object.freeze([1,3,2,6,5,7,8,9]),u=Object.freeze(Object(o.__spread)(i,[0,4,10]))},1718:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(3),o=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(t){return{id:t}}))},1719:function(t,n,e){"use strict";var r;e.d(n,"a",(function(){return r})),function(t){t[t.ignore=0]="ignore",t[t.refreshExpiration=1]="refreshExpiration",t[t.changePermission=2]="changePermission",t[t.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1754:function(t,n,e){"use strict";var r;!function(t){t[t.None=0]="None",t[t.Images=1]="Images"}(r||(r={})),n.a=r},1780:function(t,n,e){"use strict";e.d(n,"a",(function(){return o})),e.d(n,"b",(function(){return i}));var r=e(1681);function o(t){return u(t.type)}function i(t){return u(Object(r.a)(t))}function u(t){return 1===t||3===t}},1874:function(t,n,e){"use strict";e.d(n,"h",(function(){return s})),e.d(n,"i",(function(){return d})),e.d(n,"f",(function(){return l})),e.d(n,"k",(function(){return f})),e.d(n,"m",(function(){return p})),e.d(n,"e",(function(){return b})),e.d(n,"g",(function(){return h})),e.d(n,"j",(function(){return v})),e.d(n,"l",(function(){return g}));var r=e(77),o=e(1718);e.d(n,"n",(function(){return o.a}));var i=e(1694);e.d(n,"a",(function(){return i.a}));var u=e(1527);e.d(n,"d",(function(){return u.b})),e.d(n,"c",(function(){return u.a}));var c=e(1719);e.d(n,"b",(function(){return c.a}));var a=new r.c((function(){return Promise.all([e.e(1),e.e(33),e.e(70),e.e(724)]).then(e.bind(null,2900))})),s=new r.b(a,(function(t){return t.getSharingInformation})),d=new r.b(a,(function(t){return t.getSharingIssuesForSharingData})),l=new r.b(a,(function(t){return t.getInfoBarCreator})),f=new r.b(a,(function(t){return t.hasLargeDLRecipient})),p=new r.b(a,(function(t){return t.hasRecipientExpansionFailure})),b=new r.b(a,(function(t){return t.getGroupsAndSmallDLs})),h=new r.b(a,(function(t){return t.getInvididualRecipients})),v=new r.b(a,(function(t){return t.hasGetRecipientPermissionFailed})),g=new r.b(a,(function(t){return t.logSharingTipChangesForLinkRemoval}))},1903:function(t,n,e){"use strict";var r;e.d(n,"a",(function(){return r})),function(t){t[t.Initial=0]="Initial",t[t.Adaptive=1]="Adaptive",t[t.Show=2]="Show",t[t.Hide=3]="Hide",t[t.AlwaysHide=4]="AlwaysHide"}(r||(r={}))},1917:function(t,n,e){"use strict";var r=function(){function t(){this.eventDictionary={}}return t.prototype.on=function(t,n,e){return(this.eventDictionary[t]||(this.eventDictionary[t]=[])).push({callback:n,callbackThis:e}),this},t.prototype.emit=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var r=(this.eventDictionary[t]||[]).slice();return r.forEach((function(t){return t.callback.apply(t.callbackThis,n)})),this},t.prototype.off=function(t,n){var e=this.eventDictionary[t];if(e){var r=e.filter((function(t){return t.callback!==n}));r.length?this.eventDictionary[t]=r:delete this.eventDictionary[t]}return this},t.prototype.once=function(t,n,e){var r=this,o=function(){for(var i=[],u=0;u<arguments.length;u++)i[u]=arguments[u];return r.off(t,o),n.apply(e,i)};return(this.eventDictionary[t]||(this.eventDictionary[t]=[])).push({callback:o,callbackThis:e}),this},t}();n.a=r},1919:function(t,n,e){"use strict";var r;e.d(n,"a",(function(){return r})),function(t){t[t.Blank=0]="Blank",t[t.Loading=1]="Loading",t[t.Error=2]="Error",t[t.Custom=3]="Custom",t[t.Image=4]="Image",t[t.Wac=5]="Wac",t[t.Audio=6]="Audio",t[t.Video=7]="Video",t[t.Text=8]="Text",t[t.NativePdf=9]="NativePdf",t[t.PdfJs=10]="PdfJs",t[t.IFrame=11]="IFrame"}(r||(r={}))},1953:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(1384),o=e(320),i=e(270),u=e(83);function c(t){var n=Object(r.a)();switch(t){case 5:return(null==n?void 0:n.GoogleDriveAttachmentsEnabled)&&(null==n?void 0:n.ThirdPartyAttachmentsEnabled)&&Object(u.i)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return(null==n?void 0:n.BoxAttachmentsEnabled)&&(null==n?void 0:n.ThirdPartyAttachmentsEnabled)&&Object(u.i)("doc-fileProvider-box");case 2:return(null==n?void 0:n.DropboxAttachmentsEnabled)&&(null==n?void 0:n.ThirdPartyAttachmentsEnabled)&&Object(u.i)("doc-fileProvider-dropbox");case 6:return(null==n?void 0:n.ThirdPartyAttachmentsEnabled)&&Object(u.i)("doc-fileProvider-facebook");case 1:return!!Object(o.a)()||(null==n?void 0:n.OnedriveAttachmentsEnabled)&&(null==n?void 0:n.ThirdPartyAttachmentsEnabled);case 10:return Object(u.i)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return(null==n?void 0:n.ThirdPartyAttachmentsEnabled)&&Object(u.i)("doc-fileProvider-wopiClient");default:return Object(i.a)(t)}}},1973:function(t){t.exports=JSON.parse('{"a":"cga","b":"dga"}')},2014:function(t,n,e){"use strict";e.d(n,"a",(function(){return i})),e.d(n,"c",(function(){return u})),e.d(n,"e",(function(){return c})),e.d(n,"f",(function(){return a})),e.d(n,"d",(function(){return s})),e.d(n,"b",(function(){return d}));var r=e(77),o=new r.c((function(){return e.e(900).then(e.bind(null,2987))})),i=new r.b(o,(function(t){return t.extractFileUrlFromOfficeSharePointLink})),u=new r.b(o,(function(t){return t.isLinkPrefixedWithBaseUrl})),c=new r.b(o,(function(t){return t.isSharePointLink})),a=new r.b(o,(function(t){return t.isSharePointServiceGeneratedLink})),s=new r.b(o,(function(t){return t.isOfficeSharePointLink})),d=new r.b(o,(function(t){return t.getParsedQueryStringFromUrl}))},2026:function(t,n,e){"use strict";var r=e(722),o=e(2);function i(t,n,e){if(!t||!n||!e)throw new Error("Key and Value parameters should not be null");return t.indexOf("?")>0?t+"&"+n+"="+e:t+"?"+n+"="+e}e.d(n,"a",(function(){return u})),e.d(n,"b",(function(){return c})),e.d(n,"c",(function(){return a})),e.d(n,"d",(function(){return s}));var u=Object(o.G)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(t){var n=t?encodeURIComponent("?provider="+t):"",e=t&&6===t?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.l)()+"/mail/"+e+n}function a(t){var n=Object(r.l)()+"/mail/AddFileProvider.html",e=encodeURIComponent("provider="+t+"&url="+n);return u+"/ADPRedirect.aspx?"+e}function s(t,n,e,r,o,u){return function(){var t=function(){for(var t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),n=t.length-1,e=[],r=0;r<16;r++)e.push(t[Math.round(Math.random()*n)]);return"owa_csrf_token_"+e.join("")}(),c=i(n,"client_id",r);if(c=i(c,"redirect_uri",e),c=i(c,"response_type",o),u){var a=u(t);c=Object.keys(a).reduce((function(t,n){return i(t,n,a[n])}),c)}return{authUrl:c,redirectUrl:e,csrfToken:t}}}},2041:function(t){t.exports=JSON.parse('{"b":"qga","a":"rga"}')},2043:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(1326);function o(t){var n=(Object(r.a)(t)||"").toLowerCase();return!!t&&".fluid"===n}},2044:function(t,n,e){"use strict";var r;e.d(n,"a",(function(){return r})),function(t){t[t.none=0]="none",t[t.refreshing=1]="refreshing",t[t.refreshFailed=2]="refreshFailed",t[t.refreshSucceeded=3]="refreshSucceeded",t[t.attachingAsACopy=4]="attachingAsACopy",t[t.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(r||(r={}))},2077:function(t){t.exports=JSON.parse('{"b":"kga","a":"lga","e":"mga","d":"nga","f":"oga","c":"pga"}')},2118:function(t,n,e){"use strict";var r;e.d(n,"a",(function(){return r})),function(t){t[t.NoOp=0]="NoOp",t[t.AlwaysHidden=1]="AlwaysHidden",t[t.CopyMailReadingPaneContainer=2]="CopyMailReadingPaneContainer",t[t.LoadConversationReadingPane=3]="LoadConversationReadingPane",t[t.LoadItemReadingPane=4]="LoadItemReadingPane"}(r||(r={}))},2149:function(t,n,e){"use strict";var r=null,o={register:function(t){r=t},available:function(){return!!r},run:function(t,n){r&&r(t,n)}};n.a=o},2228:function(t,n,e){"use strict";var r=e(20),o=e(3),i={sharingLinks:new r.ObservableMap({})},u=Object(o.createStore)("sharingLinkStore",i);n.a=u},2229:function(t,n,e){"use strict";function r(t){return void 0!==t.recipients}function o(t){return void 0!==t.length}e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return o}))},2230:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(0),o=e(2014),i=e(97),u=e(317);function c(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,o.b.import()];case 1:return n=e.sent(),[2,a(n(t))]}}))}))}function a(t){if(!Object(i.b)(null==t?void 0:t.nav)){var n={nav:t.nav};return Object(u.stringify)(n)}return null}},2235:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(3),o=Object(r.action)("loadItemAttachment",(function(t,n){return{itemAttachmentId:t,perfDatapoint:n}}))},2381:function(t,n,e){"use strict";e.d(n,"d",(function(){return s})),e.d(n,"e",(function(){return d})),e.d(n,"f",(function(){return l})),e.d(n,"g",(function(){return f}));var r=e(77),o=e(1416);e.d(n,"a",(function(){return o.c}));var i=e(2149);e.d(n,"c",(function(){return i.a}));var u=e(2118);e.d(n,"b",(function(){return u.a}));var c=e(2235);e.d(n,"h",(function(){return c.a}));var a=new r.c((function(){return Promise.all([e.e(1),e.e(33),e.e(62),e.e(63),e.e(67),e.e(213),e.e(469)]).then(e.bind(null,4340))})),s=new r.a(a,(function(t){return t.previewAttachment})),d=new r.a(a,(function(t){return t.previewAttachmentInSxS})),l=new r.a(a,(function(t){return t.previewImageInSxS})),f=new r.a(a,(function(t){return t.previewLinkInSxS}))},337:function(t,n,e){"use strict";var r=e(726);e.d(n,"a",(function(){return r.a}))},3386:function(t,n,e){"use strict";e.d(n,"j",(function(){return o})),e.d(n,"i",(function(){return i})),e.d(n,"g",(function(){return u})),e.d(n,"c",(function(){return c})),e.d(n,"f",(function(){return a})),e.d(n,"d",(function(){return s})),e.d(n,"h",(function(){return d})),e.d(n,"e",(function(){return l})),e.d(n,"a",(function(){return f})),e.d(n,"b",(function(){return p}));var r=e(3),o=Object(r.action)("tryQueueGetWacInfo",(function(t){return{url:t}})),i=Object(r.action)("queueGetWacInfo",(function(t){return{url:t}})),u=Object(r.action)("processGetWacInfoQueue"),c=Object(r.action)("getWacInfoQueueShift"),a=Object(r.action)("onStartGetWacInfoOperation",(function(t){return{url:t}})),s=Object(r.action)("onFinishGetWacInfoOperation",(function(t){return{url:t}})),d=Object(r.action)("pushSupressedUrl",(function(t){return{url:t}})),l=Object(r.action)("onGetWacInfoSuccess",(function(t,n,e){return{url:t,wacUrlInfo:n,needRedeem:e}})),f=Object(r.action)("addGenericLinkClickListener",(function(t,n,e){return{element:t,isSafeLinkWrapped:n,isSafeLinkVerified:e}})),p=Object(r.action)("addOpenDocumentPreviewEventListener",(function(t,n,e,r,o,i){return{element:t,href:n,itemId:e,isSafeLinkWrapped:r,isSafeLinkVerified:o,isOfficeSPLink:i}}))},396:function(t,n,e){"use strict";e.d(n,"b",(function(){return c})),e.d(n,"a",(function(){return a}));var r=e(0),o=e(14),i=e(342),u=function(){return{position:"absolute",width:1,right:31,top:8,bottom:8}};function c(t){var n,e,i,c,a,s=t.semanticColors,d=t.palette,l=s.buttonBackground,f=s.buttonBackgroundPressed,p=s.buttonBackgroundHovered,b=s.buttonText,h=s.buttonTextHovered,v=s.buttonTextChecked,g=s.buttonTextCheckedHovered;return{root:{backgroundColor:l,color:b},rootHovered:{backgroundColor:p,color:h,selectors:(n={},n[o.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},n)},rootPressed:{backgroundColor:f,color:v},rootExpanded:{backgroundColor:f,color:v},rootChecked:{backgroundColor:f,color:v},rootCheckedHovered:{backgroundColor:f,color:g},rootDisabled:{selectors:(e={},e[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},e)},splitButtonContainer:{selectors:(i={},i[o.HighContrastSelector]={border:"none"},i)},splitButtonMenuButton:{color:d.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:d.neutralLight,selectors:(c={},c[o.HighContrastSelector]={color:"Highlight"},c)}}},splitButtonMenuButtonDisabled:{backgroundColor:s.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:s.buttonBackgroundDisabled}}},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},u()),{backgroundColor:d.neutralTertiaryAlt,selectors:(a={},a[o.HighContrastSelector]={backgroundColor:"WindowText"},a)}),splitButtonDividerDisabled:{backgroundColor:t.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:d.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:d.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:d.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:d.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:s.buttonText},splitButtonMenuIconDisabled:{color:s.buttonTextDisabled}}}function a(t){var n,e,c,a,s,d,l,f,p,b=t.palette,h=t.semanticColors;return{root:{backgroundColor:h.primaryButtonBackground,border:"1px solid "+h.primaryButtonBackground,color:h.primaryButtonText,selectors:(n={},n[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},n["."+i.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:b.white}}},n)},rootHovered:{backgroundColor:h.primaryButtonBackgroundHovered,border:"1px solid "+h.primaryButtonBackgroundHovered,color:h.primaryButtonTextHovered,selectors:(e={},e[o.HighContrastSelector]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},e)},rootPressed:{backgroundColor:h.primaryButtonBackgroundPressed,border:"1px solid "+h.primaryButtonBackgroundPressed,color:h.primaryButtonTextPressed,selectors:(c={},c[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},c)},rootExpanded:{backgroundColor:h.primaryButtonBackgroundPressed,color:h.primaryButtonTextPressed},rootChecked:{backgroundColor:h.primaryButtonBackgroundPressed,color:h.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:h.primaryButtonBackgroundPressed,color:h.primaryButtonTextPressed},rootDisabled:{selectors:(a={},a[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},a)},splitButtonContainer:{selectors:(s={},s[o.HighContrastSelector]={border:"none"},s)},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},u()),{backgroundColor:b.white,selectors:(d={},d[o.HighContrastSelector]={backgroundColor:"Window"},d)}),splitButtonMenuButton:{backgroundColor:h.primaryButtonBackground,color:h.primaryButtonText,selectors:(l={},l[o.HighContrastSelector]={backgroundColor:"WindowText"},l[":hover"]={backgroundColor:h.primaryButtonBackgroundHovered,selectors:(f={},f[o.HighContrastSelector]={color:"Highlight"},f)},l)},splitButtonMenuButtonDisabled:{backgroundColor:h.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:h.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:h.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:h.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:h.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:h.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:h.primaryButtonText},splitButtonMenuIconDisabled:{color:b.neutralTertiary,selectors:(p={},p[o.HighContrastSelector]={color:"GrayText"},p)}}}},3994:function(t,n,e){"use strict";var r=e(20),o=e(3),i={activeGetWacInfoOperations:[],getWacInfoQueue:[],suppressedUrls:[],docLinkPreviewInfoMap:new r.ObservableMap},u=Object(o.createStore)("sharePointDocLinkPreview",i);n.a=u()},4143:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(3),o=Object(r.action)("previewAttachment",(function(t){return{context:t}}))},4361:function(t,n,e){"use strict";var r=e(29),o=e(0);function i(t,n){var e;return void 0===t.request||t.request.__type||(t.request=(e=t.request,Object(o.__assign)({__type:"GetWacInfoRequest:#Exchange"},e))),Object(r.a)("GetWacInfo",t,n)}function u(t,n,e,r,o){return void 0===e&&(e=!1),void 0===r&&(r=!1),i({request:{Url:t,IsEdit:r,ProviderType:n,ShouldGrantAccess:e}},o)}e.d(n,"a",(function(){return u}))},440:function(t,n,e){"use strict";var r=e(0);function o(t,n){return t?Object(r.__assign)({mailboxInfo:t},n):null!=n?n:void 0}e.d(n,"a",(function(){return o}))},444:function(t,n,e){"use strict";var r=function(){function t(t,n,e){this.maxParallelTasks=t,this.taskCallback=n,this.taskDelay=e,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout((function(){t.tryRunTask()}),this.taskDelay)},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.tryRunTask=function(){var t=this;if(this.canRunMoreTasks()){var n=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(n).then((function(){t.onTaskComplete()})).catch((function(){t.onTaskComplete()})),this.scheduleTask()}},t}();e.d(n,"a",(function(){return r}))},460:function(t,n,e){"use strict";var r=e(0),o=e(1),i=e(391),u=e(458),c=e(457),a=e(14),s=e(230),d=e(392),l=e(425),f=e(396),p=Object(s.c)((function(t,n,e){var r=Object(d.a)(t),o=Object(l.a)(t),i={root:{minWidth:"80px",height:"32px"},label:{fontWeight:a.FontWeights.semibold}};return Object(a.concatStyleSets)(r,i,e?Object(f.a)(t):Object(f.b)(t),o,n)}));e.d(n,"a",(function(){return b}));var b=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return Object(r.__extends)(n,t),n.prototype.render=function(){var t=this.props,n=t.primary,e=void 0!==n&&n,c=t.styles,a=t.theme;return o.createElement(i.a,Object(r.__assign)({},this.props,{variantClassName:e?"ms-Button--primary":"ms-Button--default",styles:p(a,c,e),onRenderDescription:u.b}))},n=Object(r.__decorate)([Object(c.a)("DefaultButton",["theme","styles"],!0)],n)}(o.Component)},4629:function(t,n,e){"use strict";e.d(n,"c",(function(){return r})),e.d(n,"d",(function(){return o})),e.d(n,"a",(function(){return i})),e.d(n,"b",(function(){return u}));var r=18e5,o=2,i="SP_LINK_CLICK_EVENT_LISTENER",u="SP_LINK_MOUSEUP_EVENT_LISTENER"},5068:function(t,n,e){"use strict";e.d(n,"a",(function(){return i})),e.d(n,"b",(function(){return u}));var r=e(4629),o=e(3994);function i(t){return u(t).docLinkPreviewInfo||null}function u(t){var n=o.a.docLinkPreviewInfoMap.get(t);return n?n.time+r.c>Date.now()?{docLinkPreviewInfo:n}:{reason:"Expired"}:o.a.getWacInfoQueue.some((function(n){return n===t}))||o.a.activeGetWacInfoOperations.some((function(n){return n===t}))?{reason:"InQueue"}:o.a.suppressedUrls.some((function(n){return n===t}))?{reason:"FileTypeNotSupportedOrSuppressedAfterError"}:{reason:"Unknown"}}},5473:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(269);function o(t,n,e,o,i){Object(r.p)("SharePointLinkClick",{newTabReason:t,isSafeLinkWrapped:n,isSafeLinkVerified:e,extraInfo:o,isOfficeSPLink:i})}},6382:function(t,n,e){"use strict";e.d(n,"a",(function(){return d}));var r=e(0),o=e(4361),i=e(3517),u=e(83),c=e(1363),a=e(3386),s=e(5068);function d(t,n,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,d,f,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,,9,10]),Object(a.f)(t),o=null,Object(u.i)("doc-SxS-jsApi-ODB-Links")?[4,Object(i.a)(0,t,!0,e,!0)]:[3,6];case 1:return(d=r.sent())?[3,2]:(Object(a.h)(t),[2,null]);case 2:return f=Object(c.b)(d.name),(p=Object(c.f)(f))!==c.a.Word&&p!==c.a.Excel&&p!==c.a.PowerPoint?[3,3]:(d.openWith.wac?o={wacUrl:d.openWith.wac.applicationUrl,jsApiInfo:{bootScriptUrl:d.openWith.wac.bootstrapperUrl,wopiSrcUrl:d.openWith.wac.wopiSrc,accessToken:d.openWith.wac.accessToken,accessTokenExpiry:d.openWith.wac.accessTokenExpiry,fileSize:d.size,fileGetUrl:d.openWith.wac.fileGetUrl,bundleInfo:d.officeBundle,fetchStartTime:d.fetchStartTime,responseStartTime:d.responseStartTime,openUrl:t,fileName:d.name,userId:d.openWith.wac.userId,clientThrottlingProtection:d.openWith.wac.clientThrottlingProtection,requestedCallThrottling:d.openWith.wac.requestedCallThrottling},readOnly:d.currentUserRole.readOnly}:Object(a.e)(t,null,!0),[3,5]);case 3:return[4,l(t)];case 4:o=r.sent(),r.label=5;case 5:return[3,8];case 6:return[4,l(t)];case 7:o=r.sent(),r.label=8;case 8:return o&&Object(a.e)(t,o),n?[2,Object(s.a)(t)]:[2,null];case 9:return Object(a.d)(t),[7];case 10:return[2]}}))}))}function l(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(o.a)(t,0)];case 1:if(9===(n=e.sent()).Status||6===n.Status||5===n.Status)Object(a.h)(t);else if(0===n.Status)return[2,{wacUrl:n.WacUrl,bootScriptUrl:n.BootScriptUrl,wopiSrcUrl:n.WopiSrcUrl,accessToken:n.AccessToken,deprecatedTokenAndParameters:n.Token}];return[2,null]}}))}))}},6387:function(t,n,e){"use strict";e.d(n,"a",(function(){return i})),e.d(n,"b",(function(){return u}));var r=e(77),o=new r.c((function(){return e.e(602).then(e.bind(null,9263))})),i=new r.a(o,(function(t){return t.loadItemAttachment})),u=new r.b(o,(function(t){return t.loadItemAttachmentFromServer}))},670:function(t,n,e){"use strict";function r(t){void 0===t&&(t={}),function(t){t.timeBetweenRetryInMS=t.timeBetweenRetryInMS||function(){return 6e4}}(t);var n=t.maximumAttempts,e=t.timeBetweenRetryInMS;return function(t){var r=0,o=!1,i=function(u,c){o?c(new Error("The function retry was cancelled")):(r++,t().then((function(t){return u(t)})).catch((function(t){n&&r>=n?c(t):setTimeout((function(){return i(u,c)}),e(r))})))};return{retriableFunc:function(){return new Promise((function(t,n){return i(t,n)}))},cancel:function(){return o=!0}}}}function o(t){return function(n){return Math.pow(2,n)*t}}e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return o}))},726:function(t,n,e){"use strict";function r(t){return t>=200&&t<300}e.d(n,"a",(function(){return r}))},757:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(118);function o(t){for(var n,e=[],o=Object(r.a)(t)||document;t!==o.body;){for(var i=0,u=t.parentElement.children;i<u.length;i++){var c=u[i];c!==t&&"true"!==(null===(n=c.getAttribute("aria-hidden"))||void 0===n?void 0:n.toLowerCase())&&e.push(c)}if(!t.parentElement)break;t=t.parentElement}return e.forEach((function(t){t.setAttribute("aria-hidden","true")})),function(){!function(t){t.forEach((function(t){t.setAttribute("aria-hidden","false")}))}(e),e=[]}}},8331:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(2381),o=e(77),i=new o.c((function(){return Promise.all([e.e(0),e.e(1),e.e(2),e.e(3),e.e(4),e.e(14),e.e(21),e.e(28),e.e(33),e.e(34),e.e(41),e.e(43),e.e(62),e.e(63),e.e(61),e.e(67),e.e(175),e.e(215),e.e(232),e.e(213),e.e(275),e.e(738)]).then(e.bind(null,10831))})),u=new o.a(i,(function(t){return t.insertSxSV2IntoDomIfNeeded}));r.c.register(u.importAndExecute);var c=Object(o.d)(i,(function(t){return t.ProjectionSxSV2}))},8614:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r=e(5473),o=1,i=2;function u(t,n,e){t.button===o?Object(r.a)("MouseMiddleButton",n,e):t.button===i&&Object(r.a)("MouseRightButton",n,e)}},8615:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(269),o=e(362),i=e(3959),u=e(5473);function c(t,n,e,c){var a,s,d=Date.now(),l=new r.a("ServiceGeneratedLinkClickHandler"),f="CT="+d+"&OR=OWA-"+(t?t.ctrlKey||1===t.button?"NTB":t.shiftKey?"NW":"NT":"NT")+"&CID="+Object(o.a)(),p=t.currentTarget,b=(s=new URL(p.href),["CID","OR","CT"].forEach((function(t){var n;(null===(n=s.searchParams)||void 0===n?void 0:n.get(t))&&s.searchParams.delete(t)})),s);if(n){var h=b.href,v=h.indexOf(i.c);if(-1===v)return;var g=encodeURIComponent(btoa(f));a=h.substr(0,v)+"&xdata="+g+i.c}else{var m=b.href.indexOf("?")>=0?"&":"?";a=b.href+m+f}l.end(),window.open(a),t.preventDefault(),Object(u.a)(c||(t.altKey?"AltKey":t.ctrlKey?"CtrlKey":t.metaKey?"MetaKey":t.shiftKey?"ShiftKey":"Default"),n,e)}},940:function(t,n,e){"use strict";e.d(n,"a",(function(){return f}));var r=e(0),o=e(1),i=e(757),u=e(271),c=e(76),a=e(309),s=e(61),d=e(284),l=e(118),f=function(t){function n(e){var r=t.call(this,e)||this;return r._root=o.createRef(),r._firstBumper=o.createRef(),r._lastBumper=o.createRef(),r._hasFocus=!1,r._onRootFocus=function(t){r.props.onFocus&&r.props.onFocus(t),r._hasFocus=!0},r._onRootBlur=function(t){r.props.onBlur&&r.props.onBlur(t);var n=t.relatedTarget;null===t.relatedTarget&&(n=r._getDocument().activeElement),Object(u.a)(r._root.current,n)||(r._hasFocus=!1)},r._onFirstBumperFocus=function(){r._onBumperFocus(!0)},r._onLastBumperFocus=function(){r._onBumperFocus(!1)},r._onBumperFocus=function(t){if(!r.props.disabled){var n=t===r._hasFocus?r._lastBumper.current:r._firstBumper.current;if(r._root.current){var e=t===r._hasFocus?Object(c.i)(r._root.current,n,!0,!1):Object(c.f)(r._root.current,n,!0,!1);e&&(r._isBumper(e)?r.focus():e.focus())}}},r._onFocusCapture=function(t){r.props.onFocusCapture&&r.props.onFocusCapture(t),t.target===t.currentTarget||r._isBumper(t.target)||(r._previouslyFocusedElementInTrapZone=t.target)},r._forceFocusInTrap=function(t){if(!r.props.disabled&&n._focusStack.length&&r===n._focusStack[n._focusStack.length-1]){var e=r._getDocument().activeElement;Object(u.a)(r._root.current,e)||(r.focus(),r._hasFocus=!0,t.preventDefault(),t.stopPropagation())}},r._forceClickInTrap=function(t){if(!r.props.disabled&&n._focusStack.length&&r===n._focusStack[n._focusStack.length-1]){var e=t.target;e&&!Object(u.a)(r._root.current,e)&&(r.focus(),r._hasFocus=!0,t.preventDefault(),t.stopPropagation())}},Object(a.a)(r),r}return Object(r.__extends)(n,t),n.prototype.componentDidMount=function(){this._bringFocusIntoZone(),this._updateEventHandlers(this.props),!this.props.disabled&&this._root.current&&this.props.enableAriaHiddenSiblings&&(this._unmodalize=Object(i.a)(this._root.current))},n.prototype.UNSAFE_componentWillReceiveProps=function(t){var n=t.elementToFocusOnDismiss;n&&this._previouslyFocusedElementOutsideTrapZone!==n&&(this._previouslyFocusedElementOutsideTrapZone=n),this._updateEventHandlers(t)},n.prototype.componentDidUpdate=function(t){var n=void 0===t.forceFocusInsideTrap||t.forceFocusInsideTrap,e=void 0===this.props.forceFocusInsideTrap||this.props.forceFocusInsideTrap,r=void 0!==t.disabled&&t.disabled,o=void 0!==this.props.disabled&&this.props.disabled;!n&&e||r&&!o?(this._bringFocusIntoZone(),!this._unmodalize&&this._root.current&&this.props.enableAriaHiddenSiblings&&(this._unmodalize=Object(i.a)(this._root.current))):(n&&!e||!r&&o)&&(this._returnFocusToInitiator(),this._unmodalize&&this._unmodalize())},n.prototype.componentWillUnmount=function(){this.props.disabled&&!this.props.forceFocusInsideTrap&&Object(u.a)(this._root.current,this._getDocument().activeElement)||this._returnFocusToInitiator(),this._disposeClickHandler&&(this._disposeClickHandler(),this._disposeClickHandler=void 0),this._disposeFocusHandler&&(this._disposeFocusHandler(),this._disposeFocusHandler=void 0),this._unmodalize&&this._unmodalize(),delete this._previouslyFocusedElementInTrapZone,delete this._previouslyFocusedElementOutsideTrapZone},n.prototype.render=function(){var t=this.props,n=t.className,e=t.disabled,i=void 0!==e&&e,u=t.ariaLabelledBy,c=Object(s.j)(this.props,s.h),a={"aria-hidden":!0,style:{pointerEvents:"none",position:"fixed"},tabIndex:i?-1:0,"data-is-visible":!0};return o.createElement("div",Object(r.__assign)({},c,{className:n,ref:this._root,"aria-labelledby":u,onFocusCapture:this._onFocusCapture,onFocus:this._onRootFocus,onBlur:this._onRootBlur}),o.createElement("div",Object(r.__assign)({},a,{ref:this._firstBumper,onFocus:this._onFirstBumperFocus})),this.props.children,o.createElement("div",Object(r.__assign)({},a,{ref:this._lastBumper,onFocus:this._onLastBumperFocus})))},n.prototype.focus=function(){var t=this.props,n=t.focusPreviouslyFocusedInnerElement,e=t.firstFocusableSelector,r=t.firstFocusableTarget;if(n&&this._previouslyFocusedElementInTrapZone&&Object(u.a)(this._root.current,this._previouslyFocusedElementInTrapZone))this._focusAsync(this._previouslyFocusedElementInTrapZone);else{var o="string"==typeof e?e:e&&e(),i=null;this._root.current&&("string"==typeof r?i=this._root.current.querySelector(r):r?i=r(this._root.current):o&&(i=this._root.current.querySelector("."+o)),i||(i=Object(c.j)(this._root.current,this._root.current.firstChild,!1,!1,!1,!0))),i&&this._focusAsync(i)}},n.prototype._focusAsync=function(t){this._isBumper(t)||Object(c.b)(t)},n.prototype._bringFocusIntoZone=function(){var t=this.props,e=t.elementToFocusOnDismiss,r=t.disabled,o=void 0!==r&&r,i=t.disableFirstFocus,c=void 0!==i&&i;o||(n._focusStack.push(this),this._previouslyFocusedElementOutsideTrapZone=e||this._getDocument().activeElement,c||Object(u.a)(this._root.current,this._previouslyFocusedElementOutsideTrapZone)||this.focus())},n.prototype._returnFocusToInitiator=function(){var t=this,e=this.props.ignoreExternalFocusing;n._focusStack=n._focusStack.filter((function(n){return t!==n}));var r=this._getDocument(),o=r.activeElement;e||!this._previouslyFocusedElementOutsideTrapZone||"function"!=typeof this._previouslyFocusedElementOutsideTrapZone.focus||!Object(u.a)(this._root.current,o)&&o!==r.body||this._focusAsync(this._previouslyFocusedElementOutsideTrapZone)},n.prototype._updateEventHandlers=function(t){var n=t.isClickableOutsideFocusTrap,e=void 0!==n&&n,r=t.forceFocusInsideTrap,o=void 0===r||r;o&&!this._disposeFocusHandler?this._disposeFocusHandler=Object(d.a)(window,"focus",this._forceFocusInTrap,!0):!o&&this._disposeFocusHandler&&(this._disposeFocusHandler(),this._disposeFocusHandler=void 0),e||this._disposeClickHandler?e&&this._disposeClickHandler&&(this._disposeClickHandler(),this._disposeClickHandler=void 0):this._disposeClickHandler=Object(d.a)(window,"click",this._forceClickInTrap,!0)},n.prototype._isBumper=function(t){return t===this._firstBumper.current||t===this._lastBumper.current},n.prototype._getDocument=function(){return Object(l.a)(this._root.current)},n._focusStack=[],n}(o.Component)}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentPreviewSxSInitialize.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentPreviewSxSInitialize.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentPreviewSxSInitialize.js'] = (new Date()).getTime();