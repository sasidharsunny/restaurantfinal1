self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FolderWeb.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[409,411],{10123:function(e,r,n){"use strict";n.r(r),n.d(r,"foldersWeb",(function(){return v}));var t=n(0),o=n(2286),i=n(319),d=n(2635),u=n(547),l=n(2591),a=n(1332),s=n(2312),c=n(1436),f=n(440),v=function(e,r,n,v){return Object(t.__awaiter)(void 0,void 0,void 0,(function(){var e,v,p,h,F,I,g,_,y;return Object(t.__generator)(this,(function(t){switch(t.label){case 0:return e=[],(null===(I=r.options)||void 0===I?void 0:I.additionalProperties)?(e=r.options.additionalProperties.map((function(e){return Object(a.a)({FieldURI:e})}))).push(Object(a.a)({FieldURI:"ParentFolderId"})):v="Folder",[4,Object(d.a)({Header:Object(i.b)(),Body:Object(l.a)({FolderShape:Object(s.a)({BaseShape:"IdOnly",AdditionalProperties:e}),ShapeName:v,FolderIds:r.ids.map((function(e){return Object(u.a)({Id:e})}))})},Object(f.a)(null===(g=r.options)||void 0===g?void 0:g.mailboxInfo,n.requestOptions))];case 1:return p=t.sent(),h=null===(y=null===(_=p.Body)||void 0===_?void 0:_.ResponseMessages)||void 0===y?void 0:y.Items,[4,Object(c.a)(h)];case 2:if(t.sent(),F=[],h.forEach((function(e){var r;null===(r=e.Folders)||void 0===r||r.forEach((function(e){var r=Object(o.c)(e);r&&F.push(r)}))})),0===F.length)throw new Error("foldersWeb: failed to get folders");return[2,F]}}))}))}},1325:function(e,r,n){"use strict";n.d(r,"f",(function(){return t})),n.d(r,"d",(function(){return o})),n.d(r,"j",(function(){return i})),n.d(r,"a",(function(){return d})),n.d(r,"g",(function(){return u})),n.d(r,"b",(function(){return l})),n.d(r,"h",(function(){return a})),n.d(r,"l",(function(){return s})),n.d(r,"k",(function(){return c})),n.d(r,"i",(function(){return f})),n.d(r,"c",(function(){return v})),n.d(r,"e",(function(){return p}));var t=["journal","outbox","syncissues"],o="archivemsgfolderroot",i="msgfolderroot",d="archivedeleteditems",u="deleteditems",l="archiverecoverableitemsdeletions",a="recoverableitemsdeletions",s="msgfolderroot",c="sharedFolderTree",f="primaryFolderTree",v="archiveFolderTree",p="favorites"},1332:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(0);function o(e){return Object(t.__assign)({__type:"PropertyUri:#Exchange"},e)}},1436:function(e,r,n){"use strict";n.d(r,"a",(function(){return i}));var t=n(0),o=n(1440);function i(e){var r,n;if(!e)return Promise.reject(d("500","Server returned a null response!",null));var i=Array.isArray(e)?e:[e];try{for(var u=Object(t.__values)(i),l=u.next();!l.done;l=u.next()){var a=l.value;if(a&&!Object(o.a)(a))return Promise.reject(d(a.ResponseCode,a.StackTrace,a.MessageText))}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}return Promise.resolve()}function d(e,r,n){var t="ResponseCode="+e;r&&(t+=", Stacktrace="+r);var o=new Error(t);return o.responseCode=e,o.fetchErrorType="ServerFailure",n&&(o.diagnosticInfo="MessageText= "+n),o}},1440:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t="Success";function o(e){return e&&e.ResponseClass==t}},16494:function(e,r,n){"use strict";n.r(r),n.d(r,"folderWeb",(function(){return i}));var t=n(0),o=n(10123),i=function(e,r,n,i){return Object(t.__awaiter)(void 0,void 0,void 0,(function(){var d;return Object(t.__generator)(this,(function(t){switch(t.label){case 0:return d={ids:[r.id],options:r.options},[4,Object(o.foldersWeb)(e,d,n,i)];case 1:return[2,t.sent()[0]]}}))}))}},2286:function(e,r,n){"use strict";var t=function(e,r){var n,t;if(e.ExtendedProperty)for(var o=0;o<e.ExtendedProperty.length;o++){var i=e.ExtendedProperty[o];if((null===(n=null==i?void 0:i.ExtendedFieldURI)||void 0===n?void 0:n.PropertyTag)===r||(null===(t=null==i?void 0:i.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===r)return i.Value}},o=function(e){var r=t(e,"SourceWellKnownFolderType");return r&&parseInt(r,10)||-1},i=function(e){return t(e,"0x7018")||null},d=function(e){return"false"!==t(e,"0x10f4")},u=n(1325),l=n(59);function a(e,r,n,t,o,i){var l,a=e.RootFolder;if(!a||!a.Folders||!a.ParentFolder)throw new Error("folderHierarchyWeb: failed to get folders");var c=[];null==a||a.Folders.forEach((function(e){if(e&&function(e,r,n){if(t=null==e?void 0:e.__type,"Folder:#Exchange"!=t)return!1;var t;if((null==e?void 0:e.DistinguishedFolderId)&&u.f.indexOf(e.DistinguishedFolderId)>=0)return!1;if(d(e))return!1;if("clutter"===e.DistinguishedFolderId&&0===e.TotalCount)return!1;if("junkemail"===e.DistinguishedFolderId)return!!r;if("notes"===e.DistinguishedFolderId)return!!n;return!0}(e,t,o)){var r=s(e);r&&c.push(r)}}));var f=function(e,r){return"SharedMailbox"===r?void 0:e}((null===(l=null==a?void 0:a.ParentFolder)||void 0===l?void 0:l.DistinguishedFolderId)||"none",r);a.ParentFolder.DistinguishedFolderId=f;var v=s(a.ParentFolder);return i&&function(e,r,n){if(e){var t={},o={},i=[];t[e.FolderId.Id]=e,i.push(e.FolderId.Id),r.forEach((function(e){e&&(t[e.FolderId.Id]=e,i.push(e.FolderId.Id))})),i.forEach((function(e){var r,n=t[e],i=null===(r=n.ParentFolderId)||void 0===r?void 0:r.Id;n.DistinguishedFolderId&&(o[n.DistinguishedFolderId]=e);var d=i&&t[i];d&&d.childFolderIds.push(e)}));var d=[];n.forEach((function(e){var r=o[e];r&&d.push(r)}));for(var u=e.childFolderIds||[],l=0;l<u.length;l++){var a=u[l]||null;a&&-1==d.indexOf(a)&&d.push(a)}e.childFolderIds=d}}(v,c,n),{__typename:"FolderHierarchyResult",Folders:c,RootFolder:v,IndexedPagingOffset:a.IndexedPagingOffset,TotalItemsInView:a.TotalItemsInView,IncludesLastItemInRange:a.IncludesLastItemInRange}}function s(e){var r=e,n=r.FolderId,t=r.ParentFolderId,d=r.DisplayName,u=r.ArchiveTag,a=r.PolicyTag,s=r.ChildFolderCount,p=r.UnreadCount,h=r.TotalCount,F=r.FolderClass,I=r.DistinguishedFolderId;if(!n||!t)return l.g.warn("mapOWSFolderToGql: ignoring folder with missing folderId or missing parentFolderId"),null;var g=s||0,_=f(n);return{id:_.Id,__typename:"MailFolder",type:r.__type,FolderId:_,ParentFolderId:f(t),DisplayName:d||"",DistinguishedFolderId:I||null,FolderClass:F||"IPF.Note",UnreadCount:p||0,TotalCount:h||0,ArchiveTag:u?v(u):null,PolicyTag:a?v(a):null,hasChildren:g>0,remoteFolderDisplayName:i(r),sourceWellKnownFolderType:o(r),ReplicaList:r.ReplicaList,PermissionSet:r.PermissionSet,size:c(r),childFolderIds:[],treeType:null,pausedTotalCount:null,principalSMTPAddress:null}}function c(e){var r,n;return null===(n=null===(r=e.ExtendedProperty)||void 0===r?void 0:r[0])||void 0===n?void 0:n.Value}function f(e){return{__typename:"FolderId",Id:e.Id,ChangeKey:e.ChangeKey}}function v(e){return{__typename:"RetentionTagType",IsExplicit:e.IsExplicit,Value:e.Value}}n.d(r,"a",(function(){return o})),n.d(r,"b",(function(){return a})),n.d(r,"c",(function(){return s}))},2312:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(0);function o(e){return Object(t.__assign)({__type:"FolderResponseShape:#Exchange"},e)}},2591:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(0);function o(e){return Object(t.__assign)({__type:"GetFolderRequest:#Exchange"},e)}},2635:function(e,r,n){"use strict";var t=n(29),o=n(0);function i(e,r){var n;return void 0===e||e.__type||(n=e,e=Object(o.__assign)({__type:"GetFolderJsonRequest:#Exchange"},n)),Object(t.a)("GetFolder",e,r)}n.d(r,"a",(function(){return i}))},440:function(e,r,n){"use strict";var t=n(0);function o(e,r){return e?Object(t.__assign)({mailboxInfo:e},r):null!=r?r:void 0}n.d(r,"a",(function(){return o}))},547:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(0);function o(e){return Object(t.__assign)({__type:"FolderId:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.FolderWeb.js.map
self.scriptsLoaded['owa.FolderWeb.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FolderWeb.js'] = (new Date()).getTime();