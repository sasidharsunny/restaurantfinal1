self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.18.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[18],{1926:function(e,t,n){"use strict";var r=n(285),a=n(0),i=n(1457),o=n(2431),s=n(1391),c=n(7535);function u(e,t,n){var r=Object(i.a)(e.Smtp),a={};Object(c.a)().then((function(i){i&&(a={Authorization:"Bearer "+i,"X-AnchorMailbox":e.Smtp});var c="Group"==e.PersonaType?"GroupMailbox":void 0;t(r?Object(o.b)(r,c,s.c.regular):Object(o.a)(e.Smtp,e.OlsPersonaId,c,"largeRounded"===n),a)}))}var d=n(12),l=n(321),b=n(59),p="ows/api/beta/subscriptions/brands/{0}";function f(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e,r,i,o;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:b.g.info("[getBrandUnsubscribeInfo] targetBrandSatoriId: "+t),e=Object(d.c)(p,t),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Object(l.b)(e)];case 2:return(null==(r=a.sent())?void 0:r.subscriptions)?(i=r.subscriptions.map((function(e){var t=e.brand?e.brand.brandName:e.smtpInfo.displayName;return{smtp:e.smtpInfo.smtpAddress,smtpIdentifier:e.smtpInfo.smtpIdentifier,smtpDisplayName:t,unsubscribeSilentUri:e.unsubscribeSilentUris,unsubscribeHttpUri:e.unsubscribeHttpUris}})),n(i,void 0)):n(void 0,"Call to get brand info returned empty response"),[3,4];case 3:return o=a.sent(),b.g.info("[getBrandUnsubscribeInfo] exception from network request: "+o),n(void 0,o),[3,4];case 4:return[2]}}))}))}var v=n(3),g=Object(v.action)("onAcceptingMeeting",(function(e,t){return{meetingId:e,respondToSeries:t}})),m=Object(v.action)("onTentativelyAcceptingMeeting",(function(e,t){return{meetingId:e,respondToSeries:t}})),O=Object(v.action)("onDecliningMeeting",(function(e,t){return{meetingId:e,respondToSeries:t}})),j=Object(v.action)("onCancelingMeeting",(function(e,t){return{meetingId:e,respondToSeries:t}})),h=Object(v.action)("onDeletingMeeting",(function(e,t){return{meetingId:e,respondToSeries:t}})),I=Object(v.action)("onMeetingResponseActionFailed",(function(e,t,n,r){return{meetingId:e,originalMeetingResponse:t,error:n,meetingResponseActionParams:r}})),C=Object(v.action)("onMeetingResponseActionSucceeded",(function(e,t,n){return{meetingId:e,originalMeetingResponse:t,meetingResponseActionParams:n}})),P=Object(v.action)("joinOnlineMeeting",(function(e,t){return{meetingId:e,joinOnlineMeetingParams:t}})),S=Object(v.action)("editMeeting",(function(e,t){return{meetingId:e,editMeetingParams:t}})),U=Object(v.action)("onMeetingInfoRequested",(function(e,t){return{personaId:e,successCallback:t}})),w=Object(v.action)("openMeeting",(function(e){return{meetingId:e}}));function _(e,t){return g(e,t),{onSuccess:C,onFailure:I}}function y(e,t){return m(e,t),{onSuccess:C,onFailure:I}}function A(e,t){return O(e,t),{onSuccess:C,onFailure:I}}function M(e,t){return j(e,t),{onSuccess:C,onFailure:I}}function T(e,t){return h(e,t),{onSuccess:C,onFailure:I}}function B(e,t){P(e,t)}function F(e,t){S(e,t)}var k=n(4806),R=n(50),L=n(2985);function z(e,t,n){b.g.info("[unsubscribeFromBrand] target brand smtp identifier: "+t.smtpIdentifier),Object(L.e)("BrandCard",t.smtp,t.smtpIdentifier,t.unsubscribeSilentUri,t.unsubscribeHttpUri[0],n)}var x=n(5635),G=n(5290),D=n(319),N=n(1820),E=n(1332),q=n(1382),H=n(755);function V(e){var t=Object(q.a)({BaseFolderId:Object(H.a)({Id:"contacts"})}),n=Object(G.a)({PersonaId:null,PersonTypeString:"Person",PropertyUpdates:[],ParentFolderId:t});return e&&e.length>0&&e.forEach((function(e){n.PropertyUpdates.push(Object(N.a)({Path:Object(E.a)({FieldURI:e.name}),OldValue:e.oldValue,NewValue:e.newValue}))})),n}function X(e){return Object(x.a)({request:{Header:Object(D.b)(),Body:V(e)}})}var W=n(1906),J=n(1907),$=n(1559);function Y(e){return Object(J.a)({getNotesForPersonaRequest:Object($.a)({PersonaId:e,MaxBytesToFetch:512e3})}).then((function(e){return e.PersonaWithNotes}))}var K=n(1546),Z=n(723),Q=n(1532);function ee(e){var t=Object(K.a)({PersonaId:Object(Z.a)({Id:e})});return Object(Q.a)({Header:Object(D.b)(),Body:t}).then((function(e){if(e.Body&&"NoError"===e.Body.ResponseCode)return e.Body.Persona;throw new Error("GetPersona failed")}))}var te=n(1933),ne=n(83),re=n(269),ae=n(2),ie=n(5636),oe=n(5291);function se(e,t){var n=Object(oe.a)({PersonaId:Object(Z.a)({Id:e}),PersonTypeString:"Person",PropertyUpdates:[]});return t&&t.length>0&&t.forEach((function(e){e.newValue!==e.oldValue&&n.PropertyUpdates.push(Object(N.a)({Path:Object(E.a)({FieldURI:e.name}),OldValue:e.oldValue,NewValue:e.newValue}))})),n}function ce(e,t){return Object(ie.a)({request:{Header:Object(D.b)(),Body:se(e,t)}})}var ue=n(1853),de=n(6734),le=n(752),be=n(4),pe=n(6735),fe=n(317);function ve(e,t){if(t){var n=t.displayName?t.displayName+"<"+t.smtpAddress+">":t.smtpAddress;return e?"&"+e+"="+n:n}return""}function ge(e,t){return t?"&"+e+"="+t:""}function me(e){var t;if(!(null===(t=e.to)||void 0===t?void 0:t.smtpAddress))return"";var n=Object(be.b)();return n.mailtouri=function(e){var t;if(!(null===(t=e.to)||void 0===t?void 0:t.smtpAddress))return"";var n="mailto:"+ve(null,e.to),r="";return r+=ve("cc",e.cc),r+=ve("bcc",e.bcc),r+=ge("subject",e.subject),(r+=ge("body",e.body))?n+"?"+r.slice(1):n}(e),Object(pe.a)(de.c,de.a,"?"+fe.stringify(n))}var Oe="left=0,top=0,height=600,width=800,location=0,menubar=0,resizable=1,scrollbars=0,status=0,toolbar=0";function je(e,t){var n=e;t&&(n=n.replace("gulp&","").replace("gulp",""));var r=window.open(n||"about:blank","Deeplink",Oe);r&&t&&(r.opener=null)}var he,Ie=n(320),Ce=n(1396),Pe=n(7543),Se=n(9302);function Ue(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:t={},r.label=1;case 1:return r.trys.push([1,4,,5]),n=Object(Ce.b)(),2===n||8192===n?[3,3]:[4,Object(W.a)()];case 2:t=r.sent(),r.label=3;case 3:return[3,5];case 4:return r.sent(),Object(re.p)("LpcCallbacksWereNotInitialized"),[3,5];case 5:return[2,he=he||Object(ue.initializeLivePersonaCardAsync)(function(e,t){var n=function(e,t){var n,r,a={readMail:we,composeMail:_e(e,t),meetingActionCallbacks:{onAcceptingMeeting:_,onTentativelyAcceptingMeeting:y,onDecliningMeeting:A,onCancelingMeeting:M,onDeletingMeeting:T,joinOnlineMeeting:B,editMeeting:F},onPersonaUpdated:k.a,openMeeting:Te};Object(ne.i)("rp-brandCardsUnsubscribe")&&(a.unsubscribeFromBrand=z);if(e.actionCallbacks){e.actionCallbacks.favoritePersona&&(a.favoritePersona=e.actionCallbacks.favoritePersona),e.actionCallbacks.unfavoritePersona&&(a.unfavoritePersona=e.actionCallbacks.unfavoritePersona),e.actionCallbacks.readMail&&(a.readMail=e.actionCallbacks.readMail),e.actionCallbacks.toggleSubscribeToGroup&&(a.toggleSubscribeToGroup=e.actionCallbacks.toggleSubscribeToGroup),e.actionCallbacks.editGroup&&(a.editGroup=e.actionCallbacks.editGroup),e.actionCallbacks.addGroupMembers&&(a.addGroupMembers=e.actionCallbacks.addGroupMembers),e.actionCallbacks.updateMembership&&(a.updateMembership=e.actionCallbacks.updateMembership);var i=null===(r=(n=e.actionCallbacks).getStartChatCallback)||void 0===r?void 0:r.call(n);i&&(a.startChat=i)}return a}(e,t),r=function(e){var t,n,r={getAndPrefetchPersonaImageUri:u,getPersonaInfo:Ae};(null===(t=e.dataCallbacks)||void 0===t?void 0:t.getIsPersonaFavorited)&&(r.getIsPersonaFavorited=e.dataCallbacks.getIsPersonaFavorited);Object(ne.i)("rp-brandCardsUnsubscribe")&&(r.getBrandUnsubscribeInfo=f);(null===(n=e.dataCallbacks)||void 0===n?void 0:n.getPresence)&&(r.getPresence=e.dataCallbacks.getPresence);Object(ne.i)("csi-owa-topic-card")&&(r.getTopicData=Me);return r}(e),i={updateOwsPersona:ce,getOwsPersona:ee,getOwsPersonaByEmailAddress:te.a,getNotesForPersona:Y,createOwsPersona:X},o=function(e){var t={};if(!e.dataUpdateBroadcaster)return t;e.dataUpdateBroadcaster.setGroupUpdateListener&&(t.setGroupUpdateListener=e.dataUpdateBroadcaster.setGroupUpdateListener);e.dataUpdateBroadcaster.setGroupMembersUpdateListener&&(t.setGroupMembersUpdateListener=e.dataUpdateBroadcaster.setGroupMembersUpdateListener);e.dataUpdateBroadcaster.setGroupDeleteListener&&(t.setGroupDeleteListener=e.dataUpdateBroadcaster.setGroupDeleteListener);e.dataUpdateBroadcaster.updatePopupStateListener&&(t.updatePopupStateListener=e.dataUpdateBroadcaster.updatePopupStateListener);return t}(e);!function(){if(ue.isLokiInitialized)return;var e=Object(Ie.a)(),t=R.a.userConfiguration.SessionSettings.UserCulture,n=R.a.userConfiguration.SessionSettings.TenantGuid,r=Object(ae.C)(),a=Object(ne.i)("peo-lokiDogfood");Object(ue.initializeLoki)({culture:t,isConsumer:e,useDogfood:a,logger:function(e,t){Object(re.p)(e,t)},tenantId:n,clientCorrelationId:r})}();var s=Object(ue.getLokiBootstrapperConfig)(),c=R.a.userConfiguration.UserOptions.TimeFormat,d=R.a.userConfiguration.UserOptions.DateFormat,l=R.a.userConfiguration.SegmentationSettings.SetPhoto,b=c&&-1===c.indexOf("tt"),p=Object(Pe.a)();return Object(a.__assign)(Object(a.__assign)({},s),{actionCallbacks:n,dataCallbacks:r,privateDataCallbacks:i,dataUpdateBroadcaster:o,options:{isSetPhotoEnabled:l,isLinkedInIntegrationEnabled:!1,timeFormat:c,dateFormat:d,is24HourFormat:b,sharedMailboxAadObjectId:p}})}(t,e))]}}))}))}function we(e){var t;je((t=e)?Object(pe.a)(de.c,de.d+"/"+encodeURIComponent(t),Object(le.a)()):"",!0)}function _e(e,t){return function(n,r,a,i,o){var s;t?t(n,n):(null===(s=e.actionCallbacks)||void 0===s?void 0:s.composeMail)?e.actionCallbacks.composeMail(n,r,a,i):je(me({to:{smtpAddress:n,displayName:ye(i)}}),!0),window.LPC.dismissCard()}}function ye(e){if(e){if(e.personaDisplayName)return e.personaDisplayName;if(e.recipientDisplayName)return e.recipientDisplayName}}function Ae(e,t){"Meeting"===e.PersonaType&&U(e,t)}function Me(e,t){Object(ne.i)("csi-owa-topic-card")&&Se.c.import().then((function(n){var r=n(e.HostAppPersonaId||e.hostAppPersonaId);r?t(r):t(void 0,"Topic not found.")})).catch((function(){t(void 0,"Topic annotation bundle failed to load.")}))}function Te(e){window.LPC.dismissCard(),w(e)}var Be=n(1317),Fe=n(77),ke=n(1432),Re=n(7544);function Le(e){Be.a.livePersonaCardInitializationStatus={state:e,timestamp:Date.now()},Be.a.isLivePersonaCardInitialized=e===ke.a.Initialized,Object(Re.a)(e===ke.a.Initialized)}var ze=12e4,xe=new Fe.c((function(){return n.e(442).then(n.t.bind(null,16458,7))})),Ge=Object(r.action)("handleLivePersonaCardInitialized")((function(){Le(ke.a.Initialized)})),De=Object(r.action)("handleLivePersonaCardFailedToInitialize")((function(e){Le(ke.a.Failed),b.g.info(e)}));t.a=Object(r.action)("initializeLivePersonaCard")((function(e){(Be.a.livePersonaCardInitializationStatus.state===ke.a.NotInitialized||Be.a.livePersonaCardInitializationStatus.state===ke.a.Failed&&Date.now()-Be.a.livePersonaCardInitializationStatus.timestamp>ze)&&(Le(ke.a.Initializing),xe.import(),Ue(e).then(Ge).catch((function(e){return De(e)})))}))},2431:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f}));var r=n(2835),a=n(1376),i=n(1391),o=n(270),s=n(5),c="email",u="personId",d="UA",l="size",b="/service.svc/s/GetPersonaPhoto";function p(e,t,n,i){if(Object(a.a)()&&e)return Object(r.a)(e,n);var o=Object(s.a)().baseUrl,p="";return e&&(p=v(p,c,e&&e.toLowerCase())),t&&(p=v(p,u,t)),p=v(p,d,"0"),p=v(p,l,i?"HR96x96":"HR64x64"),""+o+b+"?"+p}function f(e,t,n){return Object(a.a)()?Object(r.a)(e,t):"https://cid-"+e+".users.storage.live.com/users/0x"+e+"/myprofile/expressionprofile/profilephoto:"+function(e){switch(e){case i.c.tiny:case i.c.extraExtraSmall:case i.c.extraSmall:case i.c.small:case i.c.regular:case i.c.large:case i.c.size10:case i.c.size8:case i.c.size16:case i.c.size24:case i.c.size28:case i.c.size32:return"UserTileStatic,UserTileSmall";case i.c.extraLarge:case i.c.size40:case i.c.size48:case i.c.size56:case i.c.size72:case i.c.size100:case i.c.size120:return"UserTileMedium,UserTileStatic,UserTileSmall";default:return Object(o.a)(e)}}(n)+"/MeControlMediumUserTile?ck=1&ex=24&fofoff=1"}function v(e,t,n){n&&(n=encodeURIComponent(n));var r=t+"="+n;return e&&(r=e+"&"+r),r}},2835:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(12),a="/profile/v1.0/{0}/{1}/image/$value";function i(e,t){var n=e.indexOf("@")>-1,i="GroupMailbox"==t?"groups":"users";return Object(r.c)(a,i,n?e:"cid:"+e)}},2985:function(e,t,n){"use strict";var r=n(0);function a(e){return e>0}var i=n(3),o=n(74),s=Object(i.action)("UNSUBSCRIBE_FROM_BRAND_SUBSCRIPTION",(function(e,t,n,r,a,i){return Object(o.c)({name:"UnsubscribeSubscription",customData:{unsubscribeSourceType:e}},{unsubscribeSourceType:e,smtpAddress:t,smtpIdentifier:n,unsubscribeSilentUris:r,unsubscribeHttpUri:a,completedCallback:i})})),c=Object(i.action)("AFTER_UNSUBSCRIBE",(function(e,t,n,r,a){return{smtpIdentifier:e,unsubscribeSourceType:t,responseType:n,debugMessage:r,completedCallback:a}})),u=n(12),d=n(321),l="ows/api/beta/subscriptions/{0}/unsubscribe";var b,p=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(d.c)(Object(u.c)(l,e),{unsubscribeSilentUris:t},null,!0)];case 1:return[2,n.sent()]}}))}))};!function(e){e[e.Fail=0]="Fail",e[e.Success=1]="Success"}(b||(b={}));var f=b,v=n(20),g=Object(i.createStore)("BrandSubscription",{subscriptions:new v.ObservableMap({}),unsubscribedSubscriptions:new v.ObservableMap({})})();function m(e){return e&&g.subscriptions.has(e.toLowerCase())?g.subscriptions.get(e.toLowerCase()):null}var O=Object(i.mutatorAction)("unsubscribeFromCache",(function(e){var t=Object(r.__assign)({},m(e));t?(g.subscriptions.delete(e.toLowerCase()),g.unsubscribedSubscriptions.set(e.toLowerCase(),t)):C()})),j=n(337);Object(i.orchestrator)(s,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,o,s,u,d,l,b,v,g,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.unsubscribeSourceType,n=e.smtpAddress,i=e.smtpIdentifier,o=e.unsubscribeSilentUris,s=e.unsubscribeHttpUri,u=e.completedCallback,s&&0!==s.length||o&&0!==o.length?(o&&a(o.length)||!s?d="No unsubscribe URIs provided":(window.open(s,"_blank"),d="Opened unsubscribe URI in new tab"),[4,p(i,o)]):(d="No unsubscribe URIs or SilentURIs provided",l=f.Fail,c(i,t,l,d,u),[2,Promise.reject("No unsubscribe URIs or SilentURIs provided")]);case 1:return b=r.sent(),v=null,Object(j.a)(b.status)?(d="Unsubscribe service called successfully. "+d,l=f.Success,O(n),[3,4]):[3,2];case 2:return d="Unsubscribe service failed. "+d,l=f.Fail,[4,b.text().then((function(e){return e?JSON.parse(e):{}}))];case 3:g=r.sent(),(v=new Error("ResponseCode="+b.status+", ErrorMessage="+(null===(m=null==g?void 0:g.error)||void 0===m?void 0:m.message))).fetchErrorType="ServerFailure",r.label=4;case 4:return c(i,t,l,d,u),v?[2,Promise.reject(v)]:[2,Promise.resolve()]}}))}))}));Object(i.mutator)(c,(function(e){var t=e.unsubscribeSourceType,n=e.responseType,r=e.debugMessage,a=e.completedCallback;"BrandCard"===t&&a&&a(n===f.Success,r)}));var h=Object(i.mutatorAction)("populateSubscriptionStore",(function(e){e.subscriptions.forEach((function(e){var t;(null===(t=null==e?void 0:e.smtpInfo)||void 0===t?void 0:t.smtpAddress)&&g.subscriptions.set(e.smtpInfo.smtpAddress.toLowerCase(),e)})),e.unsubscribedSubscriptions.forEach((function(e){var t;(null===(t=null==e?void 0:e.smtpInfo)||void 0===t?void 0:t.smtpAddress)&&g.unsubscribedSubscriptions.set(e.smtpInfo.smtpAddress.toLowerCase(),e)}))})),I="ows/api/beta/subscriptions?orderBy=name, asc";var C=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(d.b)(e?I+"&noResolveBrand=true":I,void 0,!0)];case 1:return t=r.sent(),Object(j.a)(t.status)?[4,t.json()]:[3,3];case 2:return n=r.sent(),h(n),[2,n];case 3:return[2,null]}}))}))};n.d(t,"b",(function(){return C})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"f",(function(){return a}))},2993:function(e,t,n){"use strict";var r=n(0),a=n(285),i=Object(a.action)("setIsPendingFetch")((function(e,t){e.personaBlob.isPendingFetch=t})),o=n(3),s=n(1317),c=Object(o.mutatorAction)("addBrandToDynamicBrandSet",(function(e,t){t?s.a.dynamicBrandSets.verifiedBrands.set(e,!0):s.a.dynamicBrandSets.unverifiedBrands.set(e,!0)})),u=n(2835),d=n(2431),l=n(1376),b=n(269),p=n(12),f=n(469),v=n(59),g=n(123),m=n(124),O=n(83);n.d(t,"a",(function(){return _}));var j="GetProfileImageTime",h="GetPersonaTime",I="GetProfileImageNoPhoto",C="GetPersonaResponseNoPhoto",P="https://outlook.office.com/M365.Access",S="image_verified_flag",U="outlook.brands.verified_status",w={};function _(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(a=e.personaBlob,!t&&(a.isPendingFetch||a.hasFetchFailed||a.blobUrl&&w[a.blobUrl]||Object(p.f)(e.emailAddress)&&Object(p.f)(e.personaId)||(null==n?void 0:n())))return[2];i(e,!0),r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,Object(l.a)()?A(e,t):y(e,t)];case 2:return r.sent(),[3,5];case 3:throw o=r.sent(),v.g.warn("Error in getPersonaPhoto "+o),o;case 4:return i(e,!1),[7];case 5:return[2]}}))}))}function y(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i,o,s,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=M(),a=new Headers,t&&a.append("Cache-Control","no-cache"),(i=Object(m.a)({isUserActivity:!1,returnFullResponseOnSuccess:!0,headers:a,method:"GET"})).credentials="same-origin",i.headers.has("X-OWA-CANARY")&&i.headers.delete("X-OWA-CANARY"),i.headers.has("X-Req-Source")&&i.headers.delete("X-Req-Source"),[4,Object(g.a)(Object(d.a)(e.emailAddress,e.personaId),i)];case 1:return o=r.sent(),s=T,c=[e],[4,o.blob()];case 2:return s.apply(void 0,c.concat([r.sent()])),n.end(),[2]}}))}))}function A(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i,o,s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(f.getDelegationTokenForOwa)(P)];case 1:return(n=r.sent())?(a=Object(u.a)(e.emailAddress,e.mailboxType),i={"Content-Type":"image/gif",Authorization:"Bearer "+n,"X-AnchorMailbox":e.emailAddress,image_verified_flag:"","X-RoutingParameter-ResolutionDepth":"Shallow"},t&&(i["Cache-Control"]="no-cache"),o=M(),[4,fetch(a,{method:"GET",mode:"cors",headers:i})]):[2];case 2:return s=r.sent(),Object(l.a)()&&Object(O.i)("rp-brandCards")&&function(e,t){var n=t.headers.get(S);if(null!=n){var r=n.toLowerCase(),a=-1!==r.indexOf(U),i=-1!==r.indexOf(U+" = true");a&&c(e.emailAddress,i)}}(e,s),[4,s.blob()];case 3:return d=r.sent(),T(e,d),o.end(),[2]}}))}))}function M(){var e=Object(l.a)()?j:h;return new b.b(e)}var T=Object(a.action)("processGetPhotoResponse")((function(e,t){i(e,!1);var n,r=0==t.type.toLowerCase().indexOf("image"),a=0==t.type.toLowerCase().indexOf("text/xml"),o=t.size<100;if((r||a)&&!o)return e.personaBlob.blobUrl=URL.createObjectURL(t),w[e.personaBlob.blobUrl]=!0,void(e.personaBlob.hasFetchFailed=!1);n=Object(l.a)()?I:C,Object(b.q)(n),e.personaBlob.hasFetchFailed=!0}))},3910:function(e,t,n){"use strict";function r(e,t,n,r,a,i){return{emailAddress:n,hexConsumerIdForUser:t,personaId:r,name:e,personaBlob:{blobUrl:null,isPendingFetch:!1,hasFetchFailed:!1},size:a,mailboxType:i}}n.d(t,"a",(function(){return r}))},4166:function(e,t,n){"use strict";n.r(t);var r=n(285),a=n(1317),i=n(2993);t.default=Object(r.action)("refreshPersonaPhoto")((function(e,t){a.a.viewStates.forEach((function(n){(e&&n.emailAddress===e||t&&n.personaId===t)&&Object(i.a)(n,!0)}))}))},4806:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(2993),a=n(1457),i=n(3910),o=n(4166),s=n(2431),c=n(1376),u=n(1391);function d(e,t){var n;if(null==t?void 0:t.profilePhotoDataUrl){var d=(null===(n=e.EmailAddresses)||void 0===n?void 0:n[0])?e.EmailAddresses[0].EmailAddress:void 0,l=e.PersonaId?e.PersonaId.Id:void 0;if(Object(o.default)(d,l),d){var b=Object(a.a)(d),p="ModernGroup"==e.PersonaTypeString?"GroupMailbox":"";if(Object(c.a)()){var f=Object(i.a)(e.DisplayName,b,d,l,u.c.regular,p);Object(r.a)(f,!0)}else{var v=b?Object(s.b)(b,p,u.c.regular):Object(s.a)(d,l,p);fetch(v,{headers:{"Cache-Control":"no-cache"},credentials:"include"})}}}}},5290:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"CreatePersonaRequest:#Exchange"},e)}},5291:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"UpdatePersonaRequest:#Exchange"},e)}},5635:function(e,t,n){"use strict";var r=n(29),a=n(0);function i(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(a.__assign)({__type:"CreatePersonaJsonRequest:#Exchange"},n))),Object(r.a)("CreatePersona",e,t)}n.d(t,"a",(function(){return i}))},5636:function(e,t,n){"use strict";var r=n(29),a=n(0);function i(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(a.__assign)({__type:"UpdatePersonaJsonRequest:#Exchange"},n))),Object(r.a)("UpdatePersona",e,t)}n.d(t,"a",(function(){return i}))},6734:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n(0),a=n(759),i="compose",o="read",s="group",c="/"+Object(r.__spread)(["mail"],Object(a.a)().split("/").slice(1)).join("/")+"deeplink/";Object(r.__spread)(["calendar"],Object(a.a)().split("/").slice(1)).join("/")},6735:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(313);function a(e,t,n){var a={pathname:e+t,search:n};return r.format(a)}},6736:function(e,t,n){"use strict";var r,a;function i(e,t){r=e,a=t}function o(){var e=r?r():void 0;return void 0===e||e}function s(e){a&&a(e)}n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}))},7535:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),a=n(469);function i(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(a.getDelegationTokenForOwa)("https://outlook.office.com/M365.Access")];case 1:return[2,e.sent()]}}))}))}},7543:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(50);function a(){var e,t=null===(e=r.a.userConfiguration)||void 0===e?void 0:e.SessionSettings,n=t.IsExplicitLogon,a=t.ExternalDirectoryUserGuid;return n?a:void 0}},7544:function(e,t,n){"use strict";var r=n(3),a=n(7542),i=Object(r.mutatorAction)("UPDATE_LOKI_IS_INITIALIZED",(function(e){a.a.isInitialized=e}));t.a=i},9302:function(e,t,n){"use strict";var r=n(77),a=n(6736);n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return a.c})),n.d(t,"a",(function(){return a.a}));var i=new r.c((function(){return Promise.all([n.e(21),n.e(762)]).then(n.bind(null,16877))})),o=new r.b(i,(function(e){return e.getTopicDefinition})),s=new r.b(i,(function(e){return e.getTopicAnnotations}));new r.b(i,(function(e){return e.addTopic}))}}]);
//# sourceMappingURL=owa.18.js.map
self.scriptsLoaded['owa.18.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.18.js'] = (new Date()).getTime();