self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailFilterActions~MailFolderTreesParent~PublicFolderPickerModule.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[171],{1361:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(1383),i=n(3),a={tabs:[{id:"primaryTab",type:r.a.Primary,state:2,blink:!1,sxsId:"primaryTab"}],tabBarWidth:0,isOverflowMenuShown:!1},o=Object(i.createStore)("tab",a),c=(o(),o().tabs[0])},1383:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.Compose=3]="Compose",e[e.FloatingChat=4]="FloatingChat",e[e.SxS=5]="SxS"}(r||(r={}))},1402:function(e,t,n){"use strict";n.d(t,"b",(function(){return d}));var r=n(0),i=n(20),a=n(83),o=n(1522),c=n(3),u={conversationReadingPaneViewState:null,loadedItemReadingPaneViewStates:new i.ObservableMap({}),loadedConversationReadingPaneViewStates:new i.ObservableMap({}),itemReadingPaneViewState:null,itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null,shouldShowMobileUpsellEmptyState:!1,primaryReadingPaneTabId:null,sxsId:null},d=Object(c.createStore)("readingpane",u),l=d();o.a.registerReference((function(){var e,t;return Object(a.i)("rp-persistedReadingPaneTabs")?Object(r.__spread)(l.loadedConversationReadingPaneViewStates.keys()):null===(t=null===(e=l.conversationReadingPaneViewState)||void 0===e?void 0:e.conversationId)||void 0===t?void 0:t.Id})),t.a=l},1451:function(e,t,n){"use strict";var r=n(77),i=n(1361),a=n(1738),o=n(0),c=n(1383);function u(e){var t,n,r=Object(i.a)();try{for(var a=Object(o.__values)(r.tabs),u=a.next();!u.done;u=a.next()){var d=u.value;if(d.type!==c.a.Primary&&d.type!==c.a.SxS&&d.data==e)return d}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return null}function d(e){var t,n,r=Object(i.a)();try{for(var a=Object(o.__values)(r.tabs),c=a.next();!c.done;c=a.next()){var u=c.value;if(u.sxsId===e)return u.id}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return null}var l=n(1862);function s(e){var t,n,r=function(e){var t=Object(l.a)(e);return t?t.tabId:null}(e);if(r){var a=Object(i.a)();try{for(var c=Object(o.__values)(a.tabs),u=c.next();!u.done;u=c.next()){var d=u.value;if(d.id===r)return d.sxsId}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}}return null}function f(e){var t,n,r,a,u=Object(i.a)();try{for(var d=Object(o.__values)(u.tabs),l=d.next();!l.done;l=d.next()){var s=l.value;if(s.type!==c.a.Primary&&s.type!==c.a.SxS&&(null===(a=null===(r=s.data)||void 0===r?void 0:r.id)||void 0===a?void 0:a.Id)==e)return!0}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return!1}var b=n(1764);n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return O})),n.d(t,"i",(function(){return y})),n.d(t,"k",(function(){return p})),n.d(t,"j",(function(){return w})),n.d(t,"e",(function(){return i.a})),n.d(t,"l",(function(){return i.b})),n.d(t,"d",(function(){return a.a})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return s})),n.d(t,"n",(function(){return f})),n.d(t,"a",(function(){return c.a})),n.d(t,"m",(function(){return b.b}));var v=new r.c((function(){return Promise.all([n.e(0),n.e(2),n.e(3),n.e(41),n.e(43),n.e(174),n.e(270),n.e(275),n.e(742)]).then(n.bind(null,16943))})),m=new r.a(v,(function(e){return e.activateTab})),O=new r.a(v,(function(e){return e.addTab})),y=new r.a(v,(function(e){return e.closeTab})),p=new r.a(v,(function(e){return e.setTabIsShown})),w=new r.b(v,(function(e){return e.getTabById}))},1456:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1402),i=n(83),a=n(1932);function o(e){return Object(i.i)("rp-persistedReadingPaneTabs")?Object(r.b)().loadedConversationReadingPaneViewStates.get(e||(Object(r.b)().sxsId?Object(r.b)().sxsId:Object(a.a)())):Object(r.b)().conversationReadingPaneViewState}},1608:function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"j",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"i",(function(){return s})),n.d(t,"b",(function(){return f})),n.d(t,"h",(function(){return b}));var r="SwitchGroup",i="NavigateFromMeToWe",a="GroupHeader_SendEmail_Button_Clicked",o="GroupHeader_Email_Button_Clicked",c="GroupHeader_Files_Button_Clicked",u="GroupHeader_Calendar_Button_Clicked",d="GroupHeader_Notebook_Button_Clicked",l="GroupHeader_Planner_Button_Clicked",s="GroupHeader_Site_Button_Clicked",f="GroupHeader_CustomLeaveGroup_Button_Clicked",b="GroupHeader_Settings_Button_Clicked"},1738:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(1383),a=n(1361),o=n(59);function c(){var e,t,n=Object(a.a)();try{for(var c=Object(r.__values)(n.tabs),u=c.next();!u.done;u=c.next()){var d=u.value;if(2==d.state&&d.type!=i.a.FloatingChat)return d}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}return o.d("There is no active tab. Something went very wrong."),null}},1764:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r=n(1383),i={};function a(e,t){i[r.a[e]]=t}function o(e){return i[r.a[e]]}},1862:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(764);function i(e){var t;return null===(t=r.a.projections)||void 0===t?void 0:t.filter((function(t){return t.tabId==e||t.window==e}))[0]}},1898:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"j",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return f})),n.d(t,"i",(function(){return b})),n.d(t,"e",(function(){return v})),n.d(t,"h",(function(){return m})),n.d(t,"g",(function(){return O}));var r=n(77),i=n(2159),a=new r.c((function(){return Promise.all([n.e(19),n.e(49),n.e(173),n.e(258),n.e(635)]).then(n.bind(null,4338))})),o=new r.a(a,(function(e){return e.clearAutoMarkAsReadTimer})),c=new r.a(a,(function(e){return e.setAutoMarkAsReadTimer})),u=new r.a(a,(function(e){return e.toggleRowReadState})),d=new r.b(a,(function(e){return e.markItemsAsReadBasedOnNodeIds})),l=new r.a(a,(function(e){return e.markItemAsReadFromReadingPane})),s=new r.a(a,(function(e){return e.onKeyboardMarkAsRead})),f=new r.a(a,(function(e){return e.markAsReadInTable})),b=new r.a(a,(function(e){return e.onSingleSelectionChanged})),v=new r.b(a,(function(e){return e.markReadOnTableViewChange})),m=new r.a(a,(function(e){return e.onReadingPaneClosed})),O=new r.a(a,(function(e){return e.onNavigateAwayViaUpDown}));Object(r.f)(i.b,a,(function(e){return e.onItemPartDeselectedOrchestrator}))},1915:function(e,t,n){"use strict";var r;!function(e){e[e.Email=0]="Email",e[e.Files=1]="Files",e[e.Calendar=2]="Calendar",e[e.Members=3]="Members"}(r||(r={})),t.a=r},1929:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("closeImmersiveReadingPane",(function(e){return{source:e}}))},1932:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1451),i=n(2095);function a(){var e=Object(r.d)();switch(e.type){case r.a.SecondaryReadingPane:return e.data.id.Id;case r.a.Primary:default:return Object(i.a)()}}},1965:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("REMOVE_ROWS_FROM_LISTVIEW_STORE",(function(e,t,n,r){return void 0===r&&(r=!0),{rowKeys:e,tableView:t,actionType:n,shouldRemoveFromAllTables:r}}))},2022:function(e,t,n){"use strict";var r=n(0),i=n(1454),a=n(2359),o=n(2362),c=n(1425),u=n(2204),d=n(1915),l=n(3582),s=n(2912),f=n(269),b=n(2360),v=n(2634),m=n(2996),O=n(1311);function y(e,t,n){e.currentLoadedIndex=Math.min(i.b,e.rowKeys.length),Object(b.a)(e);var r=0==e.tableQuery.type;Object(m.b)(e);var a=e.tableQuery.scenarioType;if(r){var o=Object(f.r)((function(e){return"SwitchMailFolder"==e.eventName}));o&&(o.addCustomProperty("isCached",e.isInitialLoadComplete),o.addCustomProperty("scenario",a))}if(r&&e.isInitialLoadComplete&&Object(O.T)(e.tableQuery.folderId))return Promise.resolve();var c="spotlight"===a?v.g.importAndExecute(e,t,n):Object(s.a)(e,!1,t);return e.isInitialLoadComplete?Promise.resolve():c}var p=n(1608);var w=n(2255),j=n(1800),k=n(3120),h=n(285),I=n(1898),g=n(1737);var T=n(1510),S=n(1323);t.a=Object(h.action)("loadTableViewFromTableQuery")(Object(h.select)({listViewStore:function(){return O.X}})((function(e,t,n,s){var b=Object(j.a)(),v=Object(i.c)(e);e=v.tableQuery,s.listViewStore.selectedTableViewId=v.id;var m,O=[];switch(b&&(O=Object(r.__spread)(b.selectedRowKeys.keys()),function(e,t){k.a.clear(),Object(T.j)(e,S.b.Reset)}(b)),e.type){case 1:m=o.d.importAndExecute(v,a.a,w.a,n,t);break;case 2:m=function(e,t,n){var r=Object(f.r)((function(e){return e.eventName==p.j||e.eventName==p.k})),i=u.a.navigationButtonSelected;if(r){r.addCustomProperty("GroupModule",d.a[i]);var a=Object(c.b)(e.tableQuery);if(Object(l.d)(a)){var o=Object(l.a)();r.addCustomProperty("TimeSinceWarmUp",Date.now()-o)}}var s=Promise.resolve();return i===d.a.Email&&(s=y(e,t,n)),s}(v,a.a,n);break;case 0:m=y(v,a.a,n);break;default:throw new Error("Only Folder, Group or Search Table types are supported in Table Loading")}return b&&function(e,t,n){Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return 0===t.tableQuery.type&&g.a.clearMapForFolder(t.serverFolderId),[4,I.e.import()];case 1:return r.sent()(e,t,n),1===t.tableQuery.type&&t.id!==n.id&&(i=Object(f.r)(),Object(o.a)(t,i)),[2]}}))}))}(O,b,v),m})))},2095:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1402),i=n(722);function a(){var e,t;return Object(i.v)()?null===(e=Object(r.b)().deeplinkId)||void 0===e?void 0:e.id:null===(t=Object(r.b)().primaryReadingPaneTabId)||void 0===t?void 0:t.Id}},2159:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(3),i=Object(r.action)("CLOSE_DEEPLINK_READING_PANE"),a=Object(r.action)("ON_ITEM_PART_DESELECTED",(function(e,t){return{itemId:e,tableView:t}}))},2204:function(e,t,n){"use strict";var r=n(3),i=n(1915);t.a=Object(r.createStore)("commandBarStore",{navigationButtonSelected:i.a.Email,hidden:!1})()},2255:function(e,t,n){"use strict";var r=n(1454),i=n(1518),a=n(1311),o=n(285);t.a=Object(o.action)("onLoadInitialRowsSucceeded")((function(e,t,n,o,c){2==e.tableQuery.type&&c&&(e.serverFolderId=c.Id),o&&(e.serverFolderId=o.Id);var u=Object(a.e)(e);Object(i.h)(t,e,n,u,e.isInitialLoadComplete,"MergeOnInitialRowsFetch"),e.currentLoadedIndex=Math.min(r.b,e.rowKeys.length)}))},2284:function(e,t,n){"use strict";var r=n(12),i=n(3),a=Object(i.createStore)("focusedInboxRollupStore",{uniqueSenders:null,unseenCountToDisplay:null,viewType:0})(),o=n(1311),c=n(547),u=n(1382),d=n(30),l=n(59),s=n(285),f=n(29),b=n(0);function v(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(b.__assign)({__type:"GetFolderChangeDigestRequest:#Exchange"},n)),Object(f.a)("GetFolderChangeDigest",e,t)}var m=10;var O=99,y=Object(s.action)("getFolderChangeDigestAction")((function(e){var t=0==e.focusedViewFilter,n=t?1:2,i=t?Object(d.a)().ViewStateConfiguration.FocusedViewWatermark:Object(d.a)().ViewStateConfiguration.ClutterViewWatermark;a.viewType=n,function(e,t,n,r){return v({Folders:[{FolderId:e,IsConversationView:r,ViewType:t,Watermark:n}],MaxSendersCount:m}).then((function(e){return e}))}(Object(u.a)({BaseFolderId:Object(c.a)({Id:e.folderId})}),n,i,0==Object(o.A)(e.folderId)).then((function(e){return function(e){if(null==e.Folders||0==e.Folders.length)return void l.g.info("GetFolderChangeDigestResponse.Folders is null or empty");var t=e.Folders[0],n=t.RecentUniqueSenders||[];a.uniqueSenders=n.join("; ").toString(),a.unseenCountToDisplay=function(e){if(0===e)return null;if(e>O)return Object(r.c)("{0}+",O);return e.toString()}(t.UnseenCount)}(e)}))}));var p=n(3619);function w(e,t){var n,i=Object(o.A)(t);switch(e){case 1:n=0==i?Object(r.b)(p.a):Object(r.b)(p.b);break;case 2:n=0==i?Object(r.b)(p.c):Object(r.b)(p.d)}return n}var j=n(367),k=n(74),h=Object(i.action)("updateWatermarkAndResetRollup",(function(e,t){return Object(k.c)({name:"TnS_ResetFocusedOtherRollup",customData:[t,e]},{focusedViewFilter:e})}));Object(i.orchestrator)(h,(function(e){var t=e.focusedViewFilter,n=new Date(Date.now()).toUTCString();0==t?Object(j.a)((function(e){e.ViewStateConfiguration.FocusedViewWatermark=n}),[{key:"FocusedViewWatermark",valuetype:"String",value:[n]}],"OWA.ViewStateConfiguration"):1==t&&Object(j.a)((function(e){e.ViewStateConfiguration.ClutterViewWatermark=n}),[{key:"ClutterViewWatermark",valuetype:"String",value:[n]}],"OWA.ViewStateConfiguration")})),Object(i.mutator)(h,(function(){a.uniqueSenders=null,a.unseenCountToDisplay=null,a.viewType=0}));var I=h;n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return w})),n.d(t,"d",(function(){return I})),n.d(t,"a",(function(){return a}))},2359:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r=n(2360),i=n(1311),a=n(1454),o=n(2361),c=n(285);t.a=Object(c.action)("onInitialTableLoadComplete")((function(e,t,n,c){if(e.isLoading=!1,e.isInitialLoadComplete=!0,!c)if(t){e.loadErrorStatus=0;var d=e.selectedRowKeys.size>0;0!=e.tableQuery.type&&2!=e.tableQuery.type||(d||e!=Object(i.G)()||Object(r.a)(e),o.b.importAndExecute(e,10)),Object(a.d)(e)}else u(e,n)}));var u=Object(c.action)("setTableViewErrorState")((function(e,t){switch(t){case"ErrorAccessDenied":e.loadErrorStatus=1;break;case"UnexpectedClientError":e.loadErrorStatus=2;break;default:e.loadErrorStatus=3}}))},2360:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("INIT_TABLE_SELECTION_ON_LOAD",(function(e){return{tableView:e}}))},2361:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(77),i=new r.c((function(){return n.e(826).then(n.bind(null,5591))})),a=new r.a(i,(function(e){return e.prefetchRowInCache})),o=new r.a(i,(function(e){return e.prefetchSingleRow})),c=new r.a(i,(function(e){return e.prefetchFirstN})),u=new r.a(i,(function(e){return e.prefetchAdjacentRowsOnDelay}))},2362:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var r=n(77),i=new r.c((function(){return Promise.all([n.e(14),n.e(40),n.e(45),n.e(49),n.e(712)]).then(n.bind(null,5566))})),a=new r.a(i,(function(e){return e.loadSearchTable})),o=new r.a(i,(function(e){return e.cleanSearchTableState})).importAndExecute,c=new r.b(i,(function(e){return e.loadMoreFindItemSearch})),u=new r.b(i,(function(e){return e.loadMoreSubstrateSearch}))},2462:function(e,t,n){"use strict";var r=n(0),i=n(2575),a=n(9),o=n(1965),c=n(3009),u=n(2284),d=n(1311),l=n(285),s=Object(l.action)("updateRollupOnAddOrUpdateRowNotification")((function(e){var t=Object(d.G)();if(null!=t){var n=Object(d.l)(e),r=Object(d.l)(t);(0==n&&1==r||1==n&&0==r)&&Object(u.b)(e.tableQuery)}})),f=n(1518),b=n(2184),v=n(2361),m=n(3144);var O=Object(l.action)("rowNotificationHandler.onAddOrUpdateRow")((function(e,t){var n=e.InstanceKey;if(!n)throw new Error("onAddOrUpdateNotification: Row instanceKey should not be null");if(Object(f.k)(e,t)){var r=Object(f.e)(e,t.tableQuery.listViewType),u=r.lastDeliveryOrRenewTimeStamp,l=r.lastDeliveryTimeStamp,O=Object(m.b)(u,l,t,0,n),y=Object(i.a)(n,t),p=y>=0;-1!=O?Object(d.T)(t.tableQuery.folderId)&&Object(a.Eb)(Object(a.lc)(l),d.X.inboxPausedDateTime)||(p?(y<O&&O--,function(e,t,n){Object(f.g)(e,t)?(b.a.updateRowData(e,t),Object(d.Z)(t,4)):(b.a.updateRow(n,e,t,"RowUpdateNotification"),Object(d.Z)(t,2)),Object(c.a)(e.InstanceKey,t)}(e,t,O)):function(e,t,n){b.a.addRow(n,e,t,"RowAddNotification"),Object(d.Z)(t,1),t.currentLoadedIndex++}(e,t,O),v.d.importAndExecute(n,t,!0),-1!=Object(d.l)(t)&&s(t),Object(f.d)(t)):p&&Object(o.a)([n],t,"UpdateNotification")}})),y=n(2794),p=n(3),w=Object(p.action)("TRY_REMOVE_ITEM_NORMALIZED_BODY",(function(e){return{item:e}})),j=n(1737),k=n(1323),h=n(1522),I=n(1724),g=n(1497),T=n(59),S=Object(l.select)({tableView:function(e){return g.a.tableViews.get(e.id)}})(Object(l.action)("handleRowNotification")((function(e,t){var n,r=t.tableView;if(r)if(r.isInitialLoadComplete)switch(e.EventType){case"RowAdded":n=N(e,r),C(n,r);break;case"RowModified":n=N(e,r),V(n,r);break;case"RowDeleted":n=N(e,r),R(n,r);break;case"QueryResultChanged":case"Reload":F(r);break;default:return}else T.g.info("Ignore row notifications as table has not loaded");else T.g.info("Received row notification for a deleted folder")})));function N(e,t){switch(t.tableQuery.listViewType){case 0:return e.Conversation?e.Conversation:(T.d("Conversation should not be undefined or empty in notification payload."+e.EventType+", "+e.id),null);case 1:return e.Item?e.Item:(T.d("Item should not be undefined or empty in notification payload."+e.EventType+", "+e.id),null);default:return T.d("rowNotificationStrategy: unsupported listViewType: "+t.tableQuery.listViewType),null}}var C=Object(l.action)("rowNotificationHandler.onAddRow")((function(e,t){Object(d.T)(t.tableQuery.folderId)||t.totalRowsInView++,O(e,t)})),V=Object(l.action)("rowNotificationHandler.onUpdateRow")((function(e,t){O(e,t)})),R=Object(l.action)("rowNotificationHandler.onDeleteRow")((function(e,t){var n=e.InstanceKey;if(!n)throw new Error("onDeleteNotification: Row instanceKey should not be null");(t.totalRowsInView--,Object(f.j)(e,t))&&(Object(i.a)(n,t)>=0&&(Object(o.a)([n],t,"DeleteNotification"),Object(d.Z)(t,3)))})),F=Object(l.select)({conversations:function(){return h.a},items:function(){return k.u.items}})(Object(l.action)("rowNotificationHandler.onReload")((function(e,t){!function(e,t){var n,i;switch(e.tableQuery.listViewType){case 0:t.conversations.clear();for(var a=t.conversations.getItemIds(),o=0,c=a.length;o<c;o++){var u=a[o];if(t.conversations.has(u)){var l=t.conversations.get(u);v.c.importAndExecute(l.conversationId,e)}}break;case 1:try{for(var s=Object(r.__values)(e.rowKeys),f=s.next();!f.done;f=s.next()){var b=f.value,m=d.b.getRowClientItemId(b,e),O=t.items.get(m.Id);w(O),t.items.get(m.Id).NormalizedBody&&v.c.importAndExecute(m,e)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}}(e,t),Object(y.a)(e),j.a.clearMapForFolder(e.serverFolderId)})));Object(p.mutator)(w,(function(e){var t=e.item;Object(I.d)(t.ConversationId.Id,0)||Object(I.e)(t.ItemId.Id,0)||(t.NormalizedBody=void 0)}));var _=n(1312),E=n(1325),D=n(3006),x=n(1332),P=n(1931);var A=n(2411),Q=n(1467),L=n(4419),B={kind:"Document",definitions:Object(r.__spread)([{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"subscribeToRowNotifications"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subscriptionId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"listViewType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ReactListViewType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TableQueryType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoryName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FocusedViewFilter"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ViewFilter"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sortBy"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SortByInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shapeName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isScheduledFolder"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subscribeToRowNotifications"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"subscriptionId"},value:{kind:"Variable",name:{kind:"Name",value:"subscriptionId"}}},{kind:"ObjectField",name:{kind:"Name",value:"listViewType"},value:{kind:"Variable",name:{kind:"Name",value:"listViewType"}}},{kind:"ObjectField",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}},{kind:"ObjectField",name:{kind:"Name",value:"categoryName"},value:{kind:"Variable",name:{kind:"Name",value:"categoryName"}}},{kind:"ObjectField",name:{kind:"Name",value:"focusedViewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"viewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"commonRowsOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"sortBy"},value:{kind:"Variable",name:{kind:"Name",value:"sortBy"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}},{kind:"ObjectField",name:{kind:"Name",value:"shape"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ShapeName"},value:{kind:"Variable",name:{kind:"Name",value:"shapeName"}}},{kind:"ObjectField",name:{kind:"Name",value:"IsScheduledFolder"},value:{kind:"Variable",name:{kind:"Name",value:"isScheduledFolder"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NotificationPayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"EventType"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RowNotificationChangePayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Conversation"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ConversationTypeFragment"},directives:[]}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RowNotificationDeletePayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Conversation"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"InstanceKey"},arguments:[],directives:[]}]}}]}}]}}]}}],L.a.definitions)},U=n(340),K=n(83),M=n(1493),G=n(1368);var H={};function W(e){var t=H[e];if(t){var n=Object(d.J)().tableViews.get(e);Object(K.i)("mon-conv-useGqlForConvSubscription")&&n&&0==n.tableQuery.listViewType?function(e){e.unsubscribe()}(t):Q.g.importAndExecute(t,S),delete H[e]}}function q(e){if(!H[e.id]){if(0!=e.tableQuery.type&&2!=e.tableQuery.type)throw new Error("subscribeToRowNotifications should only be called for Folder or Group table type");var t=e.tableQuery;1!=t.sortBy.sortColumn||Object(k.m)(e.tableQuery.folderId)||Object(_.D)(e.tableQuery.folderId,E.k)||"spotlight"!==t.scenarioType&&(Object(K.i)("mon-conv-useGqlForConvSubscription")&&0==t.listViewType?function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.tableQuery,[4,Object(U.a)()];case 1:return n=r.sent(),i=n.subscribe({query:B,variables:{subscriptionId:e.id,folderId:e.tableQuery.folderId,listViewType:Object(d.q)(t.listViewType),type:Object(d.s)(e.tableQuery.type),categoryName:t.categoryName,focusedViewFilter:Object(d.p)(t.focusedViewFilter),viewFilter:Object(d.t)(t.viewFilter),sortBy:{sortColumn:Object(d.r)(t.sortBy.sortColumn),sortDirection:t.sortBy.sortDirection,canSortByRenewTime:Object(f.l)(t)},shapeName:D.c(e.tableQuery.folderId,Object(d.R)(t.scenarioType)),isScheduledFolder:"scheduled"==Object(G.a)(e.tableQuery.folderId),mailboxInfo:Object(M.d)(t)},context:{attemptToUseHxResolver:Object(K.i)("mon-conv-useHxForConvListViewLoad")}}),[2,i.subscribe({next:function(e){return S(e.data.subscribeToRowNotifications)},error:function(e){T.g.info("Row notification error "+e)}})]}}))}))}(e).then((function(t){H[e.id]=t})):Q.b.import().then((function(n){var r={NotificationType:"RowNotification",FolderId:z(e),FocusedViewFilter:t.focusedViewFilter,IsConversation:0==t.listViewType,CategoryFilter:t.categoryName,Filter:t.viewFilter,ChannelId:n(),MailboxId:J(e)};!0===r.IsConversation?(r.ConversationShapeName=D.c(e.tableQuery.folderId,Object(d.R)(t.scenarioType)),r.ConversationResponseShape=D.b(e.tableQuery.folderId),r.SortBy=function(e){var t,n=e.sortBy;switch(e.sortBy.sortColumn){case 1:Object(f.l)(e)&&(t="ConversationLastDeliveryOrRenewTime");break;case 3:t="ConversationUniqueSenders";break;case 7:t="ConversationSize";break;case 8:t="ConversationTopic";break;case 5:t="ConversationImportance";break;default:throw new Error("getConversationSortByProperty: sort column is not supported "+n.sortColumn)}var r=[];t&&r.push(Object(P.a)({Order:n.sortDirection,Path:Object(x.a)({FieldURI:t})}));var i=1==e.sortBy.sortColumn?e.sortBy.sortDirection:d.c.DESCENDING_SORT_DIR;return r.push(Object(P.a)({Order:i,Path:Object(x.a)({FieldURI:"ConversationLastDeliveryTime"})})),r}(t)):r.SortBy=Object(A.a)(t);var i={subscriptionId:e.id,requiresExplicitSubscribe:!0,subscriptionParameters:r};Q.f.importAndExecute(i,S),H[e.id]=i})))}}function z(e){return 0==e.tableQuery.type?e.tableQuery.folderId:null}function J(e){return 2==e.tableQuery.type?e.tableQuery.folderId:null}n.d(t,"a",(function(){return q})),n.d(t,"b",(function(){return W}))},2575:function(e,t,n){"use strict";function r(e,t){return t.rowKeys.indexOf(e)}n.d(t,"a",(function(){return r}))},2818:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return s}));var r=n(2161),i=n(1916),a=n(1311),o=n(1322),c=n(2399);function u(){var e=Object(o.a)("inbox"),t=Object(a.A)(e),n=Object(r.a)(e);return Object(i.a)(e,t,"mail",-1,null,null,n)}function d(){var e=u();return e.focusedViewFilter=0,e}function l(){var e=u();return e.focusedViewFilter=1,e}function s(){return Object(c.a)()?d():u()}},2906:function(e,t,n){"use strict";var r=n(2462),i=n(77),a=n(1849),o=n(3272),c=n(1712),u=n(1816),d=n(2816),l=n(1966),s=n(2817),f=n(1967),b=n(3145),v=n(3444),m=n(1965),O=n(2206),y=n(3),p=n(1311);Object(y.orchestrator)(m.a,(function(e){var t=e.rowKeys,n=e.tableView,r=e.actionType,i=e.shouldRemoveFromAllTables,a=n.id,o=t.filter((function(e){return n.rowKeys.indexOf(e)>=0}));if(0!=o.length){var c=Object(p.C)(o,a);if(Object(v.a)(o,n,r),"All"==Object(p.O)(n)&&i){var u=Object(O.a)(n.tableQuery.folderId,!1),d=Object(p.l)(n);u.forEach((function(e){if(a!=e.id&&d===Object(p.l)(e)){var t=Object(p.E)(c,e);0!=t.length&&Object(v.a)(t,e,r)}}))}}}));function w(e,t){if(!t||0==t.length)return e;var n=[];return t.forEach((function(e){n.push(e)})),e.forEach((function(e){-1===t.indexOf(e)&&n.push(e)})),n}function j(e,t){return t&&0!=t.length?(e.forEach((function(e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)})),0===t.length&&(t=void 0),t):t}var k=n(3273),h=n(1323);Object(y.mutator)(k.a,(function(e){var t=e.conversationRowKeys,n=e.tableViewId,r=e.categoriesToAdd,i=e.categoriesToRemove,a=e.clearCategories;t.forEach((function(e){r&&function(e,t,n){var r=Object(p.K)(e,t);r.categories=w(n,r.categories);var i=Object(p.J)().tableViews.get(t);p.b.getItemIds(e,i).forEach((function(e){var t=Object(h.v)(e);t&&(t.Categories=w(n,t.Categories))}))}(e,n,r),i&&function(e,t,n){var r=Object(p.K)(e,t);r.categories=j(n,r.categories);var i=Object(p.J)().tableViews.get(t);p.b.getItemIds(e,i).forEach((function(e){var t=Object(h.v)(e);t&&(t.Categories=j(n,t.Categories))}))}(e,n,i),a&&function(e,t){Object(p.K)(e,t).categories=void 0;var n=Object(p.J)().tableViews.get(t);p.b.getItemIds(e,n).forEach((function(e){var t=Object(h.v)(e);t&&(t.Categories=void 0)}))}(e,n)}))}));var I=n(0),g=n(3274);Object(y.mutator)(g.a,(function(e){var t=e.itemIds,n=e.categoriesToAdd,r=e.categoriesToRemove,i=e.clearCategories;t.forEach((function(e){var t=Object(h.v)(e);n&&(t.Categories=w(n,t.Categories),function(e,t){var n,r,i=Object(O.a)(e.ParentFolderId.Id,!0),a=function(n){if(Object(p.P)(n)){var r=e.ConversationId.Id,i=Object(p.E)([r],n);if(0===i.length)return"continue";i.forEach((function(e){var r=Object(p.K)(e,n.id);r.categories=w(t,r.categories)}))}};try{for(var o=Object(I.__values)(i),c=o.next();!c.done;c=o.next()){var u=c.value;a(u)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}(t,n)),r&&(t.Categories=j(r,t.Categories),t.Categories||(t.Categories=[])),i&&(t.Categories=[])}))}));var T=new i.c((function(){return n.e(1295).then(n.bind(null,16690))}));Object(i.f)(f.a,T,(function(e){return e.markItemsAsReadStoreUpdateOrchestrator})),Object(i.f)(s.a,T,(function(e){return e.markItemsAsPinnedStoreUpdateOrchestrator})),Object(i.f)(l.a,T,(function(e){return e.markConversationsAsReadStoreUpdateOrchestrator})),Object(i.f)(d.a,T,(function(e){return e.markConversationsAsPinnedStoreUpdateOrchestrator})),Object(i.f)(c.a,T,(function(e){return e.deleteItemsStoreUpdateOrchestrator})),Object(i.f)(a.a,T,(function(e){return e.deleteConversationStoreUpdateOrchestrator})),Object(i.f)(o.a,T,(function(e){return e.deleteFolderStoreUpdateOrchestrator})),Object(i.f)(u.a,T,(function(e){return e.markAllAsReadOrchestrator})),Object(i.f)(b.a,T,(function(e){return e.updateCategoriesInViewOrchestrator}));var S=new i.a(T,(function(e){return e.removeTableFromStore}));function N(e){Object(r.b)(e),S.importAndExecute(e)}n.d(t,"a",(function(){return N}))},2907:function(e,t,n){"use strict";var r=n(2022),i=n(2359),a=n(0),o=n(3445),c=n(1531),u=n(3);Object(u.orchestrator)(c.d,(function(e){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return t=e.searchTableQuery,n=e.searchEndToEndPerformanceDatapoint,i=e.actionSource,[4,Object(r.a)(t,n,i)];case 1:return a.sent(),n.end(),Object(o.a)(t),[2]}}))}))}));var d=n(1319);var l=n(1454),s=n(2184),f=n(4761),b=n(1323),v=n(1510),m=function(e){var t=e.actionSource,n=e.row,i=e.searchTableQuery,o=e.referenceId,c=e.traceId,u=e.itemPartId,m=Object(l.c)(i);s.a.clear(m),s.a.addRow(0,n,m),Object(r.a)(i,null,t);var O={referenceKey:o,index:0,traceId:c};if(Object(f.a)(n.InstanceKey,m,O),Object(v.q)(m,m.rowKeys[0],!1,b.b.SearchSuggestionClick),0==i.listViewType&&u){var y=function(e,t){var n,r,i,o;if(d.a.conversations.has(e)){var c=d.a.conversations.get(e);try{for(var u=Object(a.__values)(c.conversationNodeIds),l=u.next();!l.done;l=u.next()){var s=l.value,f=d.a.conversationNodes.get(s);try{for(var b=(i=void 0,Object(a.__values)(f.itemIds)),v=b.next();!v.done;v=b.next()){if(v.value==t)return s}}catch(e){i={error:e}}finally{try{v&&!v.done&&(o=b.return)&&o.call(b)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}return null}(n.ConversationId.Id,u),p=Object(d.b)().conversations.get(n.ConversationId.Id),w=p?p.conversationNodeIds:[];Object(v.b)(y,u,w,m,b.b.MailListItemExpansion)}},O=(Object(u.orchestrator)(c.c,(function(e){m(e)})),n(1916)),y=n(1800),p=n(2284),w=n(1538);Object(u.orchestrator)(l.e,(function(e){var t=e.focusedViewFilter;return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var e,n,i;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return e=Object(y.a)(),Object(p.d)(t,"NonUserAction"),n=Object(O.a)(e.tableQuery.folderId,e.tableQuery.listViewType,"mail",t,null,null,null),[4,Object(r.a)(n)];case 1:return i=a.sent(),w.b.importAndExecute(),[2,i]}}))}))}));var j=n(2362),k=n(1787);Object(u.orchestrator)(k.a,(function(){j.d.import()}));var h=n(2924),I=n(77);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return i.b}));var g=new I.c((function(){return n.e(1334).then(n.bind(null,17028))}));Object(I.f)(h.a,g,(function(e){return e.onListViewTypeOptionSavedOrchestrator}))},2912:function(e,t,n){"use strict";var r=n(2255),i=n(1311),a=n(1493),o=n(1518),c=n(1454),u=n(1892),d=n(547),l=n(2923);var s=n(2411);var f=n(59),b=n(3);function v(e,t,n){switch(m(e),e.tableQuery.listViewType){case 0:return function(e,t,n){var s,f=e.tableQuery,b=null===(s=Object(i.j)(e,!0))||void 0===s?void 0:s.Id,v=f.viewFilter&&"All"!==f.viewFilter,m=i.c.getDefaultSortBy(),O=m.sortColumn,y=m.sortDirection,p=f.sortBy&&(f.sortBy.sortColumn!==O||f.sortBy.sortDirection!==y);return Object(u.d)(f.folderId,c.a,f.viewFilter,f.sortBy,Object(o.l)(f),f.focusedViewFilter,f.requestShapeName,Object(a.d)(f),void 0,f.categoryName,b,{datapoint:{customData:{scenarioType:f.scenarioType,isPrefetch:t,isFilter:v,isSort:p}}},f.shouldTryToUseSessionDataResponse).then((function(i){var a=[];return i.edges&&(a=i.edges.map((function(e){return e.node}))),Object(r.a)(e,a,i.totalConversationRowsInView,i.searchFolderId?Object(d.a)({Id:i.searchFolderId}):null,i.folderId?Object(d.a)({Id:i.folderId}):null),n(e,!0,"200",t),Promise.resolve()})).catch((function(r){var i=Object(l.a)(r);return n(e,!1,i,t),Promise.reject(r)}))}(e,t,n);case 1:return function(e,t,n){var o=e.tableQuery;return Object(u.c)(Object(i.i)(o),0,c.a,o.viewFilter,Object(s.a)(o),o.focusedViewFilter,o.requestShapeName,o.shouldTryToUseSessionDataResponse,Object(a.e)(o),o.categoryName,Object(i.j)(e,!0)).then((function(i){var a=Promise.resolve(),o="Success"==i.ResponseClass;if(o)Object(r.a)(e,i.RootFolder.Items,i.RootFolder.TotalItemsInView,i.SearchFolderId,null);else{var c=new Error("ResponseCode="+i.ResponseCode+", Stacktrace="+i.StackTrace);c.fetchErrorType="ServerFailure",a=Promise.reject(c)}return n(e,o,i.ResponseCode,t),a}),(function(r){var i,a=(null===(i=null==r?void 0:r.response)||void 0===i?void 0:i.status)||"";return n(e,!1,a,t),Promise.reject(r)}))}(e,t,n);default:return f.g.warn("listViewType: "+e.tableQuery.listViewType+" is not supported."),Promise.resolve()}}n.d(t,"a",(function(){return v}));var m=Object(b.mutatorAction)("setTableViewLoading",(function(e){e.isLoading=!0,e.loadErrorStatus=0}))},2924:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("ON_LIST_VIEW_TYPE_OPTION_SAVED",(function(e){return{newListViewType:e}}))},2996:function(e,t,n){"use strict";var r=n(2906),i=n(2462),a=5,o=[];function c(e){o.unshift(e.id),Object(i.a)(e),function(){if(o.length>a)for(var e=a;e<o.length;e++)u(o[e])}()}function u(e){var t=o.indexOf(e);if(-1==t)throw new Error("TableViewId should be present in the mru list when remove is called");o.splice(t,1),Object(r.a)(e)}function d(e){var t=o.indexOf(e.id);switch(t){case-1:c(e);break;case 0:break;default:!function(e){var t=e.id;o.splice(o.indexOf(t),1),o.unshift(t)}(e)}return t}var l=n(3580),s=n(2161),f=n(1322),b=n(1311);function v(e){if(1==e.tableQuery.type)throw new Error("updateTablesInCache should never be called for Search table");var t=e.tableQuery;if(e.tableQuery.folderId===Object(f.a)("inbox")&&"All"===Object(b.O)(e)&&"spotlight"!==t.scenarioType){var n=t.sortBy.sortColumn,r=t.sortBy.sortDirection,i=Object(s.a)(e.tableQuery.folderId);if(n===i.sortColumn&&r===i.sortDirection)return Object(l.a)(),0}return d(e)}function m(){Object(l.a)()}function O(){return o.length<a}function y(e){u(e)}n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return O})),n.d(t,"d",(function(){return y}))},3009:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ROW_UPDATED",(function(e,t){return{rowKey:e,tableView:t}}))},3120:function(e,t,n){"use strict";var r=n(444),i=n(77),a=new i.c((function(){return Promise.all([n.e(1),n.e(866)]).then(n.bind(null,16433))})),o=new i.a(a,(function(e){return e.downloadPersonaPhoto})),c=n(1317),u=n(1480),d=new r.a(3,(function(e){var t=Object(u.a)(e.emailAddress,e.personaId,e.size,e.mailboxType,e.name),n=c.a.viewStates.get(t);return o.importAndExecute(n,!1,e.skipLoadingPhoto)}),500);t.a=d},3144:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(2283),i=n(1311),a=n(1518);function o(e,t,n,r){var o=new Date(i.b.getLastDeliveryTimeStamp(n,r)).getTime()-new Date(t).getTime();if(Object(a.l)(r.tableQuery)){var c=new Date(i.b.getLastDeliveryOrRenewTimeStamp(n,r)).getTime()-new Date(e).getTime();return 0!=c?c:o}return o}function c(e,t,n,i,o){return Object(r.a)(o,n.id,e)?Object(a.f)(n,0):u(e,t,n,i)}function u(e,t,n,a){var c=n.rowKeys.length;if(0==c)return 0;var u,d=Object(i.I)(n).sortDirection==i.c.DESCENDING_SORT_DIR;for(u=a;u<c;u++){var l=n.rowKeys[u];if(!Object(r.a)(l,n.id,e)){var s=o(e,t,l,n);if(d?s<=0:s>0)return u}}return c==n.totalRowsInView?c:-1}},3145:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("updateCategoriesInView",(function(e,t){return{modifiedCategoryName:e,newCategoryName:t}}))},3146:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("UPDATE_TABLE_CURRENT_LOADED_INDEX",(function(e,t){return{tableViewId:e,currentLoadedIndexToSet:t}}))},3272:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("DELETE_FOLDER_STORE_UPDATE",(function(e){return{folderIds:e}}))},3409:function(e,t,n){"use strict";var r=n(77),i=n(3010),a=n(1737),o=n(1651);function c(e){var t;if(Object(o.c)(e.serverFolderId,o.b.Running))return!1;if(e.currentLoadedIndex<e.rowKeys.length)return!0;if("spotlight"===(null===(t=null==e?void 0:e.tableQuery)||void 0===t?void 0:t.scenarioType))return!1;var n=a.a.getCount(e.serverFolderId,3);return e.rowKeys.length>0&&e.rowKeys.length<e.totalRowsInView-n}var u=n(1454);function d(e){(function(e){return e.rowKeys.length<u.a&&!e.isLoading&&c(e)})(e)&&f.importAndExecute(e)}var l=n(3);Object(l.orchestrator)(u.d,(function(e){var t=e.tableView;t&&c(t)&&f.import().then((function(e){c(t)&&e(t)}))})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return d}));var s=new r.c((function(){return n.e(1256).then(n.bind(null,16770))}));Object(r.f)(i.a,s,(function(e){return e.reloadTableOnTriageActionFailOrchestrator}));var f=new r.a(s,(function(e){return e.loadMoreInTable})),b=new r.a(s,(function(e){return e.reloadInboxPostBoot}))},3444:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(0),i=n(3409),a=n(1510),o=n(1311),c=n(2184),u=n(1322),d=n(3146),l=n(2646),s=n(1929),f=n(1881);function b(e,t,n){var b,v;void 0===n&&(n="LocalUpdate");var m=-1,O=!1;try{for(var y=Object(r.__values)(e),p=y.next();!p.done;p=y.next()){var w=p.value;t.selectedRowKeys.has(w)&&(m=t.rowKeys.indexOf(w))>-1&&(O=o.b.getIsPinned(t.rowKeys[m],t)),c.a.removeRow(w,t,n)}}catch(e){b={error:e}}finally{try{p&&!p.done&&(v=y.return)&&v.call(y)}finally{if(b)throw b.error}}Object(d.a)(t.id,Math.min(t.currentLoadedIndex,t.rowKeys.length)),t.id===Object(l.a)()&&(Object(i.d)(t),m>-1&&t.tableQuery.folderId!=Object(u.a)("junkemail")&&t.rowKeys.length>0?Object(a.l)(t,m,O):Object(f.a)()&&Object(s.a)())}},3445:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("ON_MAIL_SEARCH_COMPLETE",(function(e){return{searchTableQuery:e}}))},3580:function(e,t,n){"use strict";var r=n(2906),i=n(2462),a=n(1454),o=[];function c(e,t){if(-1===d(e)){o.push(e);var n=Object(a.c)(t);Object(i.a)(n)}}function u(e,t){var n=d(e);if(-1!==n){o.splice(n,1);var i=Object(a.c)(t,!0);i&&Object(r.a)(i.id)}}function d(e){return o.indexOf(e)}var l=n(2284),s=n(2399),f=n(2818);n.d(t,"a",(function(){return O}));var b="FOCUSED",v="OTHER",m="ALL";function O(){var e=Object(f.c)(),t=Object(f.b)(),n=Object(f.d)();Object(s.a)()?(c(b,t),c(v,n),u(m,e),Object(l.b)(n)):(u(b,t),u(v,n),c(m,e))}},3582:function(e,t,n){"use strict";var r={warmedUpGroups:null,warmUpTime:0};function i(e){r.warmUpTime=e}function a(){return r.warmUpTime}function o(e){r.warmedUpGroups=e}function c(e){var t=e.toLowerCase();if(!r.warmedUpGroups)return!1;for(var n=0;n<r.warmedUpGroups.length;++n){if(r.warmedUpGroups[n].toLowerCase()==t)return!0}return!1}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return c}))},3619:function(e){e.exports=JSON.parse('{"a":"asb","c":"bsb","b":"csb","d":"dsb"}')}}]);
//# sourceMappingURL=owa.MailBoot~MailFilterActions~MailFolderTreesParent~PublicFolderPickerModule.js.map
self.scriptsLoaded['owa.MailBoot~MailFilterActions~MailFolderTreesParent~PublicFolderPickerModule.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailFilterActions~MailFolderTreesParent~PublicFolderPickerModule.js'] = (new Date()).getTime();