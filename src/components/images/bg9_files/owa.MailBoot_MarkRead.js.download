self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MarkRead.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[635],{11945:function(e){e.exports=JSON.parse('{"a":"Daa","b":"Eaa","c":"Faa","d":"Gaa"}')},11946:function(e){e.exports=JSON.parse('{"a":"zaa","b":"Aaa","c":"Baa","d":"Caa"}')},11947:function(e){e.exports=JSON.parse('{"a":"vaa","b":"waa","c":"xaa","d":"yaa"}')},1330:function(e,n,t){"use strict";var a,i,r=t(3),o=Object(r.action)("setOptionValue",(function(e,n){return{feature:e,value:n}})),d=Object(r.action)("assignOptionValue",(function(e,n){return{feature:e,value:n}})),c=Object(r.action)("verifyAndSetOptionValues",(function(e){return{potentialOptionValues:e}})),s=Object(r.action)("setOptionValue",(function(e,n){return{feature:e,value:n}})),l=t(0);!function(e){e[e.TestFeature=1]="TestFeature",e[e.SmartSuggestions=2]="SmartSuggestions",e[e.DiverseEmojis=4]="DiverseEmojis",e[e.SurfaceActions=5]="SurfaceActions",e[e.SkypeNotifications=6]="SkypeNotifications",e[e.WebPushNotifications=7]="WebPushNotifications",e[e.Confetti=8]="Confetti",e[e.GdprAdsPrefs=9]="GdprAdsPrefs",e[e.CalendarSurfaceAddins=10]="CalendarSurfaceAddins",e[e.ExternalImages=11]="ExternalImages",e[e.EventCapture=12]="EventCapture",e[e.Translation=14]="Translation",e[e.CalendarSurfaceOptions=15]="CalendarSurfaceOptions",e[e.TxpEventNotifications=16]="TxpEventNotifications",e[e.MentionEventNotifications=17]="MentionEventNotifications",e[e.ComposeAssistance=18]="ComposeAssistance",e[e.ActivityFeed=19]="ActivityFeed",e[e.AmpDeveloper=20]="AmpDeveloper",e[e.CalendarHelp=21]="CalendarHelp",e[e.LinkedInViewProfile=22]="LinkedInViewProfile",e[e.Bohemia=23]="Bohemia",e[e.GdprAdsV2=24]="GdprAdsV2",e[e.Proofing=25]="Proofing",e[e.ActiveProxyAddress=26]="ActiveProxyAddress",e[e.OutlookSpaces=27]="OutlookSpaces",e[e.GdprAdsV3=28]="GdprAdsV3",e[e.SxS=29]="SxS"}(a||(a={}));var u=Object(r.createStore)("owsOptionsStore",{options:(i={},i[a.SmartSuggestions]={feature:a.SmartSuggestions,smartSuggestionsEnabled:!1,browserLocationEnabled:!1},i[a.DiverseEmojis]={feature:a.DiverseEmojis,diverseEmojisSelectedSkinTone:""},i[a.SurfaceActions]={feature:a.SurfaceActions,readSurfaceActions:[],readSurfaceAddins:[],composeSurfaceActions:[],composeSurfaceAddins:[]},i[a.SkypeNotifications]={feature:a.SkypeNotifications,skypeMessageNotification:1,skypeCallingNotification:1},i[a.WebPushNotifications]={feature:a.WebPushNotifications,enabled:!1,applicationServerKey:null},i[a.Confetti]={feature:a.Confetti,confettiEnabled:!1},i[a.GdprAdsPrefs]={feature:a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},i[a.GdprAdsV2]={feature:a.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},i[a.GdprAdsV3]={feature:a.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},i[a.CalendarSurfaceAddins]={feature:a.CalendarSurfaceAddins,calendarSurfaceAddins:[]},i[a.ExternalImages]={feature:a.ExternalImages,externalImagesSelectedOption:null},i[a.EventCapture]={autoCollectionEnabled:!1},i[a.Translation]={feature:a.Translation,translationMode:0,targetLanguage:"",excludedLanguages:[]},i[a.CalendarSurfaceOptions]={feature:a.CalendarSurfaceOptions,agendaPaneIsClosed:!0,lastKnownRoamingTimeZone:void 0,roamingTimeZoneNotificationsIsDisabled:void 0,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},i[a.MentionEventNotifications]={feature:a.MentionEventNotifications,enabled:!1},i[a.TxpEventNotifications]={feature:a.TxpEventNotifications,enabled:!1},i[a.ComposeAssistance]={feature:a.ComposeAssistance,composeAssistanceEnabled:!1},i[a.AmpDeveloper]={feature:a.AmpDeveloper,enabled:!0,allowedSender:[]},i[a.ActivityFeed]={feature:a.ActivityFeed,OWASurfaceOptions:{SupportedTypes:[],DisabledInFeedPanel:[]}},i[a.LinkedInViewProfile]={dismissed:!1},i[a.CalendarHelp]={feature:a.CalendarHelp,calendarHelpEnabled:!1},i[a.Bohemia]={feature:a.Bohemia,bohemiaEnabled:!1},i[a.Proofing]={feature:a.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!1,proofingLocale:void 0,overriddenOptions:void 0},i[a.ActiveProxyAddress]={feature:a.ActiveProxyAddress,activeProxyAddresses:[]},i[a.OutlookSpaces]={feature:a.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},i[a.SxS]={feature:a.SxS,hideReadingPane:!1},i)}),b=t(20);function v(e){return(null==e?void 0:e.feature)in a}var f,m=t(360);function p(e,n){u().options[e]=n}function O(e){return u().options[e]}Object(r.mutator)(d,(function(e){var n=e.feature,t=e.value;m(u().options[n],t)})),Object(r.mutator)(o,(function(e){p(e.feature,e.value)})),Object(r.mutator)(s,(function(e){var n=e.feature,t=e.value;Object(b.extendObservable)(u().options[n],t)})),Object(r.mutator)(c,(function(e){var n,t,a=e.potentialOptionValues;try{for(var i=Object(l.__values)(a),r=i.next();!r.done;r=i.next()){var o=r.value;o&&v(o)&&p(o.feature,o)}}catch(e){n={error:e}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(n)throw n.error}}})),function(e){e[e.Work=1]="Work",e[e.Life=2]="Life"}(f||(f={})),t.d(n,"g",(function(){return o})),t.d(n,"c",(function(){return d})),t.d(n,"h",(function(){return c})),t.d(n,"f",(function(){return s})),t.d(n,"e",(function(){return u})),t.d(n,"d",(function(){return O})),t.d(n,"b",(function(){return f})),t.d(n,"a",(function(){return a}))},1652:function(e,n,t){"use strict";var a=t(77),i=t(1721),r=t(1311),o=t(1323),d=t(1322),c=t(1312),s=t(1325);function l(e,n){return e&&!Object(r.w)()&&n&&"UserMailbox"===n.type&&!Object(o.m)(e)&&e!=Object(d.a)("recoverableitemsdeletions")&&!Object(c.D)(e,s.k)}t.d(n,"e",(function(){return b})),t.d(n,"a",(function(){return i.a})),t.d(n,"b",(function(){return i.b})),t.d(n,"d",(function(){return i.c})),t.d(n,"c",(function(){return l}));var u=new a.c((function(){return t.e(932).then(t.bind(null,16432))})),b=new a.a(u,(function(e){return e.undo}))},1685:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return i}));var a=20,i=10},1721:function(e,n,t){"use strict";var a,i,r=t(0),o=t(3),d=Object(o.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null})(),c=t(1737),s=t(285),l=t(74),u=t(340),b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DismissUndo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dismissUndo"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]};t.d(n,"a",(function(){return v})),t.d(n,"b",(function(){return f})),t.d(n,"c",(function(){return p})),t.d(n,"d",(function(){return O}));var v=Object(s.action)("addActionToUndoStack")(Object(s.select)({store:function(){return d}})((function(e,n,t,r){null!==e&&(a=e,r.store.hasUndoableAction=!0,r.store.undoableActionFolderId=n,i=t)}))),f=Object(s.action)("clearLastUndoableAction")(Object(s.select)({store:function(){return d}})((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,t,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i?[4,i]:[3,4];case 1:return(n=r.sent()).success&&(t=n.undoRequestId)?(o={undoRequestId:t},[4,m.invokeDismissUndoMutation(o)]):[3,3];case 2:r.sent(),r.label=3;case 3:i=null,r.label=4;case 4:return a=null,e.store.hasUndoableAction=!1,e.store.undoableActionFolderId=null,[2]}}))}))}))),m={invokeDismissUndoMutation:function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(u.a)()];case 1:return[4,n.sent().mutate({variables:e,mutation:b})];case 2:return n.sent(),[2]}}))}))}},p=Object(s.select)({store:function(){return d}})((function(e){return e.store.hasUndoableAction})),O=Object(l.d)("undo",{name:"TnS_Undo",customData:function(e){return[e]}})((function(e){d.undoableActionFolderId?c.a.clearMapForFolder(d.undoableActionFolderId):c.a.removeAll();null!==a&&(a(),f())}))},1737:function(e,n,t){"use strict";var a={};t.r(a),t.d(a,"add",(function(){return s})),t.d(a,"remove",(function(){return l})),t.d(a,"removeAll",(function(){return u})),t.d(a,"getCount",(function(){return b})),t.d(a,"getTombstonedReasons",(function(){return v})),t.d(a,"clearMapForFolder",(function(){return f})),t.d(a,"removeRowsFromTombstone",(function(){return m}));var i=t(0),r=t(3),o=Object(r.createStore)("tombstone",{folderTombstoneMap:{}}),d=(o(),t(269)),c=t(285),s=Object(c.action)("tombstoneOperations.add")((function(e,n,t){if(1!=n.tableQuery.type&&"spotlight"!==n.tableQuery.scenarioType){var a=n.serverFolderId,i=o().folderTombstoneMap;a in i||(i[a]={});var r=i[a];e.forEach((function(e){var n=r[e];n?3!=t?n.indexOf(3)>-1||-1==n.indexOf(t)&&n.push(t):r[e]=[3]:r[e]=[t]}))}})),l=Object(c.action)("tombstoneOperations.remove")((function(e,n,t){var a=o().folderTombstoneMap;if(n in a){var i=a[n],r=i[e],d=r?r.indexOf(t):-1;if(-1==d)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");r.splice(d,1),0==r.length&&delete i[e],0==Object.keys(i).length&&delete a[n]}})),u=Object(c.action)("tombstoneOperations.removeAll")((function(){o().folderTombstoneMap={},Object(d.q)("TnS_RemoveAllFromTombstone")})),b=function(e,n){var t=o().folderTombstoneMap;if(!(e in t))return 0;var a=0,i=t[e];return Object.values(i).forEach((function(e){e==n&&a++})),a},v=function(e,n){var t=o().folderTombstoneMap;if(n in t){var a=t[n][e];if(a)return a}return[]},f=Object(c.action)("tombstoneOperations.clearMapForFolder")((function(e){var n=o().folderTombstoneMap;n[e]&&(Object(d.q)("TnS_ClearFolderMapInTombstone",[Object.keys(n[e]).length]),delete n[e])})),m=Object(c.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,n){var t,a,r=o().folderTombstoneMap;if(n in r){var d=r[n];try{for(var c=Object(i.__values)(e),s=c.next();!s.done;s=c.next()){var l=s.value;l in d&&delete d[l]}}catch(e){t={error:e}}finally{try{s&&!s.done&&(a=c.return)&&a.call(c)}finally{if(t)throw t.error}}0==Object.keys(d).length&&delete r[n]}}));n.a=a},1766:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var a=t(0),i=t(1323),r=t(1964),o=t(2065),d=t(3);function c(e){var n,t,d,c;if(i.u.conversations.has(e)){var u=i.u.conversations.get(e);try{for(var b=Object(a.__values)(u.conversationNodeIds),v=b.next();!v.done;v=b.next()){var f=v.value,m=i.u.conversationNodes.get(f);if(m)try{for(var p=(d=void 0,Object(a.__values)(m.itemIds)),O=p.next();!O.done;O=p.next()){var k=O.value;Object(r.a)(k,1)}}catch(e){d={error:e}}finally{try{O&&!O.done&&(c=p.return)&&c.call(p)}finally{if(d)throw d.error}}s(f)}}catch(e){n={error:e}}finally{try{v&&!v.done&&(t=b.return)&&t.call(b)}finally{if(n)throw n.error}}l(e)}Object(o.a)()}var s=Object(d.mutatorAction)("deleteConversationNode",(function(e){i.u.conversationNodes.delete(e)})),l=Object(d.mutatorAction)("deleteConversation",(function(e){i.u.conversations.delete(e)}))},1816:function(e,n,t){"use strict";var a=t(3);n.a=Object(a.action)("MARK_ALL_AS_READ_STORE_UPDATE",(function(e,n,t){return{tableView:e,markAsRead:n,rowIdsToExclude:t}}))},1847:function(e,n,t){"use strict";var a=t(269),i=t(324),r={tenantTokens:Object(a.e)(),isCore:!0};function o(e,n,t){var o=new i.a(e,n,r);t&&o.addCosmosOnlyData(t),a.l.importAndExecute(o)}function d(e){return new a.a(e,r)}var c=t(556);function s(){return{ariaTenantTokens:Object(c.a)(),flightControls:{client_event:{flight:"ana-client-event",rate:5},client_error:{flight:"ana-client-error"},client_verbose:{flight:"ana-client-verbose",rate:1},client_network_request:{flight:"ana-client-network-request",rate:1}},verboseWhiteListEvents:["AttachmentRefreshDownloadToken","TabViewActivateTab"],qosDatapointNames:["AddMemberModalSave","CreateGrouptoAddMembers","EditGroupModalSave","ForwardInSMIME","GroupFilesHubEnsureAuthToken","GroupFilesHubListsLoad","GroupMailComposeSend","InlineImageLoad","loadSuggestedGroupsAction","MailComposeForward","MailComposeNew","MailComposeReply","MailComposeReplyAll","MailComposeSend","MessageOptionsEmptyInvariantViolation","MessageOptionsMultipleDialogsInvariantViolation","NavigateFromMeToWe","OpenItemPeek","PreviewAttachmentInSxSE2E","ReplyAllInSMIME","ReplyInSMIME","SaveCalendarEvent","SearchEndToEnd","SelectGroup","SelectMailItem","showFullCompose","showFullComposeInEditMode","showQuickCompose","showReadingPane","SwitchGroup","SwitchMailFolder","TnS_DeleteConversation","TnS_DeleteItem","UnreadCountNotification","ViewCalendarEvent"],sampledQosDatapointNames:["LoadGroupsInLeftNavFromSessionData"]}}t.d(n,"c",(function(){return o})),t.d(n,"a",(function(){return d})),t.d(n,"b",(function(){return s}))},1854:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(3),i=Object(a.action)("USERMAIL_INTERACTION",(function(e,n,t){return{interactionType:e,instrumentationContexts:n,triageContext:t}}))},1955:function(e,n,t){"use strict";t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return d})),t.d(n,"a",(function(){return c}));var a=t(77),i=t(1854);t.d(n,"d",(function(){return i.a}));var r=new a.c((function(){return t.e(447).then(t.bind(null,3811))})),o=new a.a(r,(function(e){return e.onKeyboardUpDown})),d=new a.a(r,(function(e){return e.onOpenEmail})),c=new a.a(r,(function(e){return e.onKeyboardToggleSelect}))},1964:function(e,n,t){"use strict";var a=t(3);n.a=Object(a.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(function(e,n){return{itemIdToRemove:e,removeItemSource:n}}))},1966:function(e,n,t){"use strict";var a=t(3);n.a=Object(a.action)("MARK_CONVERSATIONS_AS_READ_STORE_UPDATE",(function(e,n,t,a){return{conversationIds:e,tableViewId:n,isReadValue:t,isExplicit:a}}))},1967:function(e,n,t){"use strict";var a=t(3);n.a=Object(a.action)("MARK_ITEMS_AS_READ_STORE_UPDATE",(function(e,n,t,a){return{itemIds:e,isReadValue:n,isExplicit:t,tableViewId:a}}))},2065:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return r}));var a=t(3),i=Object(a.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),r=Object(a.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},2093:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(3),i=Object(a.action)("setShowListPane",(function(e){return{showListPane:e}}))},2094:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(3),i=Object(a.action)("setShowReadingPane",(function(e){return{showReadingPane:e}}))},2356:function(e){e.exports=JSON.parse('{"a":"Iaa","c":"Jaa","e":"Kaa","b":"Laa","d":"Maa"}')},2479:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(3),i=Object(a.action)("onClientReadingPanePositionChange")},2645:function(e){e.exports=JSON.parse('{"a":"Haa"}')},2909:function(e,n,t){"use strict";var a=t(1737);function i(e,n,t){t&&a.a.removeRowsFromTombstone(e,n)}var r=t(3010);function o(e){e&&Object(r.a)(e)}var d=t(1436),c=t(269);function s(e,n,t,a,r,s){var l=Object(c.r)();return e.then((function(e){return l&&l.addCheckpoint("PAPCARM"),i(n,t,r),s?void 0:Object(d.a)(e)})).catch((function(e){return i(n,t,r),o(a),Promise.reject(e)}))}var l=t(0);function u(e,n,t,a,r){return e.then((function(e){if(i(n,t,r),e.ResponseMessages){var d=function(e,n){var t,a;try{for(var i=Object(l.__values)(e),r=i.next();!r.done;r=i.next()){var d=r.value;if(d&&"Success"!=d.ResponseClass){o(n);var c=new Error("ResponseCode="+d.ResponseCode+", Stacktrace="+d.StackTrace);return c.fetchErrorType="ServerFailure",c}}}catch(e){t={error:e}}finally{try{r&&!r.done&&(a=i.return)&&a.call(i)}finally{if(t)throw t.error}}return null}(e.ResponseMessages.Items,a);return d?Promise.reject(d):Promise.resolve()}return Promise.reject(new Error("processUpdateItemActionResponseMessage empty response"))})).catch((function(e){return i(n,t,r),o(a),Promise.reject(e)}))}t.d(n,"c",(function(){return s})),t.d(n,"d",(function(){return u})),t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return o}))},3010:function(e,n,t){"use strict";var a=t(3);n.a=Object(a.action)("RELOAD_TABLE_ON_TRIAGE_ACTION_FAIL",(function(e){return{tableView:e}}))},3011:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(1312),i=t(1325);function r(e){return Object(a.D)(e,i.k)}},3138:function(e){e.exports=JSON.parse('{"a":"qaa","c":"raa","e":"saa","b":"taa","d":"uaa"}')},4338:function(e,n,t){"use strict";t.r(n);var a=t(0),i=t(1311),r={markConversationAsRead:{name:function(e,n,t,a,i,r,o){var d="TnS_MarkConversation";return d+=t?"Read":"Unread",a||(d+="Background"),d},options:function(e,n,t,a,i,r,o){return a?{isCore:!0}:{sessionSampleRate:10}},customData:function(e,n,t,a,r,o,d){return[r,e.length,Object(i.l)(n),Object(i.O)(n)]},cosmosOnlyData:function(e,n,t,r,o,d,c){var s,l,u=[],b=Object(i.E)(e,n);try{for(var v=Object(a.__values)(b),f=v.next();!f.done;f=v.next()){var m=f.value;u.push(i.b.getItemIds(m,n))}}catch(e){s={error:e}}finally{try{f&&!f.done&&(l=v.return)&&l.call(v)}finally{if(s)throw s.error}}return JSON.stringify({itemIds:u,conversationIds:e})}},markItemReadUnread:{name:function(e,n,t,a,i,r){var o="TnS_MarkItem";return o+=t?"Read":"Unread",a||(o+="Background"),o},options:function(e,n,t,a,i,r){return a?{isCore:!0}:{}},customData:function(e,n,t,a,r,o){var d=e?e.tableQuery.type:null,c=e?Object(i.l)(e):null,s=e?Object(i.O)(e):null;return[d,n.length,c,s]},cosmosOnlyData:function(e,n,t,a,i,r){return JSON.stringify({itemIds:n})},actionSource:function(e,n,t,a,i){return i}}},o=t(285),d=t(3),c=Object(d.createStore)("markread",{markAsReadTimerTask:null,suppressedItemIdsMap:{}})(),s=Object(o.action)("AddMarkReadSuppressedItemIds")(Object(o.select)({store:function(){return c}})((function(e,n){e.forEach((function(e){return n.store.suppressedItemIdsMap[e]=!0}))}))),l=Object(o.action)("RemoveMarkReadSuppressedItemIds")(Object(o.select)({store:function(){return c}})((function(e,n){e.forEach((function(e){return delete n.store.suppressedItemIdsMap[e]}))}))),u=Object(o.action)("ClearMarkReadSuppressedMap")(Object(o.select)({store:function(){return c}})((function(e){e.store.suppressedItemIdsMap={}})));function b(e){for(var n=0;n<e.length;n++)if(!c.suppressedItemIdsMap[e[n]])return!1;return!0}var v=t(6174),f=t(1955),m=t(1966),p=t(5235),O=t(1493),k=t(59),j=t(74),I=t(2909);var A=t(1319);var y=t(1967),S=t(340),N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkItemAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipts"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markItemAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"ObjectField",name:{kind:"Name",value:"isRead"},value:{kind:"Variable",name:{kind:"Name",value:"isRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"suppressReadReceipts"},value:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipts"}}},{kind:"ObjectField",name:{kind:"Name",value:"isUserInitiated"},value:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},g=t(30),R=Object(j.d)("markItemsAsReadBasedOnItemIds",r.markItemReadUnread)((function(e,n,t,r,o,d){return Object(a.__awaiter)(this,void 0,void 0,(function(){var c,u,b,m,p;return Object(a.__generator)(this,(function(a){return 0==(c=function(e,n){var t=[];return e.forEach((function(e){var a=A.a.items.get(e);Object(i.V)(a)&&a.IsRead!=n&&t.push(e)})),t}(n,t)).length?[2,Promise.resolve()]:(t?l(c):r?s(c):k.g.warn("Invalid scenario to implicitly mark item as unread."),u=e?e.id:null,Object(y.a)(c,t,r,u),v.a.import().then((function(n){n(e?e.tableQuery:null,!1,t,o,c)})),b={itemIds:c},t?r?Object(f.d)("MarkAsRead",d,b):Object(f.d)("MarkAsReadImplicit",d,b):Object(f.d)("MarkAsUnread",d,b),m=Object(O.e)(e.tableQuery).mailboxInfo,p=e?Object(i.E)(c,e):[],[2,h(e,p,c,t,r,m)])}))}))}));function h(e,n,t,i,r,o){return Object(a.__awaiter)(this,void 0,void 0,(function(){var d,c,s,l;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:d=Object(g.a)(),c="AlwaysSend"!=d.UserOptions.ReadReceipt,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,T.invokeMarkItemAsReadMutation(t,i,c,r,o)];case 2:return a.sent(),[2];case 3:return s=a.sent(),l=e?e.serverFolderId:null,Object(I.a)(n,l,!0),[2,Promise.reject(s)];case 4:return[2]}}))}))}var T={invokeMarkItemAsReadMutation:function(e,n,t,i,r){var o;return Object(a.__awaiter)(this,void 0,void 0,(function(){var d;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(S.a)()];case 1:return[4,a.sent().mutate({variables:{ids:e,isRead:n,suppressReadReceipts:t,isUserInitiated:i,mailboxInfo:r},mutation:N})];case 2:return d=a.sent(),[2,null===(o=null==d?void 0:d.data)||void 0===o?void 0:o.markItemAsRead]}}))}))}},w={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkConversationAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markConversationAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"isRead"},value:{kind:"Variable",name:{kind:"Name",value:"isRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"isUserInitiated"},value:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},M=t(4568),C=Object(j.d)("markConversationsAsReadBasedOnConversationIds",r.markConversationAsRead)((function(e,n,t,r,o,d,c){var l=function(e,n,t){var a=[];return e.forEach((function(e){var r=Object(i.K)(e,n);if(r){var o=0==r.unreadCount,d=r.itemIds.length,c=r.unreadCount==d;o&&t||c&&!t||a.push(e)}})),a}(c,n.id,t);if(0==l.length)return Promise.resolve();if(1==e.length&&1==n.selectedRowKeys.size){var b=i.b.getRowIdString(l[0],n),j=Object(i.K)(Object(a.__spread)(n.selectedRowKeys.keys())[0],n.id);if(b==j.id){var A=j.itemIds;t?u():r?s(A):k.g.warn("Invalid scenario to implicitly mark conversation as unread.")}}Object(m.a)(e,n.id,t,r),v.a.import().then((function(a){a(n.tableQuery,!1,t,o,e)}));var y={conversationIds:e};t?r?Object(f.d)("MarkAsRead",d,y):Object(f.d)("MarkAsReadImplicit",d,y):Object(f.d)("MarkAsUnread",d,y);var S=Object(O.e)(n.tableQuery).mailboxInfo;return Object(i.e)(n)?function(e,n,t,r,o){var d=[];return n.forEach((function(n){d.push.apply(d,Object(a.__spread)(i.b.getItemIds(n,e)))})),h(e,n,d,t,r,o)}(n,l,t,r,S):function(e,n,t,a,r){var o=Object(p.a)(e),d=n.map((function(n){return Object(i.h)(n,e.id)})),c=E.invokeMarkConversationAsReadMutation(d,t,a,o,r),s=Object(i.ab)(e,t,a);return Object(I.c)(c,n,o,e,s,!0)}(n,l,t,r,S)}));var E={invokeMarkConversationAsReadMutation:function(e,n,t,i,r){var o;return Object(a.__awaiter)(this,void 0,void 0,(function(){var d,c;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return d=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(M.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(S.a)()];case 1:return[4,a.sent().mutate({variables:{conversations:d,isRead:n,isUserInitiated:t,folderId:i,mailboxInfo:r},mutation:w})];case 2:return c=a.sent(),[2,null===(o=null==c?void 0:c.data)||void 0===o?void 0:o.markConversationAsRead]}}))}))}},V=t(2199),_=Object(o.action)("autoMarkConversationAsRead")(Object(o.select)({items:function(){return A.a.items}})((function(e,n,t){var a=Object(i.E)([e],n),r=Object(V.a)(a[0],n.id);if(r&&Object(i.f)(n)){var o=r.itemIds;b(o)||(0==Object.keys(c.suppressedItemIdsMap).length?C([e],n,!0,!1,null,[],a):o.forEach((function(e){!b([e])&&t.items.get(e)&&R(n,[e],!0,!1,null,[])})),u())}}))),D=t(8241),x=t(7269);var P=t(2126),F=Object(o.action)("autoMarkItemAsRead")((function(e,n,t){Object(i.f)(n)&&(b([e])||(R(n,[e],!0,!1,null,[]),Object(P.a)()&&function(e,n,t){if(n){var r=t||Object(a.__spread)(e.selectedRowKeys.keys())[0],o=i.b.getRowClientItemId(r,e),d=null==o?void 0:o.Id;d&&(Object(D.c)(d)?R(e,Object(D.a)(d,n),!0,!1,null,[]):Object(x.b)(o,"CreateConversationRelationMap").then((function(){R(e,Object(D.a)(d,n),!0,!1,null,[])})))}}(n,e,t),u()))}));function U(e,n){var t;if("OnSelectionChange"===Object(g.a)().UserOptions.PreviewMarkAsRead){var a=i.b.getRowIdString(e,n);switch(n.tableQuery.listViewType){case 0:if(Object(P.a)()){var r=null===(t=i.b.getRowIdToShowInReadingPane(e,n))||void 0===t?void 0:t.Id;F(r,n,e)}else _(a,n);break;case 1:F(a,n)}}}var L=t(1534),G=Object(o.action)("onReadingPaneClosed")((function(e,n){Object(L.q)()||k.d("onReadingPaneClosed should only be called in single line view."),U(e,n)})),B=Object(o.action)("onSingleSelectionChanged")((function(e,n,t){Object(L.q)()||t&&U(e,n)}));function K(e,n,t){0==e.length||Object(L.q)()||1!==e.length||"Unread"===Object(i.O)(t)||U(e[0],n)}var Q=Object(d.action)("MARK_ITEMS_READ_BASED_ON_NODE_IDS",(function(e,n,t,a,i){return{nodeIds:e,tableViewId:n,isReadValueToSet:t,isExplicit:a,actionSource:i}})),q=Object(o.action)("markItemAsReadFromReadingPane")((function(e,n,t,a,r){var o=[],d=null;if(n){if(Object(i.P)(n)){var c=A.a.items.get(e).ConversationId.Id;o=Object(i.E)([c],n)}else o=Object(i.E)([e],n);d=Object(i.k)(n)}R(n,[e],t,!0,r,a).then((function(){n&&Object(I.a)(o,d)})).catch((function(e){n&&(Object(I.a)(o,d),Object(I.b)(n))}))})),W=t(2058),H=Object(o.action)("markConversationsAsReadFromTable")((function(e,n,t,a){var r=Object(i.C)(e,n.id),o=Object(W.a)(e,n);return C(r,n,t,!0,a,o,e)})),J=Object(o.action)("markItemsReadFromTable")((function(e,n,t,a,r){var o=Object(i.C)(e,n.id),d=Object(W.a)(e,n),c=R(n,o,t,a,r,d),s=Object(i.k)(n),l=Object(i.ab)(n,t,a);c.then((function(n){Object(I.a)(e,s,l)})).catch((function(t){Object(I.a)(e,s,l),Object(I.b)(n)}))})),z=t(2065),X=Object(o.action)("toggleRowReadState")((function(e,n,t){var a=i.X.tableViews.get(n),r=i.b.getUnreadCount(e,a)>0;switch(a.tableQuery.listViewType){case 0:H([e],a,r,t);break;case 1:J([e],a,r,!0,t)}Object(z.b)()})),Z=Object(o.action)("onNavigateAwayViaUpDown")((function(e,n){U(e,n)})),$=Object(d.action)("onKeyboardMarkAsRead",(function(e,n,t,a,i,r){return{tableView:e,selectedNodeIds:n,isInVirtualSelectAllMode:t,rowKeysToActOn:a,exclusionList:i,isReadValueToSet:r}})),Y=t(3138),ee=t(2356),ne=t(2645),te=t(11945),ae=t(12),ie=t(6155),re=t(11946),oe=t(11947);var de=t(269),ce=t(668),se=t(1328),le=t(9),ue=t(83),be=t(1312),ve=t(1937),fe=t(1816),me=t(3957),pe=t(3011),Oe=t(1652),ke={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkAllAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"markAsRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clientLastSyncTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemIdsToExclude"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipt"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markAllAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"ObjectField",name:{kind:"Name",value:"markAsRead"},value:{kind:"Variable",name:{kind:"Name",value:"markAsRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"clientLastSyncTime"},value:{kind:"Variable",name:{kind:"Name",value:"clientLastSyncTime"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemIdsToExclude"},value:{kind:"Variable",name:{kind:"Name",value:"itemIdsToExclude"}}},{kind:"ObjectField",name:{kind:"Name",value:"suppressReadReceipt"},value:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipt"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"FolderId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"},arguments:[],directives:[]}]}}]}}]}}]}}]},je=Object(o.action)("markAsReadInTable")((function(e,n,t,r,o,d,c){var s=this;if(o.length&&t)throw new Error("If in virtual select all mode, rowKeysToActOn should be empty.");if(n.length&&!t)throw new Error("If not in virtual select all mode, exclusionList should be empty.");var l=d.tableQuery.folderId,u=be.d.folderTable.get(l),b=d.isInVirtualSelectAllMode&&n.length>0,f=Object(i.O)(d),m="ContextFolder"===e||"CommandBar"===e&&t&&!d.isInCheckedMode&&!Object(i.S)(d,f),p=o.length>0&&!t,j=t&&u&&u.UnreadCount>=ie.b,I=function(e,n,t,a,r,o,d,c){if(e){if(Object(ue.i)("tri-categoryUnreadCount")){var s=Object(i.N)(o);if(s)return Object(ce.n)(s)}return null==t?void 0:t.UnreadCount}if(Object(i.u)(o)||n||Object(i.S)(o,d)&&c)return o.totalRowsInView-a;return r}(m,b,u,n.length,o.length,d,f,t),A=j||I>=ie.b,y={headerText:"",bodyText:""};if(A){var S=Object(i.o)(d.tableQuery.type,d,u&&Object(be.j)(u));y=function(e,n,t,a,i,r,o,d){var c,s="",l="",u=1===n,b=e||u;return t<0&&(k.g.warn("totalCount in getMarkAsReadUnreadAllConfirmText should not be negative."),s=b?i?Object(ae.b)(Y.e):Object(ae.b)(ee.e):i?Object(ae.b)(Y.c):Object(ae.b)(ee.c)),1==t&&(s=i?Object(ae.b)(ne.a):Object(ae.b)(ee.a)),c=t<ie.a?t:"10000+",s=b?i?Object(ae.c)(Object(ae.b)(Y.d),c):Object(ae.c)(Object(ae.b)(ee.d),c):i?Object(ae.c)(Object(ae.b)(Y.b),c):Object(ae.c)(Object(ae.b)(ee.b),c),l=e?i?Object(ae.c)(Object(ae.b)(re.b),a):Object(ae.c)(Object(ae.b)(oe.b),a):r||o?u?i?Object(ae.c)(Object(ae.b)(re.d),a):Object(ae.c)(Object(ae.b)(oe.d),a):i?Object(ae.c)(Object(ae.b)(re.c),a):Object(ae.c)(Object(ae.b)(oe.c),a):u?i?Object(ae.c)(Object(ae.b)(re.b),a):Object(ae.c)(Object(ae.b)(oe.b),a):i?Object(ae.c)(Object(ae.b)(re.a),a):Object(ae.c)(Object(ae.b)(oe.a),a),d&&(l=u?i?Object(ae.b)(te.b):Object(ae.b)(te.d):i?Object(ae.b)(te.a):Object(ae.b)(te.c)),{headerText:s,bodyText:l}}(m,d.tableQuery.listViewType,I,S,r,b,p,2===d.tableQuery.type)}Object(se.b)(y.headerText,y.bodyText,!A,{delayCallbackAfterAnimation:!0,okText:Object(ae.b)(ve.a)}).then((function(c){return Object(a.__awaiter)(s,void 0,void 0,(function(){var s,u,b,f,m,p,k,j,I;return Object(a.__generator)(this,(function(a){if(c===se.a.ok)if(Oe.b(),t){switch(s=Object(g.a)().UserOptions.ReadReceipt,u="DoNotAutomaticallySend"==s||"NeverSend"==s||Object(pe.a)(l),b=Object(i.T)(l)?i.X.inboxPausedDateTime:null,function(e,n,t){var a="TnS_MarkAllAs";a+=n?"Read":"Unread",Object(de.p)(a,[e,Object(i.l)(t),t.isInCheckedMode])}(e,r,d),v.a.import().then((function(n){n(d.tableQuery,!0,r,e)})),f=[],d.tableQuery.listViewType){case 0:f=Object(me.a)(n,d.id);break;case 1:f=Object(i.C)(n,d.id)}Object(fe.a)(d,r,f),m=Object(i.j)(d),(p=null===(j=m)||void 0===j?void 0:j.Id)||(p=null===(I=m)||void 0===I?void 0:I.Id),k={id:p,markAsRead:r,clientLastSyncTime:b&&Object(le.tb)(b),itemIdsToExclude:f,suppressReadReceipt:u,mailboxInfo:Object(O.b)(d)},Ie.invokeMarkAllAsReadMutation(k)}else switch(d.tableQuery.listViewType){case 0:H(o,d,r,e);break;case 1:J(o,d,r,!0,e)}return[2]}))}))}))})),Ie={invokeMarkAllAsReadMutation:function(e){var n;return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(S.a)()];case 1:return[4,a.sent().mutate({variables:e,mutation:ke})];case 2:return t=a.sent(),[2,null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.markAllAsRead]}}))}))}};var Ae=t(1800),ye=Object(o.action)("setAutoMarkAsReadTimer")(Object(o.select)({store:function(){return c}})((function(e,n,t){var a=Object(g.a)().UserOptions;if("Delayed"==a.PreviewMarkAsRead){var r=Object(Ae.a)();if(!r||!Object(i.f)(r))return;t.store.markAsReadTimerTask=setTimeout((function(){Ne(e,r,n)}),1e3*a.MarkAsReadDelaytime)}}))),Se=Object(o.action)("clearAutoMarkAsReadTimer")(Object(o.select)({store:function(){return c}})((function(e){e.store.markAsReadTimerTask&&(clearTimeout(e.store.markAsReadTimerTask),e.store.markAsReadTimerTask=null)}))),Ne=Object(o.action)("setMarkAsReadTimer:timeout")((function(e,n,t){Se(),t?F(e,n):1===n.tableQuery.listViewType||Object(P.a)()?F(e,n):_(e,n)})),ge=t(2159),Re=t(77),he=Object(Re.e)(ge.b,"CLONE_ON_ITEM_PART_DESELECTED",(function(e){var n=e.itemId,t=e.tableView;t&&"OnSelectionChange"==Object(g.a)().UserOptions.PreviewMarkAsRead&&F(n,t)})),Te=t(6161),we=t(2478),Me=(Object(d.orchestrator)(Q,(function(e){var n=i.X.tableViews.get(e.tableViewId),t=Object(a.__spread)(n.selectedRowKeys.keys()),r=Object(Te.a)(e.nodeIds,Object(we.a)(t[0]));R(n,r,e.isReadValueToSet,e.isExplicit,e.actionSource,null)})),t(1510)),Ce=t(5230);Object(d.orchestrator)(Me.p,(function(e){var n=e.tableViewId,t=e.currentSelectedNodeIds,a=e.rowKey;if("OnSelectionChange"==Object(g.a)().UserOptions.PreviewMarkAsRead&&Object(P.a)()&&1===(null==t?void 0:t.length)){var r=i.X.tableViews.get(n);F(Object(Ce.a)(t[0],Object(we.a)(a)),r)}}));Object(d.orchestrator)($,(function(e){var n=e.tableView,t=e.selectedNodeIds,a=e.isInVirtualSelectAllMode,i=e.rowKeysToActOn,r=e.exclusionList,o=e.isReadValueToSet;t.length>0?Q(t,n.id,o,!0,"Keyboard"):je("Keyboard",r,a,o,i,n)}));t.d(n,"onReadingPaneClosed",(function(){return G})),t.d(n,"onSingleSelectionChanged",(function(){return B})),t.d(n,"markReadOnTableViewChange",(function(){return K})),t.d(n,"markItemsAsReadBasedOnNodeIds",(function(){return Q})),t.d(n,"markItemAsReadFromReadingPane",(function(){return q})),t.d(n,"toggleRowReadState",(function(){return X})),t.d(n,"onNavigateAwayViaUpDown",(function(){return Z})),t.d(n,"onKeyboardMarkAsRead",(function(){return $})),t.d(n,"markAsReadInTable",(function(){return je})),t.d(n,"clearAutoMarkAsReadTimer",(function(){return Se})),t.d(n,"setAutoMarkAsReadTimer",(function(){return ye})),t.d(n,"onItemPartDeselectedOrchestrator",(function(){return he}))},4568:function(e,n,t){"use strict";function a(e){return e?new Date(e).toISOString():null}t.d(n,"a",(function(){return a}))},6155:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return i}));var a=1e4,i=25},6174:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return d}));var a=t(77),i=new a.c((function(){return t.e(421).then(t.bind(null,10291))})),r=new a.b(i,(function(e){return e.addMarkAsReadDiagnostics})),o=new a.b(i,(function(e){return e.addUnreadCountNotificationDiagnostics})),d=new a.b(i,(function(e){return e.addUnreadCountSubscriptionDiagnostics}))},745:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o}));var a=t(20),i=t(1);function r(e){return{get:e}}function o(e,n){return Object(i.useMemo)((function(){return Object(a.computed)(e)}),n).get()}},8241:function(e,n,t){"use strict";t.d(n,"c",(function(){return o})),t.d(n,"b",(function(){return d})),t.d(n,"a",(function(){return c}));var a=t(0),i=t(1319);function r(e){var n,t=null==e?void 0:e.conversationNodeIds,r=null==t?void 0:t.length;if(!t||!r||0==r)return null;var o=Object(a.__spread)(t);"ChronologicalNewestOnBottom"===e.conversationSortOrder||o.reverse();var d=i.a.conversationNodes.get(o[0]),c=new Map;c.set(null===(n=d.itemIds)||void 0===n?void 0:n[0],{internetMessageId:d.internetMessageId,parentItemId:null,childrenItemIds:[]});for(var l=1;l<r;){s(c,i.a.conversationNodes.get(o[l])),l+=1}return c}function o(e){var n,t=null===(n=i.a.conversations)||void 0===n?void 0:n.get(e);if(!t)return!1;var a=t.conversationNodeIds,r=null==a?void 0:a.length;return!(!a||!r||0==r)}function d(e,n){var t,a=null===(t=i.a.conversations)||void 0===t?void 0:t.get(e);if(a){var o=r(a),d=[];return o.forEach((function(e,t){if(0===e.childrenItemIds.length)for(var a=t,i=e;a;){if(n.includes(a)&&i.childrenItemIds.length<2){d.push(a);break}var r=i.parentItemId;r?(i=o.get(r),a=r):a=null}})),"ChronologicalNewestOnBottom"===a.conversationSortOrder?d:d.reverse()}return[]}function c(e,n){var t,a=[n],o=null===(t=i.a.conversations)||void 0===t?void 0:t.get(e);if(o){var d=r(o);if(!d)return a;for(var c=n;c;){a.push(c);var s=d.get(c);c=null==s?void 0:s.parentItemId}}return a}function s(e,n){var t,i,r,o,d=null===(r=n.itemIds)||void 0===r?void 0:r[0];if(!d)return null;try{for(var c=Object(a.__values)(e),s=c.next();!s.done;s=c.next()){var l=Object(a.__read)(s.value,2),u=l[0],b=l[1];if(b.internetMessageId===n.parentInternetMessageId){b.childrenItemIds.push(d),o=u;break}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=c.return)&&i.call(c)}finally{if(t)throw t.error}}e.set(d,{internetMessageId:n.internetMessageId,parentItemId:o,childrenItemIds:[]})}}}]);
//# sourceMappingURL=owa.MailBoot~MarkRead.js.map
self.scriptsLoaded['owa.MailBoot~MarkRead.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MarkRead.js'] = (new Date()).getTime();