self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailFavoritesStore~MailFolderTreesParent~PublicFolderPickerModule.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[170],{1319:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r=n(20),i=n(3),o={conversationNodes:new r.ObservableMap({}),conversations:new r.ObservableMap({}),items:new r.ObservableMap({}),searchFolderDisplayName:null,typeOfItemBeingDragged:null,triageAnnouncement:{message:null,politenessSetting:"off"}},u=Object(i.createStore)("mail",o),c=u();t.a=c},1323:function(e,t,n){"use strict";var r=n(77),i=n(1319),o=n(1623),u=n(1498),c=n(1444),a="ChronologicalNewestOnBottom";function s(e,t){return e[t==a?0:e.length-1]}var d=n(622),l=n(1332);function f(e){return Object(c.a)(e,Object(d.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(l.a)({FieldURI:"TailoredXpEntities"}),Object(l.a)({FieldURI:"TailoredXpCalendarEventIds"}),Object(l.a)({FieldURI:"TailoredXpEntitiesStatus"}),Object(l.a)({FieldURI:"EntityNamesMap"})]}),"ItemTailoredXpData","Exchange2013").then((function(e){if(e&&!(e instanceof Error)){var t=e;return{TailoredXpEntities:t.TailoredXpEntities,TailoredXpCalendarEventIds:t.TailoredXpCalendarEventIds,TailoredXpEntitiesStatus:t.TailoredXpEntitiesStatus,EntityNamesMap:t.EntityNamesMap}}return{}}))}function b(e){return i.a.items.get(e)}var m=n(30);function O(e){var t=i.a.conversations.get(e);if(t){var n=Object(m.a)().UserOptions.ConversationSortOrderReact;return t.conversationNodeIds.length>0&&!t.loadingState.hasLoadFailed&&t.conversationSortOrder==n}return!1}var v=n(1522),h=n(1312),I=n(285),p=Object(I.select)({folderTable:function(){return h.d.folderTable}})((function(e,t){return!!t.folderTable.get(e)})),E=n(1325);function y(e,t){var n=h.d.folderTable.get(e);return!!n&&(Object(h.I)(n,E.d,t)||n.DistinguishedFolderId===E.b)}function S(e){return y(e)||function(e){var t=h.d.folderTable.get(e);return t&&t.DistinguishedFolderId===E.d}(e)}var g=Object(I.select)({folderTable:function(){return h.d.folderTable}})((function(e,t,n){return Object(h.I)(e,t,n)})),_=n(1647),w=n(1530);function j(e){return e&&(Object(w.a)(e,E.h)||Object(w.a)(e,E.b))}function T(e){return e&&(g(e,E.g)||g(e,E.a))}var R=n(1571);function L(e,t){try{return C(e,t)}catch(e){return null}}function C(e,t){if(!e||!t)return null;var n=Object(h.o)().get(e).PermissionSet.Permissions.filter((function(e){return e.UserId.PrimarySmtpAddress===t}));return null==n?void 0:n[0]}var A=n(320),M="OneOff",N="Unknown";function P(e,t,n){return!Object(A.a)()&&(n==M||n==N)&&(null==e?void 0:e.indexOf(t))<0}var x=n(3),K=Object(x.mutatorAction)("setIsDraftQueuedForSubmission",(function(e,t){var n=Object(i.b)().items.get(null==e?void 0:e.Id);n&&(n.isDraftQueuedForSubmission=t)}));n.d(t,"s",(function(){return V})),n.d(t,"u",(function(){return i.a})),n.d(t,"g",(function(){return i.b})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return u.a})),n.d(t,"e",(function(){return c.a})),n.d(t,"d",(function(){return s})),n.d(t,"t",(function(){return f})),n.d(t,"v",(function(){return b})),n.d(t,"q",(function(){return O})),n.d(t,"c",(function(){return v.a})),n.d(t,"r",(function(){return p})),n.d(t,"m",(function(){return y})),n.d(t,"l",(function(){return S})),n.d(t,"n",(function(){return g})),n.d(t,"j",(function(){return _.a})),n.d(t,"k",(function(){return j})),n.d(t,"p",(function(){return T})),n.d(t,"f",(function(){return R.a})),n.d(t,"h",(function(){return L})),n.d(t,"i",(function(){return C})),n.d(t,"o",(function(){return P})),n.d(t,"w",(function(){return K}));var D=new r.c((function(){return n.e(1139).then(n.bind(null,16994))})),V=new r.a(D,(function(e){return e.setTriageActionAnnouncement}))},1392:function(e,t,n){"use strict";var r=n(3),i=Object(r.createStore)("folderForestStore",{selectedNode:{id:null,treeType:"primaryFolderTree",type:0}}),o=i();function u(){return o.selectedNode}function c(){var e=u();switch(e.type){case 1:return e.searchFolderId;case 5:return e.data.searchFolderId;case 3:return null;default:return e.id}}n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o}))},1431:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return d}));var r=n(1814),i=n(30),o=n(1494);function u(){return s(r.a.Bottom)}function c(){return s(r.a.Off)}function a(){return s(r.a.Right)}function s(e){var t=Object(o.a)();return null!==t.clientReadingPanePosition?t.clientReadingPanePosition===e:Object(i.a)().UserOptions.GlobalReadingPanePositionReact==e}function d(){var e=Object(i.a)().UserOptions.GlobalReadingPanePositionReact;return e==r.a.Off||e==r.a.Bottom}},1436:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(1440);function o(e){var t,n;if(!e)return Promise.reject(u("500","Server returned a null response!",null));var o=Array.isArray(e)?e:[e];try{for(var c=Object(r.__values)(o),a=c.next();!a.done;a=c.next()){var s=a.value;if(s&&!Object(i.a)(s))return Promise.reject(u(s.ResponseCode,s.StackTrace,s.MessageText))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return Promise.resolve()}function u(e,t,n){var r="ResponseCode="+e;t&&(r+=", Stacktrace="+t);var i=new Error(r);return i.responseCode=e,i.fetchErrorType="ServerFailure",n&&(i.diagnosticInfo="MessageText= "+n),i}},1440:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r="Success";function i(e){return e&&e.ResponseClass==r}},1444:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(1825),o=n(83),u=new(n(10).d)((function(){return n.e(789).then(n.bind(null,2709))}));function c(e,t,n,c,a,s,d,l){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(o.i)("mon-rp-loadItemViaGql")?[4,u.import().then((function(r){return r.getItemViaGraphQL(e,t,n,c,a,s,d,l)}))]:[3,2];case 1:return[2,r.sent()];case 2:return[4,Object(i.a)(e,t,n,c,s,d,l)];case 3:return[2,r.sent()]}}))}))}},1494:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.createStore)("maillayout",{clientReadingPanePosition:null,showReadingPane:!1,showListPane:!0,showFolderPane:!0})},1498:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.CommandBarArrows=1]="CommandBarArrows",e[e.KeyboardUpDown=2]="KeyboardUpDown",e[e.KeyboardEnter=3]="KeyboardEnter",e[e.KeyboardShiftEnter=4]="KeyboardShiftEnter",e[e.KeyboardCtrlSpace=5]="KeyboardCtrlSpace",e[e.MailListItemBody=6]="MailListItemBody",e[e.MailListItemBodyDoubleClick=7]="MailListItemBodyDoubleClick",e[e.MailListItemCheckbox=8]="MailListItemCheckbox",e[e.MailListItemContextMenu=9]="MailListItemContextMenu",e[e.MailListItemExpansion=10]="MailListItemExpansion",e[e.MailListItemRichPreview=11]="MailListItemRichPreview",e[e.MailListItemTwisty=12]="MailListItemTwisty",e[e.NewConversation=13]="NewConversation",e[e.Reset=14]="Reset",e[e.RowRemoval=15]="RowRemoval",e[e.ImmersiveReadingPaneDelete=16]="ImmersiveReadingPaneDelete",e[e.RouteHandler=17]="RouteHandler",e[e.ToggleCheckAll=18]="ToggleCheckAll",e[e.MessageAd=19]="MessageAd",e[e.SearchSuggestionClick=20]="SearchSuggestionClick",e[e.SingleLineClearSelection=21]="SingleLineClearSelection",e[e.KeyboardHome=22]="KeyboardHome",e[e.KeyboardEnd=23]="KeyboardEnd"}(r||(r={})),t.a=r},1510:function(e,t,n){"use strict";n.d(t,"q",(function(){return d})),n.d(t,"t",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"i",(function(){return m})),n.d(t,"o",(function(){return O})),n.d(t,"b",(function(){return v})),n.d(t,"m",(function(){return h})),n.d(t,"f",(function(){return I})),n.d(t,"p",(function(){return p})),n.d(t,"s",(function(){return E})),n.d(t,"r",(function(){return y})),n.d(t,"g",(function(){return S})),n.d(t,"j",(function(){return g})),n.d(t,"k",(function(){return _})),n.d(t,"n",(function(){return w})),n.d(t,"d",(function(){return j})),n.d(t,"c",(function(){return T})),n.d(t,"h",(function(){return R})),n.d(t,"l",(function(){return L}));var r=n(0),i=n(74),o=n(1311),u=n(1323),c=n(3),a=n(1431),s=n(30),d=Object(c.action)("SINGLE_SELECT_ROW",(function(e,t,n,r){return Object(i.c)(C(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),l=Object(c.action)("TOGGLE_SELECT_ROW",(function(e,t,n,r){return Object(i.c)(C(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),f=Object(c.action)("ON_AFTER_SELECTION_CHANGED",(function(e,t,n,r,i){return{rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:r,sxsId:i}})),b=Object(c.action)("EXPAND_ROW_FIRST_LEVEL",(function(e,t){return{rowKey:e,latestItemIdsInForks:t}})),m=Object(c.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),O=Object(c.action)("SET_SECOND_LEVEL_LIST_VIEW_EXPANSION",(function(e){return{rowKey:e}})),v=Object(c.action)("ITEM_PART_SELECTED",(function(e,t,n,r,i){return{nodeId:e,itemId:t,allNodeIds:n,tableView:r,mailListItemSelectionSource:i}})),h=Object(c.action)("SELECT_NEXT_ITEM_PART",(function(e,t){return{rowKey:e,tableView:t}})),I=Object(c.action)("ON_ITEM_PART_CONTEXT_MENU",(function(e,t,n){return{contextMenuAnchor:e,nodeId:t,tableViewId:n}})),p=Object(c.action)("SINGLE_SELECT_ITEM_PART",(function(e,t,n,r,i){return{rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:r,currentSelectedNodeIds:i}})),E=Object(c.action)("TOGGLE_SELECT_ITEM_PART",(function(e){return{nodeId:e}})),y=Object(c.action)("TOGGLE_SELECT_ALL_ROWS",(function(e){return{tableView:e}})),S=Object(c.action)("RANGE_SELECT_ROW",(function(e,t,n,r){return{tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:r}})),g=Object(c.action)("RESET_SELECTION",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}})),_=Object(c.action)("RESET_SELECTION",(function(e){return{tableView:e}})),w=Object(c.action)("SELECT_ROW_IN_DIRECTION",(function(e,t,n){return Object(i.c)(C(n,e,void 0,t),{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})})),j=Object(c.action)("KEYBOARD_MULTI_SELECT_ROW",(function(e,t,n,r){return{tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:r}})),T=Object(c.action)("KEYBOARD_COLLAPSE_CONVERSATION",(function(e){return{rowKey:e}})),R=Object(c.action)("RESET_BUS_STOP_STATE_MAP"),L=Object(c.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(function(e,t,n){return{tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}}));function C(e,t,n,i){return{name:function(e,t,n,i){return!(function(e){return e===u.b.MailListItemRichPreview||e===u.b.KeyboardShiftEnter||e===u.b.MailListItemBodyDoubleClick}(e)||Object(a.c)()&&!function(e){var t;return e===u.b.KeyboardEnter||e===u.b.MailListItemBody||e===u.b.RouteHandler||e===u.b.CommandBarArrows||e===u.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(s.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,i){if(Object(a.c)())return!1;if(e===u.b.KeyboardUpDown){var c=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==c&&1===t.selectedRowKeys.size){var s=t.rowKeys.indexOf(Object(r.__spread)(t.selectedRowKeys.keys())[0]);return i===o.d.Next?s===c+1||s===t.rowKeys.length-1&&c===t.rowKeys.length-1:s===c-1||0===s&&0===c}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,i))}(e,t,n,i)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},1522:function(e,t,n){"use strict";var r=new(n(761).a)(50);t.a=r},1530:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(50);function i(e,t){if(!e||!t)throw new Error("Input parameters to doesFolderIdEqualName must not be null.");return r.a.defaultFolderNameToIdMap.get(t)==e}},1571:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1312),i=n(1392);function o(){var e=Object(i.c)(),t=null;return null==(t=1===e.type?e.searchFolderId:5===e.type?e.data.searchFolderId:e.id)?null:r.d.folderTable.get(t)}},1623:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete"}(r||(r={}))},1647:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1530),i=n(1325);function o(e){return e&&(Object(r.a)(e,i.g)||Object(r.a)(e,i.a))}},1676:function(e,t,n){"use strict";function r(e,t){var n=Math.pow(2,32);if(e>=n||t>=n){var r=e%n,i=t%n;return(((e-=r)/n&(t-=i)/n)>>>0)*n+((r&i)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},1814:function(e,t,n){"use strict";var r;!function(e){e[e.Off=0]="Off",e[e.Right=1]="Right",e[e.Bottom=2]="Bottom"}(r||(r={})),t.a=r},1815:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r=1,i=16},1825:function(e,t,n){"use strict";var r=n(766),i=n(723),o=n(0);var u=n(767),c=n(319),a=n(59),s=n(1436);function d(e,t,n,d,l,f,b){var m,O=Object(c.b)();if(d&&(O.RequestServerVersion=d),f){var v=(m={UserRoles:["MailboxSearch"]},Object(o.__assign)({__type:"ManagementRoleType:#Exchange"},m));O.ManagementRole=v}return Object(u.a)({Header:O,Body:Object(r.a)({ItemShape:t,ItemIds:Array.isArray(e)?e.map((function(e){return Object(i.a)({Id:e})})):e?[Object(i.a)({Id:e})]:[],ShapeName:null!=n?n:void 0,InternetMessageId:b})},l).then((function(e){var t,n,r;return null===(r=null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items)||void 0===r?void 0:r[0]})).then((function(e){return Object(s.a)(e).then((function(){return e}))})).then((function(t){return(null==t?void 0:t.Items.length)?Array.isArray(e)||void 0!==b?t.Items:t.Items[0]:null})).catch((function(e){return a.g.warn("GetItem:"+e.message),e}))}n.d(t,"a",(function(){return d}))},2158:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));var r=350,i=270,o=418},3275:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1916),i=n(668),o=n(1311),u=n(1322);function c(e){var t=Object(i.k)(e,Object(i.o)());return Object(r.a)(Object(u.a)("msgfolderroot"),Object(o.A)(null),"category",-1,"UserCategory",t)}},622:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemResponseShape:#Exchange"},e)}},723:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemId:#Exchange"},e)}},761:function(e,t,n){"use strict";var r=n(0),i=n(285),o=function(){function e(e){this.maxSize=e,this.references=[],this.mruList=[]}return e.prototype.initialize=function(e,t){var n,i;if(!this.store){this.store=e,this.deleteCallback=t;try{for(var o=Object(r.__values)(e.keys()),u=o.next();!u.done;u=o.next()){var c=u.value;this.mruList.push(c)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}}},e.prototype.add=function(e,t){var n=this;Object(i.action)("MruCache_add")((function(){n.store.set(e,t),n.mruList.indexOf(e)>=0?n.touch(e):(n.mruList.push(e),n.purgeIfNecessary())}))()},e.prototype.get=function(e){return this.store.get(e)},e.prototype.getAndTouch=function(e){var t=this.store.get(e);return t&&this.touch(e),t},e.prototype.has=function(e){return this.store.has(e)},e.prototype.remove=function(e){var t=this;Object(i.action)("MruCache_remove")((function(){if(t.store.has(e)&&!t.isReferenced(e))return t.removeItemAtIndex(t.mruList.indexOf(e))}))()},e.prototype.registerReference=function(e){this.references.push(e)},e.prototype.clear=function(){var e=this;Object(i.action)("MruCache_clear")((function(){e.purgeTillSize(0)}))()},e.prototype.getItemIds=function(){return new(Array.bind.apply(Array,Object(r.__spread)([void 0],this.mruList)))},e.prototype.touch=function(e){var t=this.mruList.indexOf(e);if(t<0)throw new Error("Item with key '"+e+"' does not exist in the cache.");this.mruList.splice(t,1),this.mruList.push(e)},e.prototype.purgeIfNecessary=function(){this.purgeTillSize(this.maxSize)},e.prototype.purgeTillSize=function(e){for(var t=0;this.mruList.length>e&&t<this.mruList.length;){var n=this.mruList[t];this.isReferenced(n)?t++:this.removeItemAtIndex(t)}},e.prototype.removeItemAtIndex=function(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);var t=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(t):this.store.delete(t)},e.prototype.isReferenced=function(e){for(var t=0;t<this.references.length;t++){var n=this.references[t]();if(Array.isArray(n)){if(-1!=n.indexOf(e))return!0}else if(n==e)return!0}return!1},e}();n.d(t,"a",(function(){return o}))},766:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"GetItemRequest:#Exchange"},e)}},767:function(e,t,n){"use strict";var r=n(29),i=n(0);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"GetItemJsonRequest:#Exchange"},n)),Object(r.a)("GetItem",e,t)}n.d(t,"a",(function(){return o}))}}]);
//# sourceMappingURL=owa.MailBoot~MailFavoritesStore~MailFolderTreesParent~PublicFolderPickerModule.js.map
self.scriptsLoaded['owa.MailBoot~MailFavoritesStore~MailFolderTreesParent~PublicFolderPickerModule.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailFavoritesStore~MailFolderTreesParent~PublicFolderPickerModule.js'] = (new Date()).getTime();