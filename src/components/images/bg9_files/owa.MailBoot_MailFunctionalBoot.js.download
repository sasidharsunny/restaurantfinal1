self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailFunctionalBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[622],{12532:function(e){e.exports=JSON.parse('{"a":"Qyc"}')},1346:function(e,t,n){"use strict";function r(e,t){Object.keys(t).forEach((function(n){return e.set(n,t[n])}))}function o(e){var t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},1347:function(e,t,n){"use strict";var r=n(0),o=n(1405),i=n(388),a=n(662),c=n(269),u=n(9),s="X-AnchorMailbox",d="Authorization",f="X-OwaWebSessionType",l="X-OWA-ExplicitLogonUser";function b(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,b,v,O,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n={},b=Object(i.k)(e)){if(b.accountState==i.b.AccessRevoked)return[2,null];if(b.accountState==i.b.AccountDeprovisioned||b.accountState==i.b.AccountNotFound)return Object(i.c)(b.accountState,b.accountProviderType),[2,null]}return t?(n[s]=t,n[l]=t):b&&(n[s]=b.anchorMailbox),b?(v=b.token,!(O=Object(a.g)(b.tokenExpiry))&&v?[3,2]:(Object(c.p)("getAndUpdateAccessToken",{tokenExpiry:Object(u.y)(b.tokenExpiry,Object(u.Pb)()),isTokenExpired_1:O,isTokenInvalid_2:!v},{isCore:!0}),[4,o.a.importAndExecute(b.accountId,e)])):[3,3];case 1:(v=r.sent())||(v=""),r.label=2;case 2:p=void 0,"Outlook"==b.accountProviderType?(p='MSAuth1.0 usertoken="'+v+'", type="MSACT"',n[f]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(p="Bearer "+v,n[f]=2..toString()),n[d]=p,r.label=3;case 3:return[2,n]}}))}))}var v=n(1346),O=n(59);function p(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(v.a)(),o=n,[4,w(e,t)];case 1:return o.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function w(e,t){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,[4,b(e.mailboxInfo.userIdentity,m(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=r.sent(),Object(v.b)(o,i),[2,o]}}))}))}function m(e,t){var n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&O.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return m}))},1348:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("triggerReInitializeAccount",(function(e){return{userIdentity:e}}))},1405:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(77),o=n(1348);n.d(t,"b",(function(){return o.a}));var i=new r.c((function(){return n.e(1149).then(n.bind(null,1664))})),a=new r.a(i,(function(e){return e.getAndUpdateAccessToken}))},1418:function(e,t,n){"use strict";var r=n(0),o=n(1346);function i(e){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":e}}function a(e,t){t&&e&&Object(o.b)(t,i(e))}function c(e,t){var n,o=null!=t?t:{},i=(null===(n=o.headers)||void 0===n?void 0:n.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",a(e,i),Object(r.__assign)(Object(r.__assign)({},o),{headers:i})}var u=n(388),s=n(1347),d=n(121),f=n(360);function l(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(d.a)(),e?Object(u.r)(e.userIdentity)?[4,Object(s.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return n=r.sent(),f(t,n),[3,3];case 2:"GroupMailbox"!=e.type&&"TeamsMailbox"!=e.type||(o=i(e.mailboxSmtpAddress),f(t,o)),r.label=3;case 3:return[2,t]}}))}))}function b(){var e=Object(d.a)();return e.prefer='exchange.Behavior="CalendarInternal"',e}function v(e){void 0===e&&(e=null);var t={};return Object(u.r)(e)?(t=b(),Object(s.a)(e).then((function(e){return Object.keys(e).forEach((function(n){return t[n]=e[n]})),t}))):Promise.resolve(t)}var O=n(43);function p(e,t,n){var r=new Headers;return n&&r.set("X-OWA-CANARY",Object(O.a)()),t&&r.set("X-OWA-ActionName",t),e&&a(e,r),r}n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return p}))},1471:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return c}));var r="FileAttachment:#Exchange",o="ItemAttachment:#Exchange",i="ItemIdAttachment:#Exchange",a="ReferenceAttachment:#Exchange",c="LinkAttachment:#Exchange"},1508:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return b}));var r=n(269),o="WebPushSetup";function i(e){O("vipMailEnabled",e)}function a(e){O("mailOption",e)}function c(e){O("reminderOption",e)}function u(e){O("enabled",e)}function s(e,t){O("disabled",e),O("allClients",t)}function d(e){(window.webPushOptics.enabled||window.webPushOptics.disabled)&&(O("result",e),v())}function f(){O("lightning","ignored"),v()}function l(e){O("permission",e)}function b(e){O("roaming",e)}function v(){Object(r.p)(o,window.webPushOptics,{isCore:!0}),window.webPushOptics={}}function O(e,t){window.webPushOptics[e]=t}window.webPushOptics={}},1553:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1471);function o(e){return(e.__type||e.OwsTypeName)===r.e}},1557:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return d}));var r=n(77),o=new r.c((function(){return Promise.all([n.e(0),n.e(2),n.e(3),n.e(4),n.e(23),n.e(775)]).then(n.bind(null,4337))})),i=new r.a(o,(function(e){return e.bootStrapWebPushService})),a=new r.b(o,(function(e){return e.userInitiatedWebPushSetupWorkflow})),c=new r.b(o,(function(e){return e.userInitiatedWebPushDisableWorkflow})),u=new r.b(o,(function(e){return e.unsubscribe})),s=new r.b(o,(function(e){return e.loadWebPushOptions})),d=Object(r.d)(o,(function(e){return e.WebPushDiscovery}))},1618:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1418);function o(e){return{headers:Object(r.e)(e,"GroupMailbox")}}},16646:function(e,t,n){"use strict";n.r(t);var r=n(1322),o=n(3602),i=n(1311),a=n(83);function c(e){return Object(i.T)(Object(r.a)("inbox"))||Object(a.i)("rp-reactions")}var u=n(1338);function s(e){var t=Object(r.a)("inbox");return Object(i.T)(t)&&!Object(u.isPersonaInFavorites)(null,e.SenderSmtpEmailAddress)}var d=n(722),f=n(12),l=n(12532);var b=n(9208),v=n(2643),O=n(3),p=n(2474),w=n(6935);Object(O.orchestrator)(w.a,(function(e){var t={Subject:e.taskNewEventTitle,IsAllDayEvent:!0};p.g.importAndExecute("GetStarted","GetStarted",t)}));var m=n(1590),j=n(8313);Object(O.orchestrator)(j.a,(function(){m.f.importAndExecute("mail","attachments")}));var h=n(8314);Object(O.orchestrator)(h.a,(function(){m.f.importAndExecute("mail","messageContent")}));var I=n(8311);Object(O.orchestrator)(I.a,(function(){m.f.importAndExecute("general","timeAndLanguage")}));var g=n(1894),S=n(8312),x=n(8318),E=n(2762);Object(O.orchestrator)(S.a,(function(e){g.c.importAndExecute("GetStarted",void 0,void 0,e.taskSendEmailSubject,e.taskSendEmailBody)})),Object(O.orchestrator)(E.a,(function(e){1==e.event&&Object(x.a)()}));var P=n(8315),A=n(8319),y=n(77),N=new y.c((function(){return Promise.all([n.e(197),n.e(285),n.e(671)]).then(n.bind(null,16816))})),C=new y.a(N,(function(e){return e.showPersonalizationCard}));Object(O.orchestrator)(P.a,(function(){C.importAndExecute(A.a)}));var k=n(5707),R=n(4025),M=new y.c((function(){return n.e(307).then(n.bind(null,17034))})),T=new y.a(M,(function(e){return e.loadSenders})),_=n(9384),D=n(2571),L=new y.c((function(){return n.e(819).then(n.bind(null,16753))})),V=new y.a(L,(function(e){return e.subscribeToHierarchyNotification}));Object(y.f)(D.a,L,(function(e){return e.onNewFolderNotificationOrchestrator})),Object(y.f)(D.b,L,(function(e){return e.onUpdateFolderNotificationOrchestrator}));var U=n(20),K=n(1319),F=n(3001),W=n(59);function G(e,t){var n=function(e){var t={},n=K.a.conversationNodes.get(e);for(;n;){if(t[n.internetMessageId]){W.d("Invalid loop found in ParentInternetMessageId pointers");break}if(Object(F.b)(n.internetMessageId)&&(t[n.internetMessageId]=!0),Object(f.f)(n.parentInternetMessageId))break;n=K.a.conversationNodes.get(n.parentInternetMessageId)}return t}(e);if(1===Object.keys(n).length)return function(e,t){var n=new U.ObservableMap({});return t.forEach((function(t){var r=K.a.conversationNodes.get(t),o=t===e?i.a.CheckMark:i.a.None;n.set(r.internetMessageId,o)})),n}(e,t);for(var r=new U.ObservableMap({}),o=!1,a=!1,c=0,u=0;u<t.length;u++){var s=K.a.conversationNodes.get(t[u]);s&&(n[s.internetMessageId]?(o?c+1===Object.keys(n).length?(r.set(s.internetMessageId,i.a.BusEnd),a=!0):r.set(s.internetMessageId,i.a.BusStop):(r.set(s.internetMessageId,i.a.BusStart),o=!0),c++):!o||a?r.set(s.internetMessageId,i.a.None):r.set(s.internetMessageId,i.a.NoStop))}return r}var B=n(1510),X=n(4101),z=Object(O.action)("FOCUS_ITEM_PART",(function(e,t){return{nodeId:e,mailListItemSelectionSource:t}})),H=n(1497),q=n(6918),J=n(1323),Y=n(2478);function Q(){var e=H.a.expandedConversationViewState;e.expandedRowKey=null,e.focusedNodeId=null,e.selectedNodeIds=[],e.allNodeIds=[],e.shouldBeExpanded=!1,e.busStopStateMap=new U.ObservableMap({}),e.latestNodeIdsInEachFork=null}Object(O.mutator)(B.s,(function(e){var t=e.nodeId,n=H.a.expandedConversationViewState,r=n.selectedNodeIds,o=n.allNodeIds;H.a.expandedConversationViewState.focusedNodeId=t,r.indexOf(t)>-1?r.splice(r.indexOf(t),1):r.push(t),1===r.length&&(H.a.expandedConversationViewState.busStopStateMap=G(r[0],o))})),Object(O.mutator)(B.h,(function(e){H.a.expandedConversationViewState.busStopStateMap=new U.ObservableMap({})})),Object(O.mutator)(z,(function(e){H.a.expandedConversationViewState.focusedNodeId=e.nodeId})),Object(O.mutator)(B.p,(function(e){var t=e.rowKey,n=e.nodeIdToSelect,r=e.allNodeIds,o=H.a.expandedConversationViewState;o.selectedNodeIds=[n],o.busStopStateMap=G(n,r),o.expandedRowKey=t,o.focusedNodeId=n,o.allNodeIds=r})),Object(O.mutator)(B.t,(function(e){e.mailListItemSelectionSource===J.b.MailListItemCheckbox&&Q()})),Object(O.mutator)(X.a,(function(e){Q()})),Object(O.mutator)(B.i,(function(e){Q()})),Object(O.mutator)(B.k,(function(e){Q()})),Object(O.mutator)(B.a,(function(e){Q();var t=H.a.expandedConversationViewState;t.latestNodeIdsInEachFork=e.latestItemIdsInForks,t.expandedRowKey=e.rowKey})),Object(O.mutator)(B.q,(function(e){var t=H.a.expandedConversationViewState,n=e.rowKey,r=e.mailListItemSelectionSource;t.expandedRowKey!=n?Object(Y.d)()?(t.shouldBeExpanded=!0,t.expandedRowKey=n,t.latestNodeIdsInEachFork=[]):r===J.b.MailListItemTwisty&&(t.shouldBeExpanded=!0,t.expandedRowKey=n,t.latestNodeIdsInEachFork=null):r===J.b.MailListItemTwisty&&Object(Y.a)(n)&&(Q(),t.shouldBeExpanded=!0,t.expandedRowKey=n)})),Object(O.mutator)(B.o,(function(e){Q(),H.a.expandedConversationViewState.expandedRowKey=e.rowKey})),Object(O.mutator)(q.a,(function(e){if(1===H.a.expandedConversationViewState.selectedNodeIds.length){var t=H.a.expandedConversationViewState.selectedNodeIds[0],n=J.u.conversations.get(e.conversationId).conversationNodeIds;H.a.expandedConversationViewState.busStopStateMap=G(t,n)}}));var Z,$=n(0),ee=n(2964),te=n(9386),ne=n(1724),re=n(1431),oe=n(5261),ie=n(2126),ae=n(1493),ce=n(8241),ue=n(7269);Object(O.orchestrator)(B.b,(function(e){fe(e.itemId,e.tableView,e.nodeId,e.allNodeIds,e.mailListItemSelectionSource)}));Object(O.orchestrator)(B.e,(function(e){if(1!=e.listViewType){var t=i.X.expandedConversationViewState,n=e.mailListItemSelectionSource==J.b.MailListItemTwisty;Object(Y.d)()&&t.expandedRowKey!=e.rowKey?pe(e.rowKey,e.tableView,n):t.expandedRowKey==e.rowKey&&(t.shouldBeExpanded?t.latestNodeIdsInEachFork?pe(e.rowKey,e.tableView,n):ve(e.rowKey,e.tableView):!t.latestNodeIdsInEachFork&&n&&Oe())}})),Object(O.orchestrator)(B.c,(function(e){Object(Y.c)(e.rowKey)&&Oe()})),Object(O.orchestrator)(B.m,(function(e){for(var t=i.b.getConversationId(e.rowKey,e.tableView),n=J.u.conversations.get(t),r=null,o=null,a=n.conversationNodeIds.indexOf(i.X.expandedConversationViewState.selectedNodeIds[0])+1;a<n.conversationNodeIds.length;a++){var c=n.conversationNodeIds[a],u=Object(ee.a)(c,Object(Y.a)(e.rowKey));if(u){o=u.ItemId.Id,r=c;break}}r?fe(o,e.tableView,r,n.conversationNodeIds,J.b.RowRemoval):be(e.rowKey,e.tableView)}));var se=0,de=!0;function fe(e,t,n,r,o){if(Z&&(clearTimeout(Z),Z=null),Object(te.a)(t,!0,o,void 0),o!==J.b.KeyboardUpDown||Object(re.c)())le(e,t);else{var a=Date.now(),c=a-se;se=a,(de||c<=500)&&(de=!1,Z=setTimeout((function(){Z=null,de=!0,le(e,t)}),250))}var u=i.X.expandedConversationViewState;B.p(u.expandedRowKey,n,r,t.id,u.selectedNodeIds)}function le(e,t){if(Object(ie.a)())ne.o.importAndExecute({Id:e,mailboxInfo:Object(ae.b)(t)},!0,null,!1);else{var n=i.b.getRowClientItemId(i.X.expandedConversationViewState.expandedRowKey,t);ne.s.importAndExecute(null==n?void 0:n.Id,e,!0)}}function be(e,t,n){var r,o,a=n;if(!a||0==a.length){var c=i.b.getConversationId(e,t);a=J.u.conversations.get(c).conversationNodeIds}try{for(var u=Object($.__values)(a),s=u.next();!s.done;s=u.next()){var d=s.value,f=Object(ee.a)(d,Object(Y.a)(e));if(f){fe(f.ItemId.Id,t,d,a,J.b.RowRemoval);break}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}}function ve(e,t){B.o(e),Object(oe.a)(t,!1),be(e,t)}function Oe(){B.i()}function pe(e,t,n){var r=i.b.getRowClientItemId(e,t),o=r.Id;Object(ce.c)(o)?we(o,e,t,n):Object(ue.b)(r,"CreateConversationRelationMap").then((function(){we(o,e,t,n)}))}function we(e,t,n,r){var o=Object(i.K)(t,n.id),a=Object(ce.b)(e,o.itemIds);a.length>1?(B.a(t,a),be(t,n,a)):r?ve(t,n):B.a(t,[])}var me=n(6191),je=n(6214),he=(Object(O.orchestrator)(je.a,(function(e){Object(me.a)(),1===Object(i.J)().expandedConversationViewState.selectedNodeIds.length&&B.h()})),n(8260)),Ie=n(2646),ge=(Object(O.orchestrator)(he.a,(function(e){if(i.X.expandedConversationViewState.expandedRowKey){var t=J.u.conversations.get(e.conversationId);B.p(i.X.expandedConversationViewState.expandedRowKey,e.conversationNodeId,t.conversationNodeIds,Object(Ie.a)())}})),n(6946)),Se=n(4258),xe=n(5389),Ee=n(2127),Pe=Object(O.action)("FOCUS_ROW_IN_DIRECTION",(function(e,t,n){return{tableView:e,selectionDirection:t,mailListItemSelectionSource:n}}));function Ae(e,t,n){return Object(Ee.a)()?1===e&&n===i.d.Next||0===e&&n===i.d.Previous:e===t-1&&n===i.d.Next||e===t-2&&n===i.d.Previous}Object(O.orchestrator)(ge.a,(function(e){var t=e.selectionDirection,n=e.tableView,r=e.mailListItemSelectionSource,o=e.shouldSelect,a=Object($.__read)(function(e,t){var n=i.X.expandedConversationViewState,r=n.focusedNodeId,o=n.allNodeIds;if(!r)return[null,null];var a,c,u=o.indexOf(r);e===i.d.Next?(a=o.length-1,c=1):(a=0,c=-1);var s=Object(i.K)(t.focusedRowKey,t.id).id,d=i.X.conversationItems.get(s);for(;u!==a;){if(u+=c,Object(Se.a)(d.id)&&Ae(u,o.length,e))return Object(xe.a)(d.clientId),["loading",null];var f=o[u],l=Object(ee.a)(f,Object(Y.a)(t.focusedRowKey));if(l)return[f,l]}return[null,null]}(t,n),2),c=a[0],u=a[1];"loading"!==c&&(c?o?B.b(c,u.ItemId.Id,i.X.expandedConversationViewState.allNodeIds,n,r):z(c,r):i.X.expandedConversationViewState.expandedRowKey&&t===i.d.Previous?B.c(i.X.expandedConversationViewState.expandedRowKey):o?B.n(n,t,r):Pe(n,t,r))}));var ye=n(9387),Ne=n(4772),Ce=n(4430),ke=n(4429),Re=(Object(O.orchestrator)(Pe,(function(e){var t=e.tableView,n=e.selectionDirection,r=Object(ye.a)(t,n);if(null!==r){var o=t.rowKeys[r];Object(Ne.a)(t,o),Object(ke.a)(t,o),Object(Ce.a)(t,null),B.i()}})),n(6947));Object(O.orchestrator)(Re.a,(function(e){var t=e.tableView,n=e.mailListItemSelectionSource,r=i.X.expandedConversationViewState.focusedNodeId;r?B.s(r):B.t(t,t.focusedRowKey,!0,n)}));var Me=n(1498),Te=n(5230),_e=n(6948);Object(O.orchestrator)(_e.a,(function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.selectedRowKeys,o=e.mailListItemSelectionSource;if(n.length>0&&o===Me.a.KeyboardEnter){if(1!==n.length)return;B.b(n[0],Object(Te.a)(n[0],Object(Y.a)(r[0])),i.X.expandedConversationViewState.allNodeIds,t,o)}else{if(1!==r.length)return;B.q(t,r[0],!0,o)}}));var De=n(29);var Le=n(320),Ve=n(2634),Ue=n(5622),Ke=n(3415),Fe=n(4141),We=n(8364),Ge=n(3414),Be=n(2169),Xe=n(2801),ze=n(3004),He=n(3417),qe=new y.c((function(){return Promise.all([n.e(264),n.e(852)]).then(n.bind(null,16700))})),Je=new y.a(qe,(function(e){return e.evaluatePlaywrightMailActions})),Ye=n(30),Qe=n(6667),Ze=n(1659),$e=n(1344);function et(){var e;Object(Ye.a)().IsMonitoring&&Je.importAndExecute(),V.importAndExecute(),Object(b.a)(!0),Object(a.i)("fwk-mailtoProtocolHandler")&&(null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.registerProtocolHandler)&&window.navigator.registerProtocolHandler("mailto",""+Object(d.l)()+Object(d.j)()+"deeplink/compose?mailtouri=%s",Object(f.b)(l.a)),Xe.b.importAndExecute({condition:Object(a.i)("fwk-devTools")||Object(a.i)("sea-contextFeedback"),task:function(){return _.b.importAndExecute()}},tt,{condition:Object(a.i)("sea-clientWarmup")&&Object($e.t)(),task:function(){return Ze.l.importAndExecute()}},{condition:Object(Ve.c)(),task:function(){return Ve.f.importAndExecute()}},(function(){return Fe.a.importAndExecute()}),{condition:Object(Le.a)(),task:function(){return T.importAndExecute()}},(function(){return We.b.importAndExecute()}),(function(){return We.a.importAndExecute()}),{condition:Object(Ge.j)(),task:function(){return Ge.d.importAndExecute()}},(function(){return Ge.e.importAndExecute()}),{condition:Object(Qe.a)(),task:function(){return k.c.importAndExecute()}},{condition:Object(a.i)("mc-personalization"),task:function(){Ue.b.importAndExecute()},idle:!0},{task:function(){return Ke.c.importAndExecute()},idle:!0},{condition:Object(ne.f)(),task:function(){return R.a.importAndExecute()},idle:!0},{task:function(){return v.d.importAndExecute()},idle:!0},{condition:Object(Be.e)(window),task:function(){return Be.j.importAndExecute(window)},idle:!0},{task:function(){return ze.a.importAndExecute()},idle:!0},{condition:Object(u.isNewsEnabled)(),task:function(){return He.e.importAndExecute()}},{condition:Object(a.i)("auth-activityFeed")&&Object(a.i)("auth-activityFeedWeveSignal"),task:function(){return v.e.importAndExecute()},idle:!0},{condition:Object(a.i)("rp-projectionPopout"),task:function(){return ne.h.importAndExecute()},idle:!0}).then((function(){Xe.a.importAndExecute()}))}function tt(){var e,t;Object(o.g)(s),Object(o.f)(c),e={isOWALogon:!0},Object(De.a)("ConnectedAccountsNotification",e,t)}var nt=n(1824);Object(O.orchestrator)(o.c,(function(e){return Object($.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,o,a,c;return Object($.__generator)(this,(function(u){switch(u.label){case 0:return t=e.notification,Object(i.P)(Object(i.G)())?(n=Object(J.g)().conversations.get(t.conversationId),r={Id:t.conversationId,mailboxInfo:Object(ae.a)()},n?[3,2]:[4,nt.d.importAndExecute(r,"LoadLikedConversation")]):[3,3];case 1:u.sent(),u.label=2;case 2:return rt(r,t.subject),[3,6];case 3:return o=Object(J.g)().items.get(t.itemId),a={Id:t.itemId,mailboxInfo:Object(ae.a)()},(null==o?void 0:o.NormalizedBody)?(rt(a,t.subject),[3,6]):[3,4];case 4:return c={Id:t.itemId,mailboxInfo:Object(ae.a)()},[4,nt.e.importAndExecute(c,"LoadLikedItem")];case 5:u.sent(),rt(c,t.subject),u.label=6;case 6:return[2]}}))}))}));function rt(e,t){ne.p.importAndExecute(e,t,[],!0,null)}var ot=n(8356),it=n(96);Object(O.orchestrator)(o.d,(function(e){var t=e.notification,n=1===Object(it.h)().UserOptions.GlobalListViewTypeReact?t.ItemId:t.ConversationId;Object(ot.a)("inbox",n)}));n.d(t,"setupMailModulePostRender",(function(){return et}))},1670:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r,o=n(3),i=Object(o.createStore)("webPushStore",{currentView:0,webPushPermission:null===(r=window.Notification)||void 0===r?void 0:r.permission})(),a=Object(o.createStore)("localWebPushUserSettingStore",{userPreferenceIdentifier:null,lastSessionDate:null,uniqueDaysSessionCount:0,enabled:null,mailEnabled:null,reminderEnabled:null,vipMailEnabled:null,lastCheckboxUnchecked:null,promptCount:0,lastPromptDate:null})();function c(){return a}},1699:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d}));var r=n(1670),o=n(2141),i=n(285),a=n(1707),c=Object(i.select)({store:function(){return r.b}})((function(e){return null!=e.store&&null==e.store.enabled&&e.store.uniqueDaysSessionCount>=a.b&&e.store.lastPromptDate!=Object(o.a)().toDateString()&&e.store.promptCount<=a.a})),u=Object(i.select)({store:function(){return r.b}})((function(e){return e.store.mailEnabled||e.store.reminderEnabled})),s=Object(i.select)({store:function(){return r.b}})((function(e){var t,n,r;return{newMail:null!==(t=e.store.mailEnabled)&&void 0!==t&&t,reminder:null!==(n=e.store.reminderEnabled)&&void 0!==n&&n,vipMailOnly:null!==(r=e.store.vipMailEnabled)&&void 0!==r&&r}})),d=Object(i.select)({store:function(){return r.b}})((function(e){return e.store.reminderEnabled&&e.store.enabled}))},1707:function(e,t,n){"use strict";var r=n(1670),o=n(2141),i=n(285),a=n(8),c="WebPushUserSettings",u=5;function s(e,t){for(var n=d(e),r=-1,o=0;o<n.length;++o)if(n[o].userPreferenceIdentifier==t.userPreferenceIdentifier){r=o;break}if(r>=0)n[r]=t;else{if(r=n.length,n.length>=u){r=0;var i=new Date(n[0].lastSessionDate);for(o=1;o<n.length;++o){var s=new Date(n[o].lastSessionDate);s.getTime()<i.getTime()&&(i=s,r=o)}}n[r]=t}!function(e,t){if(t.length>0){var n=JSON.stringify(t);Object(a.e)(e,c,n)}else Object(a.d)(e,c)}(e,n)}function d(e){var t=Object(a.a)(e,c),n=new Array;try{var r=JSON.parse(t);null!=r&&(n=r)}catch(t){Object(a.d)(e,c)}return n}var f=n(1699),l=n(83);n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return v})),n.d(t,"e",(function(){return O})),n.d(t,"d",(function(){return p})),n.d(t,"g",(function(){return w})),n.d(t,"h",(function(){return m})),n.d(t,"c",(function(){return j})),n.d(t,"f",(function(){return h})),n.d(t,"i",(function(){return I}));var b=4,v=3,O=Object(i.select)({store:function(){return r.b}})(Object(i.action)("loadLocalWebPushUserSetting")((function(e,t,n){var r=function(e,t){for(var n=d(e),r=null,o=0;o<n.length;++o)if(n[o].userPreferenceIdentifier==t){r=n[o];break}return r}(e,t);if(null!=r)Object.keys(r).forEach((function(e){n.store[e]=r[e]})),I(e);else{var o=function(e,t){for(var n=d(e),r=null,o=0;o<n.length;++o)n[o].userPreferenceIdentifier<t&&(r?n[o].userPreferenceIdentifier>r.userPreferenceIdentifier&&(r=n[o]):r=n[o]);return r}(e,t);o&&(n.store.lastCheckboxUnchecked=o.lastCheckboxUnchecked,n.store.mailEnabled=o.mailEnabled,n.store.reminderEnabled=o.reminderEnabled,n.store.vipMailEnabled=o.vipMailEnabled),n.store.userPreferenceIdentifier=t,s(e,n.store)}}))),p=Object(i.select)({store:function(){return r.b}})(Object(i.action)("incrementUniqueDaysSessionCount")((function(e,t){var n=Object(o.a)().toDateString();t.store.lastSessionDate!=n&&(t.store.lastSessionDate=n,t.store.uniqueDaysSessionCount<b&&t.store.uniqueDaysSessionCount++,s(e,t.store))}))),w=Object(i.select)({store:function(){return r.b}})(Object(i.action)("resetLocalWebpushUserSetting")((function(e,t,n){n.store.userPreferenceIdentifier=t,n.store.enabled=!1,n.store.promptCount=0,n.store.lastPromptDate=null,n.store.uniqueDaysSessionCount=0,s(e,n.store)}))),m=Object(i.select)({store:function(){return r.b}})(Object(i.action)("updateLocalWebPushEnabledStatus")((function(e,t,n,r){r.store.enabled=t,r.store.userPreferenceIdentifier=n,t&&I(e),s(e,r.store)}))),j=Object(i.select)({store:function(){return r.b}})(Object(i.action)("incrementLocalWebPushPromptCount")((function(e,t){t.store.promptCount++,t.store.lastPromptDate=Object(o.a)().toDateString(),s(e,t.store)}))),h=Object(i.select)({store:function(){return r.b}})(Object(i.action)("resetLocalWebPushPromptCount")((function(e,t){t.store.promptCount=0,t.store.lastPromptDate=null,s(e,t.store)}))),I=Object(i.select)({store:function(){return r.b}})(Object(i.action)("validateAndUpdateCheckboxOptions")((function(e,t){if(t.store.enabled){if(!Object(f.b)())if(t.store.lastCheckboxUnchecked){switch(t.store.lastCheckboxUnchecked){case"NewMail":t.store.mailEnabled=!0;break;case"Reminder":t.store.reminderEnabled=!0}t.store.lastCheckboxUnchecked=null}else t.store.mailEnabled=!0,t.store.reminderEnabled=!0;1!=t.store.mailEnabled||null!=t.store.reminderEnabled&&null!=t.store.reminderEnabled||(t.store.reminderEnabled=!0)}Object(l.i)("auth-scheduleTimerForReminderWebPush")||Object(l.i)("auth-sendReminderWebPush")||(t.store.reminderEnabled=null,t.store.lastCheckboxUnchecked=null),s(e,t.store)})))},1773:function(e,t,n){"use strict";n(1618);var r=n(1573),o=n(3),i=Object(o.action)("EDIT_GROUP_SUCCESS",(function(e,t){return{groupSmtp:e,photoUrl:t}})),a=Object(o.action)("ADD_GROUP_MEMBER_SUCCESS",(function(e){return{groupSmtp:e}})),c=Object(o.action)("POPUP_OPENED",(function(){return{isOpen:!0}})),u=Object(o.action)("POPUP_CLOSED",(function(){return{isOpen:!1}})),s=Object(o.action)("DELETE_GROUP_SUCCESS",(function(e){return{groupSmtp:e}})),d=n(1608);n.d(t,"m",(function(){return r.a})),n.d(t,"l",(function(){return i})),n.d(t,"j",(function(){return a})),n.d(t,"o",(function(){return c})),n.d(t,"n",(function(){return u})),n.d(t,"k",(function(){return s})),n.d(t,"g",(function(){return d.g})),n.d(t,"c",(function(){return d.c})),n.d(t,"d",(function(){return d.d})),n.d(t,"a",(function(){return d.a})),n.d(t,"e",(function(){return d.e})),n.d(t,"f",(function(){return d.f})),n.d(t,"i",(function(){return d.i})),n.d(t,"b",(function(){return d.b})),n.d(t,"h",(function(){return d.h}))},1871:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return a})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"p",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"n",(function(){return O})),n.d(t,"r",(function(){return p})),n.d(t,"c",(function(){return w})),n.d(t,"d",(function(){return m})),n.d(t,"j",(function(){return j})),n.d(t,"f",(function(){return h})),n.d(t,"i",(function(){return I})),n.d(t,"a",(function(){return g}));var r=n(77),o=new r.c((function(){return Promise.all([n.e(1),n.e(14),n.e(32),n.e(33),n.e(39),n.e(62),n.e(63),n.e(67),n.e(120),n.e(217),n.e(805)]).then(n.bind(null,3225))})),i=new r.a(o,(function(e){return e.onSmimeItemAttachmentOpened})),a=new r.a(o,(function(e){return e.mergeSmimeDecodedMessageProperties})),c=(new r.b(o,(function(e){return e.fetchAndDecodeSmimeMessage})),new r.b(o,(function(e){return e.setSmimePropertiesInDraftMessage}))),u=new r.b(o,(function(e){return e.trySetSmimeProperties})),s=new r.b(o,(function(e){return e.tryAddSmimeProperties})),d=new r.b(o,(function(e){return e.createMailResponseBodyContent})),f=new r.b(o,(function(e){return e.downloadSmimeAttachment})),l=new r.b(o,(function(e){return e.getMergedSmimeViewState})),b=new r.b(o,(function(e){return e.getMergedSmimeViewStateForDraft})),v=new r.b(o,(function(e){return e.isSmimeItemDecoding})),O=new r.b(o,(function(e){return e.previewSmimeAttachment})),p=new r.b(o,(function(e){return e.updateSmimeAttachmentIds})),w=new r.b(o,(function(e){return e.createSmimeAttachmentsFromFiles})),m=new r.b(o,(function(e){return e.createSmimeAttachmentsViaSmimeQueueManager})),j=new r.b(o,(function(e){return e.initializeAttachmentStateForSmimeAttachments})),h=new r.b(o,(function(e){return e.getAttachmentsForSmimeResponse})),I=new r.b(o,(function(e){return e.getSmimeAttachmentsForRequest})),g=Object(r.d)(o,(function(e){return e.SignatureDetails}))},1976:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(20),o=n(3),i={clpLabels:[],learnMoreUrl:"",hasMandatoryLabel:!1,rmsTemplates:new r.ObservableMap,messageClassifications:new r.ObservableMap},a=Object(o.createStore)("protection",i),c=a()},2040:function(e,t,n){"use strict";function r(e,t){return e+"_"+(null!=t.enabledTimeInUTCMs?t.enabledTimeInUTCMs:"")}n.d(t,"a",(function(){return r}))},2089:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Unknown="Unknown",e.Like="Like",e.AtMention="AtMention",e.GroupMention="GroupMention",e.MeMention="MeMention",e.FileMention="FileMention",e.GroupAtAllMention="GroupAtAllMention",e.TxpRentalCarReservation="TxpRentalCarReservation",e.TxpFlightReservation="TxpFlightReservation",e.TxpLodgingReservation="TxpLodgingReservation",e.TxpFoodEstablishmentReservation="TxpFoodEstablishmentReservation",e.TxpEventReservation="TxpEventReservation",e.TxpParcelDelivery="TxpParcelDelivery",e.TxpInvoice="TxpInvoice",e.TxpServiceReservation="TxpServiceReservation",e.UserAtMentioned="UserAtMentioned",e.TaskNotificationInsight="TaskNotificationInsight",e.FollowUpNotificationInsight="FollowUpNotificationInsight",e.OutOfRoutineNotificationInsight="OutOfRoutineNotificationInsight",e.RealTimeFlightUpdate="RealTimeFlightUpdate",e.YammerLiveEventNotification="YammerLiveEventNotification"}(r||(r={}))},2108:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(83),o=n(57),i=n(30),a=n(1396),c=function(e){return!(!Object(r.i)("fwk-webPushNotification")&&!Object(r.i)("fwk-webPushNotificationV2"))&&(!(!e.navigator||null==e.navigator.serviceWorker||null==e.PushManager)&&((Object(o.e)()||Object(o.h)()||Object(r.i)("fwk-webPushNotificationExtended")&&(Object(o.f)()||Object(o.j)()))&&!Object(i.a)().SessionSettings.IsUserCultureRightToLeft&&(1==Object(a.b)()||2==Object(a.b)())))}},2141:function(e,t,n){"use strict";function r(){return new Date}n.d(t,"a",(function(){return r}))},2169:function(e,t,n){"use strict";var r=n(1508);n.d(t,"m",(function(){return r.b})),n.d(t,"l",(function(){return r.a})),n.d(t,"q",(function(){return r.i})),n.d(t,"n",(function(){return r.d})),n.d(t,"p",(function(){return r.g})),n.d(t,"o",(function(){return r.f}));var o=n(2040);n.d(t,"b",(function(){return o.a}));var i=n(1670);n.d(t,"a",(function(){return i.a}));var a=n(1707);n.d(t,"k",(function(){return a.e})),n.d(t,"r",(function(){return a.i}));var c=n(1699);n.d(t,"c",(function(){return c.b})),n.d(t,"d",(function(){return c.c}));var u=n(2108);n.d(t,"e",(function(){return u.a}));var s=n(1557);n.d(t,"j",(function(){return s.f})),n.d(t,"i",(function(){return s.e})),n.d(t,"h",(function(){return s.d})),n.d(t,"g",(function(){return s.c})),n.d(t,"f",(function(){return s.b}))},2354:function(e,t,n){"use strict";var r=n(3),o=Object(r.createStore)("SkypeStore",{unreadConversationCount:0,isRecentsInitialized:!1,isSwcInitialized:!1,isGlimpseOpen:!1})();t.a=o},2372:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("saveReadingPanePositionOption")},2474:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return b})),n.d(t,"g",(function(){return v}));var r=n(1705),o=n(77),i=new o.c((function(){return Promise.all([n.e(0),n.e(2),n.e(3),n.e(6),n.e(14),n.e(24),n.e(27),n.e(31),n.e(42),n.e(136),n.e(185),n.e(181),n.e(277),n.e(914)]).then(n.bind(null,3559))}));Object(o.f)(r.d,i,(function(e){return e.openTimePanelOrchestrator}));var a=Object(o.d)(i,(function(e){return e.TimePanel})),c=Object(o.d)(i,(function(e){return e.TimePanelHeaderBar})),u=new o.a(i,(function(e){return e.loadTimePanelData})),s=new o.a(i,(function(e){return e.openEventDetailsView})),d=(new o.a(i,(function(e){return e.openAttendeeTrackingView})),new o.a(i,(function(e){return e.closeAttendeeTrackingView})),new o.a(i,(function(e){return e.openTasksView}))),f=new o.a(i,(function(e){return e.openCalendarView})),l=new o.a(i,(function(e){return e.openConflictsView})),b=new o.a(i,(function(e){return e.closeConflictsView})),v=new o.a(i,(function(e){return e.openEventQuickComposeView}))},2504:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return b}));var r=n(269),o=n(2),i="addFocusOutline",a=["Tab"],c=["ArrowDown","ArrowLeft","ArrowRight","ArrowUp"],u={disable:!1};function s(e){this.classList.remove(i)}function d(e){return"INPUT"==e.tagName||"TEXTAREA"==e.tagName||e.contentEditable&&"true"==e.contentEditable}function f(e){a.indexOf(e.key)>=0&&!u.disable||c.indexOf(e.key)>=0&&!d(e.target)?this.classList.add(i):d(e.target)&&this.classList.remove(i)}function l(e){e.preventDefault()}function b(){Object(o.u)()===o.b&&document.body.addEventListener("contextmenu",l),document.body.addEventListener("mousedown",s,!0),document.body.addEventListener("keydown",f,!0),null===window||void 0===window||window.addEventListener("appinstalled",(function(){Object(r.p)("PwaInstalled")}))}},2566:function(e,t,n){"use strict";var r=n(3),o=Object(r.actionCreator)("ADD_CHAT_TAB",(function(e){return{chatConversationId:e}}));t.a=o},2643:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return s}));var r=n(77),o=n(2089);n.d(t,"c",(function(){return o.a}));var i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(6),n.e(16),n.e(18),n.e(98),n.e(116),n.e(204),n.e(298)]).then(n.bind(null,4016))})),a=Object(r.d)(i,(function(e){return e.ActivityFeed})),c=new r.a(i,(function(e){return e.initializeActivityFeed})),u=Object(r.d)(i,(function(e){return e.ActivityFeedTitle})),s=new r.a(i,(function(e){return e.postWeveSignal}))},2663:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return l}));var r=n(77),o=new r.c((function(){return Promise.all([n.e(0),n.e(2),n.e(3),n.e(4),n.e(7),n.e(10),n.e(14),n.e(685)]).then(n.bind(null,5147))})),i=new r.a(o,(function(e){return e.loadCLPUserLabels})),a=(new r.a(o,(function(e){return e.addAuditActionToViewState})),new r.b(o,(function(e){return e.showJustificationModal}))),c=new r.a(o,(function(e){return e.loadItemCLPInfo})),u=new r.b(o,(function(e){return e.updateItemCLPInfo})),s=new r.b(o,(function(e){return e.logReadCLPLabel})),d=new r.b(o,(function(e){return e.triggerCLPAutoLabeling})),f=(new r.b(o,(function(e){return e.constructCLPAuditAction})),Object(r.d)(o,(function(e){return e.CLPSubjectHeaderLabel}))),l=Object(r.d)(o,(function(e){return e.CLPMandatoryLabelModal}))},2700:function(e,t,n){"use strict";var r=n(77),o=n(3),i=n(2372),a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5),n.e(6),n.e(7),n.e(8),n.e(11),n.e(13),n.e(14),n.e(16),n.e(18),n.e(21),n.e(19),n.e(26),n.e(27),n.e(29),n.e(28),n.e(37),n.e(41),n.e(50),n.e(54),n.e(845)]).then(n.bind(null,16473))})),c=(new r.a(a,(function(e){return e.saveReadingPaneOptionQuick})),n(2479)),u=n(1929),s=n(2093),d=n(2094),f=n(285),l=n(1431),b=Object(f.action)("onPrintRow")((function(){Object(l.c)()&&(Object(d.a)(!0),Object(s.a)(!1))})),v=Object(f.action)("onNewMessage")((function(e){e||(Object(d.a)(!0),Object(s.a)(!Object(l.c)()))})),O=n(2742);n.d(t,"b",(function(){return w})),n.d(t,"c",(function(){return j})),n.d(t,"f",(function(){return h})),n.d(t,"e",(function(){return b})),n.d(t,"d",(function(){return v})),n.d(t,"a",(function(){return O.a}));var p=new r.c((function(){return Promise.all([n.e(43),n.e(49),n.e(628)]).then(n.bind(null,16767))})),w=new r.a(p,(function(e){return e.onReplyOrReplyAllOrForwardMessage})),m=(new r.b(p,(function(e){return e.onSxSPreviewPaneClose})),new r.a(p,(function(e){return e.onReadingPanePositionOptionSaved}))),j=new r.a(p,(function(e){return e.onSelectMessageAd}));function h(){Object(o.orchestrator)(i.a,(function(){m.importAndExecute()}))}Object(r.f)(c.a,p,(function(e){return e.onClientReadingPanePositionChangeOrchestrator})),Object(r.f)(u.a,p,(function(e){return e.closeImmersiveReadingPaneOrchestrator}))},2720:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(83),o=n(1396);function i(){return Object(r.i)("rp-skypeInTabs")&&1==Object(o.b)()}},2742:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("exitSearch",(function(e){return{actionSource:e}}))},2762:function(e,t,n){"use strict";var r=n(3),o=Object(r.action)("OnComposeLifecycleEvent",(function(e,t){return{viewState:e,event:t}}));t.a=o},2801:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(77),o=n(2504);n.d(t,"d",(function(){return o.b}));var i=new r.c((function(){return n.e(682).then(n.bind(null,5143))})),a=new r.a(i,(function(e){return e.setupSharedPostBoot})),c=new r.a(i,(function(e){return e.govern})),u=new r.a(i,(function(e){return e.enableGovernReport}))},2964:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1319),o=n(3001);function i(e,t){return t?r.a.items.get(e):Object(o.b)(e)}},2998:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.createStore)("whatsNewStore",{cards:null,disablePauseInboxTryIt:!1})},2999:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("OPEN_PAUSE_INBOX")},3075:function(e,t,n){"use strict";var r=n(83),o=n(1976),i=n(320);t.a=function(){var e=o.b.clpLabels;return Object(r.i)("cmp-clp")&&e.length>0&&e.some((function(e){return e.isLabelEnabled}))&&!Object(i.a)()}},3136:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_REMINDER_CLICKED",(function(e,t){return{itemId:e,reminderType:t}}))},3252:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_LIKE_NOTIFICATION_CLICKED",(function(e){return{notification:e}}))},3253:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_NEW_MAIL_NOTIFICATION_NAVIGATED",(function(e){return{notification:e}}))},3254:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Read="Read",e.Unread="Unread"}(r||(r={}))},3414:function(e,t,n){"use strict";var r=n(77),o=n(2720),i=n(83),a=function(){return!Object(i.i)("fwk-partner-code-off")&&!Object(i.i)("fwk-skypeSuite")&&Object(i.i)("fwk-skypeConsumer")},c=n(2566),u=n(2354);n.d(t,"a",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"h",(function(){return l})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return v})),n.d(t,"g",(function(){return O})),n.d(t,"f",(function(){return p})),n.d(t,"c",(function(){return o.a})),n.d(t,"j",(function(){return a})),n.d(t,"b",(function(){return c.a})),n.d(t,"k",(function(){return u.a}));var s=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(727)]).then(n.bind(null,16685))})),d=Object(r.d)(s,(function(e){return e.SkypeGlimpse})),f=new r.a(s,(function(e){return e.updateIsGlimpseOpen})),l=new r.b(s,(function(e){return e.shouldShowUnreadConversationCount})),b=new r.a(s,(function(e){return e.beginSkypeInitialization})),v=new r.a(s,(function(e){return e.createOnSwcReadyEvent})),O=new r.a(s,(function(e){return e.onNotificationReceived})),p=new r.a(s,(function(e){return e.onHideNotificationReceived}))},3415:function(e,t,n){"use strict";var r=n(77),o=n(2998),i=n(3254);function a(){var e=Object(o.a)();return e.cards?Object.keys(e.cards).filter((function(t){return e.cards[t].status===i.a.Unread})).length:0}var c=n(2999);n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(0),n.e(19),n.e(27),n.e(28),n.e(51),n.e(172),n.e(776)]).then(n.bind(null,16616))})),s=Object(r.d)(u,(function(e){return e.WhatsNewFluentPane})),d=new r.a(u,(function(e){return e.initializeWhatsNewIfNecessary})),f=new r.a(u,(function(e){return e.openPremiumDashboard}))},3433:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=[];function o(e){r.push(e)}function i(e){return r.reduce((function(t,n){return t||n(e)}),!1)}},3434:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=[];function o(e){r.push(e)}function i(e){return r.reduce((function(t,n){return t||n(e)}),!1)}},3602:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));var r=n(77),o=n(3433);n.d(t,"g",(function(){return o.a}));var i=n(3434);n.d(t,"f",(function(){return i.a}));var a=n(3252);n.d(t,"c",(function(){return a.a}));var c=n(3253);n.d(t,"d",(function(){return c.a}));var u=n(3136);n.d(t,"e",(function(){return u.a}));var s=new r.c((function(){return Promise.all([n.e(0),n.e(2),n.e(3),n.e(6),n.e(24),n.e(27),n.e(31),n.e(42),n.e(88),n.e(205),n.e(594)]).then(n.bind(null,7236))})),d=Object(r.d)(s,(function(e){return e.NotificationPane})),f=new r.b(s,(function(e){return e.onDismissAutomaticReplyNotification}))},4030:function(e,t,n){"use strict";var r,o=n(174),i=n(24),a=n(59),c=n(269);function u(e){if(e&&"5"==e.get("X-OWA-ExtendedErrorCode")){var t=e.get("X-OWA-ExtendedErrorData");r||(t?(r=!0,a.g.warn("Hip redirect needed."),Object(c.p)("ReactHipRedirect",{hipPath:t}),function(e,t){e.href=t}(Object(i.a)(),t)):a.g.warn("Missing hip redirection url"))}return r}n.d(t,"b",(function(){return o.a})),n.d(t,"a",(function(){return u}))},4141:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(77),o=new r.c((function(){return Promise.all([n.e(136),n.e(276),n.e(777)]).then(n.bind(null,6579))})),i=new r.a(o,(function(e){return e.loadWorkloadScenarioSettings}))},4258:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1319);function o(e){var t=r.a.conversations.get(e);return null==t?void 0:t.canLoadMore}},426:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"}(r||(r={}))},4267:function(e){e.exports=JSON.parse('{"e":"qwa","a":"rwa","n":"twa","p":"uwa","u":"wwa","q":"xwa","m":"ywa","j":"zwa","s":"Awa","r":"Bwa","h":"Cwa","o":"Dwa","k":"Ewa","t":"Fwa","i":"Gwa","g":"Hwa","l":"Iwa","f":"Jwa","d":"Kwa","b":"Lwa","c":"Mwa"}')},4577:function(e,t,n){"use strict";var r=n(2486),o=n(74);t.a=Object(o.d)("expandCollapsedItemsRollUp",r.a.RPCountExpCollItemsRollUp)((function(e,t){void 0===t&&(t=!1),e.conversationNodeIdsInCollapsedItemsRollUp=[]}))},464:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(426),o=n(3),i=n(537),a=n(4),c={state:r.a.NotStarted,isPopoutV2:Object(a.a)(i.a)==i.b},u=Object(o.createStore)("popoutChild",c);u()},473:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c}));var r,o=2,i=[window.location.origin];function a(e,t,n){var r={version:o,type:t,serializedData:JSON.stringify(n)};e.postMessage(JSON.stringify(r),"*")}function c(e){if(i.indexOf(e.origin)>=0){var t=void 0;try{t=JSON.parse(e.data)}catch(e){return null}if(t&&o==t.version)return t}return null}!function(e){e[e.Unknown=0]="Unknown",e[e.PopoutReady=1]="PopoutReady",e[e.SetData=2]="SetData",e[e.CloseWindow=3]="CloseWindow",e[e.DeeplinkReady=4]="DeeplinkReady"}(r||(r={}))},5389:function(e,t,n){"use strict";var r=n(4577),o=n(2486),i=n(1456),a=n(2744),c=n(269),u=n(74),s=n(1824),d=n(1319),f=n(3047),l=n(285);t.a=Object(u.d)("loadMore",o.a.RPCountLoadMore)(Object(l.select)({conversations:function(){return d.a.conversations},conversationReadingPaneViewState:function(e){return Object(i.a)(e.Id)}})((function(e,t){if(e&&t.conversations.has(e.Id)){var n=t.conversations.get(e.Id);n.isLoadMoreInProgress=!0,n.maxItemsToReturn=n.maxItemsToReturn+s.a,n.syncState="";var o=Object(c.r)();return o&&o.addCustomData([(i=n.maxItemsToReturn,u=Math.ceil((i-20)/10),Object(f.a)(u))]),Object(a.b)(t.conversationReadingPaneViewState)&&Object(r.a)(t.conversationReadingPaneViewState,!0),s.d.importAndExecute(e,"LoadMore")}var i,u;return Promise.resolve()})))},5420:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1510),o=n(1311),i=n(1800),a=n(1498);function c(e){var t=Object(i.a)(),n=Object(o.E)([e],t)[0];t.rowKeys.includes(n)&&Object(r.q)(t,n,!0,a.a.RouteHandler)}},5421:function(e,t,n){"use strict";var r=n(20),o=n(3),i={usageSuggestions:new r.ObservableMap},a=Object(o.createStore)("personalization",i)();t.a=a},5622:function(e,t,n){"use strict";var r=n(77),o=n(5421);function i(e){var t;return null===(t=o.a.usageSuggestions)||void 0===t?void 0:t.get(e)}n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return i}));var a=new r.c((function(){return n.e(856).then(n.bind(null,16744))})),c=new r.a(a,(function(e){return e.initializePersonalizationSuggestions})),u=(new r.a(a,(function(e){return e.postPersonalizationSuggestionFeedback})),new r.a(a,(function(e){return e.postPersonalizationUsageSignals})))},6191:function(e,t,n){"use strict";var r=n(0),o=n(4041),i=n(2990),a=n(3473),c=n(1495),u=n(1484),s=n(2058),d=n(2126),f=n(285),l=n(1311);t.a=Object(f.select)({composeViewState:function(){return u.a.viewStates.get(u.a.primaryComposeId)},conversationItems:function(){return l.X.conversationItems}})(Object(f.action)("reloadReadingPane")((function(e){var t,n,u=Object(l.G)(),f=u?Object(r.__spread)(u.selectedRowKeys.keys()):[];if(1==f.length){var b=l.b.getRowIdToShowInReadingPane(f[0],u),v=Object(s.a)(f,u)[0],O=u.tableQuery.listViewType;if(1===O||Object(d.a)())(null===(t=e.composeViewState)||void 0===t?void 0:t.isInlineCompose)?c.r.importAndExecute(e.composeViewState).then((function(){Object(i.a)(b,v,a.a)})):Object(i.a)(b,v,a.a);else if(0===O){var p=e.conversationItems.get(b.Id);(null===(n=e.composeViewState)||void 0===n?void 0:n.isInlineCompose)?c.r.importAndExecute(e.composeViewState).then((function(){Object(o.b)(b,v,p.subject)})):Object(o.b)(b,v,p.subject)}}})))},621:function(e,t,n){"use strict";var r=n(77),o=n(763),i=n(626),a=n(49),c=n(1),u=n(625),s=n(464),d=n(83),f=n(426),l=n(949),b=n(951),v=Object(a.a)((function(e){c.useEffect((function(){Object(d.i)("rp-popoutsDebug")||O()}),[]);return c.createElement("div",{className:b.view},Object(s.a)().state==f.a.Loading?c.createElement("span",null,c.createElement(l.a,null),e.loadingString):c.createElement("button",{onClick:O},"Get Data"))}));function O(){Object(u.a)()}function p(e,t,n,r){var o="";if(r)o="readimid/",o+=encodeURIComponent(btoa(r));else{if(o=n?"readconv/":"read/",e&&"GroupMailbox"==e.type){o+="group/";var i=e.mailboxSmtpAddress.split("@");o+=i[1]+"/"+i[0]+"/"}o+=encodeURIComponent(n||t)}return o}n.d(t,"g",(function(){return m})),n.d(t,"c",(function(){return o.a})),n.d(t,"h",(function(){return i.a})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return f.a})),n.d(t,"f",(function(){return s.a})),n.d(t,"d",(function(){return u.b})),n.d(t,"e",(function(){return p}));var w=new r.c((function(){return n.e(867).then(n.bind(null,16713))})),m=new r.b(w,(function(e){return e.bootPopout}))},6214:function(e,t,n){"use strict";var r=n(3),o=Object(r.action)("ON_CONVERSATION_OPTION_SAVED");t.a=o},625:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));var r,o=n(0),i=n(626),a=n(473),c=n(426),u=n(464),s=!1;function d(){Object(i.a)(c.a.Loading),r?r():s=!0}function f(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return s?[3,2]:[4,new Promise((function(e){r=function(){e()}}))];case 1:t.sent(),t.label=2;case 2:return[2,Object(u.a)().isPopoutV2?new Promise((function(t,n){var r=function(n){var o=Object(a.b)(n);if(o&&o.type==a.a.SetData){window.removeEventListener("message",r);var i=void 0;try{i=e?e(o.serializedData):JSON.parse(o.serializedData)}catch(e){}t(i)}};window.addEventListener("message",r);try{var o=window.opener;Object(a.c)(o,a.a.PopoutReady,null)}catch(e){t(null)}})):Promise.resolve(null)]}}))}))}},626:function(e,t,n){"use strict";var r=n(464),o=n(3),i=n(426),a=n(473);t.a=Object(o.mutatorAction)("setPopoutChildState",(function(e){var t=Object(r.a)();t.state=e,e==i.a.Ready&&t.isPopoutV2&&window.opener&&Object(a.c)(window.opener,a.a.DeeplinkReady,null)}))},6918:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("UPDATE_LOADED_CONVERSATION_READING_PANE",(function(e,t){return{conversationId:e,nodeIdCollectionChanged:t}}))},6935:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3),o=n(4267),i=n(12),a=Object(r.action)("ADD_FIRST_EVENT",(function(){return{taskNewEventTitle:Object(i.b)(o.l)}}))},6946:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_KEYBOARD_UP_DOWN",(function(e,t,n,r){return{selectionDirection:e,tableView:t,mailListItemSelectionSource:n,shouldSelect:r}}))},6947:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_KEYBOARD_TOGGLE_SELECT",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}}))},6948:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_KEYBOARD_UP_DOWN",(function(e,t,n,r){return{tableView:e,selectedNodeIds:t,selectedRowKeys:n,mailListItemSelectionSource:r}}))},763:function(e,t,n){"use strict";var r=n(0),o=n(57),i=600,a=800,c=8,u=25,s={location:!1,menubar:!1,resizable:!0,scrollbars:!1,status:!1,toolbar:!1},d=-1;function f(e,t,n){try{t=function(e){var t=u*(1+(d=(d+1)%c)),n={left:window.screenX+t,top:window.screenY+t,height:Math.max(25*Math.pow(window.innerHeight,.5),i),width:Math.max(8*Math.pow(window.innerWidth,2/3),a)};return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s),n),e)}(t);var f=(n||window).open(e,"_blank",function(e){return Object.getOwnPropertyNames(e).map((function(t){return t+"="+("boolean"==typeof(n=e[t])?n?"1":"0":n?String(n):void 0);var n})).join(",")}(t));return(Object(o.e)()||Object(o.f)())&&f.moveTo(t.left,t.top),f}catch(e){return null}}var l=n(764);var b=n(2),v=n(722),O=n(537),p="version";var w=n(74),m=n(621),j=n(269);t.a=Object(w.d)("addPopoutV2",{name:"PopoutAddPopout",customData:function(e,t,n,r,o,i){return[(t||"").split("/")[0],i]}})((function(e,t,n,r,o,i,a){var c=function(e){var t=null,n=void 0,r=null,o=null;return e&&(!function(e){return void 0!==e.deeplinkData||!!e.projectionTabId}(e)?n=e:(n=e.deeplinkData,Object(l.b)().isAvailable&&(t=e.projectionTabId||null),r=e.projectionTargetWindow,o=e.projectionParentWindow)),{deeplinkCallback:void 0===n?function(){return Promise.resolve(null)}:"function"==typeof n?n:function(){return Promise.resolve(n)},projectionTabId:t,projectionTargetWindow:r,projectionParentWindow:o}}(n),u=c.deeplinkCallback,s=c.projectionTabId,d=c.projectionTargetWindow,w=c.projectionParentWindow,h=new j.a(s?"PopoutProjectionPerf":"PopoutDeeplinkPerf"),I=s?"about:blank":function(e,t,n,r){var o;void 0===r&&(r={});var i=((o={})[p]=Object(b.n)(),o[O.a]=O.b,o);return Object.keys(r).map((function(e){i[e]=r[e]})),Object(v.p)(e,t,n,i)}(e,t,o,a),g=d||f(I,r,w);g&&m.g.import().then((function(t){return t(e,g,s,u,h)}))}))},8241:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(0),o=n(1319);function i(e){var t,n=null==e?void 0:e.conversationNodeIds,i=null==n?void 0:n.length;if(!n||!i||0==i)return null;var a=Object(r.__spread)(n);"ChronologicalNewestOnBottom"===e.conversationSortOrder||a.reverse();var c=o.a.conversationNodes.get(a[0]),u=new Map;u.set(null===(t=c.itemIds)||void 0===t?void 0:t[0],{internetMessageId:c.internetMessageId,parentItemId:null,childrenItemIds:[]});for(var d=1;d<i;){s(u,o.a.conversationNodes.get(a[d])),d+=1}return u}function a(e){var t,n=null===(t=o.a.conversations)||void 0===t?void 0:t.get(e);if(!n)return!1;var r=n.conversationNodeIds,i=null==r?void 0:r.length;return!(!r||!i||0==i)}function c(e,t){var n,r=null===(n=o.a.conversations)||void 0===n?void 0:n.get(e);if(r){var a=i(r),c=[];return a.forEach((function(e,n){if(0===e.childrenItemIds.length)for(var r=n,o=e;r;){if(t.includes(r)&&o.childrenItemIds.length<2){c.push(r);break}var i=o.parentItemId;i?(o=a.get(i),r=i):r=null}})),"ChronologicalNewestOnBottom"===r.conversationSortOrder?c:c.reverse()}return[]}function u(e,t){var n,r=[t],a=null===(n=o.a.conversations)||void 0===n?void 0:n.get(e);if(a){var c=i(a);if(!c)return r;for(var u=t;u;){r.push(u);var s=c.get(u);u=null==s?void 0:s.parentItemId}}return r}function s(e,t){var n,o,i,a,c=null===(i=t.itemIds)||void 0===i?void 0:i[0];if(!c)return null;try{for(var u=Object(r.__values)(e),s=u.next();!s.done;s=u.next()){var d=Object(r.__read)(s.value,2),f=d[0],l=d[1];if(l.internetMessageId===t.parentInternetMessageId){l.childrenItemIds.push(c),a=f;break}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}e.set(c,{internetMessageId:t.internetMessageId,parentItemId:a,childrenItemIds:[]})}},8260:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_ITEM_PART_SELECTED",(function(e,t){return{conversationNodeId:e,conversationId:t}}))},8311:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("CONFIRM_TIMEZONE")},8312:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),o=n(4267),i=n(12),a=n(30),c=Object(r.action)("SEND_AN_EMAIL",(function(){return{taskSendEmailSubject:Object(i.c)(Object(i.b)(o.s),Object(a.a)().SessionSettings.UserEmailAddress),taskSendEmailBody:Object(i.c)(Object(i.b)(o.r),Object(a.a)().SessionSettings.UserEmailAddress)}}))},8313:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("ADD_STORAGE_ACCOUNT")},8314:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("SETUP_SIGNATURE")},8315:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("SHOW_PERSONALIZATION_MODAL")},8318:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("COMPLETE_SEND_AN_EMAIL")},8319:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("COMPLETE_PERSONALIZATION")},8356:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4428),o=n(5420);function i(e,t){Object(r.a)(e),Object(o.a)(t)}},8364:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(77),o=new r.c((function(){return Promise.all([n.e(0),n.e(224),n.e(436)]).then(n.bind(null,10835))})),i=new r.a(o,(function(e){return e.subscribeToBulkActionNotification})),a=new r.a(o,(function(e){return e.findBulkActionItemAction}))},951:function(e,t,n){var r=n(952),o=n(131);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},952:function(e,t,n){(t=e.exports=n(130)(!1)).push([e.i,"._3k2DZQclSrOtYR-5XBK9RP{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={view:"_3k2DZQclSrOtYR-5XBK9RP"}}}]);
//# sourceMappingURL=owa.MailBoot~MailFunctionalBoot.js.map
self.scriptsLoaded['owa.MailBoot~MailFunctionalBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailFunctionalBoot.js'] = (new Date()).getTime();