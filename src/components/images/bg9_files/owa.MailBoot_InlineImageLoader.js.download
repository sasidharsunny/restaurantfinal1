self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~InlineImageLoader.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[598],{119:function(t,e,n){"use strict";var r=n(4),o=n(2);function i(){return!!Object(r.d)("hostApp",window.location)&&Object(r.a)("hostApp").toLowerCase()==o.e}var a,c=n(187);function u(){return Object(c.b)()||Object(r.d)("hostApp",window.location)||i()}function s(){return u()&&Object(o.u)()===o.e}!function(t){t[t.AddIns=0]="AddIns",t[t.ComposeFormHeader=1]="ComposeFormHeader",t[t.DiscardInFullCompose=2]="DiscardInFullCompose",t[t.SaveInFullCompose=3]="SaveInFullCompose",t[t.SchedulingAssistant=4]="SchedulingAssistant",t[t.Settings=5]="Settings",t[t.MultiAccounts=6]="MultiAccounts"}(a||(a={})),n.d(e,"d",(function(){return u})),n.d(e,"b",(function(){return c.a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a})),n.d(e,"e",(function(){return s}))},1346:function(t,e,n){"use strict";function r(t,e){Object.keys(e).forEach((function(n){return t.set(n,e[n])}))}function o(t){var e=null!=t?t:{headers:new Headers};return e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}))},1347:function(t,e,n){"use strict";var r=n(0),o=n(1405),i=n(388),a=n(662),c=n(269),u=n(9),s="X-AnchorMailbox",d="Authorization",f="X-OwaWebSessionType",l="X-OWA-ExplicitLogonUser";function b(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,b,v,m,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n={},b=Object(i.k)(t)){if(b.accountState==i.b.AccessRevoked)return[2,null];if(b.accountState==i.b.AccountDeprovisioned||b.accountState==i.b.AccountNotFound)return Object(i.c)(b.accountState,b.accountProviderType),[2,null]}return e?(n[s]=e,n[l]=e):b&&(n[s]=b.anchorMailbox),b?(v=b.token,!(m=Object(a.g)(b.tokenExpiry))&&v?[3,2]:(Object(c.p)("getAndUpdateAccessToken",{tokenExpiry:Object(u.y)(b.tokenExpiry,Object(u.Pb)()),isTokenExpired_1:m,isTokenInvalid_2:!v},{isCore:!0}),[4,o.a.importAndExecute(b.accountId,t)])):[3,3];case 1:(v=r.sent())||(v=""),r.label=2;case 2:p=void 0,"Outlook"==b.accountProviderType?(p='MSAuth1.0 usertoken="'+v+'", type="MSACT"',n[f]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(p="Bearer "+v,n[f]=2..toString()),n[d]=p,r.label=3;case 3:return[2,n]}}))}))}var v=n(1346),m=n(59);function p(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(v.a)(),o=n,[4,g(t,e)];case 1:return o.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function g(t,e){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=e&&(null===(n=t.headers)||void 0===n?void 0:n.set)?new Headers(t.headers):new Headers,[4,b(t.mailboxInfo.userIdentity,h(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=r.sent(),Object(v.b)(o,i),[2,o]}}))}))}function h(t,e){var n="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return n&&null==e&&m.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return h}))},1348:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3),o=Object(r.action)("triggerReInitializeAccount",(function(t){return{userIdentity:t}}))},1405:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(77),o=n(1348);n.d(e,"b",(function(){return o.a}));var i=new r.c((function(){return n.e(1149).then(n.bind(null,1664))})),a=new r.a(i,(function(t){return t.getAndUpdateAccessToken}))},1418:function(t,e,n){"use strict";var r=n(0),o=n(1346);function i(t){return{"X-OWA-ExplicitLogonUser":t,"X-AnchorMailbox":t}}function a(t,e){e&&t&&Object(o.b)(e,i(t))}function c(t,e){var n,o=null!=e?e:{},i=(null===(n=o.headers)||void 0===n?void 0:n.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",a(t,i),Object(r.__assign)(Object(r.__assign)({},o),{headers:i})}var u=n(388),s=n(1347),d=n(121),f=n(360);function l(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e=Object(d.a)(),t?Object(u.r)(t.userIdentity)?[4,Object(s.a)(t.userIdentity,"GroupMailbox"==t.type||"TeamsMailbox"==t.type?t.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return n=r.sent(),f(e,n),[3,3];case 2:"GroupMailbox"!=t.type&&"TeamsMailbox"!=t.type||(o=i(t.mailboxSmtpAddress),f(e,o)),r.label=3;case 3:return[2,e]}}))}))}function b(){var t=Object(d.a)();return t.prefer='exchange.Behavior="CalendarInternal"',t}function v(t){void 0===t&&(t=null);var e={};return Object(u.r)(t)?(e=b(),Object(s.a)(t).then((function(t){return Object.keys(t).forEach((function(n){return e[n]=t[n]})),e}))):Promise.resolve(e)}var m=n(43);function p(t,e,n){var r=new Headers;return n&&r.set("X-OWA-CANARY",Object(m.a)()),e&&r.set("X-OWA-ActionName",e),t&&a(t,r),r}n.d(e,"a",(function(){return c})),n.d(e,"d",(function(){return l})),n.d(e,"b",(function(){return v})),n.d(e,"c",(function(){return b})),n.d(e,"f",(function(){return a})),n.d(e,"e",(function(){return p}))},1568:function(t,e,n){"use strict";n.d(e,"e",(function(){return"{id}"})),n.d(e,"f",(function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"})),n.d(e,"a",(function(){return"data-custom"})),n.d(e,"c",(function(){return"originalsrc"})),n.d(e,"b",(function(){return"data-loadstatus"})),n.d(e,"d",(function(){return"pending"}))},1573:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(295),o={};function i(t){var e=t.toLocaleLowerCase();if(!o[e]){var n={type:"GroupMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:t};o[e]=n}return o[e]}},1608:function(t,e,n){"use strict";n.d(e,"k",(function(){return r})),n.d(e,"j",(function(){return o})),n.d(e,"g",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"e",(function(){return s})),n.d(e,"f",(function(){return d})),n.d(e,"i",(function(){return f})),n.d(e,"b",(function(){return l})),n.d(e,"h",(function(){return b}));var r="SwitchGroup",o="NavigateFromMeToWe",i="GroupHeader_SendEmail_Button_Clicked",a="GroupHeader_Email_Button_Clicked",c="GroupHeader_Files_Button_Clicked",u="GroupHeader_Calendar_Button_Clicked",s="GroupHeader_Notebook_Button_Clicked",d="GroupHeader_Planner_Button_Clicked",f="GroupHeader_Site_Button_Clicked",l="GroupHeader_CustomLeaveGroup_Button_Clicked",b="GroupHeader_Settings_Button_Clicked"},1618:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1418);function o(t){return{headers:Object(r.e)(t,"GroupMailbox")}}},16655:function(t,e,n){"use strict";n.r(e);var r=n(1870),o=n(285),i=Object(o.action)("clearInlineImageStore")((function(){r.a.inlineImages={}})),a=n(2436),c=n(2662),u=n(3749),s=Object(o.action)("addInlineImageToStore")((function(t,e){r.a.inlineImages[t]=e})),d=n(1568);function f(t){var e=Object(c.a)(t,a.f),n=Object(c.a)(t,d.c);if(e.length>0&&n.length>0){var r=Object(u.a)(t);r&&s(n,r)}}function l(t,e,n,r,o,i,a){void 0===r&&(r=""),void 0===o&&(o=""),void 0===i&&(i=""),void 0===a&&(a=""),t.addCustomData([e,n,r,o,i,a]),r&&r.length>0?t.endWithError("ClientError"):t.end()}var b="RequestError",v="RequestTimeout",m="RequestAbort",p="ImageZeroBytes",g="ImageInvalidLength",h=[{format:"JPEG",signature:new Uint8Array([255,216,255,224]),mime:/^image\/p?jpe?g$/i,expectedMime:"image/jpeg"},{format:"EXIF",signature:new Uint8Array([255,216,255,225]),mime:/^image\/p?jpe?g$/i},{format:"SPIFF",signature:new Uint8Array([255,216,255,232]),mime:/^image\/p?jpe?g$/i},{format:"CannonEOS",signature:new Uint8Array([255,216,255,226]),mime:/^image\/p?jpe?g$/i},{format:"SamsungD500",signature:new Uint8Array([255,216,255,227]),mime:/^image\/p?jpe?g$/i},{format:"PNG",signature:new Uint8Array([137,80,78,71,13,10,26,10]),mime:/^image\/png$/i,expectedMime:"image/png"},{format:"GIF",signature:new Uint8Array([71,73,70,56]),mime:/^image\/gif$/i,expectedMime:"image/gif"},{format:"TIFF1",signature:new Uint8Array([73,32,73]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF2",signature:new Uint8Array([73,73,42,0]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF3",signature:new Uint8Array([77,77,0,42]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF4",signature:new Uint8Array([77,77,0,43]),mime:/^image\/(x-)?tiff$/i},{format:"BMP",signature:new Uint8Array([66,77]),mime:/^image\/bmp$/i}];function O(t,e){return void 0===e&&(e=!1),new Promise((function(n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState){var t=r.status,e=r.getResponseHeader("Content-Type")||"";if(e.length>0){var o=e.indexOf(";");o>0&&(e=e.substr(0,o))}var i="",c=null,u="",s=!1,d="";if(200==t){var f=r.response;if(f&&0!=f.byteLength)if(f.byteLength<10)i=g;else{var l=function(t){for(var e=0;e<h.length;e++)for(var n=h[e],r=0;r<n.signature.length&&n.signature[r]==t[r];r++)if(r==n.signature.length-1)return n;return null}(c=new Uint8Array(r.response,0,10));l&&(u=l.format,(s=e&&l.mime.test(e))||(i=a.l,d=l.expectedMime))}else i=p}n({status:i,responseCode:t,contentType:e,detectedFormat:u,first10BytesBase64:c?j(c):"",mimeMatched:s,expectedMime:d})}},r.ontimeout=function(){n({status:v})},r.onerror=function(){n({status:b})},r.onabort=function(){n({status:m})},e&&(r.withCredentials=!0),r.open("GET",t,!0),r.responseType="arraybuffer",r.send()}))}function j(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}var y=new RegExp("^https?://([^/]*)/.*","i"),w=window.location.hostname.toLowerCase();function A(t){if(t){var e=t.ownerDocument||document;return e&&e.documentElement.contains(t)}return!1}var S="onload";function C(t,e,n,r){t.onload=function(t){var e=t.target;I(e),n&&n(e)},t.onerror=function(t){var e=t.target;I(e),r&&r(e)},t.setAttribute(d.b,d.d),t.src=e}function I(t){t.removeAttribute(S),t.removeAttribute(d.b),t.onload=null,t.onerror=null}var k=n(722),_=n(59),x="deeplink/read/",T="/owa/?debugJS=true&viewmodel=ReadMessageItem&InternetMessageID=";function E(t,e,n,r){var o="Please engage nickhu@microsoft.com with below data:\n",i=Object(c.a)(t,a.e);i&&(o+="Deeplink (React): "+M(i,!0)+"\n");var u=Object(c.a)(t,a.d);u&&(o+="Deeplink (MVVM): "+M(u,!1)+"\n");var s=t.src;s&&(o+="Src: "+s+"\n");var f=Object(c.a)(t,d.c);if(f&&(o+="OriginalSrc: "+f+"\n"),n){var l=n.status,b=n.contentType,v=n.detectedFormat,m=n.first10BytesBase64;l&&(o+="Status: "+l+"\n"),b&&(o+="ContentType: "+b+"\n"),v&&(o+="DetectedFormat: "+v+"\n"),m&&(o+="First10Bytes: "+m+"\n"),o+="MimeMatch: "+n.mimeMatched}r&&r>0&&(o+="Retried: "+r),_.d("Error loading inline image: "+e+".\n"+o)}function M(t,e){void 0===e&&(e=!0);var n=Object(k.l)();return e?n+Object(k.j)()+x+t:n+T+t}var D=n(269),R=new RegExp("[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}","i");function U(t,e,n,r,o,i,a,c,u,s,d,f,l,b){void 0===r&&(r=""),void 0===o&&(o=""),void 0===i&&(i=""),void 0===a&&(a=""),void 0===c&&(c=""),void 0===u&&(u=""),void 0===s&&(s=""),void 0===d&&(d=""),void 0===f&&(f=""),void 0===l&&(l=""),void 0===b&&(b="");var v=[t,e,n,r,o,i,a=function(t){if(!t)return"";var e="",n=t,r=t.indexOf(":");return r>=0&&(e=t.slice(0,r+1),n=t.slice(r+1)),e+(n=n.match(R)?"<GUID>":"<PII>")}(a),c,u,s,d,f,l,b];Object(D.p)("InlineImageLoadError",v),_.g.info("InlineImageLoadError: "+v)}var P,B=n(83),L="DataUri_Success",F="DataUri_RequestFailed",G="DataUri_OnError",W=new RegExp("^data:[a-z]+\\/[a-z-]+;","i");function N(t,e,n,r,o,i){n?r&&r(t):o&&o(t);var a=e.imageType,c=e.perfDataPoint,u=e.howLoad,s=e.context,d=e.loaderCode,f=e.originalSrc,b=e.owaDomain,v=e.downloadDomain,m=e.responseData,p=m.responseCode,g=m.status,h=m.contentType,O=m.detectedFormat,j=m.first10BytesBase64,y=m.mimeMatched,w=n?"":i||g||p.toString();c&&l(c,a,u,w,s,d,n?L:""),n||(U(a,u,w,p.toString(),s,d,f,h,b,v,O,j,y.toString()),Object(B.i)("mc-imageDiagnostics")&&E(t,w,m))}!function(t){t[t.NotStarted=0]="NotStarted",t[t.Pending=1]="Pending",t[t.Completed=2]="Completed"}(P||(P={}));var H=4,z=3,V=1e3,q=2e4,X="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7",$="RetryTimedOut",J=[],Z=null;function Y(t,e,n,r,o){var i={image:t,url:e,retryContext:n,currentRetry:0,status:P.NotStarted,whenQueued:Date.now(),onSuccessCallback:r,onErrorCallback:o};Q(i),J.push(i),Z||(Z=setTimeout((function(){return function t(){if(J.length>0){var e=Date.now(),n=[],r=[],o=[];J.forEach((function(t){t.status!=P.Completed&&(e-t.whenQueued>q?K(t,!1,$):t.status==P.Pending?(o.push(t),n.push(t)):t.status==P.NotStarted&&(r.push(t),n.push(t)))}));var i=H-o.length;i>0&&r.length>0&&(c=r.slice(0,Math.min(i,r.length)))&&c.length>0&&c.forEach((function(t){t.currentRetry++,t.status=P.Pending,A(t.image)?C(t.image,t.url,(function(e){K(t,!0)}),(function(e){t.currentRetry>=z?K(t,!1):Q(t)})):K(t,!1,a.k+"_R"+t.currentRetry)})),J=n}var c;Z=J.length>0?setTimeout((function(){return t()}),V):null}()}),V))}function Q(t){t.status=P.NotStarted,t.image.src=X}function K(t,e,n){if(void 0===n&&(n=""),t.status!=P.Completed){var r=t.image,o=t.onSuccessCallback,i=t.onErrorCallback,a=t.currentRetry;e?o&&o(r):i&&i(r);var c=t.retryContext,u=c.imageType,s=c.perfDataPoint,d=c.howLoad,f=c.context,b=c.loaderCode,v=c.originalSrc,m=c.owaDomain,p=c.downloadDomain,g=c.responseData,h=g.responseCode,O=g.status,j=g.contentType,y=g.detectedFormat,w=g.first10BytesBase64,A=g.mimeMatched,S=e?"":n||O||h.toString();s&&l(s,u,d,S,f,b,a.toString()),e||(U(u,d,S,h.toString(),f,b,v,j,m,p,y,w,A.toString(),a.toString()),Object(B.i)("mc-imageDiagnostics")&&200==h&&E(r,S,g)),t.status=P.Completed}}var tt="InlineImageLoad";function et(){return new D.a(tt,{logEvery:Object(B.i)("ring-dogfood")?1:20})}var nt="ZeroNaturalWidth";function rt(t,e,n,r,o,i){void 0===i&&(i=!1);var u,s=et(),f=null!=(u=e.match(y))&&u.length>1&&u[1].toLowerCase()!=w,b=f?a.o:a.q,v=Object(c.a)(t,d.c),m=Object(c.a)(t,a.c);0==m.length&&(m=a.r);var p="";f&&(t.setAttribute(a.a,a.g),p=a.g),_.g.info("InlineImage: Load attachment, Url: "+e+", crossDomain: "+f+", crossOrigin: "+p);var g=f?w:"",h=f?function(t){var e=t.match(y);return null!=e&&e.length>1?e[1].toLowerCase():w}(e):"";C(t,e,(function(t){r&&r(t);var e=t.naturalWidth>0;l(s,m,b,e?"":nt,n,p),e||U(m,b,nt,"",n,p,v,"",g,h)}),(function(c){var u=a.n;n!=a.h||A(c)?O(e,f).then((function(d){if(i&&200==d.responseCode&&d.mimeMatched)Y(c,e,{imageType:m,howLoad:b,context:n,loaderCode:p,originalSrc:v,owaDomain:g,downloadDomain:h,responseData:d,perfDataPoint:s},r,o);else if(d.status==a.l&&d.expectedMime)!function(t,e,n,r,o){var i=new XMLHttpRequest;i.onload=function(){var e=new FileReader;e.onloadend=function(){if(e.result){var i=e.result.replace(W,"data:"+n.responseData.expectedMime+";");C(t,i,(function(){return N(t,n,!0,r,o)}),(function(){return N(t,n,!1,r,o,G)}))}},e.readAsDataURL(i.response)},i.ontimeout=i.onerror=function(){N(t,n,!1,r,o,F)},t.crossOrigin==a.g&&(i.withCredentials=!0),i.open("GET",e,!0),i.responseType="blob",i.send()}(c,e,{imageType:m,howLoad:b,context:n,loaderCode:p,originalSrc:v,owaDomain:g,downloadDomain:h,responseData:d,perfDataPoint:s},r,o);else{o&&o(c);var f=d.status,O=d.responseCode,j=d.contentType,y=d.detectedFormat,w=d.first10BytesBase64,A=d.mimeMatched;u=f||O.toString(),l(s,m,b,u,n,p),U(m,b,u,O.toString(),n,p,v,j,g,h,y,w,A.toString()),Object(B.i)("mc-imageDiagnostics")&&(404!=O&&0!=O&&200!=O||E(t,u,200==O?d:null))}})):(o&&o(c),u=a.k,l(s,m,b,u,n,p),U(m,b,u,"",n,p,v,"",g,h))}))}var ot=n(263),it=n(8255),at=n(1923),ct="naturalwidth",ut="naturalheight",st="width",dt="height",ft="px";function lt(t,e,n,o){void 0===n&&(n=!0);var i=Object(c.a)(t,d.a),u=Object(c.a)(t,a.c),s=Object(c.a)(t,d.c),f=s.length>0?r.a.inlineImages[s]:null;if(0==i.length&&!f)return!1;if(f){var b=et();C(t,f,(function(t){vt(t),l(b,u,a.p,"",e)}),(function(t){l(b,u,a.p,a.n,e),U(u,a.p,a.n,"",e,"",s,"")}))}else{var v={Id:decodeURIComponent(i),mailboxInfo:Object(it.a)(t,o)},m=Object(at.a)(v,1);if(null!=m&&m.length>0){var p=t.style.display,g=n?function(t){var e="50px",n="50px";t.style.width&&t.style.height?(e=t.style.width,n=t.style.height):t.getAttribute(st)&&t.getAttribute(dt)?(e=t.getAttribute(st)+ft,n=t.getAttribute(dt)+ft):t.getAttribute(ct)&&t.getAttribute(ut)&&(e=t.getAttribute(ct)+ft,n=t.getAttribute(ut)+ft);var r=Object(ot.h)(),o=document.createElement("div");o.style.display="inline-block",o.style.width=e,o.style.height=n,o.style.maxWidth="100%",o.style.maxHeight=t.style.maxHeight,o.style.borderWidth="1px",o.style.borderStyle="dashed",o.style.borderColor=r.themePrimary,o.style.boxSizing="border-box",t.style.display="none",t.parentNode&&t.parentNode.insertBefore(o,t);if(t.getAttribute(ct)&&t.getAttribute(ut)){var i=Math.min(parseInt(o.style.width),o.offsetWidth);o.style.height=Math.ceil(i/parseInt(t.getAttribute(ct))*parseInt(t.getAttribute(ut))).toString()}return o}(t):null;rt(t,m,e,(function(t){bt(g),vt(t),t.style.display=p}),(function(t){bt(g),t.style.display="inline"}),!0)}else U(u,"",a.m,"",e,"",s,""),t.removeAttribute("src")}return!0}function bt(t){(null==t?void 0:t.parentNode)&&t.parentNode.removeChild(t)}function vt(t){var e=t.style;t.hasAttribute("width")||e.width||t.hasAttribute("height")||e.height||(e.maxWidth="100%",e.height="auto")}var mt=n(0),pt=n(1545);var gt=n(469),ht=n(97),Ot=n(337);function jt(t,e,n){return Object(B.i)("rp-imageProxy-loadViaFetch")?function(t,e,n){return Object(mt.__awaiter)(this,void 0,void 0,(function(){var r,o=this;return Object(mt.__generator)(this,(function(i){switch(i.label){case 0:return[4,fetch(e)];case 1:return r=i.sent(),[4,new Promise((function(e){return Object(mt.__awaiter)(o,void 0,void 0,(function(){var o,i;return Object(mt.__generator)(this,(function(a){switch(a.label){case 0:return Object(Ot.a)(r.status)?[4,r.blob()]:[3,2];case 1:return o=a.sent(),i=URL.createObjectURL(o),t.src=i,t.onload=function(t){n||URL.revokeObjectURL(i),e({status:r.status,renderSuccess:!0,statusText:r.statusText,headers:r.headers})},t.onerror=function(t){e({status:r.status,renderSuccess:!1,statusText:r.statusText,headers:r.headers})},[3,3];case 2:e({status:r.status,renderSuccess:!1,statusText:r.statusText,headers:r.headers}),a.label=3;case 3:return[2]}}))}))}))];case 2:return[2,i.sent()]}}))}))}(t,e,n):function(t,e){return new Promise((function(n){t.onload=function(e){yt(t),n({status:200,renderSuccess:!0})},t.onerror=function(e){yt(t),n({status:500,renderSuccess:!1})},t.src=e}))}(t,e)}function yt(t){t.onload=null,t.onerror=null}var wt,At,St=n(96),Ct=n(2),It=n(584),kt="loadFromImageProxy";function _t(t,e){if(e.proxyCount%e.logEvery!=0){var n=function(){return Promise.resolve()};return{endWithSuccess:n,endWithError:n,addCustomProperty:n,addCheckmark:n}}var r=(new Date).getTime(),o=new D.a(kt,{sessionSampleRate:10,logVerbose:!0});return o.addCustomData(Object.values(t)),o.endWithSuccess=function(){o.end(void 0,Object(It.a)(r)?"BackgroundSuccess":"Success")},o}!function(t){t.ModelD="ModelD",t.ModelB="ModelB",t.Cosmic="Cosmic"}(wt||(wt={}));var xt="p",Tt="s",Et="c",Mt="b",Dt="statusCode",Rt="https://imgproxy-{0}.services.web.outlook.com/proxy/?u={1}&t={2}&r={3}&s={4}",Ut="https://cosmic-{0}.office.net/imageproxy/proxy?u={1}&t={2}&r={3}&s={4}",Pt="https://outlookimageproxy.azurewebsites.net",Bt="clientErrorReason",Lt="serverErrorProxyCode",Ft="isShadowTraffic",Gt="isHttps",Wt=((At={})[wt.Cosmic]={sdf:"sdf",prod:"msit"},At[wt.ModelD]={sdf:"sdf",prod:"prod"},At);function Nt(t,e,n,r,o){var i;return Object(mt.__awaiter)(this,void 0,void 0,(function(){var a,u,s,f,l,b,v,m;return Object(mt.__generator)(this,(function(p){switch(p.label){case 0:if(a=n?document.createElement("img"):e,!(u=Object(c.a)(e,d.c)))return[2,!1];if((s=_t({endpoint:t},r)).addCustomProperty(Ft,n),s.addCustomProperty(Gt,"https:"==u.substring(0,6).toLowerCase()),f=Object(mt.__read)(Object(gt.getAccessTokenforResourceAsLazy)(Pt),2),l=f[0],b=f[1],s.addCustomProperty("tokenCache",l?"warm":"cold"),l)return[3,4];p.label=1;case 1:return p.trys.push([1,3,,4]),[4,b];case 2:return l=p.sent(),[3,4];case 3:return p.sent(),s.addCustomProperty(Bt,1),s.endWithError("ClientError"),[2,!1];case 4:if(s.addCheckmark("token_loaded"),!((l?l.length:0)>0))return[3,9];v=function(t,e,n,r){var o="Dogfood"==Object(Ct.t)()?"sdf":"prod";return Object(ht.a)(t==wt.Cosmic?Ut:Rt,Wt[t][o],encodeURIComponent(e),encodeURIComponent(n),r?Tt:xt,Object(St.s)()?Et:Mt)}(t,u,l,n),p.label=5;case 5:return p.trys.push([5,7,,8]),[4,jt(a,v,o)];case 6:return m=p.sent(),s.addCustomProperty(Dt,m.status),m.renderSuccess?(s.endWithSuccess(),[2,!0]):(200===m.status?(s.addCustomProperty(Bt,3),s.endWithError("ClientError")):(s.addCustomProperty(Lt,Object(B.i)("rp-imageProxy-loadViaFetch")?(null===(i=null==m?void 0:m.headers)||void 0===i?void 0:i.get("x-proxy-errorcode"))||"EmptyXProxyErrorCode":"NoXProxyCodeAsViaTag"),s.endWithError("ServerError")),[3,8]);case 7:return p.sent(),s.addCustomProperty(Bt,4),s.endWithError("ClientError"),[3,8];case 8:return[3,10];case 9:s.addCustomProperty(Bt,2),s.endWithError("ClientError"),p.label=10;case 10:return[2,!1]}}))}))}var Ht=n(4165),zt="statusCode";function Vt(t,e,n,r){return Object(mt.__awaiter)(this,void 0,void 0,(function(){var o,i,a,c;return Object(mt.__generator)(this,(function(u){switch(u.label){case 0:(o=_t({endpoint:wt.ModelB},n)).addCustomProperty("isShadowTraffic",e),u.label=1;case 1:return u.trys.push([1,6,,7]),[4,Object(Ht.a)(t)];case 2:return(i=u.sent())?[4,jt(e?document.createElement("img"):t,i,r)]:[3,4];case 3:return a=u.sent(),o.addCustomProperty(zt,a.status),200===a.status?(o.endWithSuccess(),[2,!0]):(a.status>=400&&a.status<500?o.endWithError("ClientError"):o.endWithError("ServerError"),[3,5]);case 4:o.endWithError("ClientError"),u.label=5;case 5:return[3,7];case 6:return c=u.sent(),_.d(c),o.endWithError("ClientError"),[3,7];case 7:return[2,!1]}}))}))}var qt=0,Xt=10;function $t(){var t={proxyCount:qt,logEvery:Xt};return qt++,t}function Jt(t,e,n,r,o){return void 0===n&&(n=!1),void 0===r&&(r=$t),Object(mt.__awaiter)(this,void 0,void 0,(function(){return Object(mt.__generator)(this,(function(i){return e==wt.ModelD||e==wt.Cosmic?[2,Nt(e,t,n,r(),o)]:[2,Vt(t,n,r(),o)]}))}))}function Zt(t,e,n){return void 0===e&&(e=Jt),Object(mt.__awaiter)(this,void 0,void 0,(function(){var r,o,i,u,s,f,l;return Object(mt.__generator)(this,(function(b){switch(b.label){case 0:return v=t,m=Object(c.a)(v,d.c),p=Object(c.a)(v,a.b),m&&p?Object(pt.a)()?(r=Object(B.i)("rp-imageProxyOnCosmic")||Object(B.i)("rp-imageProxyOnCosmic-test")?wt.Cosmic:Object(B.i)("rp-imageProxyOnModelD")?wt.ModelD:wt.ModelB,o=Object(mt.__spread)(Object(B.i)("rp-imageProxyOnModelBShadowing")?[wt.ModelB]:[],Object(B.i)("rp-imageProxyOnModelDShadowing")?[wt.ModelD]:[],Object(B.i)("rp-imageProxyOnCosmicShadowing")?[wt.Cosmic]:[]).filter((function(t){return t!==r})),[4,e(t,r,void 0,void 0,n)]):[3,2]:[2,!1];case 1:b.sent();try{for(i=Object(mt.__values)(o),u=i.next();!u.done;u=i.next())s=u.value,e(t,s,!0,void 0,n)}catch(t){f={error:t}}finally{try{u&&!u.done&&(l=i.return)&&l.call(i)}finally{if(f)throw f.error}}return[3,3];case 2:t.src="",b.label=3;case 3:return[2,!0]}var v,m,p}))}))}var Yt="data-imageerror",Qt="data-outlook-trace",Kt="CidTildeWrd",te="AttNotFound",ee=new RegExp("^cid:\\s?~WRD","i"),ne=new RegExp("^cid:","i"),re=new RegExp("f:([0-9]+)","i"),oe=new RegExp("t:([0-9]+)","i");function ie(t,e){var n=Object(c.a)(t,Yt),r=Object(c.a)(t,a.c),o=Object(c.a)(t,d.c);if(n&&n.length>0){var i=n;if(o&&ee.test(o))i=Kt;else if(n==te){var u=function(t){var e="";if(t){var n=re.exec(t),r=oe.exec(t);if(n&&2==n.length&&r&&2==r.length){var o=parseInt(n[1]),i=parseInt(r[1]);isNaN(o)||isNaN(i)||(0==o?e="PreEWS":o>0&&(o<i?e="MidEWS":o==i&&(e="PostEWS")))}}else e="NoTrace";return e}(Object(c.a)(t,Qt));u&&(i=te+"_"+u)}!function(t,e,n,r,o,i){void 0===n&&(n=""),void 0===r&&(r=""),void 0===o&&(o=""),void 0===i&&(i="");var a=et(),c=[t,e,n,r,o,i];a.addCustomData(c),n&&n.length>0?a.endWithError("ClientError"):a.end()}(r,"",i,e),U(r,"",i,"",e,"",o,""),t.onload=null,t.removeAttribute("src"),Object(B.i)("mc-imageDiagnostics")&&(n!=te&&0!=n.indexOf("NotImage")||E(t,n))}else if(o&&!ne.test(o)){var s=et();C(t,o,(function(t){l(s,r,"","",e)}),(function(t){l(s,r,"",a.n,e),O(o).then((function(t){var n=t.status,i=t.responseCode,a=t.contentType,c=n||i.toString();U(r,"",c,i.toString(),e,"",o,a)}))}))}}function ae(t,e,n,r,o){return Object(mt.__awaiter)(this,void 0,void 0,(function(){var i;return Object(mt.__generator)(this,(function(a){switch(a.label){case 0:return lt(t,i=e||"",!!n,r)?[3,2]:[4,Zt(t,Jt,o)];case 1:a.sent()||ie(t,i),a.label=2;case 2:return[2]}}))}))}function ce(t){var e=[t];Object(D.p)("InlineImageAttachmentUpload",e),_.g.info("InlineImageAttachmentUpload: "+e)}n.d(e,"clearInlineImageStore",(function(){return i})),n.d(e,"cacheInlineImage",(function(){return f})),n.d(e,"loadFromAttachmentServiceUrl",(function(){return rt})),n.d(e,"loadFromAttachment",(function(){return lt})),n.d(e,"loadFromProxy",(function(){return Zt})),n.d(e,"loadFromImageTag",(function(){return ae})),n.d(e,"logImageLoadError",(function(){return U})),n.d(e,"logImageUpload",(function(){return ce})),n.d(e,"tryCreateDataURIFromImage",(function(){return u.a}))},1744:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(295),o=n(388);function i(t){if("ArchiveMailbox"==t.type)return Object(r.a)();var e=t.userIdentity&&Object(o.r)(t.userIdentity),n="GroupMailbox"===t.type;return e&&!n?Object(r.b)(t.mailboxSmtpAddress)+t.userIdentity:"UserMailbox"===t.type?Object(r.a)():t.mailboxSmtpAddress}},1746:function(t,e,n){"use strict";var r=n(388),o=n(0),i={};function a(t){return i[t]}function c(t,e){var n=i[t];i[t]=Object(o.__assign)(Object(o.__assign)({},n),e)}var u=n(96),s=n(29);var d=n(269),f=n(59),l=n(670),b=n(1347),v=n(1346);function m(t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return(e={}).headers=new Headers,[4,Object(b.a)(t)];case 1:return n=r.sent(),Object(v.b)(e.headers,n),[2,e]}}))}))}var p=Object(l.b)({timeBetweenRetryInMS:function(){return 3e4}});function g(t,e){e=e<1?1:e,setInterval((function(){!function(t){Object(o.__awaiter)(this,void 0,void 0,(function(){var e,n,i,u,l,b,v=this;return Object(o.__generator)(this,(function(g){switch(g.label){case 0:if(e=function(){return Object(o.__awaiter)(v,void 0,void 0,(function(){var e,n;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),e={},Object(r.r)(t.userIdentity)?[4,m(t.userIdentity)]:[3,2];case 1:e=o.sent(),o.label=2;case 2:return[2,(i=e,Object(s.a)("GetAttachmentDownloadToken",{},i))];case 3:throw n=o.sent(),f.g.warn("Unable to get the download token "+n),n.networkError=!0,n;case 4:return[2]}var i}))}))},null==(n=a(t.userIdentity))?void 0:n.isRefreshingDownloadToken)return[3,4];c(t.userIdentity,{isRefreshingDownloadToken:!0}),i=0,u=p((function(){return Object(o.__awaiter)(v,void 0,void 0,(function(){var n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return i++,[4,e()];case 1:return n=r.sent(),f.g.info("update new token"),c(t.userIdentity,{downloadToken:n,isRefreshingDownloadToken:!1}),[2]}}))}))})).retriableFunc,l=new d.b("AttachmentRefreshDownloadToken"),g.label=1;case 1:return g.trys.push([1,3,,4]),[4,u()];case 2:return g.sent(),l.addCustomData([i]),l.end(),[3,4];case 3:return b=g.sent(),f.g.warn("Retry to refresh token failed: "+b),l.addCustomData([i]),l.endWithError("ServerError",b),c(t.userIdentity,{isRefreshingDownloadToken:!1}),[3,4];case 4:return[2]}}))}))}(t)}),6e4*e)}var h=n(270);function O(t){var e=Object(r.j)(null==t?void 0:t.userIdentity),n=a(null==t?void 0:t.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(e){case null:case"Outlook":!function(t){var e=Object(r.r)(t.userIdentity)?Object(u.i)(t.userIdentity):Object(u.h)(),n=null==e?void 0:e.ApplicationSettings;if(n){var o=n.DownloadUrlBase;c(t.userIdentity,{downloadUrlBase:o,downloadToken:n.FirstDownloadToken}),o&&g(t,n.DownloadTokenRefreshMinutes)}}(t);break;case"Google":case"ICloud":break;default:Object(h.a)(e)}var o=a(t.userIdentity);return o||(Object(d.p)("FilesUrlDataNotFound",{accountProviderType:e}),f.g.warn("Unable to get the url data")),o}function j(t){if(!t)return null;var e=O(t);return null==e?void 0:e.downloadToken}n.d(e,"b",(function(){return O})),n.d(e,"a",(function(){return j}))},1773:function(t,e,n){"use strict";n(1618);var r=n(1573),o=n(3),i=Object(o.action)("EDIT_GROUP_SUCCESS",(function(t,e){return{groupSmtp:t,photoUrl:e}})),a=Object(o.action)("ADD_GROUP_MEMBER_SUCCESS",(function(t){return{groupSmtp:t}})),c=Object(o.action)("POPUP_OPENED",(function(){return{isOpen:!0}})),u=Object(o.action)("POPUP_CLOSED",(function(){return{isOpen:!1}})),s=Object(o.action)("DELETE_GROUP_SUCCESS",(function(t){return{groupSmtp:t}})),d=n(1608);n.d(e,"m",(function(){return r.a})),n.d(e,"l",(function(){return i})),n.d(e,"j",(function(){return a})),n.d(e,"o",(function(){return c})),n.d(e,"n",(function(){return u})),n.d(e,"k",(function(){return s})),n.d(e,"g",(function(){return d.g})),n.d(e,"c",(function(){return d.c})),n.d(e,"d",(function(){return d.d})),n.d(e,"a",(function(){return d.a})),n.d(e,"e",(function(){return d.e})),n.d(e,"f",(function(){return d.f})),n.d(e,"i",(function(){return d.i})),n.d(e,"b",(function(){return d.b})),n.d(e,"h",(function(){return d.h}))},187:function(t,e,n){"use strict";var r;function o(){if(!r)throw new Error("OpxHostApi has not been initialized yet.");return r}function i(){return!!r}function a(t){r=t}n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a}))},1923:function(t,e,n){"use strict";var r=n(1928);n.d(e,"a",(function(){return r.a})),n.d(e,"b",(function(){return r.b}));var o=n(1746);n.d(e,"c",(function(){return o.a}));var i=n(1744);n.d(e,"d",(function(){return i.a}))},1928:function(t,e,n){"use strict";var r=n(270),o=n(12),i=n(43),a="/owa/",c="service.svc/s/GetFileAttachment?id={0}",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",d="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",f="service.svc/s/GetAttachmentThumbnail?id={0}",l="pdfprint.aspx?id={0}",b="pdfprint.aspx?id={0}&location={1}",v=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var m=n(320),p=n(57),g=n(2),h=n(27),O=n(1746),j=n(1744);function y(t,e,n,r,c){if(void 0===r&&(r=!1),void 0===c&&(c=null),!t||!t.Id||!t.mailboxInfo)return null;var u=Object(O.b)(t.mailboxInfo),s=null==u?void 0:u.downloadUrlBase,d=Object(j.a)(t.mailboxInfo);if(c=c||Object(o.c)(e,encodeURIComponent(t.Id)),!s||r&&"Firefox"===Object(p.a)().browser){var f=a+c+"&X-OWA-CANARY="+Object(i.a)();return Object(h.a)(f)}var l="{0}{1}/{2}";Object(m.a)()&&(l+="&isc=1");var b=Object(o.c)(l,s,d,c);return n&&(b+="&token="+(null==u?void 0:u.downloadToken),b+="&X-OWA-CANARY="+Object(i.a)()),Object(p.i)()||(b+="&owa="+window.location.hostname,b+="&scriptVer="+Object(g.n)()||!1),b}function w(t,e,n,c,s,f,l,m,p){var g;switch(void 0===s&&(s=0),void 0===f&&(f=0),void 0===l&&(l=!0),void 0===m&&(m=null),void 0===p&&(p=null),n){case 0:g=u;break;case 3:g=b;break;case 1:if(!function(t){if(!t)return!1;var e=null,n=t.lastIndexOf(".");return n>0&&(e=t.substr(n).toLowerCase()),!!e&&v.indexOf(e.toLowerCase())>=0}(m))return null;g=d;break;default:Object(r.a)(n)}var O=c?f:s;!O&&s&&(O=s);var j=Object(o.c)("{0}&permissionLevel={1}",Object(o.c)(g,encodeURIComponent(t.Id),encodeURIComponent(e)),O),w=y(t,g,!0,3===n,j);if(w)return w;var A=Object(o.c)("{0}{1}{2}",a,p,j);l&&(A=A+"&X-OWA-CANARY="+Object(i.a)());return Object(h.a)(A)}function A(t,e,n,i){var a;switch(void 0===n&&(n=!1),void 0===i&&(i=!0),e){case 0:a=c;break;case 1:a=s;break;case 2:a=f;break;case 3:a=l;break;default:return Object(r.a)(e)}if(!Object(o.f)(a)){var u=y(t,a,i,3===e);return Object(o.c)("{0}{1}{2}",u,n?"&isDownload=true":"","&animation=true")}return null}n.d(e,"b",(function(){return w})),n.d(e,"a",(function(){return A}))},2370:function(t,e,n){var r,o;
/*!
 * JavaScript Cookie v2.1.3
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(i){if(void 0===(o="function"==typeof(r=i)?r.call(e,n,e,t):r)||(t.exports=o),!0,t.exports=i(),!!0){var a=window.Cookies,c=window.Cookies=i();c.noConflict=function(){return window.Cookies=a,c}}}((function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}return function e(n){function r(e,o,i){var a;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(i=t({path:"/"},r.defaults,i)).expires){var c=new Date;c.setMilliseconds(c.getMilliseconds()+864e5*i.expires),i.expires=c}try{a=JSON.stringify(o),/^[\{\[]/.test(a)&&(o=a)}catch(t){}return o=n.write?n.write(o,e):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=(e=(e=encodeURIComponent(String(e))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape),document.cookie=[e,"=",o,i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}e||(a={});for(var u=document.cookie?document.cookie.split("; "):[],s=/(%[0-9A-Z]{2})+/g,d=0;d<u.length;d++){var f=u[d].split("="),l=f.slice(1).join("=");'"'===l.charAt(0)&&(l=l.slice(1,-1));try{var b=f[0].replace(s,decodeURIComponent);if(l=n.read?n.read(l,b):n(l,b)||l.replace(s,decodeURIComponent),this.json)try{l=JSON.parse(l)}catch(t){}if(e===b){a=l;break}e||(a[b]=l)}catch(t){}}return a}}return r.set=r,r.get=function(t){return r.call(r,t)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(e,n){r(e,"",t(n,{expires:-1}))},r.withConverter=e,r}((function(){}))}))},2436:function(t,e,n){"use strict";n.d(e,"f",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i})),n.d(e,"e",(function(){return a})),n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"g",(function(){return s})),n.d(e,"r",(function(){return d})),n.d(e,"n",(function(){return f})),n.d(e,"m",(function(){return l})),n.d(e,"k",(function(){return b})),n.d(e,"l",(function(){return v})),n.d(e,"h",(function(){return m})),n.d(e,"p",(function(){return p})),n.d(e,"o",(function(){return g})),n.d(e,"q",(function(){return h})),n.d(e,"j",(function(){return O})),n.d(e,"i",(function(){return j}));var r="src",o="data-imagetype",i="crossorigin",a="data-itemid",c="data-inetid",u="data-imageproxyendpoint",s="use-credentials",d="AttachmentByCid",f="OnError",l="NullAttachmentUrl",b="DOMDetached",v="ImageMismatch",m="RP",p="DataUri",g="CrossDomain",h="SameDomain",O="ImageProxySkipForConsumerChild",j="ImageProxyConnectorsAuthTokenFalse"},263:function(t,e,n){"use strict";var r=n(323),o=n(83);function i(){return Object(o.i)("fwk-suiteThemes")}var a=n(290);function c(){var t,e;return i()?null!==(e=null===(t=Object(a.d)())||void 0===t?void 0:t.Id)&&void 0!==e?e:"base":Object(r.a)()}function u(t,e){var n,o;if(i())return null!==(o=e?null===(n=Object(a.d)())||void 0===n?void 0:n.DarkTheme:Object(a.d)())&&void 0!==o?o:{};var c=Object(r.e)(t,e);return{BackgroundImageUrl:c.primary,BackgroundImageRepeat:c.repeat}}var s=n(82);function d(){if(i()){var t=Object(a.c)();if(Object(s.e)()){var e={};return Object.keys(t).forEach((function(t){e[t]="var(--"+t+")"})),e}return t}return Object(r.f)()}function f(t,e){return i()?Object(a.c)():Object(r.g)(t,e)}var l=n(178),b=n(48);function v(){var t=c(),e=Object(l.e)();return!e&&(t===b.a.BASE_OFFICE_THEME_ID||t==b.a.BASE_THEME_ID&&!Object(s.i)(t,e))}function m(){var t=c(),e=Object(l.e)();return e&&(t===b.a.BASE_OFFICE_THEME_ID||t==b.a.BASE_THEME_ID&&!Object(s.i)(t,e))}n.d(e,"d",(function(){return c})),n.d(e,"a",(function(){return"#0078D4"})),n.d(e,"e",(function(){return u})),n.d(e,"h",(function(){return d})),n.d(e,"i",(function(){return f})),n.d(e,"g",(function(){return v})),n.d(e,"f",(function(){return m})),n.d(e,"b",(function(){return s.c})),n.d(e,"j",(function(){return s.e})),n.d(e,"l",(function(){return s.g})),n.d(e,"k",(function(){return s.f})),n.d(e,"c",(function(){return s.d}))},265:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a}));var r=n(4),o=n(33);function i(){var t,e=Object(o.a)("DefaultAnchorMailbox");return null==e||0==e.trim().length||(t=Object(r.b)(window.location),Object.keys(t).indexOf("anonRetry")>=0)}function a(){var t=Object(r.b)(window.location);return Object.keys(t).indexOf("anonymous")>=0}},2662:function(t,e,n){"use strict";function r(t,e){return t.hasAttribute(e)?t.getAttribute(e):""}n.d(e,"a",(function(){return r}))},295:function(t,e,n){"use strict";var r=n(30),o=n(0),i=n(96),a=n(83);function c(t){var e=Object(i.i)(t);return e&&e.SessionSettings?0===e.SessionSettings.WebSessionType?Object(a.i)("doc-attachment-routingKeyAadSmtp")?"SMTP:":"":"MSA:":"no-routing-key:"}var u=n(59);function s(t,e,n){var r,i;if(n)try{for(var a=Object(o.__values)(n),c=a.next();!c.done;c=a.next()){var u=c.value;if(!d(t,u))return u}}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return e&&e.length>0?e[0]:"NoResolvableAddress@invalid.outlook.com"}function d(t,e){return("outlook_"+t+"@outlook.com").toLowerCase()===e.toLowerCase()}function f(){var t=function(){var t=Object(r.a)();if(!t||!t.SessionSettings)return u.d("SessionSettings not available"),"no-routing-key";var e=t.SessionSettings.UserEmailAddress;if(0===t.SessionSettings.WebSessionType)return c()+e;if(Object(a.i)("doc-attachment-routingKeyPuid"))return"PUID:"+t.SessionSettings.UserPuid+"@"+t.SessionSettings.TenantGuid;if(t.SessionSettings.IsShadowMailbox)return c()+t.SessionSettings.LogonEmailAddress;if(d(t.HexCID,t.SessionSettings.UserEmailAddress))return c()+s(t.HexCID,t.SessionSettings.NotManagedEmailAddresses,t.SessionSettings.UserProxyAddresses);return c()+e}();return t=encodeURIComponent(t)}function l(){var t=Object(r.a)();if(!t||!t.SessionSettings)return u.d("SessionSettings not available"),"no-mailbox-id";var e=t.SessionSettings.UserEmailAddress;return Object(a.i)("doc-attachment-usePrimarySmtpAddressForMailboxId")?e:(t.SessionSettings.IsShadowMailbox?e=t.SessionSettings.LogonEmailAddress:d(t.HexCID,t.SessionSettings.UserEmailAddress)&&(e=s(t.HexCID,t.SessionSettings.NotManagedEmailAddresses,t.SessionSettings.UserProxyAddresses)),e)}var b=n(747),v=n(623);function m(t){var e=Object(v.a)().userMailboxInfoMap;e&&e.delete(t)}function p(t,e){return t===e||null!=t&&null!=e&&t.Id===e.Id}n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return b.a})),n.d(e,"f",(function(){return m})),n.d(e,"e",(function(){return p})),n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return c}))},2994:function(t,e,n){"use strict";var r,o,i,a=n(0),c=n(269),u=n(3652),s=n(3861),d=n(319),f=n(2370),l="GetConnectorsLTITokenFailure",b="GetConnectorsLTITokenException",v="GetConnectorsLTITokenNull",m="ConnectorsLtiToken",p="40B852DF-9693-420D-AA7D-10072C9CE077",g=5;function h(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(e){switch(e.label){case 0:return(t=function(){if(r){if(Date.now()-o<1e3*(r.TTL-g)*60)return r.TokenValue}return null}())?[3,2]:[4,O()];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))}function O(){return i||(i=new Promise((function(t,e){var n={Header:Object(d.b)(),Body:Object(u.a)({TokenRequests:[{__type:"TokenRequest:#Exchange",Id:p,TokenType:"Connectors"}]})};Object(s.a)(n).then((function(n){i=null,n&&"Success"===n.Body.ResponseMessages.Items[0].ResponseClass?(r=n.Body.ResponseMessages.Items[0].Token,o=Date.now(),function(t){if(!t)throw j(v),new Error("getClientAuthToken null");f.set(m,t,{path:"/actions/"})}(r.TokenValue),t(r.TokenValue)):(j(l),e(new Error("getClientAuthToken failed")))})).catch((function(t){i=null,j(b),e(new Error("getClientAuthToken exception: "+t))}))}))),i}function j(t){Object(c.p)(t),r=void 0}var y=n(83),w=n(320),A=n(469),S="https://outlook.office365.com/connectors",C="User.Read";function I(){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return!Object(y.i)("rp-actionableMessages-aad-token")||Object(w.a)()?[3,2]:[4,_()];case 1:return[2,t.sent()];case 2:return Object(y.i)("rp-actionableMessages-msa-token")&&Object(w.a)()?[4,k()]:[3,4];case 3:return[2,t.sent()];case 4:return[4,h()];case 5:return[2,t.sent()]}}))}))}function k(){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(A.getDelegationTokenForOwa)(C)];case 1:return[2,t.sent()]}}))}))}function _(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,e,n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.__read)(Object(A.getAccessTokenforResourceAsLazy)(S),2),e=t[0],n=t[1],e?[3,2]:[4,n];case 1:e=r.sent(),r.label=2;case 2:return[2,e]}}))}))}n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return I}))},337:function(t,e,n){"use strict";var r=n(726);n.d(e,"a",(function(){return r.a}))},362:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a}));var r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function i(){return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}function a(t){return r.test(t)}},3652:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0);function o(t){return Object(r.__assign)({__type:"GetClientAccessTokenRequest:#Exchange"},t)}},3749:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(269),o="2d",i="canvas",a="image/png";function c(t){try{var e=document.createElement(i),n=t.naturalWidth,c=t.naturalHeight;if(n>0&&c>0||(Object(r.p)("CreateDataURIMissingNaturalDimensions"),n=t.width,c=t.height),n>0&&c>0)return e.width=n,e.height=c,e.getContext(o).drawImage(t,0,0),e.toDataURL(a)}catch(t){}return null}},3861:function(t,e,n){"use strict";var r=n(29),o=n(0);function i(t,e){var n;return void 0===t||t.__type||(n=t,t=Object(o.__assign)({__type:"GetClientAccessTokenJsonRequest:#Exchange"},n)),Object(r.a)("GetClientAccessToken",t,e)}n.d(e,"a",(function(){return i}))},388:function(t,e,n){"use strict";var r,o=n(3);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var i,a=n(74),c=Object(o.action)("addAccount",(function(t){return{userIdentity:t.userIdentity,account:t}})),u=Object(o.action)("removeAccount",(function(t){return{userIdentity:t}})),s=Object(o.action)("updateAccount",(function(t,e,n){return{userIdentity:t,accountToken:e,accountTokenExpiresIn:n}})),d=Object(o.action)("updateOWAConnectedAccountStatus",(function(t,e){return{userIdentity:t,accountState:e}})),f=Object(o.action)("accountIsInErrorState",(function(t,e){return Object(a.c)({name:"accountIsInErrorState",options:{isCore:!0},customData:{accountState_1:r[t],accountProvider_2:e}},{accountState:t})})),l=Object(o.action)("retryAccountUpdateToken",(function(t,e,n,o,i){return Object(a.c)({name:"retryAccountUpdateToken",customData:{currentAccountState_1:r[n],localAccountState_2:r[o],previousAccountState_3:r[i]}},{accountId:t,userIdentity:e,currentAccountState:n})})),b=Object(o.action)("connectedAccountsListRequested",(function(t){return Object(a.c)({name:"connectedAccountsGetResponse",options:{isCore:!0},customData:{isSuccess_1:t}},{isSuccess:t})})),v=Object(o.action)("setAccountsStoreState",(function(t){return{state:t}})),m=n(0),p=n(20);!function(t){t[t.None=0]="None",t[t.AccountsLoadSuccessful=1]="AccountsLoadSuccessful",t[t.AccountsLoadError=2]="AccountsLoadError"}(i||(i={}));var g=Object(o.createStore)("OWAAccountsStore",{accountsMap:new p.ObservableMap({}),accountsLoadedState:i.None}),h=n(270),O=n(96);function j(t){return t!=Object(O.b)()&&void 0!==w(t)}function y(){return Object(m.__spread)(g().accountsMap.values())}function w(t){return g().accountsMap.get(t)}function A(){var t;return(null===(t=y())||void 0===t?void 0:t.length)>0?y()[0]:null}function S(){return y().filter((function(t){return t.accountState!=r.Valid}))}function C(t){return y().filter((function(e){return t.includes(e.accountState)}))}function I(t){return y().filter((function(e){return e.accountProviderType==t}))}function k(t){return j(t)?w(t).accountProviderType:null}function _(t){return"Outlook"==t.accountProviderType?'MSAuth1.0 usertoken="'+t.token+'", type="MSACT"':"Google"==t.accountProviderType||"ICloud"==t.accountProviderType?"Bearer "+t.token:Object(h.a)(t.accountProviderType)}function x(t,e){return function(n){var r=w(n);return r?r[t]:e}}x("accountUniqueId","0");var T=x("accountState",r.Valid),E=function(){return y().some((function(t){return!R(t.userIdentity)}))},M=x("accountProviderType",null),D=function(t){return"Outlook"==M(t)},R=function(t){return T(t)==r.Valid},U=function(){return y().length>0};function P(){return g().accountsLoadedState}var B=n(9),L=n(269);Object(o.mutator)(c,(function(t){var e=t.account;Object(L.p)("owaAccountAdded",{accountStatus_1:r[e.accountState]}),g().accountsMap.set(e.userIdentity,e)})),Object(o.mutator)(u,(function(t){var e=t.userIdentity;g().accountsMap.delete(e)})),Object(o.mutator)(s,(function(t){var e=t.userIdentity,n=t.accountToken,r=t.accountTokenExpiresIn,o=g().accountsMap.get(e);o.token=n,o.tokenExpiry=Object(B.j)(Object(B.Pb)(),parseInt(r))})),Object(o.mutator)(d,(function(t){var e=t.userIdentity,n=t.accountState,o=g().accountsMap.get(e);o.accountState==r.Valid&&n!=r.Valid&&Object(L.p)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[n]}),o.accountState=n})),Object(o.mutator)(b,(function(t){var e=t.isSuccess?i.AccountsLoadSuccessful:i.AccountsLoadError;g().accountsLoadedState=e})),Object(o.mutator)(v,(function(t){g().accountsLoadedState=t.state})),n.d(e,"d",(function(){return c})),n.d(e,"u",(function(){return u})),n.d(e,"y",(function(){return s})),n.d(e,"x",(function(){return d})),n.d(e,"c",(function(){return f})),n.d(e,"v",(function(){return l})),n.d(e,"e",(function(){return b})),n.d(e,"w",(function(){return v})),n.d(e,"n",(function(){return y})),n.d(e,"k",(function(){return w})),n.d(e,"i",(function(){return A})),n.d(e,"f",(function(){return S})),n.d(e,"g",(function(){return C})),n.d(e,"o",(function(){return I})),n.d(e,"j",(function(){return k})),n.d(e,"m",(function(){return _})),n.d(e,"l",(function(){return T})),n.d(e,"q",(function(){return E})),n.d(e,"t",(function(){return D})),n.d(e,"s",(function(){return R})),n.d(e,"p",(function(){return U})),n.d(e,"h",(function(){return P})),n.d(e,"r",(function(){return j})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}))},4165:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n(0),o=n(2436),i=n(2994),a=n(33),c=n(30),u=n(269),s=n(2662),d=n(1568),f="data-connectorsauthtoken",l="u",b="i",v="d",m="ClientId";function p(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,n,i,v;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e=Object(s.a)(t,d.c),n=Object(s.a)(t,o.b),i=Object(s.a)(t,f),e&&n?Object(c.a)().IsConsumerChild?(Object(u.p)(o.j),[2,e]):"1"!=i?[3,2]:[4,g(n,e)]:[2,""];case 1:return v=r.sent(),[3,3];case 2:v=function(t,e){var n=Object(a.a)(m);if(!n)return null;if("/actions/ei"==t.toLowerCase())return Object(u.p)(o.i),null;return t+"?"+l+"="+encodeURIComponent(e)+"&"+b+"="+encodeURIComponent(n)}(n,e),r.label=3;case 3:return[2,v]}}))}))}function g(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Object(i.b)()];case 1:return n.sent(),[3,3];case 2:return n.sent(),[2,null];case 3:return[2,t+"?"+l+"="+encodeURIComponent(e)+"&"+v+"="+encodeURIComponent((new Date).toISOString())]}}))}))}},444:function(t,e,n){"use strict";var r=function(){function t(t,e,n){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout((function(){t.tryRunTask()}),this.taskDelay)},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.tryRunTask=function(){var t=this;if(this.canRunMoreTasks()){var e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then((function(){t.onTaskComplete()})).catch((function(){t.onTaskComplete()})),this.scheduleTask()}},t}();n.d(e,"a",(function(){return r}))},555:function(t,e,n){"use strict";var r,o=n(557),i=n(3),a=Object(i.createStore)("nonBootUserConfiguration",{nonBootUserConfiguration:null})(),c=n(265),u=Object(i.mutatorAction)("setNonBootUserConfiguration",(function(t){a.nonBootUserConfiguration=t}));function s(){return Object(c.b)()?Promise.resolve({}):a.nonBootUserConfiguration?Promise.resolve(a.nonBootUserConfiguration):(r||(r=Object(o.a)().then((function(t){return u(t),t})).catch((function(t){throw r=void 0,t}))),r)}var d=s;function f(){return a.nonBootUserConfiguration||s(),a.nonBootUserConfiguration}function l(){var t=(f()||{}).IsEdu;return void 0!==t&&t}function b(){var t=(f()||{}).ExternalInOutlookEnabled;return void 0!==t&&t}n.d(e,"b",(function(){return d})),n.d(e,"c",(function(){return f})),n.d(e,"d",(function(){return l})),n.d(e,"a",(function(){return b}))},557:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(29);function o(t){return Object(r.a)("GetOwaNonBootUserConfiguration",{},t)}},623:function(t,e,n){"use strict";var r=n(3),o=n(20);e.a=Object(r.createStore)("OWAClientIdStore",{userMailboxInfoMap:new o.ObservableMap})},662:function(t,e,n){"use strict";var r=n(3),o=Object(r.action)("initializeOwaObservableDateTime"),i=Object(r.action)("observableNowChanged"),a=Object(r.action)("observableTodayChanged"),c=n(9),u=n(20),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),d=Object(u.computed)((function(){return Object(c.lc)(s().now)})),f=function(){return d.get()},l=Object(u.computed)((function(){return Object(c.lc)(s().today)})),b=function(){return l.get()},v=function(t){return Object(c.Gb)(t,f())},m=function(t){return Object(c.Eb)(t,f())},p=function(t){return h(t,c.Gb)},g=function(t){return h(t,c.Hb)},h=function(t,e){return e(Object(c.Wb)(Object(c.lc)(t)),b())};function O(t){if(!t)return"";var e=Object(c.lc)(t);return function(t,e){var n=Object(c.Wb)(t);if(Object(c.Ib)(n,e))return c.Z;var r=function(t){return Object(c.Mb)(n,Object(c.e)(e,-t),e)};if(r(3))return c.hb;if(r(30))return c.gb;return c.X}(e,b())(e)}function j(t){if(!t)return"";var e=Object(c.lc)(t);return function(t,e){var n=Object(c.Wb)(t);if(Object(c.Ib)(n,e))return c.S;return c.T}(e,b())(e)}function y(t){return t?function(t,e){var n=Object(c.Wb)(t);return Object(c.Ib)(n,e)?Object(c.Z)(t):w(n,e,2)?Object(c.kb)(t):w(n,e,7)?Object(c.H)(Object(c.ab)(t),Object(c.Z)(t)):Object(c.H)(Object(c.J)(t),Object(c.Z)(t))}(Object(c.lc)(t),b()):""}function w(t,e,n){return Object(c.Mb)(t,Object(c.e)(e,-n),e)}var A=Object(r.action)("updateTimes"),S=Object(r.action)("setNow"),C=Object(r.action)("setToday",(function(t){return{today:t}}));Object(r.mutator)(S,(function(){s().now=Object(c.jc)()})),Object(r.mutator)(C,(function(t){var e=t.today;s().today=e}));var I=n(34),k=n(128);Object(r.orchestrator)(o,(function(){A();var t=Object(c.Pb)(),e=Object(c.Yb)(Object(c.h)(t,1)),n=Object(c.w)(e,t);setTimeout((function(){return setInterval(A,I.g)}),n)})),Object(r.orchestrator)(k.l,(function(){A()})),Object(r.orchestrator)(A,(function(){S();var t=Object(c.zb)(Object(c.kc)()),e=s().today!=t;e&&C(t),i(),e&&a()})),n.d(e,"d",(function(){return o})),n.d(e,"j",(function(){return i})),n.d(e,"l",(function(){return a})),n.d(e,"i",(function(){return f})),n.d(e,"k",(function(){return b})),n.d(e,"g",(function(){return v})),n.d(e,"e",(function(){return m})),n.d(e,"f",(function(){return p})),n.d(e,"h",(function(){return g})),n.d(e,"a",(function(){return O})),n.d(e,"b",(function(){return j})),n.d(e,"c",(function(){return y}))},670:function(t,e,n){"use strict";function r(t){void 0===t&&(t={}),function(t){t.timeBetweenRetryInMS=t.timeBetweenRetryInMS||function(){return 6e4}}(t);var e=t.maximumAttempts,n=t.timeBetweenRetryInMS;return function(t){var r=0,o=!1,i=function(a,c){o?c(new Error("The function retry was cancelled")):(r++,t().then((function(t){return a(t)})).catch((function(t){e&&r>=e?c(t):setTimeout((function(){return i(a,c)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(t,e){return i(t,e)}))},cancel:function(){return o=!0}}}}function o(t){return function(e){return Math.pow(2,e)*t}}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}))},726:function(t,e,n){"use strict";function r(t){return t>=200&&t<300}n.d(e,"a",(function(){return r}))},747:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(96),o=n(623);function i(t){var e=Object(o.a)().userMailboxInfoMap;if(!e||!e.get(t)){var n=!1;t&&(n=t!=Object(r.b)());var i={type:"UserMailbox",userIdentity:n?t:Object(r.b)(),mailboxSmtpAddress:n?t:Object(r.c)()};return e.set(t,i),i}return e.get(t)}},8255:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(12),o=n(1773),i=n(295),a=n(2662),c="explicitlogon";function u(t,e){var n=Object(a.a)(t,c);return Object(r.f)(n)?Object(i.d)(e):Object(o.m)(n)}}}]);
//# sourceMappingURL=owa.MailBoot~InlineImageLoader.js.map
self.scriptsLoaded['owa.MailBoot~InlineImageLoader.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~InlineImageLoader.js'] = (new Date()).getTime();