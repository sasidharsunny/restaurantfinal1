self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ActionableMessageMail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[454],{10317:function(e,t,n){var r=n(15077),a=n(131);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},10318:function(e,t,n){"use strict";var r;!function(e){e[e.LoadStart=0]="LoadStart",e[e.AutoInvokeActionStart=1]="AutoInvokeActionStart",e[e.AutoInvokeActionEnd=2]="AutoInvokeActionEnd",e[e.CardRenderStart=3]="CardRenderStart",e[e.CardRenderEnd=4]="CardRenderEnd",e[e.ThemeLoadTotalStart=5]="ThemeLoadTotalStart",e[e.ThemeLoadTotalEnd=6]="ThemeLoadTotalEnd",e[e.ThemeDefinitionsLoadStart=7]="ThemeDefinitionsLoadStart",e[e.ThemeDefinitionsLoadEnd=8]="ThemeDefinitionsLoadEnd",e[e.ThemeResolveStart=9]="ThemeResolveStart",e[e.ThemeResolveEnd=10]="ThemeResolveEnd",e[e.CardCreateStart=11]="CardCreateStart",e[e.CardCreateEnd=12]="CardCreateEnd",e[e.CardLibraryRenderStart=13]="CardLibraryRenderStart",e[e.CardLibraryRenderEnd=14]="CardLibraryRenderEnd",e[e.PrepareCardStart=15]="PrepareCardStart",e[e.PrepareCardEnd=16]="PrepareCardEnd"}(r||(r={})),t.a=r},1324:function(e,t,n){"use strict";var r,a=n(1385),i=n(618).a["__core-js_shared__"],o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";var s=function(e){return!!o&&o in e},c=n(546),u=n(1406),d=/^\[object .+?Constructor\]$/,l=Function.prototype,f=Object.prototype,p=l.toString,b=f.hasOwnProperty,g=RegExp("^"+p.call(b).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var h=function(e){return!(!Object(c.a)(e)||s(e))&&(Object(a.a)(e)?g:d).test(Object(u.a)(e))};var m=function(e,t){return null==e?void 0:e[t]};t.a=function(e,t){var n=m(e,t);return h(n)?n:void 0}},1354:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(3),a=n(20),i=Object(r.createStore)("lightningState",{unseenItems:new a.ObservableMap,lightedCount:0,lastShownId:null}),o=i()},1358:function(e,t,n){"use strict";var r=n(1385),a=n(1393);t.a=function(e){return null!=e&&Object(a.a)(e.length)&&!Object(r.a)(e)}},1360:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},1364:function(e,t,n){"use strict";t.a=function(e,t){return e===t||e!=e&&t!=t}},1369:function(e,t,n){"use strict";n.d(t,"l",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return p})),n.d(t,"i",(function(){return b})),n.d(t,"h",(function(){return g})),n.d(t,"f",(function(){return h})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return v})),n.d(t,"g",(function(){return C}));var r,a,i=n(33),o=n(30),s=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],c=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],u={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};function d(){return Object(o.a)().SessionSettings.IsPremiumConsumerMailbox}function l(){return Object(o.a)().IsConsumerChild}function f(){return Object(o.a)().SessionSettings.IsShadowMailbox}function p(){return void 0!==a?a:a=function(){var e=Object(o.a)(),t=e.SessionSettings.UserCulture;if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return t?t.toLowerCase():"en-us";var n=e.AdMarket.toLowerCase();return s.indexOf(n)>-1?n:u[n.split("-")[1]]||n}()}function b(e){return null!=e?e.toUpperCase().split("-"):[]}function g(e){return b(e)[1]||"US"}function h(){return Object(i.a)("ANON")}function m(){return Object(i.a)("MUID")}function v(){return!!Object(i.a)("TOptOut")}function C(){return r||(r="https://acdn.adnxs.com/ast/static/0.30.1/ast.js")}},1377:function(e,t,n){"use strict";var r=Object.prototype;t.a=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},1385:function(e,t,n){"use strict";var r=n(724),a=n(546),i="[object AsyncFunction]",o="[object Function]",s="[object GeneratorFunction]",c="[object Proxy]";t.a=function(e){if(!Object(a.a)(e))return!1;var t=Object(r.a)(e);return t==o||t==s||t==i||t==c}},1393:function(e,t,n){"use strict";var r=9007199254740991;t.a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},1401:function(e,t,n){"use strict";var r=9007199254740991,a=/^(?:0|[1-9]\d*)$/;t.a=function(e,t){var n=typeof e;return!!(t=null==t?r:t)&&("number"==n||"symbol"!=n&&a.test(e))&&e>-1&&e%1==0&&e<t}},1406:function(e,t,n){"use strict";var r=Function.prototype.toString;t.a=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},1413:function(e,t,n){"use strict";var r=n(0),a=n(49),i=n(1414),o=n(1),s=n.n(o);function c(e,t){var n=function(t,n){return s.a.createElement(u,Object(r.__assign)({},t),s.a.createElement(e,Object(r.__assign)({},t)))};return n.displayName=e.displayName,t?s.a.forwardRef(n):n}var u=Object(a.a)((function(e){var t=e.lid,n=e.when,r=e.series,a=e.children,o=e.disposeOnUnmount,c=void 0===o||o;return s.a.useEffect((function(){return Object(i.b)(t,n,r),function(){c&&i.c.importAndExecute(t)}}),[]),a&&l(t)?s.a.createElement(s.a.Fragment,null,a):null}));function d(e,t){i.c.importAndExecute(e,t)}function l(e){if(i.d.unseenItems){var t=i.d.unseenItems.get(e);if(null==t?void 0:t.visible)return!0}return!1}function f(e){var t;return null===(t=i.d.unseenItems)||void 0===t?void 0:t.has(e)}n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return i.a}))},1414:function(e,t,n){"use strict";var r=n(77),a=n(1354),i=n(59),o=n(0),s=n(4),c=n(20),u=n(3),d=Object(u.mutatorAction)("initializeLightning",(function(e){var t,n;if(i.g.info("initialize lightning store"),Object(a.a)().lastShownId=null,Object(a.a)().lightedCount=0,Object(a.a)().unseenItems=new c.ObservableMap,e)try{for(var r=Object(o.__values)(e),s=r.next();!s.done;s=r.next()){var u=s.value;Object(a.a)().unseenItems.set(u.identity,u)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}));var l=n(321),f="ows/v1.0/lightning/items/unseen";function p(){return i.g.info("initialize lightning from server"),Object(l.b)(f).then((function(e){var t=e.map(b);d(t)}))}function b(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var g,h=n(30),m=n(83),v="lightning",C="UnseenLightening";function O(){var e,t,n;if(!g){var r=Object(s.a)(v);if(r)g=function(e){i.g.info("initialize lightning from override query parameter");var t=e.split(",").map((function(e){return{identity:e,visible:!1}}));return d(t),Promise.resolve()}(r);else{var a=Object(h.a)().PrimeSettings;if(Object(m.i)("lightning-initFromSD")&&a&&a.Items)try{for(var c=Object(o.__values)(a.Items),u=c.next();!u.done;u=c.next()){var l=u.value;if(l.Id===C&&l.Value){n=l.Value,i.g.info("initialize lightning from session data"),d(n.map((function(e){return{identity:e.id,visible:!1,category:e.category}}))),g=Promise.resolve();break}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}g||(g=p())}}return g}var y=n(1675),j=Object(u.action)("lightup",(function(e){return{id:e}})),A=j;Object(u.mutator)(j,(function(e){i.g.info("lightup - id:"+e.id),Object(a.a)().lastShownId=e.id,Object(a.a)().lightedCount++;var t=Object(a.a)().unseenItems.get(e.id);t&&(t.visible=!0)})),Object(u.orchestrator)(j,(function(e){Object(y.a)("LIGHTUP",e.id)}));var S,I=n(722);function x(e,t){(i.g.info("lightupOrReject - id:"+e+", recurrenceCount:"+t+", lightedCount:"+Object(a.a)().lightedCount+", lastShown:"+Object(a.a)().lastShownId),Object(I.v)())?i.g.info("lightning is disabled for deeplink"):Object(a.a)().unseenItems.has(e)&&(!Object(a.a)().lastShownId||function(e,t){var n=!1,r=Object(a.a)().lastShownId;if(r&&t&&!function(){var e=Object(a.a)(),t=e.lastShownId,n=e.unseenItems;return t&&n.has(t)&&n.get(t).visible}()){var i=t.indexOf(r),o=t.indexOf(e);i>=0&&i+1==o&&(n=!0)}return n}(e,t)||function(e){var t=Object(a.a)().unseenItems.get(e);return!!t&&t.category==S.UIFeatureDiscovery}(e)||function(e){var t=Object(a.a)().unseenItems.get(e);return!!t&&t.category==S.Compliance}(e))&&A(e)}function M(e,t,n){i.g.info("beginLightning - id:"+e),t((function(){O().then((function(){return x(e,n)})).catch((function(t){i.g.warn("something is wrong, lightning id:"+e+", reason:"+t)}))}))}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(S||(S={}));var w=n(1424);n.d(t,"c",(function(){return T})),n.d(t,"d",(function(){return a.b})),n.d(t,"b",(function(){return M})),n.d(t,"a",(function(){return w.a}));var k=new r.c((function(){return n.e(438).then(n.bind(null,16948))})),T=new r.a(k,(function(e){return e.endLightningImp}))},1420:function(e,t,n){"use strict";t.a=function(e){return e}},1424:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.UserVoiceSatisfactionFirstRun="0",e.UserVoiceSatisfactionSecondRun="1",e.ConsumerRefreshFRE="2",e.AnimatedConsumerRefreshFRE="3",e.AnimatedConsumerRefreshFRE2="4",e.SettingPanelFirstRunCallout="5",e.SettingIconFirstRunCallout="6",e.AddStorageAccountCallout="7",e.PremiumDomainConnectModal="8",e.WhatsNewFlexPane="10",e.FocusOtherOff="12",e.TargetedAdsGdprPrompt="13",e.WebPushPromotion="14",e.MailGraduatedNewFeatureCarousel="15",e.EdgePromotion="20",e.ActionableMessageTeachingUiTeachingBubblePolicy="21",e.GetStartedFlexPane="22",e.CalendarSurvey="23",e.MiniUserSurveyV1="25",e.TodoCalendarFRE="26",e.TodoMailFRE="27",e.GroupFilesHubFRE="28",e.AddCloudCacheAccountCallout="29",e.NewConsumerRecruitmentCampaign="30",e.InboxPlusFRE="31",e.BusinessCutoverCarousel="32",e.SuiteNps="33",e.InboxPlusEasyOn="34",e.InboxRulesFromDL="35",e.GdprAdsV2="36",e.TimePanelCombinedDndFRE="47",e.UaeEduPrivacyNotification="48",e.OutlookSpacesFRE="49",e.TodoFlaggedEmailList="50",e.DynamicLayoutFolderPaneCollapse="51",e.EdgeUpsell="56",e.OutlookSpacesCapturedPaneFRE="57",e.ProofingTeachingFreeUserFRE="58",e.ProofingTeachingPremiumUserFRE="59",e.OutlookSpacesNotePaneFRE="60",e.OutlookSpacesTasksPaneFRE="61",e.OutlookSpacesGoalsPaneFRE="62",e.DefaultOnlineMeetingSetting="63",e.QuickUseFRE="64",e.GdprAdsV3="65",e.SpeedyMeetingsEndEarlySetting="66",e.InboxPlusEasyOff="67",e.InsertLinkTeachingMomentOpenCompose="68",e.InsertLinkTeachingMomentAfterAttach="69",e.ShortenEventsDurationSetting="70",e.HoneybeeClipboard="71",e.AttachmentSaveToCloudOpenAndEdit="72",e.GdprAdsEPrivacy="73",e.AdminInstalledNewAddinsFRE="75",e.InsertLinkFREOpenCompose="76",e.InsertLinkFREAfterAttach="77",e.SpotlightFre="78",e.OverlayFolderPaneFre="79",e.SpotlightPropertyIcon="80"}(r||(r={}))},1426:function(e,t,n){"use strict";var r=n(1433);t.a=function(e,t,n){"__proto__"==t&&r.a?Object(r.a)(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},1433:function(e,t,n){"use strict";var r=n(1324),a=function(){try{var e=Object(r.a)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.a=a},1441:function(e,t,n){"use strict";var r=n(1511),a=n(1477),i=n(1334),o=n(1448),s=n(1401),c=n(1478),u=Object.prototype.hasOwnProperty;t.a=function(e,t){var n=Object(i.a)(e),d=!n&&Object(a.a)(e),l=!n&&!d&&Object(o.a)(e),f=!n&&!d&&!l&&Object(c.a)(e),p=n||d||l||f,b=p?Object(r.a)(e.length,String):[],g=b.length;for(var h in e)!t&&!u.call(e,h)||p&&("length"==h||l&&("offset"==h||"parent"==h)||f&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||Object(s.a)(h,g))||b.push(h);return b}},1442:function(e,t,n){"use strict";t.a=function(e,t){return function(n){return e(t(n))}}},1447:function(e,t,n){"use strict";var r=n(1441),a=n(1535),i=n(1358);t.a=function(e){return Object(i.a)(e)?Object(r.a)(e):Object(a.a)(e)}},1448:function(e,t,n){"use strict";(function(e){var r=n(618),a=n(1544),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===i?r.a.Buffer:void 0,c=(s?s.isBuffer:void 0)||a.a;t.a=c}).call(this,n(1360)(e))},1463:function(e,t,n){"use strict";t.a=function(e){return function(t){return e(t)}}},1477:function(e,t,n){"use strict";var r=n(724),a=n(725),i="[object Arguments]";var o=function(e){return Object(a.a)(e)&&Object(r.a)(e)==i},s=Object.prototype,c=s.hasOwnProperty,u=s.propertyIsEnumerable,d=o(function(){return arguments}())?o:function(e){return Object(a.a)(e)&&c.call(e,"callee")&&!u.call(e,"callee")};t.a=d},1478:function(e,t,n){"use strict";var r=n(724),a=n(1393),i=n(725),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1;var s=function(e){return Object(i.a)(e)&&Object(a.a)(e.length)&&!!o[Object(r.a)(e)]},c=n(1463),u=n(1487),d=u.a&&u.a.isTypedArray,l=d?Object(c.a)(d):s;t.a=l},1483:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=n(0).__assign},1487:function(e,t,n){"use strict";(function(e){var r=n(734),a="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=a&&"object"==typeof e&&e&&!e.nodeType&&e,o=i&&i.exports===a&&r.a.process,s=function(){try{var e=i&&i.require&&i.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(e){}}();t.a=s}).call(this,n(1360)(e))},15067:function(e){e.exports=JSON.parse('{"a":"Bcc"}')},15068:function(e,t,n){var r=n(15069),a=n(131);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},15069:function(e,t,n){(t=e.exports=n(130)(!1)).push([e.i,'._2pRM5MH2wQSL6KJYv7DZjH{width:calc(100% - 25px);position:absolute;height:calc(100% - 64px)}html[dir=ltr] ._2pRM5MH2wQSL6KJYv7DZjH{margin-left:-20px;margin-right:-35px}html[dir=rtl] ._2pRM5MH2wQSL6KJYv7DZjH{margin-right:-20px;margin-left:-35px}._36_sivvBA_3QDLOOHcFq0k{width:100%;height:100%}html[dir] ._36_sivvBA_3QDLOOHcFq0k{border-width:0}._3CW7BF2coKNui2HaKAh3Zw{font-size:21px;font-weight:100;font-weight:300;color:"[theme:neutralPrimary, default:#333333]"}',""]),t.locals={opayFlexPaneContainer:"_2pRM5MH2wQSL6KJYv7DZjH",opayAppIFrameStyle:"_36_sivvBA_3QDLOOHcFq0k",flexPaneHeader:"_3CW7BF2coKNui2HaKAh3Zw"}},15070:function(e){e.exports=JSON.parse('{"a":"ldc","c":"mdc","b":"ndc","g":"odc","f":"pdc","e":"qdc","d":"rdc","i":"sdc","j":"tdc","h":"udc"}')},15071:function(e){e.exports=JSON.parse('{"a":"idc","b":"jdc","c":"kdc"}')},15072:function(e){e.exports=JSON.parse('{"a":"hdc"}')},15076:function(e){e.exports=JSON.parse('{"d":"Dcc","c":"Ecc","a":"Fcc","b":"Gcc"}')},15077:function(e,t,n){(t=e.exports=n(130)(!1)).push([e.i,"html[dir] ._3uEvU5UAdRqP1z24N4hRkz{margin-top:12px}html[dir=ltr] ._3uEvU5UAdRqP1z24N4hRkz{margin-left:52px}html[dir=rtl] ._3uEvU5UAdRqP1z24N4hRkz{margin-right:52px}.cmC6MemIKYrJJ77Z_ZD4n{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}._3FcySUHYRo6OeOulzvvAzX{-ms-flex-item-align:center;align-self:center;height:16px;line-height:16px}html[dir] ._3FcySUHYRo6OeOulzvvAzX{margin-top:8px}._3FcySUHYRo6OeOulzvvAzX ._36SOH4LiYsn62sG0PC93OB{font-size:8px}",""]),t.locals={container:"_3uEvU5UAdRqP1z24N4hRkz",cardArea:"cmC6MemIKYrJJ77Z_ZD4n",bodyToggleButton:"_3FcySUHYRo6OeOulzvvAzX",icon:"_36SOH4LiYsn62sG0PC93OB"}},1511:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},1520:function(e,t,n){"use strict";var r=n(1426),a=n(1364),i=Object.prototype.hasOwnProperty;t.a=function(e,t,n){var o=e[t];i.call(e,t)&&Object(a.a)(o,n)&&(void 0!==n||t in e)||Object(r.a)(e,t,n)}},1535:function(e,t,n){"use strict";var r=n(1377),a=n(1442),i=Object(a.a)(Object.keys,Object),o=Object.prototype.hasOwnProperty;t.a=function(e){if(!Object(r.a)(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},1543:function(e,t,n){"use strict";var r=n(1420),a=n(1599),i=n(1597);t.a=function(e,t){return Object(i.a)(Object(a.a)(e,t,r.a),e+"")}},1544:function(e,t,n){"use strict";t.a=function(){return!1}},1593:function(e,t,n){"use strict";var r=n(1520),a=n(1426);t.a=function(e,t,n,i){var o=!n;n||(n={});for(var s=-1,c=t.length;++s<c;){var u=t[s],d=i?i(n[u],e[u],u,n,e):void 0;void 0===d&&(d=e[u]),o?Object(a.a)(n,u,d):Object(r.a)(n,u,d)}return n}},1597:function(e,t,n){"use strict";var r=function(e){return function(){return e}},a=n(1433),i=n(1420),o=a.a?function(e,t){return Object(a.a)(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i.a,s=800,c=16,u=Date.now;var d=function(e){var t=0,n=0;return function(){var r=u(),a=c-(r-n);if(n=r,a>0){if(++t>=s)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(o);t.a=d},1599:function(e,t,n){"use strict";var r=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},a=Math.max;t.a=function(e,t,n){return t=a(void 0===t?e.length-1:t,0),function(){for(var i=arguments,o=-1,s=a(i.length-t,0),c=Array(s);++o<s;)c[o]=i[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=i[o];return u[t]=n(c),r(e,this,u)}}},1617:function(e,t,n){"use strict";var r=n(1364),a=n(1358),i=n(1401),o=n(546);t.a=function(e,t,n){if(!Object(o.a)(n))return!1;var s=typeof t;return!!("number"==s?Object(a.a)(n)&&Object(i.a)(t,n.length):"string"==s&&t in n)&&Object(r.a)(n[t],e)}},1628:function(e,t,n){"use strict";var r=n(1520),a=n(1593),i=n(1885),o=n(1358),s=n(1377),c=n(1447),u=Object.prototype.hasOwnProperty,d=Object(i.a)((function(e,t){if(Object(s.a)(t)||Object(o.a)(t))Object(a.a)(t,Object(c.a)(t),e);else for(var n in t)u.call(t,n)&&Object(r.a)(e,n,t[n])}));t.a=d},1642:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(0),a=n(14),i=n(230),o={root:"ms-TeachingBubble",body:"ms-TeachingBubble-body",bodyContent:"ms-TeachingBubble-bodycontent",closeButton:"ms-TeachingBubble-closebutton",content:"ms-TeachingBubble-content",footer:"ms-TeachingBubble-footer",header:"ms-TeachingBubble-header",headerIsCondensed:"ms-TeachingBubble-header--condensed",headerIsSmall:"ms-TeachingBubble-header--small",headerIsLarge:"ms-TeachingBubble-header--large",headline:"ms-TeachingBubble-headline",image:"ms-TeachingBubble-image",primaryButton:"ms-TeachingBubble-primaryButton",secondaryButton:"ms-TeachingBubble-secondaryButton",subText:"ms-TeachingBubble-subText",button:"ms-Button",buttonLabel:"ms-Button-label"},s=Object(i.c)((function(){return Object(a.keyframes)({"0%":{opacity:0,animationTimingFunction:a.AnimationVariables.easeFunction1,transform:"scale3d(.90,.90,.90)"},"100%":{opacity:1,transform:"scale3d(1,1,1)"}})})),c=function(e,t){var n=t||{},r=n.calloutWidth,a=n.calloutMaxWidth;return[{display:"block",maxWidth:364,border:0,outline:"transparent",width:r||"calc(100% + 1px)",animationName:""+s(),animationDuration:"300ms",animationTimingFunction:"linear",animationFillMode:"both"},e&&{maxWidth:a||456}]},u=function(e,t,n){return t?[e.headerIsCondensed,{marginBottom:14}]:[n&&e.headerIsSmall,!n&&e.headerIsLarge,{selectors:{":not(:last-child)":{marginBottom:14}}}]},d=function(e){var t,n,i,s=e.hasCondensedHeadline,d=e.hasSmallHeadline,l=e.hasCloseButton,f=e.hasHeadline,p=e.isWide,b=e.primaryButtonClassName,g=e.secondaryButtonClassName,h=e.theme,m=e.calloutProps,v=void 0===m?{className:void 0,theme:h}:m,C=!s&&!d,O=h.palette,y=h.semanticColors,j=h.fonts,A=Object(a.getGlobalClassNames)(o,h);return{root:[A.root,j.medium,v.className],body:[A.body,l&&!f&&{marginRight:24},{selectors:{":not(:last-child)":{marginBottom:20}}}],bodyContent:[A.bodyContent,{padding:"20px 24px 20px 24px"}],closeButton:[A.closeButton,{position:"absolute",right:0,top:0,margin:"15px 15px 0 0",borderRadius:0,color:O.white,fontSize:j.small.fontSize,selectors:{":hover":{background:O.themeDarkAlt,color:O.white},":active":{background:O.themeDark,color:O.white},":focus":{border:"1px solid "+y.variantBorder}}}],content:Object(r.__spreadArrays)([A.content],c(p),[p&&{display:"flex"}]),footer:[A.footer,{display:"flex",flex:"auto",alignItems:"center",color:O.white,selectors:(t={},t["."+A.button+":not(:first-child)"]={marginLeft:10},t)}],header:Object(r.__spreadArrays)([A.header],u(A,s,d),[l&&{marginRight:24},(s||d)&&[j.medium,{fontWeight:a.FontWeights.semibold}]]),headline:[A.headline,{margin:0,color:O.white,fontWeight:a.FontWeights.semibold},C&&[{fontSize:j.xLarge.fontSize}]],imageContent:[A.header,A.image,p&&{display:"flex",alignItems:"center",maxWidth:154}],primaryButton:[A.primaryButton,b,{backgroundColor:O.white,borderColor:O.white,color:O.themePrimary,whiteSpace:"nowrap",selectors:(n={},n["."+A.buttonLabel]=j.medium,n[":hover"]={backgroundColor:O.themeLighter,borderColor:O.themeLighter,color:O.themePrimary},n[":focus"]={backgroundColor:O.themeLighter,borderColor:O.white},n[":active"]={backgroundColor:O.white,borderColor:O.white,color:O.themePrimary},n)}],secondaryButton:[A.secondaryButton,g,{backgroundColor:O.themePrimary,borderColor:O.white,whiteSpace:"nowrap",selectors:(i={},i["."+A.buttonLabel]=[j.medium,{color:O.white}],i["&:hover, &:focus"]={backgroundColor:O.themeDarkAlt,borderColor:O.white},i[":active"]={backgroundColor:O.themePrimary,borderColor:O.white},i)}],subText:[A.subText,{margin:0,fontSize:j.medium.fontSize,color:O.white,fontWeight:a.FontWeights.regular}],subComponentStyles:{callout:{root:Object(r.__spreadArrays)(c(p,v),[j.medium]),beak:[{background:O.themePrimary}],calloutMain:[{background:O.themePrimary}]}}}}},1656:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));var r=n(0),a=n(1),i=n(352),o=n(230),s=n(188),c=n(1483);function u(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=e;return o.isSlot?0===(n=a.Children.toArray(n)).length?o(t):o(Object(r.__assign)(Object(r.__assign)({},t),{children:n})):a.createElement.apply(a,Object(r.__spreadArrays)([e,t],n))}function d(e,t){void 0===t&&(t={});var n=t.defaultProp,o=void 0===n?"children":n;return function(t,n,u,d,l){if(a.isValidElement(n))return n;var f=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];for(var a={},o=[],u=0,d=n;u<d.length;u++){var l=d[u];o.push(l&&l.className),Object(c.a)(a,l)}return a.className=Object(i.a)([e,o],{rtl:Object(s.a)(t)}),a}(d,l,t,function(e,t){var n,r;"string"==typeof t||"number"==typeof t||"boolean"==typeof t?((n={})[e]=t,r=n):r=t;return r}(o,n));if(u){if(u.component){var p=u.component;return a.createElement(p,Object(r.__assign)({},f))}if(u.render)return u.render(f,e)}return a.createElement(e,Object(r.__assign)({},f))}}var l=Object(o.c)((function(e){return d(e)}));function f(e,t){var n={},r=e,a=function(e){if(t.hasOwnProperty(e)){var a=function(n){for(var a=[],i=1;i<arguments.length;i++)a[i-1]=arguments[i];if(a.length>0)throw new Error("Any module using getSlots must use withSlots. Please see withSlots javadoc for more info.");return p(t[e],n,r[e],r.slots&&r.slots[e],r._defaultStyles&&r._defaultStyles[e],r.theme)};a.isSlot=!0,n[e]=a}};for(var i in t)a(i);return n}function p(e,t,n,r,a,i){return void 0!==e.create?e.create(t,n,r,a):l(e)(t,n,r,a,i)}},16608:function(e,t,n){"use strict";n.r(t);var r=n(4023),a=n(59),i=n(5148),o="CardLinkInteraction";function s(e,t,n,s){a.g.info("[logAdaptiveCardLinkInteraction] Log event captured for link interaction on an adaptive card");var c=Object(r.e)(n);n.card&&c?i.c.logTelemetry({cardDetails:n,eventName:o+"_"+c,messageContext:s}):a.g.warn("[ActionableMessageDebug] logAdaptiveCardLinkInteraction: Cannot log link interaction - message card context is undefined")}var c=n(0),u="00000000-0000-0000-0000-000000000000",d="Highlight_";function l(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o,s,d,l,p,b;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:try{t=JSON.parse(e)}catch(t){throw new Error("[ActionableMessageCard] parseCardProperty: unable to parse card data: "+e)}return n={connectorSenderGuid:t.ConnectorSenderGuid?t.ConnectorSenderGuid:u,smtpAddressesSerialized:t.SmtpAddressesSerialized,providerAccountUniqueId:t.ProviderAccountUniqueId,messageCardExtensionContext:t.MessageCardExtensionContext},i=[],t.AdaptiveCardSerialized?(s=(o=i).push,[4,r.f.import().then((function(e){return e(n,t.AdaptiveCardSerialized,t.AdaptiveCardSignature,!0)}))]):[3,2];case 1:return s.apply(o,[c.sent()]),[3,5];case 2:return t.MessageCardSerialized?(l=(d=i).push,[4,r.f.import().then((function(e){return e(n,t.MessageCardSerialized,t.MessageCardSignature,!1)}))]):[3,4];case 3:return l.apply(d,[c.sent()]),[3,5];case 4:return a.g.info("[ActionableMessageCard] parseCardProperty: No serialized card present"),[2,[]];case 5:return b=(p=i).concat,[4,f(t,n)];case 6:return[2,b.apply(p,[c.sent()])]}}))}))}function f(e,t){return Object(c.__awaiter)(this,void 0,void 0,(function(){var n,i=this;return Object(c.__generator)(this,(function(o){switch(o.label){case 0:return n=[],[4,Promise.all(Object.keys(e).map((function(o){return Object(c.__awaiter)(i,void 0,void 0,(function(){var i,s,u,l;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:if(!e.hasOwnProperty(o)||0!==o.indexOf(d))return[3,4];i=e[o],c.label=1;case 1:return c.trys.push([1,3,,4]),s=JSON.parse(i),[4,r.f.import().then((function(e){return e(t,s.card,null)}))];case 2:return(u=c.sent()).isContextual=!0,u.key=s.id,u.highlightTerm=s.text,n.push(u),[3,4];case 3:return l=c.sent(),a.g.warn("[ActionableMessageDebug] RenderCard: unable to render hightlight card: "+l.message),[3,4];case 4:return[2]}}))}))})))];case 1:return o.sent(),[2,n]}}))}))}var p=n(1444),b=n(2589),g=n(622),h=n(319),m="IOpenTypedFacet.Com.Microsoft.Graph.MessageCard",v="E550B918-9859-47B9-8095-97E4E72F1926";function C(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(c.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),t=Object(g.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(h.a)(v,m,"String")]}),[4,Object(p.a)(e.ItemId.Id,t)];case 1:return!(n=i.sent())||n instanceof Error?[3,3]:(r=Object(b.a)(n,null,m))?[4,l(r)]:[3,3];case 2:return[2,i.sent()];case 3:return[3,5];case 4:return i.sent(),[3,5];case 5:return a.g.info("[loadCardDetailsForItem] extendedProperty could not be retrieved"),[2,null]}}))}))}function O(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){return Object(c.__generator)(this,(function(t){switch(t.label){case 0:return e.adaptiveCardDetails?[2,e.adaptiveCardDetails]:[4,C(e)];case 1:return[2,t.sent()||[]]}}))}))}var y,j,A=n(1),S=n(49),I=n(269),x=n(9),M=n(83),w=n(2994),k=n(1650),T=function(e){function t(t){var n=e.call(this)||this;return n.preserveBody=t,n}return Object(c.__extends)(t,e),t.prototype.internalPrepareForExecution=function(t){var n=this.body;e.prototype.internalPrepareForExecution.call(this,t),this.preserveBody&&(this.body=n)},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary},t}(k.HttpAction),D=n(15067),_=n(3);!function(e){e[e.UnResolved=0]="UnResolved",e[e.InProgress=1]="InProgress",e[e.Resolved=2]="Resolved"}(y||(y={})),function(e){e[e.Empty=0]="Empty",e[e.Success=1]="Success",e[e.Error=2]="Error"}(j||(j={}));var E={cache:{data:null,state:j.Empty,time:null},requestState:y.UnResolved},P=Object(_.createStore)("amClientConfigurationStore",E)(),R=function(){var e,t,n=null;return(null===(t=null===(e=P.cache.data)||void 0===e?void 0:e.clientTimeouts)||void 0===t?void 0:t.default)&&(n=P.cache.data.clientTimeouts.default),n},N=n(12),B=n(10310),F=n(10311),L=n(43),U=n(73),H=n(30),z=function(e,t,n,r,a){var o=e["@id"]?e["@id"]:e.id,s={"@type":"HttpPOST",name:e.title,target:e.url,body:e.body,"@id":o,hideCardOnInvoke:e.hideCardOnInvoke,isPrimaryAction:!!e.isPrimary&&e.isPrimary};e.headers&&e.headers.length>0&&(s.headers=e.headers);var u=Object(H.a)(),d=[];if(t)for(var l=0;l<t.length;l++){var f=t[l],p=new k.ValidationResults;if(f.internalValidateProperties(p),p.failures.length>0)return Promise.resolve({success:!1,displayMessage:p.failures[0].errors[0].message});if(f){var b=void 0;b=f instanceof k.DateInput?{id:f.id,value:f.value,usertimezone:u.UserOptions.TimeZone}:{id:f.id,value:f.value},d.push(b)}}var g,h={type:k.HttpAction.JsonTypeName,url:e.url,body:e.body,method:e.method,id:e.id?e.id:"30d2f5e2-6e6f-43b0-a2bd-c9d87a5cd6fd",headers:e.headers},m=u.SessionSettings.UserCulture,v={type:e.getJsonTypeName(),id:e.id},C={eventName:J(e,a),messageContext:r,cardDetails:n,elementDetails:v,actionContext:e.actionContext},O=Object(i.b)(C);if(O.messageCardContext)try{O.messageCardContext=JSON.parse(O.messageCardContext)}catch(e){}if(O.messageCardExtensionContext)try{O.messageCardExtensionContext=JSON.parse(O.messageCardExtensionContext)}catch(e){}if(O.actionContext)try{O.actionContext=JSON.parse(O.actionContext)}catch(e){}return n.isAdaptiveCard?g={httpAction:h,inputParameters:d,connectorSenderGuid:n.connectorSenderGuid,SmtpAddressesSerialized:n.smtpAddressesSerialized,adaptiveCardSignature:n.cardSignature,providerAccountUniqueId:n.providerAccountUniqueId,clientTelemetry:O,adaptiveCardHash:n.cardHash,senderAddress:r.senderAddress}:(s=Object(c.__assign)(Object(c.__assign)({},e.originalJsonPayload),s),g={inputParameters:d,connectorSenderGuid:n.connectorSenderGuid,potentialAction:JSON.stringify(s),SmtpAddressesSerialized:n.smtpAddressesSerialized,messageCardSignature:n.cardSignature,providerAccountUniqueId:n.providerAccountUniqueId,clientTelemetry:O,tenantObjectId:u.SessionSettings.ExternalDirectoryTenantGuid,messageCardHash:n.cardHash,senderAddress:r.senderAddress,culture:m,uiCulture:m}),q(W(r,m,n.isAdaptiveCard),JSON.stringify(g),"HttpAction",null,Q(n),a)},J=function(e,t){return t?"AutoInvokeActionClicked":e.parent&&"InlineAdaptiveCard"===e.parent.constructor.name?"ActionCardHttpPostActionClicked":"SingleClickHttpPostActionClicked"},W=function(e,t,n){var r="UserMailbox"===e.mailboxInfo.type?"userid":e.mailboxInfo.mailboxSmtpAddress,a=e.odataItemId,i=e.odataConversationId;switch(e.mailboxInfo.type){case"UserMailbox":return n?Object(N.c)("/actions/{0}/messages/{1}/adaptiveCard/executeAction?culture={2}",r,a,t):Object(N.c)("/actions/{0}/messages/{1}/executeAction?culture={2}",r,a,t);case"GroupMailbox":case"TeamsMailbox":return n?Object(N.c)("/actions/{0}/threads/{1}/posts/{2}/adaptiveCard/executeAction?culture={3}",r,i,a,t):Object(N.c)("/actions/{0}/threads/{1}/posts/{2}/executeAction?culture={3}",r,i,a,t);case"PublicMailbox":case"SharedMailbox":case"ArchiveMailbox":return null}},q=function(e,t,n,r,i,o){return void 0===o&&(o=!1),Object(c.__awaiter)(void 0,void 0,void 0,(function(){var s,u,d,l;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:s=r||Object(U.b)(),u={correlationVector:s,cardCorrelationId:i,requestType:n},c.label=1;case 1:return c.trys.push([1,5,,6]),[4,Object(w.a)()];case 2:return(d=c.sent())?[3,4]:(a.g.warn("[ActionableMessageDebug] makePostRequest: Unable to get the client Auth token possibly AAD token"),[4,Object(w.b)()]);case 3:d=c.sent(),c.label=4;case 4:if(!d)throw new Error("Token is empty: "+d);return[3,6];case 5:return l=c.sent(),a.g.warn("[ActionableMessageDebug] makePostRequest: Error while getting token, error: "+l),Object(I.n)("ActionableMessageConnectorsPostRequestErrorGettingToken",void 0,void 0,l,u,{isCore:!0}),[2,{success:!1,displayMessage:Object(N.b)(D.a)}];case 6:return[4,G(e,d,t,o,s,u)];case 7:return[2,c.sent()]}}))}))},G=function(e,t,n,r,a,i){return new Promise((function(o){var s=new XMLHttpRequest;s.onreadystatechange=function(){4===s.readyState&&o(V(200===s.status,s.responseText))},s.ontimeout=function(){o({success:!1,displayMessage:Object(N.b)(D.a)}),Object(I.n)("ActionableMessageConnectorsPostRequestTimeout",void 0,void 0,void 0,i,{isCore:!0})},s.open("POST",e,!0),s.timeout=function(e){var t=e?6e3:1e4,n=R();return e&&(null==n?void 0:n.AutoInvokedActionTimeoutInMsec)?t=n.AutoInvokedActionTimeoutInMsec:!e&&(null==n?void 0:n.HttpActionTimeoutInMsec)&&(t=n.HttpActionTimeoutInMsec),t}(r),s.setRequestHeader("MS-CV",a),s.setRequestHeader("X-OWA-CANARY",Object(L.a)()),s.setRequestHeader("Authorization","Bearer "+t),s.send(n)}))},V=function(e,t){try{var n=JSON.parse(t),r=!!e&&Y(n.status);return{success:r,status:n.status,displayMessage:n.displayMessage?n.displayMessage:r?Object(N.b)(F.a):Object(N.b)(B.a),performedAt:n.performedAt,newCardPayload:n.refreshCardSerialized,newCardSignature:n.refreshCardSignature,removeCard:n.removeCard,showOriginalCard:n.showOriginalCard,hideCard:n.hideCard,authenticationUrl:n.authenticationUrl,cardUpdates:n.cardUpdates,errors:n.errors}}catch(e){return{success:!1,displayMessage:Object(N.b)(B.a)}}},Y=function(e){return e&&"completed"===e.toLowerCase()},Q=function(e){try{return e.card.messageCardContext.correlationId}catch(e){return""}};function K(e){var t=new T(!0);return t.method="POST",t.body=e.body,t.title=e.name,t.originalJsonPayload=e,e.headers&&e.headers.length>0&&(t.headers=[],e.headers.forEach((function(e){t.headers.push(new k.HttpHeader(e.name,e.value))}))),t.url=e.target,t["@id"]=e["@id"],t.hideCardOnInvoke=e.hideCardOnInvoke,t}var Z="HttpPOST";var $=n(320);var X=window.location.origin+"/actions/theme";function ee(e){return void 0===e&&(e="default"),Object(c.__awaiter)(this,void 0,void 0,(function(){var t,n,r,a,o,s;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:return[4,Object(w.b)()];case 1:t=c.sent(),n=function(e,t){var n={},r=Object(i.a)();return r=r.replace(/[^\d]/g,""),n.method="GET",n.headers=new Headers,n.headers.set("X-ClientType","owa"),n.headers.set("X-ClientVersion","16."+r.substr(0,4)+"."+r.substr(4,4)+"."+r.substr(8)),n.headers.set("X-ClientColorScheme",t),n.headers.set("Authorization","Bearer "+e),n}(t,e),r=void 0,c.label=2;case 2:return c.trys.push([2,7,,8]),[4,fetch(X,n)];case 3:return(a=c.sent())&&200==a.status?(o=te,[4,a.text()]):[3,5];case 4:return[2,o.apply(void 0,[c.sent()])];case 5:r=a?a.status+"-"+a.statusText:"No response",c.label=6;case 6:return[3,8];case 7:return s=c.sent(),r=s.message,[3,8];case 8:throw r}}))}))}function te(e){var t={};try{var n=JSON.parse(e).connectors;Object.keys(n).forEach((function(e){var r={themeConfigUrl:n[e],hostConfig:null,stylesheetUrl:null,isResolved:!1};t[e]=r}))}catch(e){a.g.warn("[ActionableMessageDebug] downloadThemeDefinition: error parsing response: "+e)}return t}var ne=n(8),re=function(){return!!Object(ne.c)(window)&&!!Object(ne.a)(window,"ActionableMessages.ClientConfiguration")},ae=function(){return P.cache.state!==j.Empty},ie=function(){var e,t,n,r=Date.now()-P.cache.time;return P.cache.state===j.Success&&r>=432e6||P.cache.state===j.Error&&r>=864e5||(n=null===(t=null===(e=P.cache.data)||void 0===e?void 0:e.themeMappings)||void 0===t?void 0:t.connectors,Object(M.i)("rp-actionableMessagesThemeConfig")&&P.cache.state===j.Success&&null===n)},oe=Object(_.mutatorAction)("updateRequestState",(function(e){P.requestState=e})),se=n(295),ce=function(){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r;return Object(c.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,6,,7]),e="/actions/v1.0/"+Object(se.c)()+"/clientConfigs/WAC_Outlook_React?clientVersion="+Object(i.a)()+"&clientColorScheme=default&$expand=providerConfigs",[4,Object(c.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(c.__generator)(this,(function(n){switch(n.label){case 0:return e=new Headers,[4,Object(w.a)()];case 1:return t=n.sent(),e.set("Authorization",function(e){return"Bearer "+e}(t)),e.set("MS-CV",Object(U.b)()),[2,e]}}))}))];case 1:return t=a.sent(),n=new Request(e,{method:"GET",headers:t}),[4,fetch(n)];case 2:return(r=a.sent()).ok?[4,r.json()]:[3,4];case 3:return[2,a.sent()];case 4:throw r;case 5:return[3,7];case 6:throw a.sent();case 7:return[2]}}))}))},ue=Object(_.mutatorAction)("setClientConfiguration",(function(e){P.cache=e})),de=function(){return P.cache},le=function(e){var t,n,r,a;void 0===e&&(e=!1);var i,o=de();if(i=e?null===(n=null===(t=null==o?void 0:o.data)||void 0===t?void 0:t.themeMappingsDarkMode)||void 0===n?void 0:n.connectors:null===(a=null===(r=null==o?void 0:o.data)||void 0===r?void 0:r.themeMappings)||void 0===a?void 0:a.connectors){var s={};return Object.keys(i).forEach((function(e){var t={themeConfigUrl:i[e],hostConfig:null,stylesheetUrl:null,isResolved:!1};s[e]=t})),s}return null},fe=function(e,t){void 0===t&&(t=null);var n={data:t,state:e,time:Date.now()};if(null===t){var r=de();n.data=r.data}return n},pe=Object(_.action)("loadClientConfiguration");Object(_.orchestrator)(pe,(function(){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return Object(c.__generator)(this,(function(i){switch(i.label){case 0:oe(y.InProgress),e=null,i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,ce()];case 2:return t=i.sent(),e=fe(j.Success,t),[3,5];case 3:return i.sent(),e=fe(j.Error),[3,5];case 4:return ue(e),function(e){if(Object(ne.c)(window))try{Object(ne.e)(window,"ActionableMessages.ClientConfiguration",JSON.stringify(e))}catch(e){a.g.info("[ActionableMessageDebug] owa-actionable-message-connectors loadClientConfiguration setClientConfigurationInLocalStorage Exception on setItem|JSON.stringify "+e.toString())}}(e),oe(y.Resolved),Object(M.i)("rp-actionableMessagesThemeConfig")&&(n=le(),Object(r.g)(n)),[7];case 5:return[2]}}))}))}));var be=pe,ge=function(){P.requestState!==y.InProgress&&be()},he=function(){return re()?JSON.parse(Object(ne.a)(window,"ActionableMessages.ClientConfiguration")):null},me=function(){return null!==de().data},ve=function(){if(ae())return ie()&&ge(),me();if(re()){if(ue(he()),oe(y.Resolved),ie()&&ge(),Object(M.i)("rp-actionableMessagesThemeConfig")){var e=le();Object(r.g)(e)}return me()}return ge(),!1},Ce=function(){var e,t,n=!1;if(ve()){var r=de();(null===(t=null===(e=null==r?void 0:r.data)||void 0===e?void 0:e.organizationConfigs)||void 0===t?void 0:t.SmtpActionableMessagesEnabled)&&(n=!0)}return n},Oe=function(e,t){var n,r,a=!1;try{for(var i=Object(c.__values)(e),o=i.next();!o.done;o=i.next()){if(o.value.originator===t){a=!0;break}}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},ye=function(e,t){var n,r,a=!1;if(ve()){var i=de();!t&&(null===(n=null==i?void 0:i.data)||void 0===n?void 0:n.providerConfigs)?a=Oe(i.data.providerConfigs,e):t&&(null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.providerConfigsDarkMode)&&(a=Oe(i.data.providerConfigsDarkMode,e))}return a},je="data:",Ae="blob:";function Se(e,t){var n=e.querySelectorAll('img:not([src^="cid:"])');if(n)for(var r=0;r<n.length;r++)0!==n[r].src.indexOf(je)&&0!==n[r].src.indexOf(Ae)&&Ie(n[r],t.mailboxSmtpAddress)}function Ie(e,t){return Object(c.__awaiter)(this,void 0,void 0,(function(){var n;return Object(c.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(w.b)()];case 1:return r.sent(),e.src="/actions/"+t+"/th?u="+encodeURIComponent(e.src),[3,3];case 2:return n=r.sent(),a.g.warn("[ActionableMessageDebug] fixSrcForExternalImage: Error setting src value. Exception: "+n.message),[3,3];case 3:return[2]}}))}))}var xe=function(e){return["https://outlook.office365.com","https://outlook.office.com","https://outlook-sdf.office.com","https://outlook-sdf.office365.com","https://emea.mail.microsoft.com","https://outlook-sdf.live.com","https://outlook.live.com"].includes(e)},Me=function(){var e,t,n,r=null;return(null===(n=null===(t=null===(e=P.cache.data)||void 0===e?void 0:e.clientTimeouts)||void 0===t?void 0:t.default)||void 0===n?void 0:n.SnackBarTimeoutInMsec)&&(r=P.cache.data.clientTimeouts.default.SnackBarTimeoutInMsec),null!==r?r:8e3},we={registerActions:function(){k.AdaptiveCard.actionTypeRegistry.unregisterType(k.SubmitAction.JsonTypeName),k.AdaptiveCard.actionTypeRegistry.registerType(k.HttpAction.JsonTypeName,(function(){return new T(!1)}))},executeAction:function(e,t,n,r,i,o,s){return e instanceof T&&(z(e,n,t,i,s).then((function(e){a.g.info("[ActionableMessageDebug] onExecuteAction: executeHttpAction response: "+e),r(e)})),!0)},parseLegacyMessageCardAction:function(e,t){switch(e["@type"]){case"HttpPOST":return K(e)}return null},processAutoInvokeAction:function(e,t){if(e.type===k.HttpAction.JsonTypeName||e["@type"]===Z){var n=void 0;return t.isAdaptiveCard?((n=new T(!1)).parse(e),n.hideCardOnInvoke=e.hideCardOnInvoke):n=K(e),n}return null},registerHostCapabilities:function(e){Object(M.i)("rp-actionableMessages-aad-token")&&!Object($.a)()&&(e.AADAuthentication="*")}},ke="TransactionCardDisabled",Te="messageCardContext";function De(e,t,n,a,i){var o=e.card;if(o&&o.hasOwnProperty(Te)){if(!o.messageCardContext)return!1;var s=Object(r.e)(e)===r.c.XeroOpay&&n;return s&&i.logTelemetry({messageContext:a,eventName:ke,cardDetails:e}),s}return!1}var _e="Action.Transaction",Ee=n(1961),Pe=n(2370),Re=n(15068),Ne={PPE:"https://interactive-ppe.outlook.com/ux/app",PROD:"https://interactive.outlook.com/ux/app",DEV:"https://opay-dev-wc-svc.cloudapp.net/ux/app"},Be=function(e){function t(){var t=e.call(this)||this;return t.environment="prod",t.triggerContext=null,t.intent="",t.merchantId="",t.displayId="",t}return Object(c.__extends)(t,e),t.prototype.getJsonTypeName=function(){return _e},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,t.initializationContext?(this.intent=t.initializationContext.intent,this.merchantId=t.initializationContext.merchantId,this.displayId=t.initializationContext.displayId,this.productContext=t.initializationContext.productContext,this.environment=t.initializationContext.environment):(this.intent=t.intent,this.merchantId=t.merchantId,this.displayId=t.displayId,this.productContext=t.productContext,this.environment=t.environment),this.triggerContext={MerchantId:this.merchantId,DisplayId:this.displayId,CorrelationId:Object(U.b)(),Culture:Object(H.a)().SessionSettings.UserCulture,Market:Object(Ee.g)(),Environment:this.environment},Pe.set("DefaultAnchorMailbox",Pe.get("DefaultAnchorMailbox"),{path:"/actions/"}),Object(M.i)("ring-dogfood")&&Pe.set("DefaultAnchorMailbox",Pe.get("DefaultAnchorMailbox"),{path:"/opay/"})},t.prototype.execute=function(){e.prototype.execute.call(this),this.triggerContext.CorrelationId=Object(U.b)()},t.prototype.getIFrameElement=function(){var e=Object(M.i)("rp-opay-modelb-endpoint")?window.location.origin+"/opay":this.getSvcEndpoint(),t=encodeURIComponent(JSON.stringify(this.productContext)),n=e+"/?triggerContext="+encodeURIComponent(JSON.stringify(this.triggerContext))+"&productContext="+t;return A.createElement("div",{className:Re.opayFlexPaneContainer},A.createElement("iframe",{id:"opay_iframe",className:Re.opayAppIFrameStyle,src:n}))},t.prototype.getSvcEndpoint=function(){return this.environment?0===this.environment.indexOf("dev")?Ne.DEV:"ppe"===this.environment.toLowerCase()?Ne.PPE:Ne.PROD:Ne.PROD},t}(k.Action),Fe={shouldShowModalFlexPane:!1,modalFlexPaneContent:void 0},Le=Object(_.createStore)("OPayPanel",Fe)(),Ue=Object(_.mutatorAction)("SHOW_OPAY_PANEL",(function(e){Le.shouldShowModalFlexPane=!0,Le.modalFlexPaneContent=e})),He="TransactionActionEvent",ze="actionContext";var Je={registerActions:function(){k.AdaptiveCard.actionTypeRegistry.registerType(_e,(function(){return new Be}))},executeAction:function(e,t,n,r,i,o,s){if(!(e instanceof Be))return!1;a.g.info("[ActionableMessageDebug] Transaction executed");var c=e,u={id:c.id,type:c.getJsonTypeName()};return o.logTelemetry({cardDetails:t,elementDetails:u,eventName:He,actionContext:e[ze],messageContext:i}),Ue(c.getIFrameElement()),!0},parseLegacyMessageCardAction:function(e,t){switch(e["@type"]){case"Transaction":return n=e,(r=new Be).parse(n),r.title=n.name,r}var n,r;return null},registerHostCapabilities:function(e){e.Transaction="*",e["Transaction.MSA"]="*"}},We=n(3191),qe=n(1280),Ge=n(339),Ve=n(1585),Ye=Object(_.mutatorAction)("HIDE_OPAY_PANEL",(function(){Le.shouldShowModalFlexPane=!1,Le.modalFlexPaneContent=void 0})),Qe=Object(S.a)((function(e){return Object(Ve.a)("message",(function(t){var n=t.origin.toLowerCase();if(Object.keys(Ne).some((function(e){return 0!==Ne[e].indexOf(n)}))){var r=null;try{r=JSON.parse(t.data)}catch(e){a.g.warn("Unable to parse post message data: "+t.data)}if(r){var i=r.action;if(i)switch(i){case"close":Ye();break;case"token":Object(w.a)().then((function(t){var r=document.querySelector("#opay_iframe");r&&r.contentWindow.postMessage(JSON.stringify({action:"token",token:t,messageContext:{messageId:e.odataItemId,smtpAddressesSerialized:e.smtpAddressesSerialized},result:"Success"}),n)})).catch((function(){window.postMessage(JSON.stringify({action:"token",result:"Failed"}),n)}))}}}})),A.createElement(qe.a,{key:"modalFlexPane",onDismiss:function(){Ye()},isOpen:Le.shouldShowModalFlexPane,type:Ge.a.smallFixedFar,closeButtonAriaLabel:Object(N.b)(We.a)},Le.modalFlexPaneContent)})),Ke=Object(_.mutatorAction)("addCardDetailsOnItem",(function(e,t){e.adaptiveCardDetails&&e.adaptiveCardDetails.length>0?a.g.info("[ActionableMessageDebug] addCardDetailsOnItem - item already has a card details"+e.adaptiveCardDetails):e.adaptiveCardDetails=t})),Ze=Object(_.mutatorAction)("updateCardDetailsOnItem",(function(e,t){e.adaptiveCardDetails=t})),$e=Object(_.mutatorAction)("SET_SHOW_BODY_WITH_MESSAGE_CARD",(function(e,t){e?e.showBodyWithMessageCard=t:a.g.warn("[ActionableMessageDebug] setShowBodyWithMessageCard: viewState undefined")})),Xe=Object(_.action)("showCardLoading",(function(e,t){return{viewState:e,showCardLoading:t}})),et=(Object(_.mutator)(Xe,(function(e){e.viewState.showCardLoading=e.showCardLoading})),n(2247)),tt=n(1363),nt=n(8511),rt=/url\("(.*)"\)/g,at=new nt.a(5,5e3),it=function(e,t,n){var r=e.querySelectorAll('img[src^="cid:"]');if(r)for(var a=0;a<r.length;a++)ot(r[a],t,n);var i=e.querySelectorAll("div[style*='background-image: url(\"cid:']");if(i)for(a=0;a<i.length;a++)ct(i[a],t,n)},ot=function(e,t,n){if(e.src&&0===e.src.indexOf("cid:")){e.classList.add("ac-hidden");var r=ut(e.src,t,n);if(r){e.onload=function(t){e.classList.remove("ac-hidden"),at.processNextRequest()},e.onerror=function(t){var n=t.target;0===n.src.indexOf("cid:")?a.g.info("[ActionableMessageDebug] imageSrcChangePending: image src has not been changed for cid: "+n.src):(e.classList.remove("ac-hidden"),at.processNextRequest(),a.g.info("[ActionableMessageDebug] imageSrcError: image cannot be loaded for src: "+n.src))},at.registerCallback((function(t){t||(e.src=r)}))}}},st=function(){at.clearQueue()},ct=function(e,t,n){var r=e.style.backgroundImage,a=rt.exec(r);if(a&&a.length>1&&a[1]){var i=ut(a[1],t,n);i&&(e.style.backgroundImage=Object(N.c)('url("{0}")',i))}},ut=function(e,t,n){if(!t.Attachments)return null;for(var r,i=dt(e.substring("cid:".length)),o=0;o<t.Attachments.length;o++){var s=t.Attachments[o];if(i===dt(s.Name)||i===dt(s.ContentId)){r=s.AttachmentId;break}}if(!r)return a.g.warn("[ActionableMessageDebug] fixSrcForImage: attachment id not found for cid: "+i),null;var u=Object(et.b)(Object(c.__assign)(Object(c.__assign)({},r),{mailboxInfo:n}),1);return u||(a.g.warn("[ActionableMessageDebug] fixSrcForImage: could not create attachment url for image with cid: "+i+" and attachment id: "+r),null)},dt=function(e){if(Object(tt.g)(e)){var t=Object(tt.b)(e);return e.substring(0,e.length-t.length)}return e},lt=n(6898),ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getJsonTypeName=function(){return"DisplayAppointmentForm"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.itemId=t.itemId,this.isPrimary=t.isPrimary},t}(k.Action),pt="Action.InvokeAddInCommand",bt="Action.PinAddInCommand",gt="Action.DisplayReplyAllForm",ht="Action.DisplayAppointmentForm",mt="Action.DisplayMessageForm",vt="Action.StartBotConversation",Ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getJsonTypeName=function(){return mt},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.itemId=t.itemId,this.isPrimary=t.isPrimary},t}(k.Action),Ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getJsonTypeName=function(){return"DisplayReplyAllForm"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary},t}(k.Action),yt=function(e){function t(){var t=e.call(this)||this;return t.addinId="",t.desktopCommandId="",t.initializationContext="",t}return Object(c.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.addinId=t.addInId?t.addInId:t.addinid,this.desktopCommandId=t.desktopCommandId?t.desktopCommandId:t.desktopcommandid,this.initializationContext=t.initializationContext?JSON.stringify(t.initializationContext):JSON.stringify(t.initializationcontext)},t.prototype.getJsonTypeName=function(){return pt},t}(k.Action),jt=function(e){function t(){var t=e.call(this)||this;return t.productId="",t.newPinnedStatus=!1,t}return Object(c.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.productId=t.productId,this.newPinnedStatus=t.newPinnedStatus},t.prototype.getJsonTypeName=function(){return bt},t}(k.Action),At=function(e){function t(){var t=e.call(this)||this;return t.botId="",t.initialMessage="",t.botName="",t}return Object(c.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.botId=t.botId,this.botName=t.botName,this.initialMessage=t.initialMessage},t.prototype.getJsonTypeName=function(){return vt},t}(k.Action),St=n(1365),It=n(1496),xt=n(1318),Mt=n(8922),wt=n(1495),kt=n(2872),Tt=n(5612),Dt=n(1380),_t=n(1400),Et="MessageCardInvokeAddinCommandClicked",Pt="MessageCardPinAddinCommandClicked",Rt="DisplayAppointmentFormClicked",Nt="DisplayMessageFormClicked",Bt="actionContext";var Ft={registerActions:function(){k.AdaptiveCard.actionTypeRegistry.registerType(pt,(function(){return new yt})),k.AdaptiveCard.actionTypeRegistry.registerType(bt,(function(){return new jt})),k.AdaptiveCard.actionTypeRegistry.registerType(gt,(function(){return new Ot})),k.AdaptiveCard.actionTypeRegistry.registerType(ht,(function(){return new ft})),k.AdaptiveCard.actionTypeRegistry.registerType(mt,(function(){return new Ct})),Object(M.i)("mc-botConversation")&&k.AdaptiveCard.actionTypeRegistry.registerType(vt,(function(){return new At}))},executeAction:function(e,t,n,r,i,o,s){var u={id:e.id,type:e.getJsonTypeName()},d={cardDetails:t,elementDetails:u,messageContext:i,actionContext:e[Bt],eventName:void 0};if(e instanceof Ot){a.g.info("[ActionableMessageDebug] onExecuteAction: reply all with: "+e.title);var l=Dt.HtmlSanitizer.sanitizeHtml(e.title);wt.o.importAndExecute({referenceItemId:{Id:i.itemId,mailboxInfo:i.mailboxInfo},isReplyAll:!0,useFullCompose:!1,actionSource:"Link",instrumentationContexts:null,conversationId:i.conversationId,body:l})}else if(e instanceof ft){a.g.info("[ActionableMessageDebug] onExecuteAction: display appointment form for itemId: "+e.itemId),d.eventName=Rt,o.logTelemetry(d);var f="/calendar/item/"+encodeURIComponent(e.itemId);window.open(f,"_blank")}else if(e instanceof Ct)a.g.info("[AdaptiveCard] DisplayMessageFormAction executed"),d.eventName=Nt,o.logTelemetry(d),Object(kt.a)(e.itemId);else if(e instanceof jt&&Object(M.i)("addin-pinThroughAM")){a.g.info("[AdaptiveCard] PinAddinCommandAction executed"),d.eventName=Pt,o.logTelemetry(d),function(e){var t,n,r=Object(_t.s)().Extensions;try{for(var a=Object(c.__values)(r),i=a.next();!i.done;i=a.next()){var o=i.value;if(o.Id===e.productId){var s={readMode:null!=o.ExtensionPointCollection.MessageReadCommandSurface,composeMode:null!=o.ExtensionPointCollection.MessageComposeCommandSurface,calendarMode:null!=o.ExtensionPointCollection.AppointmentOrganizerCommandSurface&&null!=o.ExtensionPointCollection.AppointmentAttendeeCommandSurface};xt.h.importAndExecute(e.productId.toLowerCase(),e.newPinnedStatus,s);break}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}(e)}else if(e instanceof yt){a.g.info("[AdaptiveCard] InvokeAddinCommandAction executed"),d.eventName=Et,o.logTelemetry(d);var p=e,b=Object(St.p)(i.itemId);St.y.import().then((function(e){e(b,p.addinId.toLowerCase(),p.desktopCommandId,It.a.MessageRead,p.initializationContext)}))}else if(e instanceof At){var g=e,h=g.botId,m=g.botName,v=function(e){if(null==e?void 0:e.$data)return e.$data;return}(t.card);a.g.info("[ActionableMessageDebug] StartBotConversation executed with message: "+h),Mt.a.import().then((function(e){return e(i.mailboxInfo,{friendlyBotName:m,botId:h,botData:v,connectorSenderGuid:t.connectorSenderGuid,smtpAddressSerialized:t.smtpAddressesSerialized},"help")})),o.logTelemetry(d)}else{if(!(e instanceof k.OpenUrlAction))return!1;if("mailto:"===(f=new URL(e.url)).protocol.toLowerCase()){var C=Object(Tt.a)(f.href).composeInitProps;wt.m.importAndExecute(C,2)}}return!0},parseLegacyMessageCardAction:function(e,t){switch(e["@type"].toLowerCase()){case"displayreplyallform":return n=e,(r=new Ot).title=n.name,r.htmlBody=n.htmlBody,r;case"invokeaddincommand":return function(e){var t=new yt;return t.title=e.name,t.addinId=e.addInId,t.desktopCommandId=e.desktopCommandId,t.initializationContext=JSON.stringify(e.initializationContext),t}(e);case"pinaddincommand":return function(e){var t=new jt;return t.title=e.name,t.productId=e.productId,t.newPinnedStatus=e.newPinnedStatus,t}(e)}var n,r;return null},processAutoInvokeAction:function(e,t){if(Object(M.i)("mc-botConversation")&&e.type===vt){var n=new At;return n.parse(e),n}return null},registerHostCapabilities:null},Lt=n(15070),Ut=n(15071),Ht=n(15072),zt=n(432);var Jt,Wt={ComponentDidMount:"11",ComponentWillUnMount:"12",ComponentDidUpdate:"13",FetchInProgress:"14",CardDetailsPresent:"15",FetchInitiated:"16",NotUpdatingCardDetailsAsItAlreadyPresent:"17",FetchSuccess:"18",CardId:"19",ItemId:"110",FetchError:"111",FetchException:"112",RenderCard:"113",NoCard:"114",ShowMessage:"115",UpdateOnItem:"116",UpdateLoadingState:"117",FinishLoading:"118",Render:"119"},qt=function(e){var t="UserMailbox"===e.mailboxInfo.type?"userid":e.mailboxInfo.mailboxSmtpAddress,n=e.odataItemId;return Object(N.c)("/actions/{0}/messages/{1}/adaptiveCard/action",t,n)},Gt=n(3814),Vt=n(96);!function(e){e.Completed="Completed",e.Failed="Failed"}(Jt||(Jt={}));var Yt,Qt=function(e){function t(t,n,r,a){var i=e.call(this,t)||this;return i.cardDetails=n,i.messageContext=r,i.onCardDetailsUpdated=a,i}return Object(c.__extends)(t,e),t.prototype.sendRequestAsync=function(e){var t,n;return Object(c.__awaiter)(this,void 0,void 0,(function(){var r,a,i,o,s,u,d,l;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:return c.trys.push([0,4,,5]),r={connectorSenderGuid:this.cardDetails.connectorSenderGuid,inputParameters:[],senderAddress:this.messageContext.senderAddress,SmtpAddressesSerialized:this.cardDetails.smtpAddressesSerialized,adaptiveCardSignature:this.cardDetails.cardSignature,adaptiveCardHash:this.cardDetails.cardHash,clientTelemetry:{}},e.activity.channelData=r,a=Object(Vt.h)(),i=null===(t=a.SessionSettings)||void 0===t?void 0:t.UserPrincipalName,o=null===(n=a.SessionSettings)||void 0===n?void 0:n.UserEmailAddress,e.activity.from={id:i||o},[4,Object(w.a)()];case 1:if(!(s=c.sent()))throw(u=new Error("Token is empty: "+s)).name="EmptyTokenError",u;return[4,fetch(this.url,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+s},body:JSON.stringify(e.activity)})];case 2:return[4,(d=c.sent()).json()];case 3:if((l=c.sent()).RefreshCardSerialized&&this.onCardDetailsUpdated(JSON.parse(l)),d.ok)return void 0,[2,l.status===Jt.Completed?{request:e,status:Gt.ActivityStatus.Success,content:l.RefreshCardSerialized?l.RefreshCardSerialized:l.DisplayMessage}:{request:e,status:Gt.ActivityStatus.Failure,content:l.ErrorMessage}];throw d;case 4:throw c.sent();case 5:return[2]}}))}))},t}(Gt.HttpChannelAdapter),Kt=n(15076),Zt=n(2319),$t=n(85),Xt=n(1413),en=n(1628),tn=n(2),nn="ActionableMessageTeachingUI",rn=""+nn,an={CLICK:rn+"_BtnClicked",GOTITCUSTOM:rn+"_GotItClicked",LEARN:rn+"_LearnMoreClicked",TRIGGERED:rn+"_Triggered",DISMISSED:{BTNSCT:rn+"_DismisByAction",UNMNT:rn+"_DismissByUnmount"},SCOPE:{MOUNTED:rn+"_Mounted",UNMNTED:rn+"_Unmounted"},DISABLED:rn+"_FlightDisabled",RENDERED:rn+"_Rendered"},on={Transaction:"https://support.office.com/en-us/article/pay-bills-and-invoices-in-outlook-using-microsoft-pay-1196e7e6-c096-44f1-a18a-9df3af832a48"};function sn(e,t){Object(I.p)(e,t)}function cn(e){if(e)try{a.g.info("[ActionableMessageTeachingUI] Corelation telemetry trace function called"),function(e){Yt=Yt||{correlationVector:"",adaptiveCardCorrelationId:"",owaVersion:"",messageId:"",lightningAction:"",tuiType:""},Object(en.a)(Yt,e)}(e)}catch(e){a.g.warn("[ActionableMessageDebug] teachingUITrace: Failed complete the logging of the telemetry - "+e.message)}return Yt&&(Yt.correlationVector=Yt?Object(U.b)():void 0),Yt}var un=Object(Xt.d)(Object(S.a)((function(e){e=Object(c.__assign)({hasSmallIcon:!0,hasSmallHeadline:!0,hasCloseIcon:!0,isWide:!0},e);var t=Object(c.__read)(A.useState(!0),2),n=t[0],r=t[1];A.useEffect((function(){return a.g.info("[ActionableMessageTeachingUI:TeachingBubble] Teaching Bubble DidMount"),sn("TeachingBubble_"+an.SCOPE.MOUNTED,cn()),function(){a.g.info("[ActionableMessageTeachingUI:TeachingBubble] Teaching Bubble WillUnmountMount"),sn("TeachingBubble_"+an.SCOPE.UNMNTED,cn())}}),[]);var i=function(t){void 0===t&&(t="Primary"),"Secondary"==t?(a.g.info("[ActionableMessageTeachingUI:TeachingBubble] teacing bubble dismissed by user interaction"),sn("TeachingBubble_"+an.CLICK,cn({lightningAction:t}))):(a.g.info("[ActionableMessageTeachingUI:TeachingBubble] teaching bubble passively dismissed"),sn("TeachingBubble_"+an.DISMISSED.UNMNT,cn({lightningAction:t}))),Object(Xt.e)(e.lid,t),r(!1)};return n&&(a.g.info("[ActionableMessageTeachingUI:TeachingBubble] Using TeachingBubble for ActionableMessageTeachingUI"),sn("TeachingBubble_"+an.RENDERED,cn())),n&&A.createElement(Zt.a,Object(c.__assign)({calloutProps:{beakWidth:15,directionalHint:$t.DirectionalHint.leftCenter,minPagePadding:50},targetElement:e.target(),primaryButtonProps:Object(c.__assign)(Object(c.__assign)({},e.gotItBtn),{onClick:function(){sn("TeachingBubble_"+an.GOTITCUSTOM,cn({lightningAction:"Secondary"})),i("Secondary")}}),secondaryButtonProps:Object(c.__assign)(Object(c.__assign)({},e.learnMoreBtn),{onClick:function(){sn("TeachingBubble_"+an.LEARN,cn({lightningAction:"Secondary"})),window.open(e.learnMoreBtnUri,"_blank"),i("Secondary")}}),onDismiss:function(){return e.onClose||i("Primary")}},e,{target:void 0}),e.bodyText)}))),dn=n(2116),ln=(n(313),Object(S.a)((function(e){A.useEffect((function(){var t;t={adaptiveCardCorrelationId:e.acCorrelationId,messageId:e.messageId,tuiType:e.actionType},rn=nn+"_",cn({adaptiveCardCorrelationId:t.adaptiveCardCorrelationId,messageId:t.messageId,owaVersion:Object(tn.n)(),lightningAction:"",tuiType:t.tuiType})}),[]);var t;return"Transaction"==e.actionType&&A.createElement(un,{target:e.target,when:function(e){sn(an.TRIGGERED,cn()),e()},gotItBtn:(t="TeachingBubble",{buttonType:dn.a.primary,children:Object(N.b)(Kt.a),onClick:t}),learnMoreBtn:fn("TeachingBubble"),learnMoreBtnUri:on[e.actionType]||void 0,headline:Object(N.b)(Kt.d),bodyText:Object(N.b)(Kt.c),hasSmallHeadline:!0,lid:Xt.b.ActionableMessageTeachingUiTeachingBubblePolicy})})));function fn(e){return{buttonType:dn.a.normal,children:Object(N.b)(Kt.b),onClick:e}}var pn=n(10317),bn=Object(S.a)((function(e){var t,n,o=this,s=e.actionableMessageLoggingHandler;A.useEffect((function(){return s.log(Wt.ComponentDidMount),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper mount"),function(){st(),s.log(Wt.ComponentWillUnMount),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper unmount")}}),[]),A.useEffect((function(){s.log(Wt.ComponentDidUpdate),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper update"),j()})),A.useEffect((function(){return p.current=setTimeout((function(){a.g.info("[ActionableMessageDebug] ActionableMessageContent card load timed out"),Object(I.p)("actionableMessageContentLoadTimeout"),b.current=!0,B(!0)}),4e3),function(){return clearTimeout(p.current)}}),[]);var u=A.useRef(Object(lt.a)(e.item)),d=A.useRef({loadStartTime:Object(x.Qb)()}),l=A.useRef([]),f=A.useRef(),p=A.useRef(),b=A.useRef(),g=Object(c.__read)(A.useState(!1),2),h=g[0],m=g[1],v=Object(c.__read)(A.useState(null),2),C=v[0],y=v[1],j=function(){return Object(c.__awaiter)(o,void 0,void 0,(function(){var t,n,r,i,o,u,l,p,b;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:if(f.current)return s.log(Wt.FetchInProgress),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties fetch already in process. Aborting this attempt"),[2];if(t=e.item,d.current.fetchStartTime=Object(x.Qb)(),(n=t.adaptiveCardDetails)&&n.length>0)return s.log(Wt.CardDetailsPresent+":"+(null===(l=n[0].cardId)||void 0===l?void 0:l.slice(0,8))),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties already had cardDetails on the item. cardId: "+n[0].cardId),d.current.fetchEndTime=Object(x.Qb)(),[2];r=new I.a("MCActionableCardGetProperty"),c.label=1;case 1:return c.trys.push([1,3,4,5]),f.current=!0,s.log(Wt.FetchInitiated),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties fetching cardDetails from the server"),[4,O(t)];case 2:return i=c.sent(),(o=t.adaptiveCardDetails)&&o.length>0?(s.log(Wt.NotUpdatingCardDetailsAsItAlreadyPresent+":"+(null===(p=o[0].cardId)||void 0===p?void 0:p.slice(0,8))),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties not updating the details as its already present"+i[0].cardId)):i&&i.length>0?(r.end(),d.current.fetchEndTime=Object(x.Qb)(),s.log(Wt.FetchSuccess),s.log(Wt.CardId+":"+(null===(b=i[0].cardId)||void 0===b?void 0:b.slice(0,8))),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties got card details from the server. cardId: "+i[0].cardId),Ke(t,i)):(s.log(Wt.FetchError),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),B(!0),r.endWithError("ServerError")),[3,5];case 3:return u=c.sent(),s.log(Wt.FetchException),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),a.g.warn("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties: exception during getCardDetails: "+u.message),B(!0),r.endWithError("ClientError"),[3,5];case 4:return f.current=!1,[7];case 5:return[2]}}))}))},S=function(e){return e.filter((function(e){return!e.isContextual}))},k=function(t){var n,o=S(t),f={onUndo:function(){return t=e.darkModeContentHandler,n=e.undoDarkMode,void(t&&n&&(a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: undoing dark mode"),t.undoHandler(l.current),l.current=[]));var t,n},onApply:function(t){return function(t){var n=e.undoDarkMode,r=e.darkModeContentHandler;if(t&&r&&!n)if(a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: applying dark mode to card elements"),r.cssSelector){r.handler(t),l.current.push(t);var i=t.querySelectorAll(r.cssSelector);if(i)for(var o=0;o<i.length;o++){var s=i.item(o);r.handler(s),l.current.push(s)}}else a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: no cssSelector specified by DarkMode handler")}(t)}},p=new r.b(i.c,u.current,d.current);if(o&&1===o.length&&function(t){var n,r=!0,a=null===(n=null==t?void 0:t.card)||void 0===n?void 0:n.originator;return a||(a=null==t?void 0:t.connectorSenderGuid),a&&(r=!ye(a,e.isDarkMode)),r}(o[0])){s.log(Wt.RenderCard+":"+(null===(n=o[0].cardId)||void 0===n?void 0:n.slice(0,8))),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper renderCardFromDetails. cardId: "+o[0].cardId);var b=new Qt(qt(u.current),o[0],u.current,D);return A.createElement("div",{className:pn.container},A.createElement(r.a,{key:o[0].cardId,cardDetails:o[0],snackBarTimeout:Me(),showMessageBodyCallback:T,contentHandlerUndoMode:e.undoDarkMode,actionProviders:[Ft,we,Je],adjustCardElementBeforeRenderCallback:E,onCardRendered:P,downloadThemeCallback:ee,onCardDetailsUpdated:D,getClientAuthToken:w.a,actionableMessageContentHandler:f,actionableMessageCardStrings:{format:N.c,placeholder:{textInput:Object(N.b)(Lt.g),numberInput:Object(N.b)(Lt.f),dateInput:Object(N.b)(Lt.e),choiceSetInput:Object(N.b)(Lt.d)},error:{generic:Object(N.b)(Lt.h)},warning:{invalidInput:Object(N.b)(Lt.i),missingRequiredInput:Object(N.b)(Lt.j),inputNumberNotNumeric:Object(N.b)(Ut.c),inputNumberLessThanMin:Object(N.b)(Ut.a),inputNumberMoreThanMax:Object(N.b)(Ut.b),requiredField:Object(N.b)(Ht.a)},information:{actionInProgress:Object(N.b)(Lt.a),authenticationFlowAcknowledgeMessage:Object(N.b)(Lt.c),authenticationFlowAcknowledgeButtonText:Object(N.b)(Lt.b)},datePicker:Object(c.__assign)(Object(c.__assign)({},Object(zt.a)()),{isRequiredErrorMessage:Ht.a})},telemetryHandler:p,loggingHandler:s,httpChannelAdapter:b,isTrustedDomain:xe}))}return s.log(Wt.NoCard),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper renderCardFromDetails - Did not find expected number of cards on the message"),T(!0),A.createElement("div",null)},T=function(t){s.log(Wt.ShowMessage),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper setShowMessageBody: "+t),$e(e.viewState,t),t&&Xe(e.viewState,!1),B(t)},D=function(t){s.log(Wt.UpdateOnItem),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper updateCardOnItem"),Ze(e.item,t)},_=function(){var t=e.item.adaptiveCardDetails;if(t&&t.length>0){var n=t[0].card.messageCardContext;return n?{acCorrelationId:n.correlationId,actionType:Object(r.e)(t[0]),messageId:e.item.ItemId.Id,target:function(){return C}}:{acCorrelationId:"",actionType:void 0,messageId:null,target:function(){return C}}}return null},E=function(t){a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper fixInlineImages"),Se(t,e.item.MailboxInfo),it(t,e.item,e.item.MailboxInfo)},P=function(t){s.log(Wt.UpdateLoadingState),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper  onCardRendered. Updating loading state"),C!==t&&(m(!0),y(t),B(!1)),e.viewState.showCardLoading&&Xe(e.viewState,!1)},R=function(e){return(null==e?void 0:e.actionType)&&null!=e.target?(a.g.info("[ActionableMessageCard] TeachingUI triggered"),A.createElement(ln,Object(c.__assign)({},e))):null},B=function(t){s.log(Wt.FinishLoading),a.g.info("[ActionableMessageDebug] Finish Loading - forceShowMessageBody:"+t),p.current&&(clearTimeout(p.current),p.current=null);var n=e.viewState;Xe(n,!1),t&&$e(n,!0)},F=e.item.adaptiveCardDetails;return s.log(Wt.Render),s.log(Wt.CardId+":"+((null==F?void 0:F[0])?null===(n=null===(t=F[0])||void 0===t?void 0:t.cardId)||void 0===n?void 0:n.slice(0,8):" ")),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper render. itemId: "+e.item.ItemId.Id+". CardDetails: "+((null==F?void 0:F[0])?F[0].cardId:"undefined")),F&&F.length>0?0!==function(t){var n=S(t);return n=n.filter((function(t){return De(t,e.item.MailboxInfo,Object(M.i)("rp-acDisableTransactionCard"),u.current,i.c)}))}(F).length?(B(!0),null):function(e){return b.current&&B(!0),!b.current&&A.createElement(A.Fragment,null,A.createElement("div",{className:pn.cardArea},k(e)),A.createElement(Qe,{odataItemId:u.current.odataItemId,smtpAddressesSerialized:e[0].smtpAddressesSerialized}),h&&R(e?_():null))}(F):null})),gn=n(10318),hn=n(4321),mn=n(8948),vn=(Object(_.mutator)(mn.a,(function(e){hn.a.cards.set(e.cardId,{actionInProgress:!1,actionResponseMessage:"",actionResponseDate:"",showActionResponse:!1,perfCheckpoints:{currentCardCheckpoints:{}}})})),Object(_.mutator)(mn.c,(function(e){hn.a.cards.delete(e.cardId)})),Object(_.mutator)(mn.d,(function(e){var t=hn.a.cards.get(e.cardId);t?t.autoInvokeActionAlreadyRan=e.autoInvokeActionAlreadyRan:a.g.warn("[ActionableMessageDebug] setAutoInvokeActionAlreadyRanMutator: card is undefined for cardId "+e.cardId)})),Object(_.mutator)(mn.b,(function(e){var t=hn.a.cards.get(e.cardId);if(t){var n=e.time||Object(x.Qb)();switch(e.perfMarker){case gn.a.LoadStart:t.perfCheckpoints.loadStart=n;break;case gn.a.AutoInvokeActionStart:t.perfCheckpoints.autoInvokeActionStart=n;break;case gn.a.AutoInvokeActionEnd:t.perfCheckpoints.autoInvokeActionEnd=n;break;case gn.a.CardRenderStart:t.perfCheckpoints.currentCardCheckpoints.cardRenderStart=n;break;case gn.a.CardRenderEnd:t.perfCheckpoints.currentCardCheckpoints.cardRenderEnd=n;break;case gn.a.ThemeLoadTotalStart:t.perfCheckpoints.currentCardCheckpoints.themeLoadTotalStart=n;break;case gn.a.ThemeLoadTotalEnd:t.perfCheckpoints.currentCardCheckpoints.themeLoadTotalEnd=n;break;case gn.a.ThemeDefinitionsLoadStart:t.perfCheckpoints.currentCardCheckpoints.themeDefinitionsLoadStart=n;break;case gn.a.ThemeDefinitionsLoadEnd:t.perfCheckpoints.currentCardCheckpoints.themeDefinitionsLoadEnd=n;break;case gn.a.ThemeResolveStart:t.perfCheckpoints.currentCardCheckpoints.themeResolveStart=n;break;case gn.a.ThemeResolveEnd:t.perfCheckpoints.currentCardCheckpoints.themeResolveEnd=n;break;case gn.a.CardCreateStart:t.perfCheckpoints.currentCardCheckpoints.cardCreateStart=n;break;case gn.a.CardCreateEnd:t.perfCheckpoints.currentCardCheckpoints.cardCreateEnd=n;break;case gn.a.CardLibraryRenderStart:t.perfCheckpoints.currentCardCheckpoints.cardLibraryRenderStart=n;break;case gn.a.CardLibraryRenderEnd:t.perfCheckpoints.currentCardCheckpoints.cardLibraryRenderEnd=n;break;case gn.a.PrepareCardStart:t.perfCheckpoints.currentCardCheckpoints.prepareCardStart=n;break;case gn.a.PrepareCardEnd:t.perfCheckpoints.currentCardCheckpoints.prepareCardEnd=n;break;default:a.g.info("Actionable Message Card: markPerfCheckpointMutator called with unexpected PerfMarker")}}})),Object(_.mutator)(mn.e,(function(e){var t,n=hn.a.cards.get(e.cardId);(null===(t=null==n?void 0:n.perfCheckpoints)||void 0===t?void 0:t.currentCardCheckpoints)&&(n.perfCheckpoints.currentCardCheckpoints.totalFetchTime=e.totalFetchTime)})),Object(_.mutator)(mn.f,(function(e){var t=hn.a.cards.get(e.cardId);(null==t?void 0:t.perfCheckpoints)&&(t.perfCheckpoints.previousCardCheckpoints=t.perfCheckpoints.currentCardCheckpoints,t.perfCheckpoints.currentCardCheckpoints={})})),n(77)),Cn={XeroOpay:"Transaction"};function On(e){var t,n,r,i=void 0;if(a.g.info("[getCardTypeFromCardDetails] Fetching the card type"),null===(t=e.card)||void 0===t?void 0:t.messageCardContext){var o=e.card.messageCardContext;n=o.oamAppName,(r=Cn[n])||a.g.warn("[ActionableMessageDebug] getCardType: Unable to fetch cardType for OamAppName "+n),i=r||"Unknown"}else a.g.warn("[ActionableMessageDebug] getCardTypeFromCardDetails: Cannot extract the context of an invalid CardDetails object");return i}n(362);var yn=new vn.c((function(){return Promise.all([n.e(5),n.e(7),n.e(10),n.e(29),n.e(116),n.e(146),n.e(452)]).then(n.bind(null,16637))})),jn=Object(vn.d)(yn,(function(e){return e.ActionableMessageCard})),An=(new vn.b(yn,(function(e){return e.parseCardFromStringOrObject})),n(10317)),Sn=Object(S.a)((function(e){var t,n,r=this,o=e.actionableMessageLoggingHandler;A.useEffect((function(){return o.log(Wt.ComponentDidMount),a.g.info("[ActionableMessageDebug] ActionableMessageContent mount"),function(){st(),o.log(Wt.ComponentWillUnMount),a.g.info("[ActionableMessageDebug] ActionableMessageContent unmount")}}),[]),A.useEffect((function(){o.log(Wt.ComponentDidUpdate),a.g.info("[ActionableMessageDebug] ActionableMessageContent update"),S()})),A.useEffect((function(){return b.current=setTimeout((function(){a.g.info("[ActionableMessageDebug] ActionableMessageContent card load timed out"),Object(I.p)("actionableMessageContentLoadTimeout"),g.current=!0,N(!0)}),4e3),function(){return clearTimeout(b.current)}}),[]);var s=A.useRef(Object(lt.a)(e.item)),u=A.useRef(Object(x.Qb)()),d=A.useRef(),l=A.useRef(),f=A.useRef([]),p=A.useRef(),b=A.useRef(),g=A.useRef(),h=Object(c.__read)(A.useState(!1),2),m=h[0],v=h[1],C=Object(c.__read)(A.useState(null),2),y=C[0],j=C[1],S=function(){return Object(c.__awaiter)(r,void 0,void 0,(function(){var t,n,r,i,s,u,f,b,g;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:if(p.current)return o.log(Wt.FetchInProgress),a.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties fetch already in process. Aborting this attempt"),[2];if(t=e.item,d.current=Object(x.Qb)(),(n=t.adaptiveCardDetails)&&n.length>0)return o.log(Wt.CardDetailsPresent+":"+(null===(f=n[0].cardId)||void 0===f?void 0:f.slice(0,8))),a.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties already had cardDetails on the item. cardId: "+n[0].cardId),l.current=Object(x.Qb)(),[2];r=new I.a("MCActionableCardGetProperty"),c.label=1;case 1:return c.trys.push([1,3,4,5]),p.current=!0,o.log(Wt.FetchInitiated),a.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties fetching cardDetails from the server"),[4,O(t)];case 2:return i=c.sent(),(s=t.adaptiveCardDetails)&&s.length>0?(o.log(Wt.NotUpdatingCardDetailsAsItAlreadyPresent+":"+(null===(b=s[0].cardId)||void 0===b?void 0:b.slice(0,8))),a.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties not updating the details as its already present"+i[0].cardId)):i&&i.length>0?(r.end(),l.current=Object(x.Qb)(),o.log(Wt.FetchSuccess),o.log(Wt.CardId+":"+(null===(g=i[0].cardId)||void 0===g?void 0:g.slice(0,8))),a.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties got card details from the server. cardId: "+i[0].cardId),Ke(t,i)):(o.log(Wt.FetchError),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),N(!0),r.endWithError("ServerError")),[3,5];case 3:return u=c.sent(),o.log(Wt.FetchException),a.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties error getting card details from the server"),a.g.warn("[ActionableMessageDebug] ActionableMessageContent getCardProperties: exception during getCardDetails: "+u.message),N(!0),r.endWithError("ClientError"),[3,5];case 4:return p.current=!1,[7];case 5:return[2]}}))}))},w=function(e){return e.filter((function(e){return!e.isContextual}))},k=function(t){var n,r=w(t),c={onUndo:function(){return t=e.darkModeContentHandler,n=e.undoDarkMode,void(t&&n&&(a.g.info("ActionableMessageContent: applyDarkModeHandlerToCardElement: undoing dark mode"),t.undoHandler(f.current),f.current=[]));var t,n},onApply:function(t){return function(t){var n=e.undoDarkMode,r=e.darkModeContentHandler;if(t&&r&&!n)if(a.g.info("ActionableMessageCard: applyDarkModeHandlerToCardElement: applying dark mode to card elements"),r.cssSelector){r.handler(t),f.current.push(t);var i=t.querySelectorAll(r.cssSelector);if(i)for(var o=0;o<i.length;o++){var s=i.item(o);r.handler(s),f.current.push(s)}}else a.g.info("ActionableMessageCard: applyDarkModeHandlerToCardElement: no cssSelector specified by DarkMode handler")}(t)}};return r&&1===r.length&&function(t){var n,r=!0,a=null===(n=null==t?void 0:t.card)||void 0===n?void 0:n.originator;return a||(a=null==t?void 0:t.connectorSenderGuid),a&&(r=!ye(a,e.isDarkMode)),r}(r[0])?(o.log(Wt.RenderCard+":"+(null===(n=r[0].cardId)||void 0===n?void 0:n.slice(0,8))),a.g.info("[ActionableMessageDebug] ActionableMessageContent renderCardFromDetails. cardId: "+r[0].cardId),A.createElement("div",{className:An.container},A.createElement(jn,{key:r[0].cardId,cardDetails:r[0],mailboxInfo:e.item.MailboxInfo,messageContext:s.current,showMessageBodyCallback:T,contentHandlerUndoMode:e.undoDarkMode,actionProviders:[Ft,we,Je],telemetryProvider:i.c,loggingHandler:o,adjustCardElementBeforeRenderCallback:E,onCardRendered:P,downloadThemeCallback:ee,onCardDetailsUpdated:D,perfData:{loadStartTime:u.current,fetchStartTime:d.current,fetchEndTime:l.current},actionableMessageContentHandler:c}))):(o.log(Wt.NoCard),a.g.info("Did not find expected number of cards on the message"),T(!0),A.createElement("div",null))},T=function(t){o.log(Wt.ShowMessage),a.g.info("[ActionableMessageDebug] ActionableMessageContent setShowMessageBody: "+t),$e(e.viewState,t),t&&Xe(e.viewState,!1),N(t)},D=function(t){o.log(Wt.UpdateOnItem),a.g.info("[ActionableMessageDebug] ActionableMessageContent updateCardOnItem"),Ze(e.item,t)},_=function(){var t=e.item.adaptiveCardDetails;if(t&&t.length>0){var n=t[0].card.messageCardContext;return n?{acCorrelationId:n.correlationId,actionType:On(t[0]),messageId:e.item.ItemId.Id,target:function(){return y}}:{acCorrelationId:"",actionType:void 0,messageId:null,target:function(){return y}}}return null},E=function(t){a.g.info("[ActionableMessageDebug] ActionableMessageContent fixInlineImages"),Se(t,e.item.MailboxInfo),it(t,e.item,e.item.MailboxInfo)},P=function(t){o.log(Wt.UpdateLoadingState),a.g.info("[ActionableMessageDebug] ActionableMessageContent onCardRendered. Updating loading state"),y!==t&&(v(!0),j(t),N(!1)),e.viewState.showCardLoading&&Xe(e.viewState,!1)},R=function(e){return(null==e?void 0:e.actionType)&&null!=e.target?(a.g.info("[ActionableMessageDebug] TeachingUI triggered"),A.createElement(ln,Object(c.__assign)({},e))):null},N=function(t){o.log(Wt.FinishLoading),a.g.info("[ActionableMessageDebug] Finish Loading - forceShowMessageBody:"+t),b.current&&(clearTimeout(b.current),b.current=null);var n=e.viewState;Xe(n,!1),t&&$e(n,!0)},B=e.item.adaptiveCardDetails;return o.log(Wt.Render+":"+((null==B?void 0:B[0])?null===(n=null===(t=B[0])||void 0===t?void 0:t.cardId)||void 0===n?void 0:n.slice(0,8):" ")),a.g.info("[ActionableMessageDebug] ActionableMessageContent render. itemId: "+e.item.ItemId.Id+". CardDetails: "+((null==B?void 0:B[0])?B[0].cardId:"undefined")),B&&B.length>0?0!==function(t){var n=w(t);return n=n.filter((function(t){return De(t,e.item.MailboxInfo,Object(M.i)("rp-acDisableTransactionCard"),s.current,i.c)}))}(B).length?(N(!0),null):function(e){return g.current&&N(!0),!g.current&&A.createElement(A.Fragment,null,A.createElement("div",{className:An.cardArea},k(e)),A.createElement(Qe,{odataItemId:s.current.odataItemId,smtpAddressesSerialized:e[0].smtpAddressesSerialized}),m&&R(e?_():null))}(B):null}));n.d(t,"logAdaptiveCardLinkInteraction",(function(){return s})),n.d(t,"getCardDetails",(function(){return O})),n.d(t,"ActionableMessageMailWrapper",(function(){return bn})),n.d(t,"ActionableMessageContent",(function(){return Sn})),n.d(t,"doesActionableMessageEnabled",(function(){return Ce}))},1675:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(74),a=n(1424);function i(e,t){Object.keys(a.a).some((function(n){return a.a[n]==t&&(Object(r.h)(e,{key:n,id:t},{isCore:!0}),!0)}))}},1696:function(e,t,n){"use strict";var r=n(1),a=n(1656),i=n(2168),o=n(14),s={root:"ms-StackItem"},c={start:"flex-start",end:"flex-end"};n.d(t,"a",(function(){return u}));var u=Object(i.a)((function(e){var t=e.children;if(r.Children.count(t)<1)return null;var n=Object(a.b)(e,{root:"div"});return Object(a.c)(n.root,null,t)}),{displayName:"StackItem",styles:function(e,t,n){var r=e.grow,a=e.shrink,i=e.disableShrink,u=e.align,d=e.verticalFill,l=e.order,f=e.className,p=Object(o.getGlobalClassNames)(s,t);return{root:[t.fonts.medium,p.root,{margin:n.margin,padding:n.padding,height:d?"100%":"auto",width:"auto"},r&&{flexGrow:!0===r?1:r},(i||!r&&!a)&&{flexShrink:0},a&&!i&&{flexShrink:1},u&&{alignSelf:c[u]||u},l&&{order:l},f]}}})},1791:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),a=n(1),i=n(273),o=n(309),s=n(1792),c=n(680),u=n(85),d=Object(i.a)(),l=function(e){function t(t){var n=e.call(this,t)||this;return n.rootElement=a.createRef(),Object(o.a)(n),n.state={},n._defaultCalloutProps={beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:u.DirectionalHint.rightCenter},n}return Object(r.__extends)(t,e),t.prototype.focus=function(){this.rootElement.current&&this.rootElement.current.focus()},t.prototype.render=function(){var e=this.props,t=e.calloutProps,n=e.targetElement,i=e.onDismiss,o=e.hasCloseButton,u=void 0===o?this.props.hasCloseIcon:o,l=e.isWide,f=e.styles,p=e.theme,b=e.target,g=Object(r.__assign)(Object(r.__assign)({},this._defaultCalloutProps),t),h={theme:p,isWide:l,calloutProps:Object(r.__assign)(Object(r.__assign)({},g),{theme:g.theme}),hasCloseButton:u},m=d(f,h),v=m.subComponentStyles?m.subComponentStyles.callout:void 0;return a.createElement(c.a,Object(r.__assign)({target:b||n,onDismiss:i},g,{className:m.root,styles:v,hideOverflow:!0}),a.createElement("div",{ref:this.rootElement},a.createElement(s.a,Object(r.__assign)({},this.props))))},t.defaultProps={calloutProps:{beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:u.DirectionalHint.rightCenter}},t}(a.Component)},1792:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(450),a=n(1793),i=n(1642),o=Object(r.a)(a.a,i.a,void 0,{scope:"TeachingBubbleContent"})},1793:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(0),a=n(1),i=n(273),o=n(60),s=n(309),c=n(460),u=n(753),d=n(666),l=n(366),f=n(2186),p=n(940),b=Object(i.a)(),g=function(e){function t(t){var n=e.call(this,t)||this;return n.rootElement=a.createRef(),n._onKeyDown=function(e){n.props.onDismiss&&e.which===o.a.escape&&n.props.onDismiss()},Object(s.a)(n),n.state={},n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.onDismiss&&document.addEventListener("keydown",this._onKeyDown,!1)},t.prototype.componentWillUnmount=function(){this.props.onDismiss&&document.removeEventListener("keydown",this._onKeyDown)},t.prototype.focus=function(){this.rootElement.current&&this.rootElement.current.focus()},t.prototype.render=function(){var e,t,n,i,o,s=this.props,g=s.children,h=s.illustrationImage,m=s.primaryButtonProps,v=s.secondaryButtonProps,C=s.headline,O=s.hasCondensedHeadline,y=s.hasCloseButton,j=void 0===y?this.props.hasCloseIcon:y,A=s.onDismiss,S=s.closeButtonAriaLabel,I=s.hasSmallHeadline,x=s.isWide,M=s.styles,w=s.theme,k=s.ariaDescribedBy,T=s.ariaLabelledBy,D=s.footerContent,_=s.focusTrapZoneProps,E=b(M,{theme:w,hasCondensedHeadline:O,hasSmallHeadline:I,hasCloseButton:j,hasHeadline:!!C,isWide:x,primaryButtonClassName:m?m.className:void 0,secondaryButtonClassName:v?v.className:void 0});if(h&&h.src&&(e=a.createElement("div",{className:E.imageContent},a.createElement(l.a,Object(r.__assign)({},h)))),C){var P="string"==typeof C?"p":"div";t=a.createElement("div",{className:E.header},a.createElement(P,{role:"heading",className:E.headline,id:T},C))}if(g){var R="string"==typeof g?"p":"div";n=a.createElement("div",{className:E.body},a.createElement(R,{className:E.subText,id:k},g))}return(m||v||D)&&(i=a.createElement(f.a,{className:E.footer,horizontal:!0,horizontalAlign:D?"space-between":"end"},a.createElement(f.a.Item,{align:"center"},a.createElement("span",null,D)),a.createElement(f.a.Item,null,v&&a.createElement(c.a,Object(r.__assign)({},v,{className:E.secondaryButton})),m&&a.createElement(u.a,Object(r.__assign)({},m,{className:E.primaryButton}))))),j&&(o=a.createElement(d.a,{className:E.closeButton,iconProps:{iconName:"Cancel"},title:S,ariaLabel:S,onClick:A})),a.createElement("div",{className:E.content,ref:this.rootElement,role:"dialog",tabIndex:-1,"aria-labelledby":T,"aria-describedby":k,"data-is-focusable":!0},e,a.createElement(p.a,Object(r.__assign)({isClickableOutsideFocusTrap:!0},_),a.createElement("div",{className:E.bodyContent},t,n,i,o)))},t}(a.Component)},1885:function(e,t,n){"use strict";var r=n(1543),a=n(1617);t.a=function(e){return Object(r.a)((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&Object(a.a)(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var c=n[r];c&&e(t,c,r,o)}return t}))}},1961:function(e,t,n){"use strict";var r=n(1369),a=["AT","BE","BG","CH","CY","CZ","DE","DK","EE","ES","FI","FR","GB","GR","HR","HU","IE","IS","IT","LI","LT","LU","LV","MT","NL","NO","PL","PT","RO","SE","SI","SK"];function i(){var e=Object(r.h)(Object(r.e)());return a.indexOf(e)>=0}var o=n(83);function s(){var e;return Object(o.i)("fwk-gdprAdsV3-freString6")&&(e=!0),e}var c,u={};function d(e,t){return void 0===t&&(t=!0),u[e]&&c&&-1!=c.indexOf(e)||(u[e]=new Promise((function(n,r){var a=window.document.createElement("script");a.src=e,a.type="text/javascript",t&&(a.crossOrigin="anonymous"),a.onload=function(){c?c.push(e):c=[e],n()},a.onerror=function(){r("OnError "+e)},window.document.head.appendChild(a)}))),u[e]}var l,f,p,b,g=n(96),h=n(30),m=["en-us","en-gb","en-ca","en-au","fr-fr","de-de","en-de"];function v(){if(!l){var e=Object(r.e)();l=Object(o.i)("fwk-nativeAds-bingOneClickOtherInboxOnly")&&m.indexOf(e)>-1?0:2}return l}function C(e){return O(e)?!Object(o.i)("fwk-nativeAds-honorEasyOtherOffKillSwitch")&&8&Object(h.a)().ViewStateConfiguration.FocusedInboxBitFlags||!Object(o.i)("fwk-ads-exp2-RuntimeBypass")&&("DisplayOffNativeInbox"==b||"DisplayOnNativeInbox"==b)?2:1:0}function O(e){return void 0!==f?f:(f=!1,Object(g.s)()?(p=Object(r.e)(),Object(o.i)("fwk-nativeAds-bingOneClickOtherInboxOnly")||Object(o.i)("fwk-nativeAds-prebidOneClickOtherInboxOnly")||Object(o.i)("fwk-nativeAds-appNexusOneClickOtherInboxOnly")?Object(r.b)()?f:Object(r.c)()?f:Object(r.a)()?f:r.d.indexOf(p)>-1?f:y()?f:f=!0:f):f)}function y(){return b=Object(h.a)().UserOptions.ConsumerAdsExperimentMode,!(Object(o.i)("fwk-ads-exp2-RuntimeBypass")||"DisplayOffNativeOff"!=b&&"DisplayOnNativeOff"!=b)}n.d(t,"q",(function(){return i})),n.d(t,"r",(function(){return s})),n.d(t,"s",(function(){return d})),n.d(t,"e",(function(){return y})),n.d(t,"m",(function(){return O})),n.d(t,"o",(function(){return v})),n.d(t,"n",(function(){return C})),n.d(t,"a",(function(){return m})),n.d(t,"f",(function(){return r.d})),n.d(t,"g",(function(){return r.e})),n.d(t,"h",(function(){return r.f})),n.d(t,"j",(function(){return r.h})),n.d(t,"k",(function(){return r.i})),n.d(t,"l",(function(){return r.j})),n.d(t,"p",(function(){return r.k})),n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"t",(function(){return r.l})),n.d(t,"i",(function(){return r.g}))},2116:function(e,t,n){"use strict";var r,a;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),function(e){e[e.button=0]="button",e[e.anchor=1]="anchor"}(r||(r={})),function(e){e[e.normal=0]="normal",e[e.primary=1]="primary",e[e.hero=2]="hero",e[e.compound=3]="compound",e[e.command=4]="command",e[e.icon=5]="icon",e[e.default=6]="default"}(a||(a={}))},2168:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(0),a=n(1),i=n(14),o=n(311),s=n(179),c=n(1656),u=n(1483);function d(e,t){void 0===t&&(t={});var n=t.factoryOptions,d=(void 0===n?{}:n).defaultProp,l=function(n){var c,d,l,f=(c=t.displayName,d=a.useContext(o.a),l=t.fields,s.a.getSettings(l||["theme","styles","tokens"],c,d.customizations)),p=t.state;p&&(n=Object(r.__assign)(Object(r.__assign)({},n),p(n)));var b=n.theme||f.theme,g=function e(t,n){for(var a=[],i=2;i<arguments.length;i++)a[i-2]=arguments[i];for(var o={},s=0,c=a;s<c.length;s++){var d=c[s];d&&(d="function"==typeof d?d(t,n):d,Array.isArray(d)&&(d=e.apply(void 0,Object(r.__spreadArrays)([t,n],d))),Object(u.a)(o,d))}return o}(n,b,t.tokens,f.tokens,n.tokens),h=function(e,t,n){for(var r=[],a=3;a<arguments.length;a++)r[a-3]=arguments[a];return i.concatStyleSets.apply(void 0,r.map((function(r){return"function"==typeof r?r(e,t,n):r})))}(n,b,g,t.styles,f.styles,n.styles),m=Object(r.__assign)(Object(r.__assign)({},n),{styles:h,tokens:g,_defaultStyles:h,theme:b});return e(m)};return l.displayName=t.displayName||e.name,d&&(l.create=Object(c.a)(l,{defaultProp:d})),Object(u.a)(l,t.statics),l}},2186:function(e,t,n){"use strict";var r=n(0),a=n(1),i=n(1656),o=n(2168),s=n(382),c=n(61),u=function(e,t){return t.spacing.hasOwnProperty(e)?t.spacing[e]:e},d=function(e){var t=parseFloat(e),n=isNaN(t)?0:t,r=isNaN(t)?"":t.toString();return{value:n,unit:e.substring(r.toString().length)||"px"}},l=function(e,t){if(void 0===e||"number"==typeof e||""===e)return e;var n=e.split(" ");return n.length<2?u(e,t):n.reduce((function(e,n){return u(e,t)+" "+u(n,t)}))},f=n(14),p={start:"flex-start",end:"flex-end"},b={root:"ms-Stack",inner:"ms-Stack-inner"},g=n(1696);n.d(t,"a",(function(){return m}));var h={Item:g.a},m=Object(o.a)((function(e){var t=e.as,n=void 0===t?"div":t,o=e.disableShrink,u=e.wrap,d=Object(r.__rest)(e,["as","disableShrink","wrap"]);Object(s.a)("Stack",e,{gap:"tokens.childrenGap",maxHeight:"tokens.maxHeight",maxWidth:"tokens.maxWidth",padding:"tokens.padding"});var l=a.Children.map(e.children,(function(e,t){if(!e)return null;if((i=e)&&"object"==typeof i&&i.type&&i.type.displayName===g.a.displayName){var n={shrink:!o};return a.cloneElement(e,Object(r.__assign)(Object(r.__assign)({},n),e.props))}var i;return e})),f=Object(c.j)(d,c.k),p=Object(i.b)(e,{root:n,inner:"div"});return u?Object(i.c)(p.root,Object(r.__assign)({},f),Object(i.c)(p.inner,null,l)):Object(i.c)(p.root,Object(r.__assign)({},f),l)}),{displayName:"Stack",styles:function(e,t,n){var a,i,o,s,c,g,h,m=e.verticalFill,v=e.horizontal,C=e.reversed,O=e.grow,y=e.wrap,j=e.horizontalAlign,A=e.verticalAlign,S=e.disableShrink,I=e.className,x=Object(f.getGlobalClassNames)(b,t),M=n&&n.childrenGap?n.childrenGap:e.gap,w=n&&n.maxHeight?n.maxHeight:e.maxHeight,k=n&&n.maxWidth?n.maxWidth:e.maxWidth,T=n&&n.padding?n.padding:e.padding,D=function(e,t){if(void 0===e||""===e)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if("number"==typeof e)return{rowGap:{value:e,unit:"px"},columnGap:{value:e,unit:"px"}};var n=e.split(" ");if(n.length>2)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if(2===n.length)return{rowGap:d(u(n[0],t)),columnGap:d(u(n[1],t))};var r=d(u(e,t));return{rowGap:r,columnGap:r}}(M,t),_=D.rowGap,E=D.columnGap,P=""+-.5*E.value+E.unit,R=""+-.5*_.value+_.unit,N={textOverflow:"ellipsis"},B={"> *:not(.ms-StackItem)":{flexShrink:S?0:1}};return y?{root:[x.root,{flexWrap:"wrap",maxWidth:k,maxHeight:w,width:"auto",overflow:"visible",height:"100%"},j&&(a={},a[v?"justifyContent":"alignItems"]=p[j]||j,a),A&&(i={},i[v?"alignItems":"justifyContent"]=p[A]||A,i),I,{display:"flex"},v&&{height:m?"100%":"auto"}],inner:[x.inner,{display:"flex",flexWrap:"wrap",marginLeft:P,marginRight:P,marginTop:R,marginBottom:R,overflow:"visible",boxSizing:"border-box",padding:l(T,t),width:0===E.value?"100%":"calc(100% + "+E.value+E.unit+")",maxWidth:"100vw",selectors:Object(r.__assign)({"> *":Object(r.__assign)({margin:""+.5*_.value+_.unit+" "+.5*E.value+E.unit},N)},B)},j&&(o={},o[v?"justifyContent":"alignItems"]=p[j]||j,o),A&&(s={},s[v?"alignItems":"justifyContent"]=p[A]||A,s),v&&{flexDirection:C?"row-reverse":"row",height:0===_.value?"100%":"calc(100% + "+_.value+_.unit+")",selectors:{"> *":{maxWidth:0===E.value?"100%":"calc(100% - "+E.value+E.unit+")"}}},!v&&{flexDirection:C?"column-reverse":"column",height:"calc(100% + "+_.value+_.unit+")",selectors:{"> *":{maxHeight:0===_.value?"100%":"calc(100% - "+_.value+_.unit+")"}}}]}:{root:[x.root,{display:"flex",flexDirection:v?C?"row-reverse":"row":C?"column-reverse":"column",flexWrap:"nowrap",width:"auto",height:m?"100%":"auto",maxWidth:k,maxHeight:w,padding:l(T,t),boxSizing:"border-box",selectors:Object(r.__assign)((c={"> *":N},c[C?"> *:not(:last-child)":"> *:not(:first-child)"]=[v&&{marginLeft:""+E.value+E.unit},!v&&{marginTop:""+_.value+_.unit}],c),B)},O&&{flexGrow:!0===O?1:O},j&&(g={},g[v?"justifyContent":"alignItems"]=p[j]||j,g),A&&(h={},h[v?"alignItems":"justifyContent"]=p[A]||A,h),I]}},statics:h})},2319:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(450),a=n(1791),i=n(1642),o=Object(r.a)(a.a,i.a,void 0,{scope:"TeachingBubble"})},2872:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),a=n(83),i=n(1318),o=n(621);function s(e,t,n,s){var c=Object(o.e)(n,e,null,t),u=Object(r.__assign)(Object(r.__assign)({},s),{includeFluidOnPopout:Object(i.d)(i.a.Bohemia).bohemiaEnabled&&Object(i.d)(i.a.Bohemia).fluidEnabledForTenant&&Object(a.i)("cmp-prague")});Object(o.c)("mail",c,u,{resizable:!0})}},3191:function(e){e.exports=JSON.parse('{"a":"Ccc"}')},325:function(e){e.exports=JSON.parse('{"l":"PBa","i":"QBa","n":"RBa","k":"SBa","m":"TBa","j":"UBa","d":"VBa","b":"WBa","f":"XBa","g":"YBa","e":"ZBa","a":"_Ba","c":"$Ba","o":"aCa","s":"bCa","r":"cCa","p":"dCa","q":"eCa","h":"fCa"}')},432:function(e,t,n){"use strict";var r=n(561),a=n(562),i=n(563),o=n(564),s=n(565),c=n(566),u=n(567),d=n(507),l=n(508),f=n(509),p=n(510),b=n(511),g=n(512),h=n(513),m=n(514),v=n(515),C=n(516),O=n(517),y=n(518),j=n(325),A=n(779),S=n(569),I=n(570),x=n(571),M=n(572),w=n(573),k=n(574),T=n(575),D=n(576),_=n(577),E=n(578),P=n(579),R=n(580),N=n(12),B=n(20),F=function(){return L.get()},L=Object(B.computed)((function(){return{months:[Object(N.b)(y.a),Object(N.b)(O.a),Object(N.b)(C.a),Object(N.b)(v.a),Object(N.b)(m.a),Object(N.b)(h.a),Object(N.b)(g.a),Object(N.b)(b.a),Object(N.b)(p.a),Object(N.b)(f.a),Object(N.b)(l.a),Object(N.b)(d.a)],shortMonths:[Object(N.b)(R.a),Object(N.b)(P.a),Object(N.b)(E.a),Object(N.b)(_.a),Object(N.b)(D.a),Object(N.b)(T.a),Object(N.b)(k.a),Object(N.b)(w.a),Object(N.b)(M.a),Object(N.b)(x.a),Object(N.b)(I.a),Object(N.b)(S.a)],days:[Object(N.b)(u.a),Object(N.b)(c.a),Object(N.b)(s.a),Object(N.b)(o.a),Object(N.b)(i.a),Object(N.b)(a.a),Object(N.b)(r.a)],shortDays:[Object(N.b)(j.d),Object(N.b)(j.b),Object(N.b)(j.f),Object(N.b)(j.g),Object(N.b)(j.e),Object(N.b)(j.a),Object(N.b)(j.c)],goToToday:Object(N.b)(A.a),prevMonthAriaLabel:Object(N.b)(j.l),nextMonthAriaLabel:Object(N.b)(j.i),prevYearAriaLabel:Object(N.b)(j.n),nextYearAriaLabel:Object(N.b)(j.k),prevYearRangeAriaLabel:Object(N.b)(j.m),nextYearRangeAriaLabel:Object(N.b)(j.j),monthPickerHeaderAriaLabel:Object(N.b)(j.o),yearPickerHeaderAriaLabel:Object(N.b)(j.s),weekNumberFormatString:Object(N.b)(j.r),selectedDateFormatString:Object(N.b)(j.p),todayDateFormatString:Object(N.b)(j.q),dayMarkedAriaLabel:Object(N.b)(j.h)}})),U=n(96),H=function(e,t){return e?e.tz:t||Object(U.p)()},z=n(9),J=function(e,t){return Object(z.Qb)(e,t.getFullYear(),t.getMonth(),t.getDate())};n.d(t,"a",(function(){return F})),n.d(t,"c",(function(){return H})),n.d(t,"b",(function(){return J}))},4321:function(e,t,n){"use strict";var r=n(20),a=n(3),i={themeStore:{loadStatus:0,themeMapping:{}},cards:new r.ObservableMap},o=Object(a.createStore)("ActionableMessage",i);t.a=o()},507:function(e){e.exports=JSON.parse('{"a":"rCa"}')},508:function(e){e.exports=JSON.parse('{"a":"qCa"}')},509:function(e){e.exports=JSON.parse('{"a":"pCa"}')},510:function(e){e.exports=JSON.parse('{"a":"oCa"}')},511:function(e){e.exports=JSON.parse('{"a":"nCa"}')},512:function(e){e.exports=JSON.parse('{"a":"mCa"}')},513:function(e){e.exports=JSON.parse('{"a":"lCa"}')},514:function(e){e.exports=JSON.parse('{"a":"kCa"}')},515:function(e){e.exports=JSON.parse('{"a":"jCa"}')},516:function(e){e.exports=JSON.parse('{"a":"iCa"}')},517:function(e){e.exports=JSON.parse('{"a":"hCa"}')},518:function(e){e.exports=JSON.parse('{"a":"gCa"}')},561:function(e){e.exports=JSON.parse('{"a":"qBa"}')},562:function(e){e.exports=JSON.parse('{"a":"wBa"}')},563:function(e){e.exports=JSON.parse('{"a":"vBa"}')},564:function(e){e.exports=JSON.parse('{"a":"uBa"}')},565:function(e){e.exports=JSON.parse('{"a":"tBa"}')},566:function(e){e.exports=JSON.parse('{"a":"sBa"}')},567:function(e){e.exports=JSON.parse('{"a":"rBa"}')},569:function(e){e.exports=JSON.parse('{"a":"NBa"}')},570:function(e){e.exports=JSON.parse('{"a":"MBa"}')},571:function(e){e.exports=JSON.parse('{"a":"LBa"}')},572:function(e){e.exports=JSON.parse('{"a":"KBa"}')},573:function(e){e.exports=JSON.parse('{"a":"JBa"}')},574:function(e){e.exports=JSON.parse('{"a":"IBa"}')},575:function(e){e.exports=JSON.parse('{"a":"HBa"}')},576:function(e){e.exports=JSON.parse('{"a":"GBa"}')},577:function(e){e.exports=JSON.parse('{"a":"FBa"}')},578:function(e){e.exports=JSON.parse('{"a":"EBa"}')},579:function(e){e.exports=JSON.parse('{"a":"DBa"}')},580:function(e){e.exports=JSON.parse('{"a":"CBa"}')},779:function(e){e.exports=JSON.parse('{"a":"OBa"}')},8511:function(e,t,n){"use strict";var r=n(59),a=function(){function e(e,t){var n=this;void 0===e&&(e=5),void 0===t&&(t=5e3),this.throttleCallbacks=[],this.activeRequests=0,this.processedRequests=0,this.lastProcessedRequests=0,this.watchDogTimer=null,this.clearQueue=function(){n.throttleCallbacks.length=0,n.activeRequests=0},this.maxConcurrentRequests=e,this.watchDogTimerInterval=t}return e.prototype.watchDogAction=function(){this.throttleCallbacks.length>0?this.processedRequests===this.lastProcessedRequests?(this.activeRequests=0,this.traceInfo("Watch dog is processing the queue."),this.processNextRequest()):(this.traceInfo("Watch dog is watching."),this.lastProcessedRequests=this.processedRequests):(window.clearInterval(this.watchDogTimer),this.watchDogTimer=null,this.traceInfo("Stop watch dog."))},e.prototype.traceInfo=function(e){r.g.info("ThrottleRequests:active="+this.activeRequests+";throttled="+this.throttleCallbacks.length+";processed="+this.processedRequests+";lastProcessed="+this.lastProcessedRequests+";info="+e)},e.prototype.processNextRequest=function(){(this.processedRequests++,0===this.throttleCallbacks.length)?(this.activeRequests>0&&this.activeRequests--,this.traceInfo("Queue is empty.")):(this.throttleCallbacks.shift()(!1),this.traceInfo("Process next."))},e.prototype.registerCallback=function(e){var t=this;if(null==e)throw new Error("A null callback is registered to Throttle Thumbnails queue.");this.activeRequests<this.maxConcurrentRequests?(e(!1),this.activeRequests++,this.processedRequests++,this.traceInfo("Process now.")):(e(!0),this.throttleCallbacks.push(e),this.traceInfo("Pushes to queue."),this.watchDogTimer||(this.watchDogTimer=window.setInterval((function(){t.watchDogAction()}),this.watchDogTimerInterval),this.traceInfo("Start watch dog.")))},e.prototype.unregisterCallback=function(e){var t=this.throttleCallbacks.indexOf(e);this.throttleCallbacks.splice(t,1),this.activeRequests=0,this.traceInfo("unregisterComponent:"+t)},e}();t.a=a},8922:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(77),a=new r.c((function(){return Promise.all([n.e(7),n.e(12),n.e(145),n.e(146),n.e(203),n.e(662)]).then(n.bind(null,10827))})),i=new r.b(a,(function(e){return e.openBotConversation})),o=new r.b(a,(function(e){return e.openCortanaConversation}));new r.a(a,(function(e){return e.setEditorInterface}))},8948:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u}));var r=n(3),a=Object(r.action)("addCard",(function(e){return{cardId:e}})),i=Object(r.action)("removeCard",(function(e){return{cardId:e}})),o=Object(r.action)("setAutoInvokeActionAlreadyRan",(function(e,t){return{cardId:e,autoInvokeActionAlreadyRan:t}})),s=Object(r.action)("markPerfCheckpoint",(function(e,t,n){return{cardId:e,perfMarker:t,time:n}})),c=Object(r.action)("setTotalFetchTimeForCard",(function(e,t){return{cardId:e,totalFetchTime:t}})),u=Object(r.action)("updatePerfCheckpointsBeforeUpdatingAutoInvokeResponse",(function(e){return{cardId:e}}))}}]);
//# sourceMappingURL=owa.MailBoot~ActionableMessageMail.js.map
self.scriptsLoaded['owa.MailBoot~ActionableMessageMail.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ActionableMessageMail.js'] = (new Date()).getTime();