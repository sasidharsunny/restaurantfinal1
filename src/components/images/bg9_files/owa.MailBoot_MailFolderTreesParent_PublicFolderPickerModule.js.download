self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailFolderTreesParent~PublicFolderPickerModule.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[251],{1317:function(e,t,n){"use strict";var r=n(1432),o=n(1350),i=n(3),a=n(20),u={viewStates:new a.ObservableMap,livePersonaCardInitializationStatus:{state:r.a.NotInitialized,timestamp:Date.now()},isLivePersonaCardInitialized:!1,isPersonaCardDisabled:!1,brandList:null,brandListLoadState:o.a.unloaded,dynamicBrandSets:{unverifiedBrands:new a.ObservableMap,verifiedBrands:new a.ObservableMap}},c=Object(i.createStore)("personacontrol",u)();t.a=c},1350:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.unloaded=0]="unloaded",e[e.loading=1]="loading",e[e.loadSucceeded=2]="loadSucceeded",e[e.loadFailed=3]="loadFailed"}(r||(r={}))},1369:function(e,t,n){"use strict";n.d(t,"l",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"i",(function(){return v})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return h})),n.d(t,"j",(function(){return O})),n.d(t,"k",(function(){return g})),n.d(t,"g",(function(){return m}));var r,o,i=n(33),a=n(30),u=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],c=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],s={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};function d(){return Object(a.a)().SessionSettings.IsPremiumConsumerMailbox}function l(){return Object(a.a)().IsConsumerChild}function f(){return Object(a.a)().SessionSettings.IsShadowMailbox}function b(){return void 0!==o?o:o=function(){var e=Object(a.a)(),t=e.SessionSettings.UserCulture;if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return t?t.toLowerCase():"en-us";var n=e.AdMarket.toLowerCase();return u.indexOf(n)>-1?n:s[n.split("-")[1]]||n}()}function v(e){return null!=e?e.toUpperCase().split("-"):[]}function p(e){return v(e)[1]||"US"}function h(){return Object(i.a)("ANON")}function O(){return Object(i.a)("MUID")}function g(){return!!Object(i.a)("TOptOut")}function m(){return r||(r="https://acdn.adnxs.com/ast/static/0.30.1/ast.js")}},1376:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(30),o=n(320),i=n(83);function a(){return Object(o.a)()&&Object(i.i)("rp-imageApiConsumer")&&!Object(r.a)().SessionSettings.IsShadowMailbox}},1403:function(e,t,n){"use strict";var r=n(57);function o(e,t){return e?t(e):e}function i(e){return e.replace(/\bctrl\b/,"command")}var a=[function(e){if(Array.isArray(e)){if(e.includes("del"))return e.concat("backspace")}else if(-1!==e.indexOf("del"))return[e,e.replace("del","backspace")];return e},function(e){return Array.isArray(e)?e.map(i):i(e)}];function u(e){return Object(r.n)()?function(e,t){return Array.isArray(e)||"string"==typeof e?t.reduce((function(e,t){return t(e)}),e):{hotmail:t.reduce((function(e,t){return o(e,t)}),e.hotmail),owa:t.reduce((function(e,t){return o(e,t)}),e.owa),gmail:t.reduce((function(e,t){return o(e,t)}),e.gmail),yahoo:t.reduce((function(e,t){return o(e,t)}),e.yahoo)}}(e,a):e}n.d(t,"a",(function(){return u}))},1423:function(e,t,n){"use strict";n.d(t,"k",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"l",(function(){return v})),n.d(t,"n",(function(){return p})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return O})),n.d(t,"g",(function(){return g})),n.d(t,"e",(function(){return m})),n.d(t,"m",(function(){return S})),n.d(t,"i",(function(){return F})),n.d(t,"j",(function(){return j}));var r=n(77),o=n(1896),i=n(1787),a=n(1897),u=n(1914),c=new r.c((function(){return Promise.all([n.e(1),n.e(5),n.e(6),n.e(7),n.e(8),n.e(11),n.e(13),n.e(14),n.e(16),n.e(18),n.e(21),n.e(19),n.e(29),n.e(37),n.e(40),n.e(43),n.e(45),n.e(50),n.e(49),n.e(54),n.e(64),n.e(69),n.e(82),n.e(100),n.e(827)]).then(n.bind(null,3822))})),s=new r.c((function(){return Promise.all([n.e(1),n.e(6),n.e(14),n.e(16),n.e(18),n.e(25),n.e(24),n.e(27),n.e(31),n.e(33),n.e(40),n.e(42),n.e(43),n.e(45),n.e(49),n.e(55),n.e(56),n.e(58),n.e(62),n.e(63),n.e(67),n.e(175),n.e(257),n.e(631)]).then(n.bind(null,3829))})),d=Object(r.d)(c,(function(e){return e.SearchHeaderFirstRowContent})),l=Object(r.d)(c,(function(e){return e.SearchFiltersContainer})),f=Object(r.d)(c,(function(e){return e.AdvancedSearchWrapper})),b=Object(r.d)(c,(function(e){return e.FolderScopePicker})),v=new r.b(c,(function(e){return e.setStaticSearchScopeData})),p=new r.b(c,(function(e){return e.startSearchWithCategory})),h=new r.a(c,(function(e){return e.findEmailFromSender})),O=(new r.b(c,(function(e){return e.initializeLivePersonaCard})),new r.b(c,(function(e){return e.personaControlStore})),new r.b(c,(function(e){return e.createFallbackPersonaSearchTableQuery}))),g=new r.b(c,(function(e){return e.createFallbackPrivateDistributionListSearchTableQuery})),m=new r.b(c,(function(e){return e.createFallbackCategorySearchTableQuery})),S=new r.b(c,(function(e){return e.shouldShowInScopeSelector}));Object(r.f)(o.a,c,(function(e){return e.getSuggestionsOrchestrator})),Object(r.f)(i.a,c,(function(e){return e.searchSessionStartedOrchestrator})),Object(r.f)(a.a,c,(function(e){return e.startSearchOrchestrator}),{captureBundleTime:!0}),Object(r.f)(u.a,s,(function(e){return e.startAnswerSearchSessionOrchestrator}));var F=new r.b(c,(function(e){return e.getNaturalLanguageGhostText})),j=new r.a(c,(function(e){return e.initializeSearch}))},1432:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.NotInitialized="NotInitialized",e.Initializing="Initializing",e.Initialized="Initialized",e.Failed="Failed"}(r||(r={}))},1437:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1801),o=n(1684);function i(e){return Object(o.b)().scenarioStores.get(Object(r.a)(e))||Object(o.a)()}},1480:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1376);function o(e,t,n,o,i){var a="",u=Object(r.a)();return e?a+=e.toLowerCase():t?a+=t:i&&(a+=i.toLowerCase()),o&&u&&(a+=o),n&&!u&&(a+=n),a}},1484:function(e,t,n){"use strict";var r=n(20),o=n(3),i={viewStates:new r.ObservableMap,primaryComposeId:null,newMessageCreationInProgress:!1},a=Object(o.createStore)("compose",i),u=a();n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return a}))},1495:function(e,t,n){"use strict";n.d(t,"o",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"m",(function(){return f})),n.d(t,"r",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"q",(function(){return p})),n.d(t,"n",(function(){return h})),n.d(t,"l",(function(){return O})),n.d(t,"d",(function(){return g})),n.d(t,"i",(function(){return m})),n.d(t,"p",(function(){return S})),n.d(t,"c",(function(){return F})),n.d(t,"g",(function(){return j})),n.d(t,"e",(function(){return w})),n.d(t,"s",(function(){return y}));var r=n(77),o=n(1667);n.d(t,"a",(function(){return o.a}));var i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5),n.e(6),n.e(7),n.e(8),n.e(11),n.e(13),n.e(14),n.e(16),n.e(18),n.e(21),n.e(26),n.e(32),n.e(34),n.e(35),n.e(37),n.e(39),n.e(41),n.e(43),n.e(50),n.e(811)]).then(n.bind(null,2696))})),a={captureBundleTime:!0},u=new r.a(i,(function(e){return e.replyToMessage}),a),c=new r.a(i,(function(e){return e.forwardMessage}),a),s=new r.a(i,(function(e){return e.closeCompose})),d=new r.a(i,(function(e){return e.discardCompose})),l=new r.a(i,(function(e){return e.loadDraftToCompose})),f=new r.a(i,(function(e){return e.openCompose})),b=new r.a(i,(function(e){return e.trySaveAndCloseCompose})),v=new r.a(i,(function(e){return e.moveComposeToTab})),p=new r.a(i,(function(e){return e.tryCreateResendDraft})),h=new r.a(i,(function(e){return e.replyToApprovalMessage})),O=new r.a(i,(function(e){return e.onEditDraftButtonClicked})),g=new r.b(i,(function(e){return e.createReply})),m=new r.b(i,(function(e){return e.getToCcRecipientsForReply})),S=new r.b(i,(function(e){return e.replyToMessageAndCreateViewState})),F=new r.b(i,(function(e){return e.createAttachments})),j=new r.b(i,(function(e){return e.extractComposePopoutData})),w=new r.b(i,(function(e){return e.didInsertLinksHaveIssuesOnBlockDialogDismiss})),y=new r.b(i,(function(e){return e.insertSignature}))},1531:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return d}));var r=n(3),o=Object(r.action)("CLEAR_SEARCH_SCOPE",(function(e,t,n){return{actionSource:e,shouldStartSearch:t,searchScopeKind:n}})),i=Object(r.action)("LOAD_MESSAGE_SUGGESTION_INTO_TABLE",(function(e,t,n,r,o,i){return{actionSource:e,row:t,searchTableQuery:n,referenceId:r,traceId:o,itemPartId:i}})),a=Object(r.action)("LOAD_TABLE_VIEW_FROM_SEARCH_TABLE_QUERY",(function(e,t,n){return{searchTableQuery:e,searchEndToEndPerformanceDatapoint:t,actionSource:n}})),u=Object(r.action)("SET_STATIC_SEARCH_SCOPE",(function(e){return{searchScope:e}})),c=Object(r.action)("START_SEARCH_WITH_CATEGORY",(function(e,t){return{actionSource:e,categoryName:t}})),s=Object(r.action)("FIND_EMAIL_FROM_SENDER_CLICKED",(function(e,t){return{senderName:e,senderEmail:t}})),d=Object(r.action)("ON_ANSWER_RENDERED")},1538:function(e,t,n){"use strict";var r=n(77),o={sequentialIndex:"0",nonSequentialIndex:"-1"};n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return o}));var i=new r.c((function(){return n.e(817).then(n.bind(null,16995))})),a=new r.a(i,(function(e){return e.registerComponent})),u=new r.a(i,(function(e){return e.resetFocus})),c=new r.a(i,(function(e){return e.setFocusToSynchronous}))},1556:function(e,t,n){"use strict";var r=n(77),o=n(2123),i=n(3),a=n(1312),u=Object(i.mutatorAction)("loadPopoutDataToFolderStore",(function(e){var t=e.folderId,n=e.treeType,r=e.permission,o=e.principalSMTPAddress,i=Object(a.o)();if(!i.get(t)){var u={FolderId:{Id:t},treeType:n,PermissionSet:{Permissions:[r]},principalSMTPAddress:o};i.set(t,u)}})),c=n(3114),s=Object(i.mutatorAction)("loadPopoutDataToPublicFolderFavoriteStore",(function(e){var t=e.folderId,n=e.treeType,r=e.replicaItem,o=c.b.folderTable;if(!o.get(t)){var i={FolderId:{Id:t},treeType:n,ReplicaList:[r]};o.set(t,i)}})),d=n(1996),l=n(1322),f=n(1338),b=n(1323),v=n(285),p=Object(v.action)("selectFolderWithFallbackInFolderForest")((function(e,t){var n=Object(l.a)(e)||e;Object(b.r)(n)?Object(f.isFolderInFavorites)(n)?Object(d.a)(n,"favorites",t):Object(d.a)(n,"primaryFolderTree",t):Object(o.a)(t)})),h=n(1392);function O(e,t){var n=Object(h.c)();return(null==n?void 0:n.id)&&n.treeType==t&&e.toLowerCase()==n.id.toLowerCase()}var g=n(2723),m=n(3142),S=n(3143),F=n(3442);Object(i.orchestrator)(F.a,(function(e){p("notes",e.actionSource)}));n.d(t,"c",(function(){return w})),n.d(t,"l",(function(){return y})),n.d(t,"h",(function(){return I})),n.d(t,"g",(function(){return T})),n.d(t,"i",(function(){return A})),n.d(t,"f",(function(){return C})),n.d(t,"j",(function(){return P})),n.d(t,"k",(function(){return k})),n.d(t,"e",(function(){return E})),n.d(t,"b",(function(){return R})),n.d(t,"d",(function(){return _})),n.d(t,"p",(function(){return o.a})),n.d(t,"m",(function(){return u})),n.d(t,"n",(function(){return s})),n.d(t,"q",(function(){return d.a})),n.d(t,"r",(function(){return p})),n.d(t,"a",(function(){return O})),n.d(t,"o",(function(){return g.a}));var j=new r.c((function(){return Promise.all([n.e(14),n.e(40),n.e(557)]).then(n.bind(null,16670))})),w=new r.a(j,(function(e){return e.loadDumpster})),y=new r.a(j,(function(e){return e.toggleFavoriteFolder})),I=new r.a(j,(function(e){return e.selectFolderNode})),T=new r.a(j,(function(e){return e.selectFavoriteSearch})),A=new r.a(j,(function(e){return e.selectGroup})),C=new r.a(j,(function(e){return e.selectFavoriteCategory})),P=new r.a(j,(function(e){return e.selectPersona})),k=new r.a(j,(function(e){return e.selectPrivateDistributionList})),E=new r.a(j,(function(e){return e.prefetchFrequentlyUsedFolders})),R=new r.a(j,(function(e){return e.deleteFolderInFolderForest})),_=new r.a(j,(function(e){return e.logConsumerDeletedRetentionPolicy}));Object(r.f)(m.a,j,(function(e){return e.selectPreviousNodeOrchestrator})),Object(r.f)(S.a,j,(function(e){return e.validateDumpsterQuotaOrchestrator}))},1563:function(e,t,n){"use strict";var r=n(0),o=n(20),i=n(1),a=n(77),u=new a.c((function(){return n.e(1569).then(n.t.bind(null,16431,7))})),c=new a.b(u,(function(e){return e.default})),s=n(96),d=n(1403);function l(e){if("string"==typeof(e=Object(d.a)(e))||Array.isArray(e))return e;var t=Object(s.h)().UserOptions,n=(void 0===t?{}:t).KeyboardShortcutsMode;switch(void 0===n?"":n){case 0:return e.hotmail;case 2:return e.yahoo;case 3:return e.gmail;case 4:return e.owa;default:return}}function f(e,t,n,r,o){return function(i){(function(e,t){if(t)return!1;var n=e.target;return"INPUT"==n.tagName||"SELECT"==n.tagName||"TEXTAREA"==n.tagName||n.contentEditable&&"true"==n.contentEditable})(i,e)||t&&!t()||(n&&i.stopPropagation(),r&&i.preventDefault(),o(i))}}function b(e,t,n){void 0===n&&(n={}),h(void 0,i.useMemo((function(){return[{command:e,handler:t,options:n}]}),[e,t,n.stopPropagation,n.preventDefault,n.allowHotkeyOnTextFields,n.isEnabled]))}function v(e,t,n,r){void 0===r&&(r={}),h(e,i.useMemo((function(){return[{command:t,handler:n,options:r}]}),[t,n,r.stopPropagation,r.preventDefault,r.allowHotkeyOnTextFields,r.isEnabled]))}function p(e,t,n){h(e,i.useMemo((function(){return t(n)}),[t,n]))}function h(e,t){var n=this;i.useEffect((function(){var i=Object(r.__awaiter)(n,void 0,void 0,(function(){var n,i,a,u,s,d;return Object(r.__generator)(this,(function(b){switch(b.label){case 0:return[4,c.import()];case 1:return n=b.sent(),(i=e?e.current:document.body)?(a=new n(i),Array.isArray(t)?(s=t,[3,4]):[3,2]):[3,5];case 2:return[4,t];case 3:s=b.sent(),b.label=4;case 4:return u=s,d=Object(o.autorun)((function(){var e,t;try{for(var n=Object(r.__values)(u),o=n.next();!o.done;o=n.next()){var i=o.value,c=i.command,s=i.handler,d=i.options,b=void 0===d?{}:d,v=b.stopPropagation,p=void 0===v||v,h=b.preventDefault,O=void 0===h||h,g=b.allowHotkeyOnTextFields,m=void 0!==g&&g,S=b.isEnabled,F=void 0===S?void 0:S,j=l(c);j&&a.bind(j,f(m,F,p,O,s))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}})),[2,function(){a.reset(),d()}];case 5:return[2,function(){}]}}))}));return function(){i.then((function(e){return e()}))}}),[e,t])}n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return d.a}))},1606:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(83),o=n(96);function i(){return Object(r.i)("mail-oneView")&&Object(o.r)()}},1631:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Mail=1]="Mail",e[e.Calendar=2]="Calendar",e[e.FilesHub=3]="FilesHub",e[e.FilesPicker=4]="FilesPicker",e[e.Spaces=5]="Spaces",e[e.FileSuggestions=6]="FileSuggestions"}(r||(r={})),t.b=r},1632:function(e,t,n){"use strict";function r(){return{isBeingDragged:!1}}n.d(t,"a",(function(){return r}))},1648:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(20),o=n(3),i={mailFavoritesViewState:{contextMenuState:null,shouldShowFindFavoritesPicker:!1},favoritePersonasRootFolderId:void 0,isFavoritingInProgress:new r.ObservableMap({}),favoriteNodeViewStates:new r.ObservableMap({})},a=Object(o.createStore)("mailFavorites",i);t.a=a()},1667:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("conversationSendStateChanged",(function(e,t){return{viewState:e,isSendPending:t}}))},1684:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(20),o=n(3),i=function(){return{alteredQuery:"",alterationProviderId:null,answerPlaceholderId:null,currentSearchQueryId:null,currentSuggestions:null,displayedQFRequestTime:null,flaggedTokens:[],isAnswerRendered:!1,isLastKeyPressedDeletion:!1,isSuggestionsCalloutClickable:!1,isSuggestionsDropdownVisible:!1,isUsing3S:null,latestQFRequestId:null,latestRenderedQFTraceId:null,latestQFTraceId:null,latestTraceId:null,nextSearchQueryId:null,recourseQuery:"",searchBoxHasFocus:!1,searchBoxWidth:null,searchSessionGuid:null,searchText:"",searchTextForSuggestion:"",selectedPillIndex:-1,selectedSuggestionIndex:-1,showRefiners:!1,showSearchBoxInCompactMode:!1,suggestedSearchTerm:"",suggestedSearchTermReferenceId:"",suggestionPillIds:[],suggestionPills:new r.ObservableMap,queryAlterationType:null,queryActionSource:null,queryAlterationLogicalId:null,traceIdToLogicalIdMap:new r.ObservableMap,tableViewId:null,isScopePickerVisible:!1}},a={scenarioStores:new r.ObservableMap},u=Object(o.createStore)("commonSearchStore",a);t.b=u},1783:function(e,t,n){"use strict";n.r(t);var r=n(77),o=n(0),i=n(269),a=n(668),u=n(362),c=n(30),s=n(3),d=n(2724),l=n(1338);Object(s.orchestrator)(l.migrateOutlookFavorites,(function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r,s,v,p,h,O,g,m,S,F;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return e=function(){var e=Object(c.a)().UserOptions.FavoriteNodes;if(!e)return{owsFavoritesData:[],clientFavoritesData:[]};var t=[],n=[];return e.forEach((function(e){var r=Object(l.parseFavoriteNode)(e);switch(r.type){case 1:var o=r;if(!Object(l.isPersonaInFavorites)(o.personaId,o.mainEmailAddress)){var i=function(e,t,n){return{treeType:"favorites",type:"persona",favoriteId:e,displayName:t.displayName,searchFolderId:t.searchFolderId,client:n?"Migration":"OWA",allEmailAddresses:t.allEmailAddresses,personaId:t.personaId,mainEmailAddress:t.mainEmailAddress,isSearchFolderPopulated:!!t.searchFolderId,isSyncUpdateDone:!0}}(f=Object(u.a)(),o,!0),c=function(e){var t=[],n=[],r=e.displayName||e.mainEmailAddress;if(r){if(e.mainEmailAddress){t.push({Key:"MainEmailAddress",Value:e.mainEmailAddress}),e.searchFolderId&&t.push({Key:"SearchFolderId",Value:Object(l.convertEWSFolderIdToRestFolderId)(e.searchFolderId)});var o=e.allEmailAddresses&&e.allEmailAddresses.filter((function(e){return!!e}));o.length>0?n.push({Key:"EmailAddresses",Values:o}):n.push({Key:"EmailAddresses",Values:[e.mainEmailAddress]})}if(e.personaId&&t.push({Key:"PersonaId",Value:Object(l.convertEWSFolderIdToRestFolderId)(e.personaId)}),0!==t.length)return{Type:"persona",DisplayName:r,SingleValueSettings:t,MultiValueSettings:n,Client:"Migration"}}}(o);c&&(t.push(c),n.push(i))}break;case 4:var s=r.id,d=Object(a.o)().filter((function(e){return e.Id===s}))[0];if(d&&!Object(l.isCategoryInFavorites)(s)){var f=Object(u.a)(),b=Object(l.createClientFavoriteCategoryData)(f,d,!0),v=Object(l.createOwsFavoriteCategoryData)(d,!0);t.push(v),n.push(b)}}})),{owsFavoritesData:t,clientFavoritesData:n}}(),t=e.owsFavoritesData,n=e.clientFavoritesData,0===t.length?(b(),[2]):[4,l.lazyAddMultipleFavoritesToStore.import()];case 1:o.sent()(n),(r=n.filter((function(e){return"persona"===e.type}))).length>0&&Object(d.a)(r),s=Math.ceil(t.length/20),v=!1,(p=new i.a("MigrateOutlookFavoriteService",{isCore:!0})).addCustomProperty("totalBatchCount",s),h=0,O=0,o.label=2;case 2:return h<s?(g=t.slice(O,O+20),(m=new i.a("MigrateOutlookFavoriteSingleBatchService",{isCore:!0})).addCustomProperty("favoritesCount",g.length),S=n.slice(O,O+20),[4,f(g,S,m)]):[3,5];case 3:v=o.sent(),o.label=4;case 4:return h++,O+=20,[3,2];case 5:return v?p.endWithError("ServerError"):p.end(),(F=!Object(l.getIsBitEnabled)(8))?(l.lazySetOutlookFavoritesBitFlag.importAndExecute(8),v||b()):b(),Object(i.p)(F?"FirstAttemptMigrationCompleted":"SecondAttemptMigrationCompleted",[v],{isCore:!0}),[2]}}))}))}));function f(e,t,n){return Object(o.__awaiter)(this,void 0,void 0,(function(){var r,i,a,u,c,s;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,Object(l.createMultipleOutlookFavoritesService)(e)];case 1:return r=o.sent(),[3,3];case 2:return i=o.sent(),n.endWithError("ServerError",i),[2,!0];case 3:return o.trys.push([3,5,,6]),a=(r.value||[]).map((function(e){return Object(l.convertServiceResponseToFavoriteData)(e,e.Type.toLowerCase())})),[4,l.lazyAddMultipleFavoritesCompleted.import()];case 4:return o.sent()(t,a),u=a.filter((function(e){return"persona"===e.type})),c=a.filter((function(e){return"category"===e.type})),n.addCustomProperty("migratedPersonasCount",u.length),n.addCustomProperty("migratedCategoriesCount",c.length),n.end(),[3,6];case 5:return s=o.sent(),n.endWithError("ClientError",s),[2,!0];case 6:return[2,!1]}}))}))}function b(){l.lazySetOutlookFavoritesBitFlag.importAndExecute(16)}var v=n(1648),p=n(1632),h=n(1362),O=Object(s.mutatorAction)("setFavoriteNodeViewStateMutator",(function(e,t){Object(v.b)().favoriteNodeViewStates.set(e,t)}));function g(e){return Object(v.b)().favoriteNodeViewStates.has(e)||O(e,{drag:Object(p.a)(),drop:Object(h.a)()}),Object(v.b)().favoriteNodeViewStates.get(e)}var m=n(285),S=Object(m.action)("showFindFavoritesPicker")((function(e){v.a.mailFavoritesViewState.shouldShowFindFavoritesPicker=e})),F=n(2301);n.d(t,"lazyModule",(function(){return j})),n.d(t,"lazyToggleFavoritesTreeExpansion",(function(){return w})),n.d(t,"lazyRemoveFavoriteSearch",(function(){return y})),n.d(t,"lazyRemoveFavoritePersona",(function(){return I})),n.d(t,"lazyOnSelectedPersonaNodeChanged",(function(){return T})),n.d(t,"lazyHandleToggleFavoritePersonaError",(function(){return A})),n.d(t,"lazyMarkFavoritePersonaNodeAsAdded",(function(){return C})),n.d(t,"lazyOnFavoritePersonaSelected",(function(){return P})),n.d(t,"lazyAddFavoriteFolder",(function(){return k})),n.d(t,"lazyRemoveFavoriteFolder",(function(){return E})),n.d(t,"lazyAddFavoriteFolderV1",(function(){return R})),n.d(t,"lazyRemoveFavoriteFolderV1",(function(){return _})),n.d(t,"lazyOnFavoritePersonaUpdated",(function(){return D})),n.d(t,"lazyAddFavoritePersona",(function(){return x})),n.d(t,"lazyInitializeFavoritePersonas",(function(){return M})),n.d(t,"lazyOutlookFavoritePersonasLoaded",(function(){return N})),n.d(t,"getFavoriteNodeViewStateFromId",(function(){return g})),n.d(t,"getStore",(function(){return v.b})),n.d(t,"showFindFavoritesPicker",(function(){return S})),n.d(t,"isFavoritingInProgress",(function(){return F.a}));var j=new r.c((function(){return Promise.all([n.e(41),n.e(59),n.e(65),n.e(71),n.e(79),n.e(170),n.e(249),n.e(617)]).then(n.bind(null,16654))})),w=new r.a(j,(function(e){return e.toggleFavoritesTreeExpansion})),y=new r.a(j,(function(e){return e.removeFavoriteSearch})),I=new r.a(j,(function(e){return e.removeFavoritePersona})),T=new r.a(j,(function(e){return e.onSelectedPersonaNodeChanged})),A=new r.a(j,(function(e){return e.handleToggleFavoritePersonaError})),C=new r.a(j,(function(e){return e.markFavoritePersonaNodeAsAdded})),P=new r.a(j,(function(e){return e.onFavoritePersonaSelected})),k=new r.b(j,(function(e){return e.addFavoriteFolder})),E=new r.b(j,(function(e){return e.removeFavoriteFolder})),R=new r.a(j,(function(e){return e.addFavoriteFolderV1})),_=new r.a(j,(function(e){return e.removeFavoriteFolderV1})),D=new r.a(j,(function(e){return e.onFavoritePersonaUpdated})),x=new r.a(j,(function(e){return e.addFavoritePersona})),M=new r.a(j,(function(e){return e.initializeFavoritePersonas})),N=new r.a(j,(function(e){return e.outlookFavoritePersonasLoaded}))},1787:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("SEARCH_SESSION_STARTED",(function(e,t,n){return{actionSource:e,shouldStartSearch:t,scenarioId:n}}))},1789:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"m",(function(){return u})),n.d(t,"l",(function(){return c})),n.d(t,"n",(function(){return s})),n.d(t,"o",(function(){return d})),n.d(t,"p",(function(){return l})),n.d(t,"r",(function(){return f})),n.d(t,"q",(function(){return b})),n.d(t,"u",(function(){return v})),n.d(t,"s",(function(){return p})),n.d(t,"t",(function(){return h})),n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return g})),n.d(t,"e",(function(){return m})),n.d(t,"a",(function(){return S})),n.d(t,"d",(function(){return F})),n.d(t,"h",(function(){return j})),n.d(t,"i",(function(){return w})),n.d(t,"j",(function(){return y})),n.d(t,"k",(function(){return I}));var r=n(77),o=new r.c((function(){return Promise.all([n.e(1),n.e(5),n.e(6),n.e(8),n.e(16),n.e(18),n.e(19),n.e(23),n.e(30),n.e(48),n.e(266),n.e(711)]).then(n.bind(null,2552))})),i=new r.b(o,(function(e){return e.clearSearchBox})),a=new r.b(o,(function(e){return e.endSearchSession})),u=new r.b(o,(function(e){return e.onDownArrowPressedSearchInput})),c=new r.b(o,(function(e){return e.onBackspacePressedSearchInput})),s=new r.b(o,(function(e){return e.onLeftArrowPressedSearchInput})),d=(new r.b(o,(function(e){return e.onRightArrowPressedSearchInput})),new r.b(o,(function(e){return e.onUpArrowPressedSearchInput}))),l=new r.b(o,(function(e){return e.removeSuggestionPillFromSearchBox})),f=new r.b(o,(function(e){return e.setLatestQFRequestId})),b=new r.b(o,(function(e){return e.setIsSuggestionsDropdownVisible})),v=new r.b(o,(function(e){return e.updateIsSuggestionSetComplete})),p=new r.b(o,(function(e){return e.setShowSearchBoxInCompactMode})),h=new r.a(o,(function(e){return e.setSpellerData})),O=(Object(r.d)(o,(function(e){return e.PersonaPill})),Object(r.d)(o,(function(e){return e.PrivateDistributionListPill})),Object(r.d)(o,(function(e){return e.SearchBoxDropdown}))),g=Object(r.d)(o,(function(e){return e.SearchBoxPillWell})),m=Object(r.d)(o,(function(e){return e.SuggestionsCallout})),S=Object(r.d)(o,(function(e){return e.CompactSearchBox})),F=Object(r.d)(o,(function(e){return e.SearchScopePicker})),j=new r.b(o,(function(e){return e.getSuggestionAtIndex})),w=new r.b(o,(function(e){return e.isInSearchMode})),y=new r.b(o,(function(e){return e.isQFRequestIdEqualToLatest})),I=new r.b(o,(function(e){return e.isSearchBoxEmpty}))},1801:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1631);function o(e){switch(e){case r.b.Mail:return"Mail";case r.b.Calendar:return"Calendar";case r.b.FilesHub:return"FilesHub";case r.b.FilesPicker:return"FilesPicker";case r.b.Spaces:return"Spaces";case r.b.FileSuggestions:return"FileSuggestions";default:throw Error("Unknown SearchScenarioId value!")}}},1826:function(e,t,n){"use strict";var r=n(1606),o=n(83),i=n(1369),a=n(674);function u(){return Object(o.i)("auth-cloudCache")&&(Object(i.b)()||Object(i.c)())&&Object(a.a)()||Object(r.a)()}n.d(t,"a",(function(){return u}))},1828:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1494);function o(){return Object(r.a)().showReadingPane}},1881:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1431),o=n(1828);function i(){return Object(r.c)()&&Object(o.a)()}},1896:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),o=n(74),i=Object(r.action)("GET_SUGGESTIONS",(function(e){return Object(o.c)({name:"Search_SuggestionsE2E"},{scenarioId:e})}))},1897:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("START_SEARCH",(function(e,t,n,r,o,i){return void 0===n&&(n=!1),void 0===r&&(r=[]),void 0===i&&(i="All"),{actionSource:e,scenarioId:t,explicitSearch:n,connectedAccountInfo:r,searchProvider:o,filter:i}}))},1914:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("START_SEARCH_SESSION",(function(e,t,n){return{actionSource:e,shouldStartSearch:t,scenarioId:n}}))},1996:function(e,t,n){"use strict";var r=n(1556),o=n(3005),i=n(3119),a=n(1312),u=n(2129),c=n(2513),s=n(1538),d=n(1392),l=n(3237),f=n(2360),b=n(1311),v=n(1323),p=n(1368),h=n(1322),O=n(74),g=n(1325),m=n(3),S=n(1431),F=n(1828),j=n(1881),w=n(1572),y=n(12),I=n(3620),T=n(1498);var A=Object(m.action)("selectFolder",(function(e,t,n,r){var o=Object(d.c)().id;return Object(O.c)({name:"SwitchMailFolder",options:{variant:3},customData:[Object(p.a)(e),o?Object(p.a)(o):"",t,n,Object(b.B)(Object(b.A)(e))]},{folderId:e,treeType:t,previousFolderId:o,actionSource:n,folderNodeType:r,isNewFolderSameAsPreviousFolder:e==o})}));t.a=A,Object(m.orchestrator)(A,(function(e){var t,n=e.folderId,d=e.treeType,O=e.previousFolderId,m=e.actionSource,A=e.folderNodeType,C=e.isNewFolderSameAsPreviousFolder,P=Object(j.a)(),k=a.d.folderTable.get(n);6===A&&(k=w.a.folderTable.get(n));var E=Promise.resolve(),R=Object(b.G)(),_=R&&1==R.tableQuery.type;C&&R&&(Object(S.c)()&&Object(F.a)()||Object(f.a)(R));var D=R&&Object(b.O)(R);if(!C||D&&"All"!==D||"spotlight"==(null===(t=null==R?void 0:R.tableQuery)||void 0===t?void 0:t.scenarioType)){E=function(e,t,n,r){var o;e&&(o=Object(h.a)(e));var a=o||e;return Object(i.a)({id:a,type:null!=r?r:0,treeType:t},n)}(n,d,m,A);var x=Object(p.a)(n);Object(u.a)(n),Object(a.G)(k)&&"inbox"!==x&&x!==g.h&&Object(l.b)(n),x===g.g?r.c.importAndExecute(g.h):x===g.a&&r.c.importAndExecute(g.b)}return s.b.importAndExecute(),Object(o.a)(m),"ResetInbox"===m&&v.s.importAndExecute(Object(y.b)(I.a),"assertive"),E.then((function(){Object(c.a)(n,O,_,null==R?void 0:R.id,T.a.Auto,P,m)})),E})),Object(m.mutator)(A,(function(e){e.isNewFolderSameAsPreviousFolder&&(d.a.selectedNode.treeType=e.treeType),b.X.rowInfoForVLV.clear(),b.X.scrollTop=0}))},2063:function(e,t,n){"use strict";var r=n(3),o=Object(r.createStore)("spotlightStore",{spotlightItems:[],rollupDismissed:!1,logicalId:null});t.a=o},2092:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("setShowFolderPane",(function(e){return{showFolderPane:e}}))},2123:function(e,t,n){"use strict";var r=n(1322);var o=n(1996),i=n(1338);function a(e){var t=Object(r.a)("inbox"),n=Object(i.isFolderInFavorites)(t)?"favorites":"primaryFolderTree";Object(o.a)(t,n,e)}n.d(t,"a",(function(){return a}))},2202:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1481),o=n(1431);function i(){var e=Object(r.c)();return Object(o.a)()?e<=541:e<=918}},2254:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1494);function o(){return Object(r.a)().showFolderPane}},2300:function(e,t,n){"use strict";var r=n(362),o=n(83);t.a={RemoveFavoritePersonaAction:{name:"RemoveFavoritePersonaAction",customData:function(e,t){return[t]}},AddFavoriteSearch:{name:"AddFavoriteSearch",customData:function(e,t){return[t,Object(o.i)("tri-favorites-roaming")]}},RemoveFavoriteSearch:{name:"RemoveFavoriteSearch",customData:function(e,t){return[t,Object(o.i)("tri-favorites-roaming")]}},AddFavoritePersonaAction:{name:"AddFavoritePersonaAction",customData:function(e,t,n,r,o,i){return[r]}},ValidateAndUpdateFavorite:{name:"ValidateAndUpdateFavorite",customData:function(e,t,n){return Object(r.b)(e)?[e]:null}},DeleteFolderFailure:{name:"DeleteFolderFailure",customData:function(e){return[e]}},OnFavoritePersonaSelectedAction:{name:"OnFavoritePersonaSelectedAction"},OnFavoritePersonaUpdatedAction:{name:"OnFavoritePersonaUpdatedAction"},InitializeFavoritePersonasAction:{name:"InitializeFavoritePersonasAction"},OneOffAddressUsedForFavorite:"OneOffAddressUsedForFavorite",OutlookFavoritePersonasLoaded:{name:"OutlookFavoritePersonasLoaded"}}},2301:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1648),o=n(1338),i=n(83);function a(e){return Object(i.i)("tri-favorites-roaming")?Object(o.isOutlookFavoritingInProgress)(e):!0===Object(r.b)().isFavoritingInProgress.get(e)}},2303:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1408),o=n(83);function i(){return Object(o.i)("tri-spotlight2")&&!Object(r.a)(2048)}},2512:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return d}));var r=n(77),o=new r.c((function(){return Promise.all([n.e(14),n.e(44),n.e(85),n.e(241),n.e(575)]).then(n.bind(null,5569))})),i=new r.a(o,(function(e){return e.loadGroups})),a=new r.a(o,(function(e){return e.loadGroupsFromSessionData})),u=new r.a(o,(function(e){return e.removeGroupFromLeftNav})),c=new r.a(o,(function(e){return e.toggleGroupTreeExpansion})),s=new r.a(o,(function(e){return e.unsubscribeFromUnreadNotifications})),d=new r.a(o,(function(e){return e.setGroupLastVisitedTime}))},2634:function(e,t,n){"use strict";var r=n(77),o=n(2063);function i(e){var t=e.itemId,n=e.conversationId,r=e.rowKey;return Object(o.a)().spotlightItems.some((function(e){return t&&e.itemId===t||n&&e.conversationId===n||r&&e.rowKey===r}))}function a(e){var t=Object(o.a)().spotlightItems.filter((function(t){return t.itemId===e}))[0];return null==t?void 0:t.rowKey}var u=n(2303);n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"a",(function(){return v})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return u.a}));var c=new r.c((function(){return Promise.all([n.e(1),n.e(45),n.e(49),n.e(59),n.e(65),n.e(79),n.e(733)]).then(n.bind(null,16658))})),s=new r.a(c,(function(e){return e.initializeSpotlight})),d=new r.b(c,(function(e){return e.getUnacknowledgedSpotlightCount})),l=new r.a(c,(function(e){return e.onSpotlightDismissedFromRP})),f=new r.a(c,(function(e){return e.loadImportantTable})),b=new r.a(c,(function(e){return e.logSpotlightItemClicked})),v=Object(r.d)(c,(function(e){return e.SpotlightIconTeachingMoment}))},2636:function(e,t,n){"use strict";var r=n(3),o=n(20),i=n(3447);Object(r.mutator)(i.a,(function(e){u().prefetchedFolderIds.set(e.folderId,!0)}));n.d(t,"b",(function(){return u}));var a={frequentlyUsedFolders:[],isInitialized:!1,prefetchedFolderIds:new o.ObservableMap({})},u=Object(r.createStore)("frequentlyUsedFoldersStore",a),c=u();t.a=c},2723:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("onNewsSearchExit",(function(e){return{treeType:e}}))},2724:function(e,t,n){"use strict";var r=n(3),o=n(74),i=n(2300);t.a=Object(r.action)("outlookFavoritePersonasLoaded",(function(e){return Object(o.c)(i.a.OutlookFavoritePersonasLoaded,{personas:e})}))},2727:function(e,t,n){"use strict";var r=n(285),o=n(2204);t.a=Object(r.action)("commandBarAction")((function(e){o.a.navigationButtonSelected=e}))},2728:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="#"},2813:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("POPULATE_PUBLIC_FOLDER_OUTLOOK_FAVORITE_STORE")},2814:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("POPULATE_PUBLIC_FOLDER_FAVORITE_STORE_V1")},2815:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ADD_PUBLIC_FOLDER_TO_STORE",(function(e,t){return{state:e,item:t}}))},2913:function(e,t,n){"use strict";var r=n(1311),o=n(1892);function i(e,t){var n;switch(t){case 0:n=o.a;break;case 1:n=Object(o.f)()}return{categoryName:null,folderId:e,focusedViewFilter:-1,listViewType:t,viewFilter:"All",sortBy:r.c.getDefaultSortBy(),requestShapeName:n,type:2,shouldTryToUseSessionDataResponse:!1,scenarioType:"group"}}var a=n(30);function u(){var e=Object(a.a)().UserOptions.GlobalListViewTypeReact;return null==e?0:e}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u}))},2922:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("REMOVE_FAVORITE_FROM_PUBLIC_FOLDER_STORE",(function(e){return{folderId:e}}))},3005:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(0),o=n(3443),i=n(1652),a=n(1789),u=n(1437),c=n(1631),s=n(664),d=n(2202),l=n(2254),f=n(2092);function b(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return i.b(),s.c.import().then((function(e){e("MailModuleNotificationBarHost")})),Object(u.a)(c.a.Mail).searchSessionGuid?[4,a.g.import()]:[3,2];case 1:t.sent()(c.a.Mail,e),t.label=2;case 2:return Object(l.a)()&&Object(d.a)()&&Object(f.a)(!1),Object(o.a)(),[2]}}))}))}},3114:function(e,t,n){"use strict";var r=n(2813),o=n(2814),i=n(77),a=n(2157),u=n(0),c=n(2815),s=n(3),d=n(2286),l=(Object(s.mutator)(c.a,(function(e){var t=e.state,n=e.item,r=n.FolderId.Id;if(!t.folderTable.has(r)){var o=Object(u.__assign)(Object(u.__assign)({},Object(d.c)(n)),{childFolderIds:[],sourceWellKnownFolderType:Object(d.a)(n)});t.folderTable.set(r,o)}})),n(2922)),f=n(1572);Object(s.mutator)(l.a,(function(e){var t=e.folderId;f.a.folderTable.has(t)&&f.a.folderTable.delete(t)})),n(1788);n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return f.a}));var b=new i.c((function(){return Promise.all([n.e(19),n.e(51),n.e(870)]).then(n.bind(null,16845))}));Object(i.f)(a.a,b,(function(e){return e.loadPublicFolderFavoritesOchestrator})),Object(i.f)(r.a,b,(function(e){return e.populatePublicFolderOutlookFavoriteStoreOrchestrator})),Object(i.f)(o.a,b,(function(e){return e.populatePublicFolderFavoriteStoreV1Orchestrator}));var v=Object(i.d)(b,(function(e){return e.PostedToLine}))},3119:function(e,t,n){"use strict";var r=n(0),o=n(668),i=n(2913),a=n(1783),u=n(1831),c=n(1311),s=n(2907),d=n(1338),l=n(1423),f=n(3275),b=n(1916);var v=n(2727),p=n(1915),h=n(2512),O=n(1425),g=n(3),m=n(1392);function S(e,t){var n=Object(m.d)();if(1===n.selectedNode.type&&a.lazyOnSelectedPersonaNodeChanged.importAndExecute(n.selectedNode),2===n.selectedNode.type){if("DeleteGroup"!=t){var g=Object(c.G)();g&&h.d.importAndExecute(Object(O.b)(g.tableQuery))}2!==e.type&&Object(v.a)(p.a.Email)}var S=Object(r.__assign)({},e);return F(S),function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,v,p,h,O;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(e.type){case 0:return[3,1];case 4:return[3,2];case 1:return[3,6];case 5:return[3,10];case 2:return[3,14];case 6:return[3,15]}return[3,16];case 1:return v=Object(u.a)(e.id),n=Object(b.a)(e.id,Object(c.A)(e.id),"mail",null,null,null,{sortColumn:v.sortColumn,sortDirection:v.sortOrder}),[3,17];case 2:return Object(a.isFavoritingInProgress)(e.id)?(p=Object(o.k)(e.id,Object(o.o)()),[4,l.e.import()]):[3,4];case 3:return n=r.sent()(p,Object(c.A)(e.id)),[3,5];case 4:n=Object(f.a)(e.id),r.label=5;case 5:return[3,17];case 6:return(h=e).isSearchFolderPopulated?[3,8]:[4,l.f.import()];case 7:return n=r.sent()(h.displayName,h.allEmailAddresses,Object(c.A)(e.id)),[3,9];case 8:n=Object(b.a)(h.searchFolderId,Object(c.A)(h.searchFolderId),"persona"),r.label=9;case 9:return[3,17];case 10:return(O=d.favoritesStore.outlookFavorites.get(e.id)).isSearchFolderPopulated?[3,12]:[4,l.g.import()];case 11:return n=r.sent()(O.displayName,O.members,O.pdlId,O.owsPersonaId,Object(c.A)(e.id)),[3,13];case 12:n=Object(b.a)(O.searchFolderId,Object(c.A)(O.searchFolderId),"privatedistributionlist"),r.label=13;case 13:return[3,17];case 14:return n=Object(i.a)(e.id,Object(i.b)()),[3,17];case 15:return n=Object(b.a)(e.id,1,"mail"),[3,17];case 16:return[3,17];case 17:return[2,Object(s.a)(n,null,t)]}}))}))}(S,t)}n.d(t,"a",(function(){return S}));var F=Object(g.mutatorAction)("setSelectedFolderNode",(function(e){Object(m.d)().selectedNode=e}))},3142:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("SELECT_PREVIOUS_NODE",(function(e){return{actionSource:e}}))},3143:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),o=Object(r.action)("TRY_VALIDATE_DUMPSTER_QUOTA",(function(e){return{folderId:e}}))},3237:function(e,t,n){"use strict";var r=n(3446),o=n(2636),i=n(285),a=Object(i.action)("sortFolders")((function(){var e=Object(o.b)(),t=e.frequentlyUsedFolders.sort((function(e,t){return e.Weight==t.Weight?Math.abs(Date.parse(t.lvt)-Date.parse(e.lvt)):t.Weight-e.Weight}));e.frequentlyUsedFolders=t})),u=Object(i.action)("addFrequentlyUsedFolder")((function(e){var t=!1,n=Object(o.b)();if(n.isInitialized){for(var i=n.frequentlyUsedFolders.length-1;i>=0;i--){var u=n.frequentlyUsedFolders[i];if(u.FolderId==e)u.Weight+=5,u.Weight=Math.min(u.Weight,20),u.lvt=(new Date).toISOString(),t=!0;else if(u.Weight--,u.Weight=Math.max(u.Weight,0),u.Weight<=0){var c=Math.abs(Date.now()-Date.parse(u.lvt));c<6048e5&&c>=0||n.frequentlyUsedFolders.splice(i,1)}}t||n.frequentlyUsedFolders.push({FolderId:e,Weight:10,lvt:(new Date).toISOString()}),a(),n.frequentlyUsedFolders.splice(10),Object(r.a)()}})),c=n(2728);n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c.a}))},3443:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1929),o=n(1495),i=n(1484),a=n(1881),u=n(1431),c=n(722);function s(){null===i.a.primaryComposeId||Object(c.v)()?Object(u.c)()&&Object(a.a)()&&Object(r.a)("FolderNodeClick"):o.r.importAndExecute(null)}},3446:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(367),o=n(2636),i=n(59);function a(){var e=[];Object(o.b)().frequentlyUsedFolders.forEach((function(t){e.push(JSON.stringify(t))})),Object(r.a)((function(t){t.UserOptions.FrequentlyUsedFolders=e}),[{key:"FrequentlyUsedFolders",valuetype:"StringArray",value:e}]).catch((function(e){i.g.warn("saveFrequentlyUsedFolders: "+e)}))}},3447:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("folderPrefetchedAction",(function(e){return{folderId:e}}))},3620:function(e){e.exports=JSON.parse('{"a":"haa"}')},425:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),o=n(14),i=n(230),a=Object(i.c)((function(e,t){var n,i,a,u,c,s,d,l,f,b,v,p,h=e.effects,O=e.palette,g=e.semanticColors,m={position:"absolute",width:1,right:31,top:8,bottom:8},S={splitButtonContainer:[Object(o.getFocusStyle)(e,{highContrastStyle:{left:-2,top:-2,bottom:-2,right:-2,border:"none"},inset:2}),{display:"inline-flex",selectors:{".ms-Button--default":{borderTopRightRadius:"0",borderBottomRightRadius:"0",borderRight:"none"},".ms-Button--primary":{borderTopRightRadius:"0",borderBottomRightRadius:"0",border:"none",selectors:(n={},n[o.HighContrastSelector]={color:"WindowText",backgroundColor:"Window",border:"1px solid WindowText",borderRightWidth:"0",MsHighContrastAdjust:"none"},n)},".ms-Button--primary + .ms-Button":{border:"none",selectors:(i={},i[o.HighContrastSelector]={border:"1px solid WindowText",borderLeftWidth:"0"},i)}}}],splitButtonContainerHovered:{selectors:{".ms-Button--primary":{selectors:(a={},a[o.HighContrastSelector]={color:"Window",backgroundColor:"Highlight"},a)},".ms-Button.is-disabled":{color:g.buttonTextDisabled,selectors:(u={},u[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},u)}}},splitButtonContainerChecked:{selectors:{".ms-Button--primary":{selectors:(c={},c[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},c)}}},splitButtonContainerCheckedHovered:{selectors:{".ms-Button--primary":{selectors:(s={},s[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},s)}}},splitButtonContainerFocused:{outline:"none!important"},splitButtonMenuButton:{padding:6,height:"auto",boxSizing:"border-box",borderRadius:0,borderTopRightRadius:h.roundedCorner2,borderBottomRightRadius:h.roundedCorner2,border:"1px solid "+O.neutralSecondaryAlt,borderLeft:"none",outline:"transparent",userSelect:"none",display:"inline-block",textDecoration:"none",textAlign:"center",cursor:"pointer",verticalAlign:"top",width:32,marginLeft:-1,marginTop:0,marginRight:0,marginBottom:0},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},m),{selectors:(d={},d[o.HighContrastSelector]={backgroundColor:"WindowText"},d)}),splitButtonDividerDisabled:Object(r.__assign)(Object(r.__assign)({},m),{selectors:(l={},l[o.HighContrastSelector]={backgroundColor:"GrayText"},l)}),splitButtonMenuButtonDisabled:{pointerEvents:"none",border:"none",selectors:(f={":hover":{cursor:"default"},".ms-Button--primary":{selectors:(b={},b[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},b)},".ms-Button-menuIcon":{selectors:(v={},v[o.HighContrastSelector]={color:"GrayText"},v)}},f[o.HighContrastSelector]={color:"GrayText",border:"1px solid GrayText",backgroundColor:"Window"},f)},splitButtonFlexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},splitButtonContainerDisabled:{outline:"none",border:"none",selectors:Object(r.__assign)((p={},p[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},p),Object(o.getEdgeChromiumNoHighContrastAdjustSelector)())}};return Object(o.concatStyleSets)(S,t)}))},444:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.tryRunTask=function(){var e=this;if(this.canRunMoreTasks()){var t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()}},e}();n.d(t,"a",(function(){return r}))},446:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(363),o=n(364);function i(e,t){var n=Object(r.a)(e,(function(e){return t===e||e.hasAttribute(o.a)}));return null!==n&&n.hasAttribute(o.a)}},674:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(24),o=n(51);function i(){var e,t=null===(e=Object(r.a)())||void 0===e?void 0:e.pathname;if(t){var n=t.split("/"+Object(o.a)()+"/")[1];if(n){var i=n.split("/")[0];if(i&&!isNaN(parseInt(i)))return!0}}return!1}}}]);
//# sourceMappingURL=owa.MailBoot~MailFolderTreesParent~PublicFolderPickerModule.js.map
self.scriptsLoaded['owa.MailBoot~MailFolderTreesParent~PublicFolderPickerModule.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailFolderTreesParent~PublicFolderPickerModule.js'] = (new Date()).getTime();