self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.27.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[27],{177:function(n,r,e){"use strict";var t=e(274),a=e(0),d=e(3),u=Object(d.action)("initializeCalendarsCacheInStore",(function(n,r,e,t,a,d){return{defaultCalendarEntry:n,calendarEntries:r,calendarFolders:e,calendarGroups:t,folderIdMapping:a,calendarIdToChangeKeyMapping:d}})),i=Object(d.action)("updateChangeKeyByCalendarItemId",(function(n){return{itemId:n}})),o=Object(d.action)("addToCalendarsCache",(function(n,r,e){return{calendarEntry:n,folder:r,mailboxInfo:e}})),c=Object(d.action)("addCalendarGroupToCalendarsCache",(function(n){return{calendarGroup:n}})),l=Object(d.action)("updateCalendarEntry",(function(n,r){return{itemId:n,calendarEntry:r}})),f=Object(d.action)("updateCalendarFolder",(function(n,r){return{calendar:n,calendarFolder:r}})),I=Object(d.action)("removeCalendarFromCalendarsCache",(function(n){return{calendar:n}})),b=Object(d.action)("markCalendarEntryAsValid",(function(n){return{calendarEntry:n}})),s=Object(d.action)("calendarUpdated",(function(n,r){return{calendarId:n,updates:r}})),p=Object(d.action)("groupAssociationChanged",(function(n){return{payload:n}})),O=Object(d.action)("removeCalendarWithIDFromCalendarsCache",(function(n){return{calendarId:n}}));Object(d.mutator)(i,(function(n){var r=n.itemId,e=r.Id,a=r.ChangeKey;Object(t.a)().calendarItemIdToChangeKey.set(e,a)})),Object(d.mutator)(l,(function(n){var r=n.itemId.Id,e=n.calendarEntry,d=Object(t.a)().calendarEntryMapping.get(r),u=(e.ItemId,Object(a.__rest)(e,["ItemId"]));d&&Object.keys(u).forEach((function(n){d[n]=u[n]}))})),Object(d.mutator)(b,(function(n){var r=n.calendarEntry;Object(t.a)().validEntryMapping.set(r.ItemId.Id,!0)}));var v=e(283);function j(n,r){return r+"_"+n}function m(n,r){Object.keys(r).forEach((function(e){return n.set(e,r[e])}))}function g(n,r,e){var a=Object(t.a)();a.calendarItemIdToChangeKey.delete(n),e||(a.calendarEntryMapping.delete(n),a.validEntryMapping.delete(n)),a.calendarFolderMapping.delete(n),r&&a.folderIdToCalendarId.delete(r)}Object(d.mutator)(u,(function(n){var r=n.defaultCalendarEntry;r&&Object(t.a)().defaultCalendars.set(r.id.mailboxInfo.userIdentity,r)})),Object(d.mutator)(u,(function(n){var r=n.calendarEntries;m(Object(t.a)().calendarEntryMapping,r)})),Object(d.mutator)(u,(function(n){var r=n.calendarFolders;m(Object(t.a)().calendarFolderMapping,r)})),Object(d.mutator)(u,(function(n){var r=n.folderIdMapping;m(Object(t.a)().folderIdToCalendarId,r)})),Object(d.mutator)(u,(function(n){var r=n.calendarIdToChangeKeyMapping;m(Object(t.a)().calendarItemIdToChangeKey,r)})),Object(d.mutator)(u,(function(n){var r=n.calendarGroups;m(Object(t.a)().calendarGroupsMapping,r)})),Object(d.mutator)(o,(function(n){var r=n.calendarEntry,e=n.folder,d=n.mailboxInfo,u=Object(t.a)();u.calendarItemIdToChangeKey.set(r.ItemId.Id,r.ItemId.ChangeKey);var i=Object(a.__assign)(Object(a.__assign)({},r),{id:{id:r.ItemId.Id,mailboxInfo:d}});u.calendarEntryMapping.set(r.ItemId.Id,i),u.calendarFolderMapping.set(r.ItemId.Id,e),e.FolderId?u.folderIdToCalendarId.set(e.FolderId.Id,{id:r.ItemId.Id,mailboxInfo:d}):e.DistinguishedFolderId&&u.folderIdToCalendarId.set(e.DistinguishedFolderId,{id:r.ItemId.Id,mailboxInfo:d})})),Object(d.mutator)(c,(function(n){var r=n.calendarGroup,e=Object(t.a)(),a=j(r.id.mailboxInfo.userIdentity,r.GroupId);e.calendarGroupsMapping.set(a,r)})),Object(d.mutator)(I,(function(n){var r=n.calendar;g(r.id.id,r.calculatedFolderId?r.calculatedFolderId:null)})),Object(d.mutator)(O,(function(n){var r=n.calendarId;g(r,Object(v.s)(r),!0)})),Object(d.mutator)(f,(function(n){var r=n.calendar,e=n.calendarFolder,t=Object(v.l)(r);Object.keys(e).forEach((function(n){t[n]=e[n]}))}));e(606);var C=e(653);function y(n){var r=Object(v.p)(n);return r?r.mailboxInfo:null}function h(n){if(!n)return!1;var r=Object(v.l)(n),e=Object(v.h)(n);return r&&e&&!e.IsReadOnly&&r.EffectiveRights&&r.EffectiveRights.CreateContents}var M=e(471),E=e(30);function x(n,r){var e,t=Object(v.h)(n);if(Object(M.e)(t)){var a=t;return!a.IsOwnerEmailAddressInvalid&&a.OwnerEmailAddress==r}return(null===(e=n.id)||void 0===e?void 0:e.mailboxInfo)?r.indexOf(n.id.mailboxInfo.mailboxSmtpAddress)>=0:Object(E.a)().SessionSettings.UserEmailAddress==r}function F(n){return n?n.map(v.f).filter((function(n){return!!n})):null}function T(n){var r=Object(v.h)(n);return!!r&&r.IsGroupMailboxCalendar}function w(n){var r=Object(v.h)(n);return null==r?void 0:r.IsSchoolCalendar}var G,_,K=e(96),S=e(83),A=e(388);function N(n){if(n.IsGroupMailboxCalendar){var r=n.OwnerEmailAddress,e=n.id.mailboxInfo.userIdentity;return{MailboxId:Object(v.w)(n)&&Object(S.i)("cal-showAddTeamsCalendars")?Object(v.c)(r):r,MailboxType:Object(A.r)(e)?1:0}}var t=n.CalendarFolderId;if(t){e=n.id.mailboxInfo.userIdentity;return Object(K.t)(e)?{FolderId:t.Id}:Object(A.r)(e)?{FolderId:t.Id,MailboxId:e,MailboxType:Object(A.t)(e)?2:3}:null}return null}function k(n){return Object(v.o)().filter((function(r){return function(n,r){return!!n&&n.id.mailboxInfo.userIdentity===r}(r,n)})).sort(D)}function D(n,r){var e=L[n.GroupType]-L[r.GroupType];if(0!==e)return e;var t=R[n.id.mailboxInfo.type]-R[r.id.mailboxInfo.type];return 0!==t?t:n.GroupName.localeCompare(r.GroupName)}var L=((G={})[0]=0,G[2]=1,G[1]=2,G[3]=3,G),R=((_={}).UserMailbox=0,_.TeamsMailbox=1,_.GroupMailbox=2,_.PublicMailbox=3,_.SharedMailbox=4,_.ArchiveMailbox=5,_);function P(n,r){var e=Object(v.r)(n),t=Object(v.d)().filter((function(t){return function(n,r){return!!n&&n.id.mailboxInfo.userIdentity===r}(t,n)&&U(t,r)&&(d=e,!((a=t)&&d&&a.id.id===d.id.id));var a,d})).sort(q);return e&&U(e,r)&&t.unshift(e),t}function U(n,r){var e=Object(v.h)(n);return!!e&&e.ParentGroupId===r}function q(n,r){return n.displayName.localeCompare(r.displayName)}e.d(r,"E",(function(){return u})),e.d(r,"U",(function(){return i})),e.d(r,"b",(function(){return o})),e.d(r,"a",(function(){return c})),e.d(r,"S",(function(){return l})),e.d(r,"T",(function(){return f})),e.d(r,"Q",(function(){return I})),e.d(r,"P",(function(){return b})),e.d(r,"e",(function(){return s})),e.d(r,"D",(function(){return p})),e.d(r,"R",(function(){return O})),e.d(r,"w",(function(){return v.r})),e.d(r,"G",(function(){return v.t})),e.d(r,"k",(function(){return v.g})),e.d(r,"g",(function(){return v.d})),e.d(r,"t",(function(){return v.o})),e.d(r,"u",(function(){return v.p})),e.d(r,"m",(function(){return v.i})),e.d(r,"j",(function(){return v.f})),e.d(r,"p",(function(){return v.l})),e.d(r,"l",(function(){return v.h})),e.d(r,"o",(function(){return v.k})),e.d(r,"q",(function(){return v.m})),e.d(r,"v",(function(){return v.q})),e.d(r,"r",(function(){return v.n})),e.d(r,"x",(function(){return v.s})),e.d(r,"i",(function(){return v.e})),e.d(r,"d",(function(){return v.b})),e.d(r,"I",(function(){return v.u})),e.d(r,"J",(function(){return v.v})),e.d(r,"M",(function(){return v.x})),e.d(r,"c",(function(){return v.a})),e.d(r,"n",(function(){return v.j})),e.d(r,"L",(function(){return v.w})),e.d(r,"O",(function(){return v.y})),e.d(r,"f",(function(){return v.c})),e.d(r,"h",(function(){return C.a})),e.d(r,"y",(function(){return y})),e.d(r,"s",(function(){return j})),e.d(r,"N",(function(){return h})),e.d(r,"F",(function(){return x})),e.d(r,"z",(function(){return F})),e.d(r,"H",(function(){return T})),e.d(r,"K",(function(){return w})),e.d(r,"C",(function(){return N})),e.d(r,"A",(function(){return k})),e.d(r,"B",(function(){return P}))},274:function(n,r,e){"use strict";var t=e(3),a=e(20),d={calendarEntryMapping:new a.ObservableMap,calendarFolderMapping:new a.ObservableMap,calendarItemIdToChangeKey:new a.ObservableMap,folderIdToCalendarId:new a.ObservableMap,validEntryMapping:new a.ObservableMap,calendarGroupsMapping:new a.ObservableMap,defaultCalendars:new a.ObservableMap};r.a=Object(t.createStore)("calendarsCacheStore",d)},283:function(n,r,e){"use strict";e.d(r,"r",(function(){return o})),e.d(r,"t",(function(){return c})),e.d(r,"g",(function(){return l})),e.d(r,"d",(function(){return f})),e.d(r,"o",(function(){return I})),e.d(r,"p",(function(){return b})),e.d(r,"i",(function(){return s})),e.d(r,"f",(function(){return p})),e.d(r,"l",(function(){return O})),e.d(r,"h",(function(){return v})),e.d(r,"k",(function(){return j})),e.d(r,"m",(function(){return m})),e.d(r,"q",(function(){return g})),e.d(r,"n",(function(){return C})),e.d(r,"s",(function(){return y})),e.d(r,"e",(function(){return h})),e.d(r,"b",(function(){return M})),e.d(r,"u",(function(){return E})),e.d(r,"v",(function(){return x})),e.d(r,"x",(function(){return F})),e.d(r,"a",(function(){return T})),e.d(r,"j",(function(){return w})),e.d(r,"w",(function(){return G})),e.d(r,"y",(function(){return _})),e.d(r,"c",(function(){return K}));var t=e(0),a=e(274),d=e(653),u=e(295),i=e(606);function o(n){return n||(n=Object(u.d)().userIdentity),Object(a.a)().defaultCalendars.get(n)}function c(n,r){var e=o(r);return e&&n===e.id}function l(){var n=Object(a.a)().calendarEntryMapping;return Object(t.__spread)(n.values())}function f(){return l().map((function(n){return p(n.id.id)})).filter((function(n){return n}))}function I(){var n=Object(a.a)().calendarGroupsMapping;return Object(t.__spread)(n.values())}function b(n){return Object(a.a)().folderIdToCalendarId.get(n)}function s(n){return Object(a.a)().calendarEntryMapping.get(n)}function p(n){var r=s(n);return r?{id:{id:n,mailboxInfo:Object(t.__assign)({},r.id.mailboxInfo)},calculatedFolderId:h(n),displayName:r.CalendarName,colorScheme:null}:null}function O(n){return Object(a.a)().calendarFolderMapping.get(n.id.id)}function v(n){var r;return s(null===(r=null==n?void 0:n.id)||void 0===r?void 0:r.id)}function j(n){var r=b(n);return r?s(r.id):void 0}function m(n){var r=Object(a.a)().calendarFolderMapping,e=b(n);return e?r.get(e.id):void 0}function g(n){return Object(a.a)().calendarItemIdToChangeKey.get(n)}function C(n){return y(n.id.id)}function y(n){var r=Object(a.a)().calendarFolderMapping.get(n);return r&&(r.FolderId||r.DistinguishedFolderId)?r.FolderId?r.FolderId.Id:r.DistinguishedFolderId:h(n)}function h(n){var r=Object(a.a)().calendarEntryMapping.get(n);if(r){var e=Object(d.a)(r);return e?e.Id:null}return null}function M(n){return!!s(n)}function E(n){var r=Object(a.a)(),e=r.folderIdToCalendarId,t=r.calendarEntryMapping,d=e.get(n);if(d){var u=t.get(d.id);return u&&!u.IsGroupMailboxCalendar&&null!=u.CalendarFolderId}return!1}function x(n){if(E(n)){var r=j(n);return null==r?void 0:r.IsReadOnly}return!1}function F(n){var r=Object(a.a)().validEntryMapping;return n&&r.get(n.ItemId.Id)}function T(n){return!E(y(n))&&!F(s(n))}function w(n){var r,e=Object(a.a)(),d=e.folderIdToCalendarId,u=e.calendarEntryMapping,i=d.get(n);i?r=u.get(i.id):r=Object(t.__spread)(u.values()).filter((function(r){return r.OwnerEmailAddress&&r.OwnerEmailAddress.toLowerCase()==n.toLowerCase()}))[0];return r}function G(n){var r,e;return"TeamsMailbox"==(null===(e=null===(r=null==n?void 0:n.id)||void 0===r?void 0:r.mailboxInfo)||void 0===e?void 0:e.type)}function _(n,r){return[n,r].join(i.a)}function K(n){return n.split(i.a)[0]}},471:function(n,r,e){"use strict";var t="LinkedCalendarEntry:#Exchange";function a(n){return(null==n?void 0:n.__type)==t}function d(n){return(null==n?void 0:n.__type)==t&&!(null==n?void 0:n.IsGroupMailboxCalendar)}function u(n){return n.CanViewPrivateItems||a(n)}e.d(r,"e",(function(){return a})),e.d(r,"f",(function(){return d})),e.d(r,"a",(function(){return t})),e.d(r,"b",(function(){return"LocalCacheForRemoteCalendarEntry:#Exchange"})),e.d(r,"c",(function(){return"TeamsCalendarEntry:#Exchange"})),e.d(r,"d",(function(){return u}))},606:function(n,r,e){"use strict";e.d(r,"a",(function(){return t}));var t="_CHANNELTEAMSTYPE_"},653:function(n,r,e){"use strict";function t(n){if(void 0!==n.CalendarFolderId)return n.CalendarFolderId;var r=n;return r.IsGeneralScheduleCalendar?{Id:r.OwnerEmailAddress,ChangeKey:""}:r.SharedFolderId?{Id:r.SharedFolderId.Id,ChangeKey:null!=r.SharedFolderId.ChangeKey?r.SharedFolderId.ChangeKey:""}:null}e.d(r,"a",(function(){return t}))}}]);
//# sourceMappingURL=owa.27.js.map
self.scriptsLoaded['owa.27.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.27.js'] = (new Date()).getTime();