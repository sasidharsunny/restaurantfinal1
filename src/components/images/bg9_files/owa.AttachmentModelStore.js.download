self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentModelStore.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[310],{1322:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(50);function i(t){if(!t)throw new Error("Input parameter to folderNameToId must not be null.");return r.a.defaultFolderNameToIdMap.get(t)}},1326:function(t,e,n){"use strict";function r(t){if(!t)return null;var e=t.lastIndexOf(".");return e>0?t.substr(e).toLowerCase():null}function i(t){var e=r(t);return e?e.replace(".",""):null}function c(t){var e;return(null===(e=i(t))||void 0===e?void 0:e.substring(0,4))||""}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return c}))},1333:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Base64InlineImage=0]="Base64InlineImage",t[t.Cloud=1]="Cloud",t[t.Local=2]="Local",t[t.MailItem=3]="MailItem",t[t.Uri=4]="Uri",t[t.AttachmentItem=5]="AttachmentItem",t[t.CloudSuggestion=6]="CloudSuggestion",t[t.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",t[t.Inline=8]="Inline",t[t.Smime=9]="Smime",t[t.FilesHub=10]="FilesHub",t[t.GroupFilesHub=11]="GroupFilesHub",t[t.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",t[t.Unknown=13]="Unknown",t[t.ContextualSuggestion=14]="ContextualSuggestion",t[t.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",t[t.SmartDoc=16]="SmartDoc",t[t.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1346:function(t,e,n){"use strict";function r(t,e){Object.keys(e).forEach((function(n){return t.set(n,e[n])}))}function i(t){var e=null!=t?t:{headers:new Headers};return e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}))},1347:function(t,e,n){"use strict";var r=n(0),i=n(1405),c=n(388),u=n(662),o=n(269),a=n(9),s="X-AnchorMailbox",d="Authorization",f="X-OwaWebSessionType",l="X-OWA-ExplicitLogonUser";function b(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,b,p,m,O;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n={},b=Object(c.k)(t)){if(b.accountState==c.b.AccessRevoked)return[2,null];if(b.accountState==c.b.AccountDeprovisioned||b.accountState==c.b.AccountNotFound)return Object(c.c)(b.accountState,b.accountProviderType),[2,null]}return e?(n[s]=e,n[l]=e):b&&(n[s]=b.anchorMailbox),b?(p=b.token,!(m=Object(u.g)(b.tokenExpiry))&&p?[3,2]:(Object(o.p)("getAndUpdateAccessToken",{tokenExpiry:Object(a.y)(b.tokenExpiry,Object(a.Pb)()),isTokenExpired_1:m,isTokenInvalid_2:!p},{isCore:!0}),[4,i.a.importAndExecute(b.accountId,t)])):[3,3];case 1:(p=r.sent())||(p=""),r.label=2;case 2:O=void 0,"Outlook"==b.accountProviderType?(O='MSAuth1.0 usertoken="'+p+'", type="MSACT"',n[f]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(O="Bearer "+p,n[f]=2..toString()),n[d]=O,r.label=3;case 3:return[2,n]}}))}))}var p=n(1346),m=n(59);function O(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(p.a)(),i=n,[4,v(t,e)];case 1:return i.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function v(t,e){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=e&&(null===(n=t.headers)||void 0===n?void 0:n.set)?new Headers(t.headers):new Headers,[4,b(t.mailboxInfo.userIdentity,g(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null)];case 1:return c=r.sent(),Object(p.b)(i,c),[2,i]}}))}))}function g(t,e){var n="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return n&&null==e&&m.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return O})),n.d(e,"c",(function(){return g}))},1348:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(3),i=Object(r.action)("triggerReInitializeAccount",(function(t){return{userIdentity:t}}))},1363:function(t,e,n){"use strict";var r=n(1326),i=n(1566),c=n(12);function u(t){var e;return t>=1073741824?(t/=1073741824,e=Object(c.b)(i.b)):t>=1048576?(t/=1048576,e=Object(c.b)(i.d)):t>=1024?(t/=1024,e=Object(c.b)(i.c)):e=Object(c.b)(i.a),Object(c.c)(e,Math.round(t))}var o,a=n(1411),s=n(83),d=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function f(t){if(!Object(s.i)("doc-attachment-documentThumbnail"))return!1;var e=Object(r.a)(t);return!!e&&d.indexOf(e.toLowerCase())>=0}function l(t){switch(t){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return o.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return o.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return o.PowerPoint;default:return null}}!function(t){t[t.Word=0]="Word",t[t.Excel=1]="Excel",t[t.PowerPoint=2]="PowerPoint"}(o||(o={}));var b=n(1371);n.d(e,"b",(function(){return r.a})),n.d(e,"c",(function(){return r.b})),n.d(e,"d",(function(){return r.c})),n.d(e,"i",(function(){return u})),n.d(e,"g",(function(){return a.a})),n.d(e,"h",(function(){return f})),n.d(e,"f",(function(){return l})),n.d(e,"e",(function(){return b.b})),n.d(e,"a",(function(){return o}))},1371:function(t,e,n){"use strict";function r(t){return e=t||"",(n=c.exec(e))&&n.length>1&&i[n[1].toLowerCase()];var e,n}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return u}));var i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},c=/^\s*([^;\s]*)(?:;|\s|$)/;function u(t){var e="";return Object.entries(i).forEach((function(n){n[1]===t&&(e=n[0])})),e}},1379:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1679);function i(t){return Object(r.a)().attachments.get(t.Id)}},1384:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(276);function i(){return Object(r.a)().attachment}},1389:function(t,e,n){"use strict";var r,i,c;n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return c})),function(t){t[t.Compose=0]="Compose",t[t.Extensibility=1]="Extensibility",t[t.ReadingPane=2]="ReadingPane",t[t.Fileshub=3]="Fileshub",t[t.Txp=4]="Txp",t[t.Peek=5]="Peek",t[t.CalendarCard=6]="CalendarCard"}(r||(r={})),function(t){t[t.SmimeSignature=0]="SmimeSignature",t[t.Safety=1]="Safety",t[t.Error=2]="Error",t[t.Info=3]="Info",t[t.Encryption=4]="Encryption",t[t.Translation=5]="Translation",t[t.Sensitivity=6]="Sensitivity",t[t.InsightMessage=7]="InsightMessage",t[t.External=8]="External",t[t.Spotlight=9]="Spotlight"}(i||(i={})),function(t){t[t.Grey=0]="Grey",t[t.Red=1]="Red",t[t.Green=2]="Green",t[t.Yellow=3]="Yellow",t[t.Orange=4]="Orange",t[t.Green20=5]="Green20"}(c||(c={}))},1405:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(77),i=n(1348);n.d(e,"b",(function(){return i.a}));var c=new r.c((function(){return n.e(1149).then(n.bind(null,1664))})),u=new r.a(c,(function(t){return t.getAndUpdateAccessToken}))},1411:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));var r=n(1326),i=n(1371),c=n(70),u=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],o=[".tiff",".tif"];function a(t,e,n){return void 0===n&&(n=!0),s(Object(r.a)(t)||Object(i.a)(e),n)}function s(t,e){return void 0===e&&(e=!0),!!t&&(u.indexOf(t.toLowerCase())>=0||e&&o.indexOf(t.toLowerCase())>=0&&(Object(c.e)()||Object(c.d)()||Object(c.h)()||Object(c.g)()&&!Object(c.l)()))}},1443:function(t,e,n){"use strict";var r=n(1333),i=n(1363);function c(t){return t.map((function(t){return{fileType:r.a.Uri,name:t.name,type:Object(i.b)(t.url)||"",size:0,uri:t.url}}))}var u=n(59);function o(t,e,n){if(t.length!=e.length)return u.d("The sizes of subjects and latestItemIds are different"),null;for(var i=[],c=0;c<t.length;c++){var o={fileType:r.a.MailItem,name:t[c],size:(null==n?void 0:n[c])||0,itemId:e[c]};i.push(o)}return i}function a(t,e,n){var i=[],c={fileType:r.a.MailItem,name:t,size:n||0,mimeContent:e};return i.push(c),i}function s(t){if(!t)return null;for(var e=[],n=0;n<t.length;n++){var i=t[n],c={fileType:r.a.Local,name:i.name,size:i.size,type:i.type,fileObject:i};e.push(c)}return e}function d(t){if(!t)return null;for(var e=[],n=0;n<t.length;n++){var r=t[n],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};e.push(i)}return e}function f(t){var e,n;return null===t?null:{fileType:r.a.Cloud,name:t.Name,size:t.Size,providerId:t.AttachmentProviderId,providerType:t.ProviderType,location:t.Location,providerEndpointUrl:t.ProviderEndpointUrl,isFolder:1===t.Type,fileId:t.Id,fileParentId:t.ParentId,thumbnailUrl:(null===(e=t.Thumbnail)||void 0===e?void 0:e.Url)||"",previewUrl:(null===(n=t.Preview)||void 0===n?void 0:n.Url)||"",type:t.MimeType}}function l(t){return null===t?null:{attachmentItemId:t.Id,name:t.Name,size:t.Size,fileType:r.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var b={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function p(t){switch(t?t.toLowerCase():null){case b.ONE_DRIVE_PRO.toLowerCase():return 0;case b.GDRIVE.toLowerCase():return 5;case b.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case b.DROPBOX.toLowerCase():return 2;case b.BOX.toLowerCase():return 3;case b.WOPI_BOX.toLowerCase():return 7;case b.WOPI_EGNYTE.toLowerCase():return 8;case b.MAILBOX.toLowerCase():return 4;case b.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(e,"i",(function(){return c})),n.d(e,"h",(function(){return o})),n.d(e,"g",(function(){return a})),n.d(e,"f",(function(){return s})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return f})),n.d(e,"c",(function(){return l})),n.d(e,"b",(function(){return p})),n.d(e,"a",(function(){return r.a}))},1469:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},t)}},1471:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return c})),n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return o}));var r="FileAttachment:#Exchange",i="ItemAttachment:#Exchange",c="ItemIdAttachment:#Exchange",u="ReferenceAttachment:#Exchange",o="LinkAttachment:#Exchange"},1527:function(t,e,n){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),function(t){t.noPermissionToShare="WarningNoPermissionToShare",t.getSharingInfoFailed="WarningGetSharingInfoFailed",t.linkHasExpired="WarningLinksHasExpired",t.linkWillExpire="WarningLinksWillExpire",t.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",t.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",t.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",t.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1553:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1471);function i(t){return(t.__type||t.OwsTypeName)===r.e}},1566:function(t){t.exports=JSON.parse('{"b":"Yba","d":"Zba","c":"_ba","a":"$ba"}')},1580:function(t,e){t.exports=function(t){return t instanceof Date}},1607:function(t,e,n){var r=n(1580),i=36e5,c=6e4,u=2,o=/[T ]/,a=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],f=/^(\d{4})/,l=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],b=/^-(\d{2})$/,p=/^-?(\d{3})$/,m=/^-?(\d{2})-?(\d{2})$/,O=/^-?W(\d{2})$/,v=/^-?W(\d{2})-?(\d{1})$/,g=/^(\d{2}([.,]\d*)?)$/,h=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,j=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,S=/([Z+-].*)$/,I=/^(Z)$/,y=/^([+-])(\d{2})$/,x=/^([+-])(\d{2}):?(\d{2})$/;function A(t,e,n){e=e||0,n=n||0;var r=new Date(0);r.setUTCFullYear(t,0,4);var i=7*e+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}t.exports=function(t,e){if(r(t))return new Date(t.getTime());if("string"!=typeof t)return new Date(t);var n=(e||{}).additionalDigits;n=null==n?u:Number(n);var w=function(t){var e,n={},r=t.split(o);a.test(r[0])?(n.date=null,e=r[0]):(n.date=r[0],e=r[1]);if(e){var i=S.exec(e);i?(n.time=e.replace(i[1],""),n.timezone=i[1]):n.time=e}return n}(t),T=function(t,e){var n,r=d[e],i=l[e];if(n=f.exec(t)||i.exec(t)){var c=n[1];return{year:parseInt(c,10),restDateString:t.slice(c.length)}}if(n=s.exec(t)||r.exec(t)){var u=n[1];return{year:100*parseInt(u,10),restDateString:t.slice(u.length)}}return{year:null}}(w.date,n),E=T.year,P=function(t,e){if(null===e)return null;var n,r,i,c;if(0===t.length)return(r=new Date(0)).setUTCFullYear(e),r;if(n=b.exec(t))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(e,i),r;if(n=p.exec(t)){r=new Date(0);var u=parseInt(n[1],10);return r.setUTCFullYear(e,0,u),r}if(n=m.exec(t)){r=new Date(0),i=parseInt(n[1],10)-1;var o=parseInt(n[2],10);return r.setUTCFullYear(e,i,o),r}if(n=O.exec(t))return c=parseInt(n[1],10)-1,A(e,c);if(n=v.exec(t)){c=parseInt(n[1],10)-1;var a=parseInt(n[2],10)-1;return A(e,c,a)}return null}(T.restDateString,E);if(P){var C,k=P.getTime(),_=0;return w.time&&(_=function(t){var e,n,r;if(e=g.exec(t))return(n=parseFloat(e[1].replace(",",".")))%24*i;if(e=h.exec(t))return n=parseInt(e[1],10),r=parseFloat(e[2].replace(",",".")),n%24*i+r*c;if(e=j.exec(t)){n=parseInt(e[1],10),r=parseInt(e[2],10);var u=parseFloat(e[3].replace(",","."));return n%24*i+r*c+1e3*u}return null}(w.time)),w.timezone?C=function(t){var e,n;if(e=I.exec(t))return 0;if(e=y.exec(t))return n=60*parseInt(e[2],10),"+"===e[1]?-n:n;if(e=x.exec(t))return n=60*parseInt(e[2],10)+parseInt(e[3],10),"+"===e[1]?-n:n;return 0}(w.timezone):(C=new Date(k+_).getTimezoneOffset(),C=new Date(k+_+C*c).getTimezoneOffset()),new Date(k+_+C*c)}return new Date(t)}},1640:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(270);function i(t){switch(t){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(t)}}},1681:function(t,e,n){"use strict";var r=n(1471),i=n(12),c=function(t){return t&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(t)};function u(t){var e=t.__type||t.OwsTypeName;switch(e){case r.a:return 0;case r.e:return t.IsLink?3:1;case r.d:return 3;case r.b:return 2;case r.c:var n=t,u=t.EmbeddedItemClass;return u&&c(u)||Object(i.f)(n.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+e)}}n.d(e,"a",(function(){return u}))},1694:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.InProgress=0]="InProgress",t[t.Failed=1]="Failed",t[t.Succeeded=2]="Succeeded"}(r||(r={}))},1718:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(3),i=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(t){return{id:t}}))},1719:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.ignore=0]="ignore",t[t.refreshExpiration=1]="refreshExpiration",t[t.changePermission=2]="changePermission",t[t.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1780:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return c}));var r=n(1681);function i(t){return u(t.type)}function c(t){return u(Object(r.a)(t))}function u(t){return 1===t||3===t}},1784:function(t,e,n){"use strict";var r=n(1384);function i(){var t=Object(r.a)();return t.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var c=n(1640),u=n(1553);function o(){return i()}function a(t){return(t&&t.length>0&&function(t){return t.some((function(t){return!((e=t).IsInline&&!Object(u.a)(e));var e}))}(t)?i():[]).map(c.a)}n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return a}))},1874:function(t,e,n){"use strict";n.d(e,"h",(function(){return s})),n.d(e,"i",(function(){return d})),n.d(e,"f",(function(){return f})),n.d(e,"k",(function(){return l})),n.d(e,"m",(function(){return b})),n.d(e,"e",(function(){return p})),n.d(e,"g",(function(){return m})),n.d(e,"j",(function(){return O})),n.d(e,"l",(function(){return v}));var r=n(77),i=n(1718);n.d(e,"n",(function(){return i.a}));var c=n(1694);n.d(e,"a",(function(){return c.a}));var u=n(1527);n.d(e,"d",(function(){return u.b})),n.d(e,"c",(function(){return u.a}));var o=n(1719);n.d(e,"b",(function(){return o.a}));var a=new r.c((function(){return Promise.all([n.e(1),n.e(33),n.e(70),n.e(724)]).then(n.bind(null,2900))})),s=new r.b(a,(function(t){return t.getSharingInformation})),d=new r.b(a,(function(t){return t.getSharingIssuesForSharingData})),f=new r.b(a,(function(t){return t.getInfoBarCreator})),l=new r.b(a,(function(t){return t.hasLargeDLRecipient})),b=new r.b(a,(function(t){return t.hasRecipientExpansionFailure})),p=new r.b(a,(function(t){return t.getGroupsAndSmallDLs})),m=new r.b(a,(function(t){return t.getInvididualRecipients})),O=new r.b(a,(function(t){return t.hasGetRecipientPermissionFailed})),v=new r.b(a,(function(t){return t.logSharingTipChangesForLinkRemoval}))},190:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(24);function i(){var t=Object(r.a)(),e=t.origin;return e||(e=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")),e}},1938:function(t,e,n){"use strict";var r=n(77),i=[0,1],c=n(2136),u=n(2101),o=n(12),a=n(270),s=n(1389);function d(t){switch(t){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(o.b)(u.a),messageParts:[Object(o.b)(u.a),f()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(o.b)(c.b),messageParts:[Object(o.b)(c.b),f()],color:s.a.Red};default:return Object(a.a)(t)}}function f(){return{text:Object(o.b)(c.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var l=n(1784),b=n(1640),p=n(0),m=n(83),O=n(1384);function v(){var t=Object(O.a)();if(Object(m.i)("fwk-devTools")){if(Object(m.i)("doc-attachment-CA-readOnlyAccessIssues"))return Object(p.__assign)(Object(p.__assign)({},t),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(m.i)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(p.__assign)(Object(p.__assign)({},t),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return t}function g(){var t=v();return t.DirectFileAccessOnPrivateComputersEnabled&&t.DirectFileAccessOnPublicComputersEnabled?2:t.WacViewingOnPrivateComputersEnabled&&t.WacViewingOnPublicComputersEnabled?0:1}n.d(e,"g",(function(){return j})),n.d(e,"a",(function(){return i})),n.d(e,"f",(function(){return d})),n.d(e,"b",(function(){return l.a})),n.d(e,"e",(function(){return b.a})),n.d(e,"d",(function(){return g})),n.d(e,"c",(function(){return v}));var h=new r.c((function(){return n.e(1570).then(n.bind(null,16451))})),j=new r.b(h,(function(t){return t.getAccessIssuesForAttachments}))},2101:function(t){t.exports=JSON.parse('{"a":"cca"}')},2136:function(t){t.exports=JSON.parse('{"a":"aca","b":"bca"}')},2518:function(t,e,n){"use strict";function r(t){var e=null;return(e=t.AttachLongPathName)||(e=t.WebUrl),e}n.d(e,"a",(function(){return r}))},295:function(t,e,n){"use strict";var r=n(30),i=n(0),c=n(96),u=n(83);function o(t){var e=Object(c.i)(t);return e&&e.SessionSettings?0===e.SessionSettings.WebSessionType?Object(u.i)("doc-attachment-routingKeyAadSmtp")?"SMTP:":"":"MSA:":"no-routing-key:"}var a=n(59);function s(t,e,n){var r,c;if(n)try{for(var u=Object(i.__values)(n),o=u.next();!o.done;o=u.next()){var a=o.value;if(!d(t,a))return a}}catch(t){r={error:t}}finally{try{o&&!o.done&&(c=u.return)&&c.call(u)}finally{if(r)throw r.error}}return e&&e.length>0?e[0]:"NoResolvableAddress@invalid.outlook.com"}function d(t,e){return("outlook_"+t+"@outlook.com").toLowerCase()===e.toLowerCase()}function f(){var t=function(){var t=Object(r.a)();if(!t||!t.SessionSettings)return a.d("SessionSettings not available"),"no-routing-key";var e=t.SessionSettings.UserEmailAddress;if(0===t.SessionSettings.WebSessionType)return o()+e;if(Object(u.i)("doc-attachment-routingKeyPuid"))return"PUID:"+t.SessionSettings.UserPuid+"@"+t.SessionSettings.TenantGuid;if(t.SessionSettings.IsShadowMailbox)return o()+t.SessionSettings.LogonEmailAddress;if(d(t.HexCID,t.SessionSettings.UserEmailAddress))return o()+s(t.HexCID,t.SessionSettings.NotManagedEmailAddresses,t.SessionSettings.UserProxyAddresses);return o()+e}();return t=encodeURIComponent(t)}function l(){var t=Object(r.a)();if(!t||!t.SessionSettings)return a.d("SessionSettings not available"),"no-mailbox-id";var e=t.SessionSettings.UserEmailAddress;return Object(u.i)("doc-attachment-usePrimarySmtpAddressForMailboxId")?e:(t.SessionSettings.IsShadowMailbox?e=t.SessionSettings.LogonEmailAddress:d(t.HexCID,t.SessionSettings.UserEmailAddress)&&(e=s(t.HexCID,t.SessionSettings.NotManagedEmailAddresses,t.SessionSettings.UserProxyAddresses)),e)}var b=n(747),p=n(623);function m(t){var e=Object(p.a)().userMailboxInfoMap;e&&e.delete(t)}function O(t,e){return t===e||null!=t&&null!=e&&t.Id===e.Id}n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return b.a})),n.d(e,"f",(function(){return m})),n.d(e,"e",(function(){return O})),n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return o}))},3155:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1471);function i(t){return(t.__type||t.OwsTypeName)===r.d}},337:function(t,e,n){"use strict";var r=n(726);n.d(e,"a",(function(){return r.a}))},362:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return u}));var r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function i(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function c(){return i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()}function u(t){return r.test(t)}},388:function(t,e,n){"use strict";var r,i=n(3);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var c,u=n(74),o=Object(i.action)("addAccount",(function(t){return{userIdentity:t.userIdentity,account:t}})),a=Object(i.action)("removeAccount",(function(t){return{userIdentity:t}})),s=Object(i.action)("updateAccount",(function(t,e,n){return{userIdentity:t,accountToken:e,accountTokenExpiresIn:n}})),d=Object(i.action)("updateOWAConnectedAccountStatus",(function(t,e){return{userIdentity:t,accountState:e}})),f=Object(i.action)("accountIsInErrorState",(function(t,e){return Object(u.c)({name:"accountIsInErrorState",options:{isCore:!0},customData:{accountState_1:r[t],accountProvider_2:e}},{accountState:t})})),l=Object(i.action)("retryAccountUpdateToken",(function(t,e,n,i,c){return Object(u.c)({name:"retryAccountUpdateToken",customData:{currentAccountState_1:r[n],localAccountState_2:r[i],previousAccountState_3:r[c]}},{accountId:t,userIdentity:e,currentAccountState:n})})),b=Object(i.action)("connectedAccountsListRequested",(function(t){return Object(u.c)({name:"connectedAccountsGetResponse",options:{isCore:!0},customData:{isSuccess_1:t}},{isSuccess:t})})),p=Object(i.action)("setAccountsStoreState",(function(t){return{state:t}})),m=n(0),O=n(20);!function(t){t[t.None=0]="None",t[t.AccountsLoadSuccessful=1]="AccountsLoadSuccessful",t[t.AccountsLoadError=2]="AccountsLoadError"}(c||(c={}));var v=Object(i.createStore)("OWAAccountsStore",{accountsMap:new O.ObservableMap({}),accountsLoadedState:c.None}),g=n(270),h=n(96);function j(t){return t!=Object(h.b)()&&void 0!==I(t)}function S(){return Object(m.__spread)(v().accountsMap.values())}function I(t){return v().accountsMap.get(t)}function y(){var t;return(null===(t=S())||void 0===t?void 0:t.length)>0?S()[0]:null}function x(){return S().filter((function(t){return t.accountState!=r.Valid}))}function A(t){return S().filter((function(e){return t.includes(e.accountState)}))}function w(t){return S().filter((function(e){return e.accountProviderType==t}))}function T(t){return j(t)?I(t).accountProviderType:null}function E(t){return"Outlook"==t.accountProviderType?'MSAuth1.0 usertoken="'+t.token+'", type="MSACT"':"Google"==t.accountProviderType||"ICloud"==t.accountProviderType?"Bearer "+t.token:Object(g.a)(t.accountProviderType)}function P(t,e){return function(n){var r=I(n);return r?r[t]:e}}P("accountUniqueId","0");var C=P("accountState",r.Valid),k=function(){return S().some((function(t){return!L(t.userIdentity)}))},_=P("accountProviderType",null),M=function(t){return"Outlook"==_(t)},L=function(t){return C(t)==r.Valid},D=function(){return S().length>0};function R(){return v().accountsLoadedState}var F=n(9),W=n(269);Object(i.mutator)(o,(function(t){var e=t.account;Object(W.p)("owaAccountAdded",{accountStatus_1:r[e.accountState]}),v().accountsMap.set(e.userIdentity,e)})),Object(i.mutator)(a,(function(t){var e=t.userIdentity;v().accountsMap.delete(e)})),Object(i.mutator)(s,(function(t){var e=t.userIdentity,n=t.accountToken,r=t.accountTokenExpiresIn,i=v().accountsMap.get(e);i.token=n,i.tokenExpiry=Object(F.j)(Object(F.Pb)(),parseInt(r))})),Object(i.mutator)(d,(function(t){var e=t.userIdentity,n=t.accountState,i=v().accountsMap.get(e);i.accountState==r.Valid&&n!=r.Valid&&Object(W.p)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[n]}),i.accountState=n})),Object(i.mutator)(b,(function(t){var e=t.isSuccess?c.AccountsLoadSuccessful:c.AccountsLoadError;v().accountsLoadedState=e})),Object(i.mutator)(p,(function(t){v().accountsLoadedState=t.state})),n.d(e,"d",(function(){return o})),n.d(e,"u",(function(){return a})),n.d(e,"y",(function(){return s})),n.d(e,"x",(function(){return d})),n.d(e,"c",(function(){return f})),n.d(e,"v",(function(){return l})),n.d(e,"e",(function(){return b})),n.d(e,"w",(function(){return p})),n.d(e,"n",(function(){return S})),n.d(e,"k",(function(){return I})),n.d(e,"i",(function(){return y})),n.d(e,"f",(function(){return x})),n.d(e,"g",(function(){return A})),n.d(e,"o",(function(){return w})),n.d(e,"j",(function(){return T})),n.d(e,"m",(function(){return E})),n.d(e,"l",(function(){return C})),n.d(e,"q",(function(){return k})),n.d(e,"t",(function(){return M})),n.d(e,"s",(function(){return L})),n.d(e,"p",(function(){return D})),n.d(e,"h",(function(){return R})),n.d(e,"r",(function(){return j})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return c}))},429:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(75);function i(t){return Object(r.a)(t,[r.c])}},440:function(t,e,n){"use strict";var r=n(0);function i(t,e){return t?Object(r.__assign)({mailboxInfo:t},e):null!=e?e:void 0}n.d(e,"a",(function(){return i}))},444:function(t,e,n){"use strict";var r=function(){function t(t,e,n){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout((function(){t.tryRunTask()}),this.taskDelay)},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.tryRunTask=function(){var t=this;if(this.canRunMoreTasks()){var e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then((function(){t.onTaskComplete()})).catch((function(){t.onTaskComplete()})),this.scheduleTask()}},t}();n.d(e,"a",(function(){return r}))},547:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"FolderId:#Exchange"},t)}},622:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"ItemResponseShape:#Exchange"},t)}},623:function(t,e,n){"use strict";var r=n(3),i=n(20);e.a=Object(r.createStore)("OWAClientIdStore",{userMailboxInfoMap:new i.ObservableMap})},662:function(t,e,n){"use strict";var r=n(3),i=Object(r.action)("initializeOwaObservableDateTime"),c=Object(r.action)("observableNowChanged"),u=Object(r.action)("observableTodayChanged"),o=n(9),a=n(20),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),d=Object(a.computed)((function(){return Object(o.lc)(s().now)})),f=function(){return d.get()},l=Object(a.computed)((function(){return Object(o.lc)(s().today)})),b=function(){return l.get()},p=function(t){return Object(o.Gb)(t,f())},m=function(t){return Object(o.Eb)(t,f())},O=function(t){return g(t,o.Gb)},v=function(t){return g(t,o.Hb)},g=function(t,e){return e(Object(o.Wb)(Object(o.lc)(t)),b())};function h(t){if(!t)return"";var e=Object(o.lc)(t);return function(t,e){var n=Object(o.Wb)(t);if(Object(o.Ib)(n,e))return o.Z;var r=function(t){return Object(o.Mb)(n,Object(o.e)(e,-t),e)};if(r(3))return o.hb;if(r(30))return o.gb;return o.X}(e,b())(e)}function j(t){if(!t)return"";var e=Object(o.lc)(t);return function(t,e){var n=Object(o.Wb)(t);if(Object(o.Ib)(n,e))return o.S;return o.T}(e,b())(e)}function S(t){return t?function(t,e){var n=Object(o.Wb)(t);return Object(o.Ib)(n,e)?Object(o.Z)(t):I(n,e,2)?Object(o.kb)(t):I(n,e,7)?Object(o.H)(Object(o.ab)(t),Object(o.Z)(t)):Object(o.H)(Object(o.J)(t),Object(o.Z)(t))}(Object(o.lc)(t),b()):""}function I(t,e,n){return Object(o.Mb)(t,Object(o.e)(e,-n),e)}var y=Object(r.action)("updateTimes"),x=Object(r.action)("setNow"),A=Object(r.action)("setToday",(function(t){return{today:t}}));Object(r.mutator)(x,(function(){s().now=Object(o.jc)()})),Object(r.mutator)(A,(function(t){var e=t.today;s().today=e}));var w=n(34),T=n(128);Object(r.orchestrator)(i,(function(){y();var t=Object(o.Pb)(),e=Object(o.Yb)(Object(o.h)(t,1)),n=Object(o.w)(e,t);setTimeout((function(){return setInterval(y,w.g)}),n)})),Object(r.orchestrator)(T.l,(function(){y()})),Object(r.orchestrator)(y,(function(){x();var t=Object(o.zb)(Object(o.kc)()),e=s().today!=t;e&&A(t),c(),e&&u()})),n.d(e,"d",(function(){return i})),n.d(e,"j",(function(){return c})),n.d(e,"l",(function(){return u})),n.d(e,"i",(function(){return f})),n.d(e,"k",(function(){return b})),n.d(e,"g",(function(){return p})),n.d(e,"e",(function(){return m})),n.d(e,"f",(function(){return O})),n.d(e,"h",(function(){return v})),n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return j})),n.d(e,"c",(function(){return S}))},670:function(t,e,n){"use strict";function r(t){void 0===t&&(t={}),function(t){t.timeBetweenRetryInMS=t.timeBetweenRetryInMS||function(){return 6e4}}(t);var e=t.maximumAttempts,n=t.timeBetweenRetryInMS;return function(t){var r=0,i=!1,c=function(u,o){i?o(new Error("The function retry was cancelled")):(r++,t().then((function(t){return u(t)})).catch((function(t){e&&r>=e?o(t):setTimeout((function(){return c(u,o)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(t,e){return c(t,e)}))},cancel:function(){return i=!0}}}}function i(t){return function(e){return Math.pow(2,e)*t}}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}))},6990:function(t,e,n){"use strict";var r=n(2368),i=n(1379),c=n(8225),u=n(83),o=n(285);e.a=Object(o.action)("setAttachmentPermissionLevel")((function(t,e,n,o){var a=Object(i.a)(t),s=a.model;s.PermissionType=e,n&&(s.AttachLongPathName=n,a.openUrl=Object(c.a)(s)),Object(u.i)("doc-attachment-referenceAttachmentExpiration")&&a.info&&a.info.sharingInfo&&(a.info.sharingInfo.expirationDate=o),Object(r.a)(t)}))},6991:function(t,e,n){"use strict";var r=n(0),i=n(1379),c=n(2007),u=n(5381),o=n(1780),a=n(2247),s=n(285);e.a=Object(s.action)("refreshThumbnailImageUrl")((function(t,e,n){return void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(s=Object(i.a)(t),!Object(o.b)(s.model))return[3,7];switch(s.model.ProviderType){case c.e:return[3,1]}return[3,5];case 1:return r.trys.push([1,3,,4]),[4,Object(u.a)(s.model)];case 2:return d=r.sent(),s.thumbnailImage.url=d,[3,4];case 3:return r.sent(),s.thumbnailImage.url=null,[3,4];case 4:case 5:return[3,6];case 6:return[3,8];case 7:d=Object(a.a)(t,s.model,2,Object(o.b)(s.model),e,n),s.thumbnailImage.url=d,r.label=8;case 8:return[2]}}))}))}))},726:function(t,e,n){"use strict";function r(t){return t>=200&&t<300}n.d(e,"a",(function(){return r}))},7292:function(t,e,n){"use strict";var r=n(0),i=n(285),c=n(9),u=n(6990);function o(t){return Object(r.__assign)({__type:"SetAttachmentPermissionsRequest:#Exchange"},t)}var a=n(29);function s(t,e,n,r){void 0===n&&(n=null),void 0===r&&(r=!1);var i,c,u=function(t,e,n,r){return void 0===n&&(n=null),void 0===r&&(r=!1),o({AttachmentIds:t,PermissionLevel:e,NewAttachLongPathNames:n,SetToOriginalPermissionLevel:r})}(t,e,n,r);return void 0===(i={request:u}).request||i.request.__type||(i.request=o(i.request)),Object(a.a)("SetAttachmentPermissionsV2",i,c)}e.a=Object(i.action)("changeAttachmentPermission")((function(t,e,n,i){return void 0===n&&(n=null),void 0===i&&(i=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,s(t.map((function(t){return t.Id})),e,n,i)];case 1:if(!(o=r.sent()).OperationSucceeded||!o.NewAttachLongPathNames||o.NewAttachLongPathNames.length!==t.length)throw new Error("Error setting attachment permissions");return t.forEach((function(t,n){var r,i=null;(null===(r=o.ExpirationDates)||void 0===r?void 0:r[n])&&(i=Object(c.lc)(o.ExpirationDates[n])),Object(u.a)(t,e,o.NewAttachLongPathNames[n],i)})),[2]}}))}))}))},747:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(96),i=n(623);function c(t){var e=Object(i.a)().userMailboxInfoMap;if(!e||!e.get(t)){var n=!1;t&&(n=t!=Object(r.b)());var c={type:"UserMailbox",userIdentity:n?t:Object(r.b)(),mailboxSmtpAddress:n?t:Object(r.c)()};return e.set(t,c),c}return e.get(t)}},780:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"FindItemJsonRequest:#Exchange"},t)}},794:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(29),i=n(780);function c(t,e){return void 0===t||t.__type||(t=Object(i.a)(t)),Object(r.a)("FindItem",t,e)}},795:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"FindItemRequest:#Exchange"},t)}}}]);
//# sourceMappingURL=owa.AttachmentModelStore.js.map
self.scriptsLoaded['owa.AttachmentModelStore.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentModelStore.js'] = (new Date()).getTime();